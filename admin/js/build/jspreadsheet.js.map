{"version":3,"file":"jspreadsheet.js","mappings":";;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AAAE,WAAUA,MAAM,EAAEC,OAAO,EAAE;EAC5B;EACA;EACA;EACAD,MAAM,CAACE,YAAY,GAAGF,MAAM,CAACG,MAAM,GAAGF,OAAO,CAAC,CAAC;AAChD,CAAC,EAACG,MAAM,EAAG,YAAY;EAAE;;EAExB,YAAY;;EAEZ;EACA,IAAIC,OAAO,GAAG,YAAW;IACxB;IACA,IAAIC,IAAI,GAAG;MACVC,KAAK,EAAE,cAAc;MACrBC,OAAO,EAAE,OAAO;MAChBC,IAAI,EAAE,IAAI;MACVC,IAAI,EAAE,mCAAmC;MACzCC,OAAO,EAAE,KAAK;MACdC,KAAK,EAAE,SAAAA,CAAA,EAAW;QACjB,OAAO,CAAE,IAAI,CAACL,KAAK,GAAG,GAAG,GAAG,IAAI,CAACE,IAAI,GAAG,GAAG,GAAG,IAAI,CAACD,OAAO,EAAE,IAAI,CAACE,IAAI,EAAE,IAAI,CAACC,OAAO,CAAE,CAACE,IAAI,CAAC,MAAM,CAAC;MACnG;IACD,CAAC;IAED,OAAO,YAAW;MACjB,OAAOP,IAAI;IACZ,CAAC;EACF,CAAC,CAAC,CAAC;;EAEH;AACD;AACA;EACC,IAAIQ,SAAS,GAAG,SAAAA,CAASC,KAAK,EAAE;IAC/B,IAAIC,CAAC,GAAG,CAAC,EAAE,GAACD,KAAK,EAAE,CAAC,CAAC;IACrB,OAAOC,CAAC,IAAI,GAAG,IAAIA,CAAC,IAAI,GAAG,GAAG,IAAI,GAAG,KAAK;EAC3C,CAAC;;EAED;AACD;AACA;EACC,IAAIC,OAAO,GAAG,SAAAA,CAASC,CAAC,EAAE;IACzB,IAAIA,CAAC,CAACC,MAAM,IAAID,CAAC,CAACE,IAAI,IAAIF,CAAC,CAACG,MAAM,EAAE;MACnC,IAAIC,GAAG,GAAG,CAAC,CAAC;MACZ,IAAIJ,CAAC,CAACE,IAAI,EAAE;QACXE,GAAG,CAACF,IAAI,GAAGF,CAAC,CAACE,IAAI;MAClB,CAAC,MAAM,IAAIF,CAAC,CAACC,MAAM,EAAE;QACpBG,GAAG,CAACF,IAAI,GAAGF,CAAC,CAACC,MAAM;MACpB,CAAC,MAAM;QACNG,GAAG,CAACD,MAAM,GAAGH,CAAC,CAACG,MAAM;QACrBC,GAAG,CAACC,OAAO,GAAGL,CAAC,CAACK,OAAO;MACxB;MAEA,IAAIL,CAAC,CAACM,OAAO,EAAE;QACd,IAAI,CAAEF,GAAG,CAACC,OAAO,EAAE;UAClBD,GAAG,CAACC,OAAO,GAAG,CAAC,CAAC;QACjB;QACAD,GAAG,CAACC,OAAO,GAAG;UAAEC,OAAO,EAAEN,CAAC,CAACM;QAAQ,CAAC;MACrC;MACA,OAAOF,GAAG;IACX;IAEA,OAAO,IAAI;EACZ,CAAC;;EAED;EACA,IAAInB,MAAM,GAAI,SAAAA,CAASsB,EAAE,EAAEF,OAAO,EAAE;IACnC;IACA,IAAIG,GAAG,GAAG,CAAC,CAAC;IACZA,GAAG,CAACH,OAAO,GAAG,CAAC,CAAC;IAEhB,IAAI,EAAGE,EAAE,YAAYE,OAAO,IAAIF,EAAE,YAAYG,YAAY,CAAC,EAAE;MAC5DC,OAAO,CAACC,KAAK,CAAC,6CAA6C,CAAC;MAC5D,OAAO,KAAK;IACb,CAAC,MAAM,IAAIL,EAAE,CAACM,OAAO,IAAI,OAAO,EAAE;MACjC,IAAIR,OAAO,GAAGpB,MAAM,CAAC6B,eAAe,CAACP,EAAE,EAAEF,OAAO,CAAC,EAAE;QAClD,IAAIU,GAAG,GAAGC,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;QACvCV,EAAE,CAACW,UAAU,CAACC,YAAY,CAACJ,GAAG,EAAER,EAAE,CAAC;QACnCA,EAAE,CAACa,MAAM,CAAC,CAAC;QACXb,EAAE,GAAGQ,GAAG;MACT,CAAC,MAAM;QACNJ,OAAO,CAACC,KAAK,CAAC,6CAA6C,CAAC;QAC5D,OAAO,KAAK;MACb;IACD;;IAEA;IACA,IAAIS,QAAQ,GAAG;MACd;MACAC,GAAG,EAAC,IAAI;MACR;MACAC,MAAM,EAAE,KAAK;MACbC,gBAAgB,EAAE,IAAI;MACtB;MACAC,IAAI,EAAC,IAAI;MACT;MACAC,OAAO,EAAC,IAAI;MACZ;MACAC,iBAAiB,EAAC,KAAK;MACvBC,IAAI,EAAC,IAAI;MACT;MACAC,IAAI,EAAC,EAAE;MACPC,OAAO,EAAC,EAAE;MACV;MACAC,UAAU,EAAC,EAAE;MACbC,SAAS,EAAC,EAAE;MACZC,aAAa,EAAC,EAAE;MAChBC,aAAa,EAAC,IAAI;MAClB;MACAC,eAAe,EAAC,EAAE;MAClBC,eAAe,EAAC,QAAQ;MACxB;MACAC,gBAAgB,EAAE,IAAI;MACtB;MACAC,YAAY,EAAC,CAAC;MACdC,YAAY,EAAC,CAAC;MACd;MACAC,aAAa,EAAC,CAAC,CAAC,EAAC,CAAC,CAAC;MACnB;MACAC,WAAW,EAAC,IAAI;MAChB;MACAC,wBAAwB,EAAC,KAAK;MAC9B;MACAC,oBAAoB,EAAC,KAAK;MAC1B;MACAC,aAAa,EAAC,IAAI;MAClB;MACAC,UAAU,EAAC,KAAK;MAChB;MACAC,YAAY,EAAC,IAAI;MACjB;MACAC,SAAS,EAAC,KAAK;MACf;MACAC,OAAO,EAAC,IAAI;MACZ;MACAC,QAAQ,EAAC,IAAI;MACb;MACAC,cAAc,EAAC,IAAI;MACnB;MACAC,oBAAoB,EAAC,IAAI;MACzB;MACAC,iBAAiB,EAAC,IAAI;MACtB;MACAC,uBAAuB,EAAC,IAAI;MAC5B;MACAC,cAAc,EAAC,IAAI;MACnB;MACAC,oBAAoB,EAAC,KAAK;MAC1B;MACAC,iBAAiB,EAAC,IAAI;MACtB;MACAC,iBAAiB,EAAC,IAAI;MACtB;MACAC,aAAa,EAAC,KAAK;MACnB;MACAC,QAAQ,EAAC,KAAK;MACd;MACAC,YAAY,EAAE,IAAI;MAClB;MACAC,GAAG,EAAC,IAAI;MACR;MACAC,WAAW,EAAC,cAAc;MAC1B;MACAC,UAAU,EAAC,IAAI;MACf;MACAC,YAAY,EAAC,GAAG;MAChB;MACAC,0BAA0B,EAAC,KAAK;MAChCC,sBAAsB,EAAC,KAAK;MAC5B;MACAC,aAAa,EAAC,IAAI;MAClB;MACAC,UAAU,EAAC,CAAC,CAAC;MACb;MACAC,OAAO,EAAC,IAAI;MACZ;MACAC,MAAM,EAAC,KAAK;MACZ;MACAC,UAAU,EAAC,KAAK;MAChBC,iBAAiB,EAAC,IAAI;MACtB;MACAC,UAAU,EAAC,KAAK;MAChB;MACAC,WAAW,EAAC,KAAK;MACjBC,WAAW,EAAC,KAAK;MACjB;MACAC,aAAa,EAAC,KAAK;MACnBC,WAAW,EAAC,OAAO;MACnBC,UAAU,EAAC,IAAI;MACfC,YAAY,EAAC,KAAK;MAClB;MACAC,IAAI,EAAE,IAAI;MACV;MACAC,KAAK,EAAC,IAAI;MACVC,OAAO,EAAC,IAAI;MACZ;MACAC,aAAa,EAAC,IAAI;MAClBC,aAAa,EAAC,IAAI;MAClBC,WAAW,EAAC,IAAI;MAChB;MACAC,cAAc,EAAC,IAAI;MACnBC,SAAS,EAAC,IAAI;MACdC,eAAe,EAAC,KAAK;MACrB;MACAC,OAAO,EAAC,KAAK;MACbC,OAAO,EAAC,IAAI;MACZ;MACAC,MAAM,EAAC,IAAI;MACXC,MAAM,EAAC,IAAI;MACXC,MAAM,EAAC,IAAI;MACXC,QAAQ,EAAC,IAAI;MACbC,UAAU,EAAC,IAAI;MACfC,cAAc,EAAC,IAAI;MACnBC,cAAc,EAAC,IAAI;MACnBC,iBAAiB,EAAE,IAAI;MACvBC,WAAW,EAAC,IAAI;MAChBC,oBAAoB,EAAE,IAAI;MAC1BC,cAAc,EAAC,IAAI;MACnBC,iBAAiB,EAAC,IAAI;MACtBC,WAAW,EAAC,IAAI;MAChBC,oBAAoB,EAAC,IAAI;MACzBC,cAAc,EAAC,IAAI;MACnBC,SAAS,EAAC,IAAI;MACdC,YAAY,EAAC,IAAI;MACjBC,WAAW,EAAC,IAAI;MAChBC,cAAc,EAAC,IAAI;MACnBC,MAAM,EAAC,IAAI;MACXC,WAAW,EAAC,IAAI;MAChBC,MAAM,EAAC,IAAI;MACXC,OAAO,EAAC,IAAI;MACZC,aAAa,EAAC,IAAI;MAClBC,OAAO,EAAC,IAAI;MACZC,OAAO,EAAC,IAAI;MACZC,MAAM,EAAC,IAAI;MACXC,cAAc,EAAC,IAAI;MACnBC,cAAc,EAAC,IAAI;MACnBC,cAAc,EAAC,IAAI;MACnBC,YAAY,EAAC,IAAI;MACjBC,aAAa,EAAC,IAAI;MAClBC,YAAY,EAAC,IAAI;MACjBC,YAAY,EAAC,IAAI;MACjBC,YAAY,EAAC,IAAI;MACjBC,MAAM,EAAC,IAAI;MACX;MACAC,OAAO,EAAC,IAAI;MACZ;MACAC,WAAW,EAAC,KAAK;MACjB;MACAC,WAAW,EAAC,IAAI;MAChB;MACAC,gBAAgB,EAAE,KAAK;MACvBC,aAAa,EAAC,IAAI;MAClB;MACAC,IAAI,EAAC;QACJC,cAAc,EAAE,kBAAkB;QAClCC,WAAW,EAAE,iCAAiC;QAC9CC,IAAI,EAAE,OAAO;QACbjE,MAAM,EAAE,QAAQ;QAChBkE,OAAO,EAAE,UAAU;QACnBC,UAAU,EAAE,aAAa;QACzBC,sBAAsB,EAAE,4BAA4B;QACpDC,qBAAqB,EAAE,2BAA2B;QAClDC,qBAAqB,EAAE,yBAAyB;QAChDC,gBAAgB,EAAE,oBAAoB;QACtCC,cAAc,EAAE,iBAAiB;QACjCC,eAAe,EAAE,kBAAkB;QACnCC,mBAAmB,EAAE,yBAAyB;QAC9CC,kBAAkB,EAAE,wBAAwB;QAC5CC,kBAAkB,EAAE,sBAAsB;QAC1CC,YAAY,EAAE,eAAe;QAC7BC,WAAW,EAAE,cAAc;QAC3BC,QAAQ,EAAE,UAAU;QACpBC,aAAa,EAAE,gBAAgB;QAC/BC,IAAI,EAAE,SAAS;QACfC,KAAK,EAAE,UAAU;QACjBC,MAAM,EAAE,YAAY;QACpBC,KAAK,EAAE,OAAO;QACdC,iCAAiC,EAAE,2CAA2C;QAC9EC,oCAAoC,EAAE,8CAA8C;QACpFC,qDAAqD,EAAE,mEAAmE;QAC1HC,8CAA8C,EAAE,2DAA2D;QAC3GC,qCAAqC,EAAE,8CAA8C;QACrFC,sBAAsB,EAAE,2BAA2B;QACnDC,iBAAiB,EAAE,qBAAqB;QACxCC,eAAe,EAAE;MAClB,CAAC;MACD;MACAR,KAAK,EAAE;IACR,CAAC;;IAED;IACA,KAAK,IAAIS,QAAQ,IAAI9I,QAAQ,EAAE;MAC9B,IAAIhB,OAAO,IAAIA,OAAO,CAAC+J,cAAc,CAACD,QAAQ,CAAC,EAAE;QAChD,IAAIA,QAAQ,KAAK,MAAM,EAAE;UACxB3J,GAAG,CAACH,OAAO,CAAC8J,QAAQ,CAAC,GAAG9I,QAAQ,CAAC8I,QAAQ,CAAC;UAC1C,KAAK,IAAIE,OAAO,IAAIhK,OAAO,CAAC8J,QAAQ,CAAC,EAAE;YACtC,IAAI9J,OAAO,CAAC8J,QAAQ,CAAC,CAACC,cAAc,CAACC,OAAO,CAAC,EAAC;cAC7C7J,GAAG,CAACH,OAAO,CAAC8J,QAAQ,CAAC,CAACE,OAAO,CAAC,GAAGhK,OAAO,CAAC8J,QAAQ,CAAC,CAACE,OAAO,CAAC;YAC5D;UACD;QACD,CAAC,MAAM;UACN7J,GAAG,CAACH,OAAO,CAAC8J,QAAQ,CAAC,GAAG9J,OAAO,CAAC8J,QAAQ,CAAC;QAC1C;MACD,CAAC,MAAM;QACN3J,GAAG,CAACH,OAAO,CAAC8J,QAAQ,CAAC,GAAG9I,QAAQ,CAAC8I,QAAQ,CAAC;MAC3C;IACD;;IAEA;IACA3J,GAAG,CAACD,EAAE,GAAGA,EAAE;IACXC,GAAG,CAAC8J,MAAM,GAAG,IAAI;IACjB9J,GAAG,CAAC+J,WAAW,GAAG,IAAI;IACtB/J,GAAG,CAACgK,QAAQ,GAAG,IAAI;IACnBhK,GAAG,CAACiK,GAAG,GAAG,IAAI;IACdjK,GAAG,CAACkK,OAAO,GAAG,IAAI;IAClBlK,GAAG,CAACmK,KAAK,GAAG,IAAI;IAChBnK,GAAG,CAACoK,KAAK,GAAG,IAAI;IAChBpK,GAAG,CAACqK,KAAK,GAAG,IAAI;IAChBrK,GAAG,CAACqB,IAAI,GAAG,EAAE;IACbrB,GAAG,CAACsK,OAAO,GAAG,IAAI;IAClBtK,GAAG,CAACuK,WAAW,GAAG,IAAI;IACtBvK,GAAG,CAAC6D,OAAO,GAAG,IAAI;IAClB7D,GAAG,CAAC+D,UAAU,GAAG,IAAI;IACrB/D,GAAG,CAACwK,UAAU,GAAG,IAAI;IACrBxK,GAAG,CAACyK,eAAe,GAAG,IAAI;IAC1BzK,GAAG,CAAC0K,iBAAiB,GAAG,IAAI;;IAE5B;IACA1K,GAAG,CAAC2K,OAAO,GAAG,EAAE;IAChB3K,GAAG,CAAC4K,OAAO,GAAG,EAAE;IAChB5K,GAAG,CAAC6K,OAAO,GAAG,EAAE;IAChB7K,GAAG,CAAC8K,OAAO,GAAG,EAAE;IAChB9K,GAAG,CAAC+K,QAAQ,GAAG,EAAE;IACjB/K,GAAG,CAACgL,SAAS,GAAG,EAAE;IAClBhL,GAAG,CAACiL,WAAW,GAAI,EAAE;IACrBjL,GAAG,CAACkL,YAAY,GAAG,IAAI;IACvBlL,GAAG,CAACmL,iBAAiB,GAAG,IAAI;IAC5BnL,GAAG,CAACyE,KAAK,GAAG,EAAE;IACdzE,GAAG,CAACiB,IAAI,GAAG,IAAI;IACfjB,GAAG,CAACoL,MAAM,GAAG,IAAI;IACjBpL,GAAG,CAACiF,OAAO,GAAG,EAAE;;IAEhB;IACAjF,GAAG,CAACqL,MAAM,GAAG,IAAI;IACjBrL,GAAG,CAACsL,YAAY,GAAG,CAAC,CAAC;IACrBtL,GAAG,CAACuL,YAAY,GAAG,KAAK;IACxBvL,GAAG,CAACwL,aAAa,GAAG,KAAK;IACzBxL,GAAG,CAACyL,OAAO,GAAG,IAAI;IAClBzL,GAAG,CAAC0L,UAAU,GAAG,IAAI;IACrB1L,GAAG,CAAC2L,QAAQ,GAAG,IAAI;IACnB3L,GAAG,CAAC4L,QAAQ,GAAG,IAAI;;IAEnB;IACA,IAAI5L,GAAG,CAACH,OAAO,CAACqE,WAAW,IAAI,IAAI,IAAKlE,GAAG,CAACH,OAAO,CAACuE,aAAa,IAAI,KAAK,IAAIpE,GAAG,CAACH,OAAO,CAACoE,UAAU,IAAI,KAAM,EAAE;MAC/G9D,OAAO,CAACC,KAAK,CAAC,uFAAuF,CAAC;MACtGJ,GAAG,CAACH,OAAO,CAACqE,WAAW,GAAG,KAAK;IAChC;;IAEA;AACF;AACA;AACA;AACA;IACElE,GAAG,CAACiE,UAAU,GAAG,UAAS4H,QAAQ,EAAE;MACnC;MACA,IAAIA,QAAQ,IAAI,IAAI,EAAE;QACrBA,QAAQ,GAAG,CAAE7L,GAAG,CAACH,OAAO,CAACoE,UAAU;MACpC;;MAEA;MACA,IAAIjE,GAAG,CAACH,OAAO,CAACoE,UAAU,IAAI4H,QAAQ,EAAE;QACvC7L,GAAG,CAACH,OAAO,CAACoE,UAAU,GAAG4H,QAAQ;;QAEjC;QACA,IAAIA,QAAQ,IAAI,IAAI,EAAE;UACrB9L,EAAE,CAAC+L,SAAS,CAACC,GAAG,CAAC,YAAY,CAAC;QAC/B,CAAC,MAAM;UACNhM,EAAE,CAAC+L,SAAS,CAAClL,MAAM,CAAC,YAAY,CAAC;QAClC;MACD;IACD,CAAC;;IAED;AACF;AACA;IACEZ,GAAG,CAACgM,QAAQ,GAAG,UAASC,KAAK,EAAE;MAC9B;MACA,IAAI,CAAEjM,GAAG,CAACuL,YAAY,EAAE;QACvB;QACA,IAAI,OAAOvL,GAAG,CAACH,OAAO,CAAC0H,OAAQ,IAAI,UAAU,EAAE;UAC9C,IAAI2E,GAAG,GAAGlM,GAAG,CAACH,OAAO,CAAC0H,OAAO,CAAC4E,KAAK,CAAC,IAAI,EAAEC,SAAS,CAAC;QACrD;QACA;QACA,IAAI,OAAOpM,GAAG,CAACH,OAAO,CAACoM,KAAK,CAAE,IAAI,UAAU,EAAE;UAC7C,IAAIC,GAAG,GAAGlM,GAAG,CAACH,OAAO,CAACoM,KAAK,CAAC,CAACE,KAAK,CAAC,IAAI,EAAEE,KAAK,CAACC,SAAS,CAACC,KAAK,CAACC,IAAI,CAACJ,SAAS,EAAE,CAAC,CAAC,CAAC;QACnF;MACD;;MAEA;MACA,IAAIH,KAAK,IAAI,gBAAgB,IAAIjM,GAAG,CAACH,OAAO,CAAC2H,WAAW,EAAE;QACzD,IAAI1G,GAAG,GAAGd,GAAG,CAACH,OAAO,CAAC2H,WAAW,IAAI,IAAI,GAAGxH,GAAG,CAACH,OAAO,CAACiB,GAAG,GAAGd,GAAG,CAACH,OAAO,CAAC2H,WAAW;QACrF,IAAIvG,IAAI,GAAGjB,GAAG,CAACyM,WAAW,CAACL,SAAS,CAAC,CAAC,CAAC,CAAC;QACxCpM,GAAG,CAAC0M,IAAI,CAAC5L,GAAG,EAAEG,IAAI,CAAC;MACpB;MAEA,OAAOiL,GAAG;IACX,CAAC;;IAED;AACF;AACA;AACA;AACA;IACElM,GAAG,CAAC2M,YAAY,GAAG,YAAW;MAC7B;MACA,IAAIrC,OAAO,GAAG,EAAE;;MAEhB;MACA,IAAIsC,IAAI,GAAG5M,GAAG,CAACH,OAAO,CAACyB,OAAO,CAACuL,MAAM;MAErC,IAAI7M,GAAG,CAACH,OAAO,CAACoB,IAAI,IAAI,OAAOjB,GAAG,CAACH,OAAO,CAACoB,IAAI,CAAC,CAAC,CAAE,KAAK,WAAW,EAAE;QACpE;QACA,IAAI6L,IAAI,GAAGC,MAAM,CAACD,IAAI,CAAC9M,GAAG,CAACH,OAAO,CAACoB,IAAI,CAAC,CAAC,CAAC,CAAC;QAE3C,IAAI6L,IAAI,CAACD,MAAM,GAAGD,IAAI,EAAE;UACvBA,IAAI,GAAGE,IAAI,CAACD,MAAM;QACnB;MACD;;MAEA;MACA,IAAI7M,GAAG,CAACH,OAAO,CAACmC,aAAa,CAAC,CAAC,CAAC,GAAG4K,IAAI,EAAE;QACxCA,IAAI,GAAG5M,GAAG,CAACH,OAAO,CAACmC,aAAa,CAAC,CAAC,CAAC;MACpC;;MAEA;MACA,IAAIgL,QAAQ,GAAG,EAAE;;MAEjB;MACA,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGL,IAAI,EAAEK,CAAC,EAAE,EAAE;QAC9B;QACA,IAAI,CAAEjN,GAAG,CAACH,OAAO,CAAC0B,UAAU,CAAC0L,CAAC,CAAC,EAAE;UAChCjN,GAAG,CAACH,OAAO,CAAC0B,UAAU,CAAC0L,CAAC,CAAC,GAAG,EAAE;QAC/B;QACA,IAAI,CAAEjN,GAAG,CAACH,OAAO,CAAC2B,SAAS,CAACyL,CAAC,CAAC,EAAE;UAC/BjN,GAAG,CAACH,OAAO,CAAC2B,SAAS,CAACyL,CAAC,CAAC,GAAGjN,GAAG,CAACH,OAAO,CAAC8B,eAAe;QACvD;QACA,IAAI,CAAE3B,GAAG,CAACH,OAAO,CAAC4B,aAAa,CAACwL,CAAC,CAAC,EAAE;UACnCjN,GAAG,CAACH,OAAO,CAAC4B,aAAa,CAACwL,CAAC,CAAC,GAAGjN,GAAG,CAACH,OAAO,CAAC+B,eAAe;QAC3D;;QAEA;QACA,IAAI,CAAE5B,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,EAAE;UAC7BjN,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,GAAG;YAAElO,IAAI,EAAC;UAAO,CAAC;QACzC,CAAC,MAAM,IAAI,CAAEiB,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAAClO,IAAI,EAAE;UACzCiB,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAAClO,IAAI,GAAG,MAAM;QACrC;QACA,IAAI,CAAEiB,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAACC,IAAI,EAAE;UAClClN,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAACC,IAAI,GAAGJ,IAAI,IAAIA,IAAI,CAACG,CAAC,CAAC,GAAGH,IAAI,CAACG,CAAC,CAAC,GAAGA,CAAC;QAC5D;QACA,IAAI,CAAEjN,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAACE,MAAM,EAAE;UACpCnN,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAACE,MAAM,GAAG,EAAE;QACnC;QACA,IAAI,CAAEnN,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAACpN,OAAO,EAAE;UACrCG,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAACpN,OAAO,GAAG,EAAE;QACpC;QACA,IAAI,CAAEG,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAACG,MAAM,EAAE;UACpCpN,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAACG,MAAM,GAAG,IAAI;QACrC;QACA,IAAI,CAAEpN,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAACI,UAAU,EAAE;UACxCrN,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAACI,UAAU,GAAG,KAAK;QAC1C;QACA,IAAI,CAAErN,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAACpO,KAAK,EAAE;UACnCmB,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAACpO,KAAK,GAAGmB,GAAG,CAACH,OAAO,CAAC0B,UAAU,CAAC0L,CAAC,CAAC,GAAGjN,GAAG,CAACH,OAAO,CAAC0B,UAAU,CAAC0L,CAAC,CAAC,GAAG,EAAE;QAC1F;QACA,IAAI,CAAEjN,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAACK,KAAK,EAAE;UACnCtN,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAACK,KAAK,GAAGtN,GAAG,CAACH,OAAO,CAAC2B,SAAS,CAACyL,CAAC,CAAC,GAAGjN,GAAG,CAACH,OAAO,CAAC2B,SAAS,CAACyL,CAAC,CAAC,GAAGjN,GAAG,CAACH,OAAO,CAAC8B,eAAe;QACjH;QACA,IAAI,CAAE3B,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAACM,KAAK,EAAE;UACnCvN,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAACM,KAAK,GAAGvN,GAAG,CAACH,OAAO,CAAC4B,aAAa,CAACwL,CAAC,CAAC,GAAGjN,GAAG,CAACH,OAAO,CAAC4B,aAAa,CAACwL,CAAC,CAAC,GAAG,QAAQ;QACtG;;QAEA;QACA,IAAIjN,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAAClO,IAAI,IAAI,cAAc,IAAIiB,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAAClO,IAAI,IAAI,UAAU,EAAE;UAC/F;UACA,IAAIiB,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAACnM,GAAG,EAAE;YAC/BkM,QAAQ,CAACQ,IAAI,CAAC;cACb1M,GAAG,EAAEd,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAACnM,GAAG;cAC/B2M,KAAK,EAAER,CAAC;cACRlM,MAAM,EAAE,KAAK;cACb2M,QAAQ,EAAE,MAAM;cAChBC,OAAO,EAAE,SAAAA,CAAS1M,IAAI,EAAE;gBACvB,IAAIkM,MAAM,GAAG,EAAE;gBACf,KAAK,IAAIF,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGhM,IAAI,CAAC4L,MAAM,EAAEI,CAAC,EAAE,EAAE;kBACrCjN,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC,IAAI,CAACmM,KAAK,CAAC,CAACN,MAAM,CAACK,IAAI,CAACvM,IAAI,CAACgM,CAAC,CAAC,CAAC;gBACrD;cACD;YACD,CAAC,CAAC;UACH;QACD,CAAC,MAAM,IAAIjN,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAAClO,IAAI,IAAI,UAAU,EAAE;UACrD;UACA,IAAI,CAAEiB,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAACpN,OAAO,CAACJ,MAAM,EAAE;YAC5CO,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAACpN,OAAO,CAACJ,MAAM,GAAG,YAAY;UACrD;QACD;MACD;MACA;MACA,IAAI,CAAEuN,QAAQ,CAACH,MAAM,EAAE;QACtB7M,GAAG,CAAC4N,WAAW,CAAC,CAAC;MAClB,CAAC,MAAM;QACNC,OAAO,CAACC,IAAI,CAACd,QAAQ,EAAE,YAAW;UACjChN,GAAG,CAAC4N,WAAW,CAAC,CAAC;QAClB,CAAC,CAAC;MACH;IACD,CAAC;IAED5N,GAAG,CAAC4N,WAAW,GAAG,YAAW;MAC5B;MACA5N,GAAG,CAACmK,KAAK,GAAG3J,QAAQ,CAACC,aAAa,CAAC,OAAO,CAAC;MAC3CT,GAAG,CAACoK,KAAK,GAAG5J,QAAQ,CAACC,aAAa,CAAC,OAAO,CAAC;MAC3CT,GAAG,CAACqK,KAAK,GAAG7J,QAAQ,CAACC,aAAa,CAAC,OAAO,CAAC;;MAE3C;MACAT,GAAG,CAAC2K,OAAO,GAAG,EAAE;MAChB3K,GAAG,CAAC+K,QAAQ,GAAG,EAAE;;MAEjB;MACA/K,GAAG,CAACkK,OAAO,GAAG1J,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;MAC3CT,GAAG,CAACkK,OAAO,CAAC4B,SAAS,CAACC,GAAG,CAAC,gBAAgB,CAAC;MAC3C/L,GAAG,CAACkK,OAAO,CAAC6D,QAAQ,GAAG,UAASC,CAAC,EAAE;QAClChO,GAAG,CAACiO,cAAc,CAACD,CAAC,CAAC;MACtB,CAAC;MACDhO,GAAG,CAACkK,OAAO,CAACgE,OAAO,GAAG,UAASF,CAAC,EAAE;QACjChO,GAAG,CAACmO,aAAa,CAACH,CAAC,CAAC;MACrB,CAAC;;MAED;MACAhO,GAAG,CAAC6D,OAAO,GAAGrD,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;MAC3CT,GAAG,CAAC6D,OAAO,CAACiI,SAAS,CAACC,GAAG,CAAC,gBAAgB,CAAC;;MAE3C;MACA,IAAIqC,eAAe,GAAG5N,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;MACnD,IAAI4N,UAAU,GAAG7N,QAAQ,CAAC8N,cAAc,CAAEtO,GAAG,CAACH,OAAO,CAAC+H,IAAI,CAAC9D,MAAM,GAAI,IAAI,CAAC;MAC1E9D,GAAG,CAACuK,WAAW,GAAG/J,QAAQ,CAACC,aAAa,CAAC,OAAO,CAAC;MACjDT,GAAG,CAACuK,WAAW,CAACuB,SAAS,CAACC,GAAG,CAAC,eAAe,CAAC;MAC9CqC,eAAe,CAACG,WAAW,CAACF,UAAU,CAAC;MACvCD,eAAe,CAACG,WAAW,CAACvO,GAAG,CAACuK,WAAW,CAAC;MAC5CvK,GAAG,CAACuK,WAAW,CAAC3D,OAAO,GAAG,YAAW;QACpC5G,GAAG,CAACwO,cAAc,CAAC,CAAC;MACrB,CAAC;;MAED;MACA,IAAIC,yBAAyB,GAAGjO,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;MAE7D,IAAIT,GAAG,CAACH,OAAO,CAACkE,UAAU,GAAG,CAAC,IAAI/D,GAAG,CAACH,OAAO,CAACmE,iBAAiB,IAAIhE,GAAG,CAACH,OAAO,CAACmE,iBAAiB,CAAC6I,MAAM,GAAG,CAAC,EAAE;QAC5G7M,GAAG,CAAC0O,kBAAkB,GAAGlO,QAAQ,CAACC,aAAa,CAAC,QAAQ,CAAC;QACzDT,GAAG,CAAC0O,kBAAkB,CAAC5C,SAAS,CAACC,GAAG,CAAC,4BAA4B,CAAC;QAClE/L,GAAG,CAAC0O,kBAAkB,CAACpJ,QAAQ,GAAG,YAAW;UAC5CtF,GAAG,CAACH,OAAO,CAACkE,UAAU,GAAG4K,QAAQ,CAAC,IAAI,CAACtP,KAAK,CAAC;UAC7CW,GAAG,CAAC4O,IAAI,CAAC,CAAC,CAAC;QACZ,CAAC;QAED,KAAK,IAAI3B,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjN,GAAG,CAACH,OAAO,CAACmE,iBAAiB,CAAC6I,MAAM,EAAEI,CAAC,EAAE,EAAE;UAC9D,IAAI4B,IAAI,GAAGrO,QAAQ,CAACC,aAAa,CAAC,QAAQ,CAAC;UAC3CoO,IAAI,CAACxP,KAAK,GAAGW,GAAG,CAACH,OAAO,CAACmE,iBAAiB,CAACiJ,CAAC,CAAC;UAC7C4B,IAAI,CAACC,SAAS,GAAG9O,GAAG,CAACH,OAAO,CAACmE,iBAAiB,CAACiJ,CAAC,CAAC;UACjDjN,GAAG,CAAC0O,kBAAkB,CAACH,WAAW,CAACM,IAAI,CAAC;QACzC;;QAEA;QACA7O,GAAG,CAAC0O,kBAAkB,CAACrP,KAAK,GAAGW,GAAG,CAACH,OAAO,CAACkE,UAAU;QAErD0K,yBAAyB,CAACF,WAAW,CAAC/N,QAAQ,CAAC8N,cAAc,CAACtO,GAAG,CAACH,OAAO,CAAC+H,IAAI,CAACG,IAAI,CAAC,CAAC;QACrF0G,yBAAyB,CAACF,WAAW,CAACvO,GAAG,CAAC0O,kBAAkB,CAAC;QAC7DD,yBAAyB,CAACF,WAAW,CAAC/N,QAAQ,CAAC8N,cAAc,CAACtO,GAAG,CAACH,OAAO,CAAC+H,IAAI,CAACI,OAAO,CAAC,CAAC;MACzF;;MAEA;MACA,IAAIoD,MAAM,GAAG5K,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;MAC1C2K,MAAM,CAACU,SAAS,CAACC,GAAG,CAAC,eAAe,CAAC;MACrCX,MAAM,CAACmD,WAAW,CAACE,yBAAyB,CAAC;MAC7CrD,MAAM,CAACmD,WAAW,CAACH,eAAe,CAAC;;MAEnC;MACApO,GAAG,CAAC0K,iBAAiB,GAAGlK,QAAQ,CAACC,aAAa,CAAC,UAAU,CAAC;MAC1D,IAAIsO,OAAO,GAAGvO,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;MAC3CsO,OAAO,CAACC,YAAY,CAAC,OAAO,EAAE,IAAI,CAAC;MACnChP,GAAG,CAAC0K,iBAAiB,CAAC6D,WAAW,CAACQ,OAAO,CAAC;;MAE1C;MACA,IAAI/O,GAAG,CAACH,OAAO,CAAC6B,aAAa,IAAI1B,GAAG,CAACH,OAAO,CAAC6B,aAAa,CAACmL,MAAM,GAAG,CAAC,EAAE;QACtE;QACA,IAAI7M,GAAG,CAACH,OAAO,CAAC6B,aAAa,CAAC,CAAC,CAAC,IAAI1B,GAAG,CAACH,OAAO,CAAC6B,aAAa,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;UACpE,KAAK,IAAIuN,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjP,GAAG,CAACH,OAAO,CAAC6B,aAAa,CAACmL,MAAM,EAAEoC,CAAC,EAAE,EAAE;YAC1DjP,GAAG,CAACoK,KAAK,CAACmE,WAAW,CAACvO,GAAG,CAACkP,kBAAkB,CAAClP,GAAG,CAACH,OAAO,CAAC6B,aAAa,CAACuN,CAAC,CAAC,CAAC,CAAC;UAC5E;QACD,CAAC,MAAM;UACNjP,GAAG,CAACoK,KAAK,CAACmE,WAAW,CAACvO,GAAG,CAACkP,kBAAkB,CAAClP,GAAG,CAACH,OAAO,CAAC6B,aAAa,CAAC,CAAC;QACzE;MACD;;MAEA;MACA1B,GAAG,CAACyK,eAAe,GAAGjK,QAAQ,CAACC,aAAa,CAAC,IAAI,CAAC;MAClD,IAAIsO,OAAO,GAAGvO,QAAQ,CAACC,aAAa,CAAC,IAAI,CAAC;MAC1CsO,OAAO,CAACjD,SAAS,CAACC,GAAG,CAAC,kBAAkB,CAAC;MACzC/L,GAAG,CAACyK,eAAe,CAAC8D,WAAW,CAACQ,OAAO,CAAC;MAExC,KAAK,IAAI9B,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjN,GAAG,CAACH,OAAO,CAACyB,OAAO,CAACuL,MAAM,EAAEI,CAAC,EAAE,EAAE;QACpD;QACAjN,GAAG,CAACmP,gBAAgB,CAAClC,CAAC,CAAC;QACvB;QACAjN,GAAG,CAACyK,eAAe,CAAC8D,WAAW,CAACvO,GAAG,CAAC2K,OAAO,CAACsC,CAAC,CAAC,CAAC;QAC/CjN,GAAG,CAAC0K,iBAAiB,CAAC6D,WAAW,CAACvO,GAAG,CAAC+K,QAAQ,CAACkC,CAAC,CAAC,CAAC;MACnD;MAEAjN,GAAG,CAACoK,KAAK,CAACmE,WAAW,CAACvO,GAAG,CAACyK,eAAe,CAAC;;MAE1C;MACA,IAAIzK,GAAG,CAACH,OAAO,CAACoF,OAAO,IAAI,IAAI,EAAE;QAChCjF,GAAG,CAACoL,MAAM,GAAG5K,QAAQ,CAACC,aAAa,CAAC,IAAI,CAAC;QACzC,IAAI2O,EAAE,GAAG5O,QAAQ,CAACC,aAAa,CAAC,IAAI,CAAC;QACrCT,GAAG,CAACoL,MAAM,CAACmD,WAAW,CAACa,EAAE,CAAC;QAE1B,KAAK,IAAInC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjN,GAAG,CAACH,OAAO,CAACyB,OAAO,CAACuL,MAAM,EAAEI,CAAC,EAAE,EAAE;UACpD,IAAImC,EAAE,GAAG5O,QAAQ,CAACC,aAAa,CAAC,IAAI,CAAC;UACrC2O,EAAE,CAACN,SAAS,GAAG,QAAQ;UACvBM,EAAE,CAACJ,YAAY,CAAC,QAAQ,EAAE/B,CAAC,CAAC;UAC5BmC,EAAE,CAACC,SAAS,GAAG,sBAAsB;UACrC,IAAIrP,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAAClO,IAAI,IAAI,QAAQ,EAAE;YAC5CqQ,EAAE,CAAC3K,KAAK,CAAC6K,OAAO,GAAG,MAAM;UAC1B;UACAtP,GAAG,CAACoL,MAAM,CAACmD,WAAW,CAACa,EAAE,CAAC;QAC3B;QAEApP,GAAG,CAACoK,KAAK,CAACmE,WAAW,CAACvO,GAAG,CAACoL,MAAM,CAAC;MAClC;;MAEA;MACApL,GAAG,CAACmK,KAAK,GAAG3J,QAAQ,CAACC,aAAa,CAAC,OAAO,CAAC;MAC3CT,GAAG,CAACmK,KAAK,CAAC2B,SAAS,CAACC,GAAG,CAAC,QAAQ,CAAC;MACjC/L,GAAG,CAACmK,KAAK,CAAC6E,YAAY,CAAC,aAAa,EAAE,GAAG,CAAC;MAC1ChP,GAAG,CAACmK,KAAK,CAAC6E,YAAY,CAAC,aAAa,EAAE,GAAG,CAAC;MAC1ChP,GAAG,CAACmK,KAAK,CAAC6E,YAAY,CAAC,cAAc,EAAE,KAAK,CAAC;MAC7C;MACAhP,GAAG,CAACmK,KAAK,CAACoE,WAAW,CAACvO,GAAG,CAAC0K,iBAAiB,CAAC;MAC5C1K,GAAG,CAACmK,KAAK,CAACoE,WAAW,CAACvO,GAAG,CAACoK,KAAK,CAAC;MAChCpK,GAAG,CAACmK,KAAK,CAACoE,WAAW,CAACvO,GAAG,CAACqK,KAAK,CAAC;MAEhC,IAAI,CAAErK,GAAG,CAACH,OAAO,CAAC0E,YAAY,EAAE;QAC/BvE,GAAG,CAACmK,KAAK,CAAC2B,SAAS,CAACC,GAAG,CAAC,iBAAiB,CAAC;MAC3C;;MAEA;MACA/L,GAAG,CAAC8J,MAAM,GAAGtJ,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;MAC1CT,GAAG,CAAC8J,MAAM,CAACuF,SAAS,GAAG,eAAe;MACtCrP,GAAG,CAAC8J,MAAM,CAACkF,YAAY,CAAC,cAAc,EAAE,IAAI,CAAC;MAC7ChP,GAAG,CAAC8J,MAAM,CAACkF,YAAY,CAAC,eAAe,EAAE,cAAc,CAAC;MAExD,IAAIhP,GAAG,CAACH,OAAO,CAAC8D,aAAa,IAAI,KAAK,EAAE;QACvC3D,GAAG,CAAC8J,MAAM,CAACrF,KAAK,CAAC6K,OAAO,GAAG,MAAM;MAClC;;MAEA;MACAtP,GAAG,CAACgK,QAAQ,GAAGxJ,QAAQ,CAACC,aAAa,CAAC,UAAU,CAAC;MACjDT,GAAG,CAACgK,QAAQ,CAACqF,SAAS,GAAG,iBAAiB;MAC1CrP,GAAG,CAACgK,QAAQ,CAACuF,EAAE,GAAG,iBAAiB;MACnCvP,GAAG,CAACgK,QAAQ,CAACwF,QAAQ,GAAG,IAAI;;MAE5B;MACAxP,GAAG,CAAC+J,WAAW,GAAGvJ,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;MAC/CT,GAAG,CAAC+J,WAAW,CAACsF,SAAS,GAAG,oBAAoB;;MAEhD;MACAxB,OAAO,CAAC4B,WAAW,CAACzP,GAAG,CAAC+J,WAAW,EAAE;QACpC2F,OAAO,EAAC,SAAAA,CAAA,EAAW;UAClB1P,GAAG,CAAC+J,WAAW,CAAC0F,WAAW,CAACE,KAAK,CAAC,KAAK,CAAC;QACzC;MACD,CAAC,CAAC;;MAEF;MACA,IAAI1F,GAAG,GAAGzJ,QAAQ,CAACC,aAAa,CAAC,GAAG,CAAC;MACrCwJ,GAAG,CAAC+E,YAAY,CAAC,MAAM,EAAE,oCAAoC,CAAC;MAC9DhP,GAAG,CAACiK,GAAG,GAAGzJ,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;MACvCT,GAAG,CAACiK,GAAG,CAACoF,SAAS,GAAG,cAAc;MAClC;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;MACG,IAAIO,IAAI,GAAGpP,QAAQ,CAACC,aAAa,CAAC,MAAM,CAAC;MACzCmP,IAAI,CAACd,SAAS,GAAG,iBAAiB;MAClC7E,GAAG,CAACsE,WAAW,CAACqB,IAAI,CAAC;MACrB5P,GAAG,CAACiK,GAAG,CAACsE,WAAW,CAACtE,GAAG,CAAC;;MAExB;MACA,IAAI4F,SAAS,GAAGrP,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;MAC7CoP,SAAS,CAAC/D,SAAS,CAACC,GAAG,CAAC,cAAc,CAAC;;MAEvC;MACA/L,GAAG,CAAC+D,UAAU,GAAGvD,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;MAC9CT,GAAG,CAAC+D,UAAU,CAAC+H,SAAS,CAACC,GAAG,CAAC,mBAAmB,CAAC;MACjD,IAAI+D,cAAc,GAAGtP,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;MAClD,IAAIsP,eAAe,GAAGvP,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;MACnDT,GAAG,CAAC+D,UAAU,CAACwK,WAAW,CAACuB,cAAc,CAAC;MAC1C9P,GAAG,CAAC+D,UAAU,CAACwK,WAAW,CAACwB,eAAe,CAAC;;MAE3C;MACA,IAAI,CAAE/P,GAAG,CAACH,OAAO,CAACkE,UAAU,EAAE;QAC7B/D,GAAG,CAAC+D,UAAU,CAACU,KAAK,CAAC6K,OAAO,GAAG,MAAM;MACtC;;MAEA;MACA,IAAItP,GAAG,CAACH,OAAO,CAACiE,MAAM,IAAI,IAAI,EAAE;QAC/B/D,EAAE,CAACwO,WAAW,CAACnD,MAAM,CAAC;MACvB;;MAEA;MACApL,GAAG,CAACkK,OAAO,CAACqE,WAAW,CAACvO,GAAG,CAACmK,KAAK,CAAC;MAClCnK,GAAG,CAACkK,OAAO,CAACqE,WAAW,CAACvO,GAAG,CAAC8J,MAAM,CAAC;MACnC9J,GAAG,CAACkK,OAAO,CAACqE,WAAW,CAACvO,GAAG,CAACgK,QAAQ,CAAC;MAErCjK,EAAE,CAACwO,WAAW,CAACvO,GAAG,CAAC6D,OAAO,CAAC;MAC3B9D,EAAE,CAACwO,WAAW,CAACvO,GAAG,CAACkK,OAAO,CAAC;MAC3BnK,EAAE,CAACwO,WAAW,CAACvO,GAAG,CAAC+D,UAAU,CAAC;MAC9BhE,EAAE,CAACwO,WAAW,CAACvO,GAAG,CAAC+J,WAAW,CAAC;MAC/BhK,EAAE,CAACwO,WAAW,CAACvO,GAAG,CAACiK,GAAG,CAAC;MACvBlK,EAAE,CAAC+L,SAAS,CAACC,GAAG,CAAC,kBAAkB,CAAC;;MAEpC;MACA,IAAI/L,GAAG,CAACH,OAAO,CAACgE,OAAO,IAAI7D,GAAG,CAACH,OAAO,CAACgE,OAAO,CAACgJ,MAAM,EAAE;QACtD7M,GAAG,CAACgQ,aAAa,CAAC,CAAC;MACpB;;MAEA;MACA,IAAIhQ,GAAG,CAACH,OAAO,CAACoE,UAAU,IAAI,IAAI,EAAE;QACnClE,EAAE,CAAC+L,SAAS,CAACC,GAAG,CAAC,YAAY,CAAC;MAC/B,CAAC,MAAM;QACN;QACA,IAAI/L,GAAG,CAACH,OAAO,CAACuE,aAAa,IAAI,IAAI,EAAE;UACtC,IAAIpE,GAAG,CAACH,OAAO,CAACwE,WAAW,EAAE;YAC5BrE,GAAG,CAACkK,OAAO,CAACzF,KAAK,CAAC,YAAY,CAAC,GAAG,MAAM;YACxCzE,GAAG,CAACkK,OAAO,CAACzF,KAAK,CAAC,YAAY,CAAC,GAAG,oCAAoC;YACtEzE,GAAG,CAACkK,OAAO,CAACzF,KAAK,CAACwL,SAAS,GAAGjQ,GAAG,CAACH,OAAO,CAACwE,WAAW;UACtD;UACA,IAAIrE,GAAG,CAACH,OAAO,CAACyE,UAAU,EAAE;YAC3BtE,GAAG,CAACkK,OAAO,CAACzF,KAAK,CAAC,YAAY,CAAC,GAAG,MAAM;YACxCzE,GAAG,CAACkK,OAAO,CAACzF,KAAK,CAAC6I,KAAK,GAAGtN,GAAG,CAACH,OAAO,CAACyE,UAAU;UACjD;QACD;MACD;;MAEA;MACA,IAAItE,GAAG,CAACH,OAAO,CAACuE,aAAa,IAAI,IAAI,IAAIpE,GAAG,CAACH,OAAO,CAACgE,OAAO,EAAE;QAC7D9D,EAAE,CAAC+L,SAAS,CAACC,GAAG,CAAC,cAAc,CAAC;MACjC;;MAEA;MACA,IAAI/L,GAAG,CAACH,OAAO,CAACwC,UAAU,IAAI,IAAI,EAAE;QACnCrC,GAAG,CAACoK,KAAK,CAAC0B,SAAS,CAACC,GAAG,CAAC,WAAW,CAAC;MACrC;MACA,IAAI/L,GAAG,CAACH,OAAO,CAACyC,YAAY,IAAI,IAAI,EAAE;QACrCtC,GAAG,CAACoK,KAAK,CAAC0B,SAAS,CAACC,GAAG,CAAC,WAAW,CAAC;MACrC;MACA,IAAI/L,GAAG,CAACH,OAAO,CAAC2C,OAAO,IAAI,IAAI,EAAE;QAChCxC,GAAG,CAACqK,KAAK,CAACyB,SAAS,CAACC,GAAG,CAAC,WAAW,CAAC;MACrC;MACA,IAAI/L,GAAG,CAACH,OAAO,CAAC0C,SAAS,IAAI,IAAI,EAAE;QAClCvC,GAAG,CAACqK,KAAK,CAACyB,SAAS,CAACC,GAAG,CAAC,WAAW,CAAC;MACrC;;MAEA;MACA/L,GAAG,CAACkQ,OAAO,CAAC,CAAC;;MAEb;MACA,IAAIlQ,GAAG,CAACH,OAAO,CAAC4E,KAAK,EAAE;QACtBzE,GAAG,CAACmQ,QAAQ,CAACnQ,GAAG,CAACH,OAAO,CAAC4E,KAAK,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC;MAClD;;MAEA;MACA,IAAIzE,GAAG,CAACH,OAAO,CAAC6E,OAAO,EAAE;QACxB,IAAI0L,CAAC,GAAGrD,MAAM,CAACD,IAAI,CAAC9M,GAAG,CAACH,OAAO,CAAC6E,OAAO,CAAC;QACxC,KAAK,IAAIuI,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGmD,CAAC,CAACvD,MAAM,EAAEI,CAAC,EAAE,EAAE;UAClC,IAAIoD,IAAI,GAAG5R,MAAM,CAAC6R,mBAAmB,CAACF,CAAC,CAACnD,CAAC,CAAC,EAAE,IAAI,CAAC;UACjDjN,GAAG,CAAC4K,OAAO,CAACyF,IAAI,CAAC,CAAC,CAAC,CAAC,CAACA,IAAI,CAAC,CAAC,CAAC,CAAC,CAACvE,SAAS,CAACC,GAAG,CAAC/L,GAAG,CAACH,OAAO,CAAC6E,OAAO,CAAC0L,CAAC,CAACnD,CAAC,CAAC,CAAC,CAAC;QACvE;MACD;IACD,CAAC;;IAED;AACF;AACA;AACA;AACA;IACEjN,GAAG,CAACuQ,OAAO,GAAG,YAAW;MACxB,IAAIvQ,GAAG,CAACH,OAAO,CAACiB,GAAG,EAAE;QACpB;QACA,IAAId,GAAG,CAACH,OAAO,CAACsE,WAAW,IAAI,IAAI,EAAE;UACpC0J,OAAO,CAAC2C,OAAO,CAACzI,IAAI,CAAC,CAAC;QACvB;QAEA8F,OAAO,CAACC,IAAI,CAAC;UACZhN,GAAG,EAAEd,GAAG,CAACH,OAAO,CAACiB,GAAG;UACpBC,MAAM,EAAEf,GAAG,CAACH,OAAO,CAACkB,MAAM;UAC1BE,IAAI,EAAEjB,GAAG,CAACH,OAAO,CAACmB,gBAAgB;UAClC0M,QAAQ,EAAE,MAAM;UAChBC,OAAO,EAAE,SAAAA,CAAS8C,MAAM,EAAE;YACzB;YACAzQ,GAAG,CAACH,OAAO,CAACoB,IAAI,GAAIwP,MAAM,CAACxP,IAAI,GAAIwP,MAAM,CAACxP,IAAI,GAAGwP,MAAM;YACvD;YACAzQ,GAAG,CAACkQ,OAAO,CAAC,CAAC;YACb;YACA,IAAIlQ,GAAG,CAACH,OAAO,CAACsE,WAAW,IAAI,IAAI,EAAE;cACpC0J,OAAO,CAAC2C,OAAO,CAACE,IAAI,CAAC,CAAC;YACvB;UACD;QACD,CAAC,CAAC;MACH,CAAC,MAAM;QACN1Q,GAAG,CAACkQ,OAAO,CAAC,CAAC;MACd;IACD,CAAC;;IAED;AACF;AACA;AACA;AACA;AACA;IACElQ,GAAG,CAACkQ,OAAO,GAAG,UAASjP,IAAI,EAAE;MAC5B;MACA,IAAIA,IAAI,EAAE;QACT,IAAI,OAAOA,IAAK,IAAI,QAAQ,EAAE;UAC7BA,IAAI,GAAG0P,IAAI,CAACC,KAAK,CAAC3P,IAAI,CAAC;QACxB;QAEAjB,GAAG,CAACH,OAAO,CAACoB,IAAI,GAAGA,IAAI;MACxB;;MAEA;MACA,IAAI,CAAEjB,GAAG,CAACH,OAAO,CAACoB,IAAI,EAAE;QACvBjB,GAAG,CAACH,OAAO,CAACoB,IAAI,GAAG,EAAE;MACtB;;MAEA;MACA,IAAIjB,GAAG,CAACH,OAAO,CAACoB,IAAI,IAAIjB,GAAG,CAACH,OAAO,CAACoB,IAAI,CAAC,CAAC,CAAC,EAAE;QAC5C,IAAI,CAAEoL,KAAK,CAACwE,OAAO,CAAC7Q,GAAG,CAACH,OAAO,CAACoB,IAAI,CAAC,CAAC,CAAC,CAAC,EAAE;UACzC,IAAIA,IAAI,GAAG,EAAE;UACb,KAAK,IAAIgO,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjP,GAAG,CAACH,OAAO,CAACoB,IAAI,CAAC4L,MAAM,EAAEoC,CAAC,EAAE,EAAE;YACjD,IAAI6B,GAAG,GAAG,EAAE;YACZ,KAAK,IAAI7D,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjN,GAAG,CAACH,OAAO,CAACyB,OAAO,CAACuL,MAAM,EAAEI,CAAC,EAAE,EAAE;cACpD6D,GAAG,CAAC7D,CAAC,CAAC,GAAGjN,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACgO,CAAC,CAAC,CAACjP,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAACC,IAAI,CAAC;YAC1D;YACAjM,IAAI,CAACuM,IAAI,CAACsD,GAAG,CAAC;UACf;UAEA9Q,GAAG,CAACH,OAAO,CAACoB,IAAI,GAAGA,IAAI;QACxB;MACD;;MAEA;MACA,IAAIgO,CAAC,GAAG,CAAC;MACT,IAAIhC,CAAC,GAAG,CAAC;MACT,IAAI8D,MAAM,GAAG/Q,GAAG,CAACH,OAAO,CAACyB,OAAO,CAACuL,MAAM;MACvC,IAAImE,MAAM,GAAGhR,GAAG,CAACH,OAAO,CAACoB,IAAI,CAAC4L,MAAM;MACpC,IAAIoE,KAAK,GAAGjR,GAAG,CAACH,OAAO,CAACmC,aAAa,CAAC,CAAC,CAAC;MACxC,IAAIkP,KAAK,GAAGlR,GAAG,CAACH,OAAO,CAACmC,aAAa,CAAC,CAAC,CAAC;MACxC,IAAImP,KAAK,GAAGF,KAAK,GAAGF,MAAM,GAAGE,KAAK,GAAGF,MAAM;MAC3C,IAAIK,KAAK,GAAGF,KAAK,GAAGF,MAAM,GAAGE,KAAK,GAAGF,MAAM;MAE3C,KAAK/B,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGmC,KAAK,EAAEnC,CAAC,EAAE,EAAE;QAC3B,KAAKhC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGkE,KAAK,EAAElE,CAAC,EAAE,EAAE;UAC3B,IAAIjN,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACgO,CAAC,CAAC,IAAIoC,SAAS,EAAE;YACrCrR,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACgO,CAAC,CAAC,GAAG,EAAE;UACzB;UAEA,IAAIjP,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACgO,CAAC,CAAC,CAAChC,CAAC,CAAC,IAAIoE,SAAS,EAAE;YACxCrR,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACgO,CAAC,CAAC,CAAChC,CAAC,CAAC,GAAG,EAAE;UAC5B;QACD;MACD;;MAEA;MACAjN,GAAG,CAACqB,IAAI,GAAG,EAAE;MACbrB,GAAG,CAACsK,OAAO,GAAG,IAAI;MAClBtK,GAAG,CAAC4K,OAAO,GAAG,EAAE;MAChB5K,GAAG,CAAC6K,OAAO,GAAG,EAAE;;MAEhB;MACA7K,GAAG,CAACsL,YAAY,GAAG,CAAC,CAAC;;MAErB;MACAtL,GAAG,CAACqK,KAAK,CAACyE,SAAS,GAAG,EAAE;;MAExB;MACA,IAAI9O,GAAG,CAACH,OAAO,CAACqE,WAAW,IAAI,IAAI,EAAE;QACpC;QACA,IAAIoN,WAAW,GAAG,CAAC;QACnB,IAAIC,WAAW,GAAGvR,GAAG,CAACH,OAAO,CAACoB,IAAI,CAAC4L,MAAM,GAAG,GAAG,GAAG7M,GAAG,CAACH,OAAO,CAACoB,IAAI,CAAC4L,MAAM,GAAG,GAAG;QAE/E,IAAI7M,GAAG,CAACH,OAAO,CAACkE,UAAU,EAAE;UAC3B/D,GAAG,CAACH,OAAO,CAACkE,UAAU,GAAG,KAAK;UAC9B5D,OAAO,CAACC,KAAK,CAAC,8DAA8D,CAAC;QAC9E;MACD,CAAC,MAAM,IAAIJ,GAAG,CAACH,OAAO,CAACkE,UAAU,EAAE;QAClC;QACA,IAAI,CAAE/D,GAAG,CAACwK,UAAU,EAAE;UACrBxK,GAAG,CAACwK,UAAU,GAAG,CAAC;QACnB;QACA,IAAIgH,eAAe,GAAGxR,GAAG,CAACH,OAAO,CAACkE,UAAU;QAC5CuN,WAAW,GAAItR,GAAG,CAACH,OAAO,CAACkE,UAAU,GAAG/D,GAAG,CAACwK,UAAW;QACvD+G,WAAW,GAAIvR,GAAG,CAACH,OAAO,CAACkE,UAAU,GAAG/D,GAAG,CAACwK,UAAU,GAAIxK,GAAG,CAACH,OAAO,CAACkE,UAAU;QAEhF,IAAI/D,GAAG,CAACH,OAAO,CAACoB,IAAI,CAAC4L,MAAM,GAAG0E,WAAW,EAAE;UAC1CA,WAAW,GAAGvR,GAAG,CAACH,OAAO,CAACoB,IAAI,CAAC4L,MAAM;QACtC;MACD,CAAC,MAAM;QACN,IAAIyE,WAAW,GAAG,CAAC;QACnB,IAAIC,WAAW,GAAGvR,GAAG,CAACH,OAAO,CAACoB,IAAI,CAAC4L,MAAM;MAC1C;;MAEA;MACA,KAAKoC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjP,GAAG,CAACH,OAAO,CAACoB,IAAI,CAAC4L,MAAM,EAAEoC,CAAC,EAAE,EAAE;QAC7C;QACA,IAAIwC,EAAE,GAAGzR,GAAG,CAAC0R,SAAS,CAACzC,CAAC,EAAEjP,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACgO,CAAC,CAAC,CAAC;QAC9C;QACA,IAAIA,CAAC,IAAIqC,WAAW,IAAIrC,CAAC,GAAGsC,WAAW,EAAE;UACxCvR,GAAG,CAACqK,KAAK,CAACkE,WAAW,CAACkD,EAAE,CAAC;QAC1B;MACD;MAEA,IAAIzR,GAAG,CAACH,OAAO,CAACqE,WAAW,IAAI,IAAI,EAAE;QACpC;MAAA,CACA,MAAM,IAAIlE,GAAG,CAACH,OAAO,CAACkE,UAAU,EAAE;QAClC/D,GAAG,CAAC2R,gBAAgB,CAAC,CAAC;MACvB;;MAEA;MACA,IAAI3R,GAAG,CAACH,OAAO,CAAC+D,UAAU,EAAE;QAC3B,IAAIkJ,IAAI,GAAGC,MAAM,CAACD,IAAI,CAAC9M,GAAG,CAACH,OAAO,CAAC+D,UAAU,CAAC;QAC9C,KAAK,IAAIqJ,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGH,IAAI,CAACD,MAAM,EAAEI,CAAC,EAAE,EAAE;UACrC,IAAI2E,GAAG,GAAG5R,GAAG,CAACH,OAAO,CAAC+D,UAAU,CAACkJ,IAAI,CAACG,CAAC,CAAC,CAAC;UACzCjN,GAAG,CAAC6R,QAAQ,CAAC/E,IAAI,CAACG,CAAC,CAAC,EAAE2E,GAAG,CAAC,CAAC,CAAC,EAAEA,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;QACzC;MACD;;MAEA;MACA5R,GAAG,CAACyH,WAAW,CAAC,CAAC;;MAEjB;MACAzH,GAAG,CAACgM,QAAQ,CAAC,QAAQ,EAAEjM,EAAE,EAAEC,GAAG,CAAC;IAChC,CAAC;;IAED;AACF;AACA;AACA;AACA;AACA;IACEA,GAAG,CAAC8R,OAAO,GAAG,UAAS7G,WAAW,EAAE8G,QAAQ,EAAE;MAC7C;MACA,IAAIC,OAAO,GAAG,EAAE;MAChB,IAAIC,EAAE,GAAG,CAAC;MACV,IAAIC,EAAE,GAAG,CAAC;;MAEV;MACA,IAAIxE,QAAQ,GAAGqE,QAAQ,IAAI,IAAI,IAAI/R,GAAG,CAACH,OAAO,CAACsB,iBAAiB,IAAI,KAAK,GAAG,IAAI,GAAG,KAAK;;MAExF;MACA,IAAIgR,CAAC,GAAGnS,GAAG,CAACH,OAAO,CAACyB,OAAO,CAACuL,MAAM;MAClC,IAAIuF,CAAC,GAAGpS,GAAG,CAACH,OAAO,CAACoB,IAAI,CAAC4L,MAAM;;MAE/B;MACA,KAAK,IAAIoC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGmD,CAAC,EAAEnD,CAAC,EAAE,EAAE;QAC3BgD,EAAE,GAAG,CAAC;QACN,KAAK,IAAIhF,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGkF,CAAC,EAAElF,CAAC,EAAE,EAAE;UAC3B;UACA,IAAI,CAAEhC,WAAW,IAAIjL,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAAChC,CAAC,CAAC,CAACnB,SAAS,CAACuG,QAAQ,CAAC,WAAW,CAAC,EAAE;YACvE;YACA,IAAI,CAAEL,OAAO,CAACE,EAAE,CAAC,EAAE;cAClBF,OAAO,CAACE,EAAE,CAAC,GAAG,EAAE;YACjB;YACA,IAAI,CAAExE,QAAQ,EAAE;cACfsE,OAAO,CAACE,EAAE,CAAC,CAACD,EAAE,CAAC,GAAGjS,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAAChC,CAAC,CAAC,CAAC6B,SAAS;YAC9C,CAAC,MAAM;cACNkD,OAAO,CAACE,EAAE,CAAC,CAACD,EAAE,CAAC,GAAGjS,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACgO,CAAC,CAAC,CAAChC,CAAC,CAAC;YACzC;YACAgF,EAAE,EAAE;UACL;QACD;QACA,IAAIA,EAAE,GAAG,CAAC,EAAE;UACXC,EAAE,EAAE;QACL;MACD;MAEA,OAAOF,OAAO;IACf,CAAC;;IAED;AACF;AACA;AACA;AACA;AACA;IACEhS,GAAG,CAACsS,UAAU,GAAG,UAASC,SAAS,EAAE;MACpC,IAAIC,OAAO,GAAGxS,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACsR,SAAS,CAAC;MACzC,IAAIJ,CAAC,GAAGnS,GAAG,CAACH,OAAO,CAACyB,OAAO,CAACuL,MAAM;MAElC,IAAIiE,GAAG,GAAG,CAAC,CAAC;MACZ,KAAK,IAAI7D,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGkF,CAAC,EAAElF,CAAC,EAAE,EAAE;QAC3B,IAAI,CAAEjN,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAACC,IAAI,EAAE;UAClClN,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAACC,IAAI,GAAGD,CAAC;QAChC;QACA6D,GAAG,CAAC9Q,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAACC,IAAI,CAAC,GAAGsF,OAAO,CAACvF,CAAC,CAAC;MAC9C;MAEA,OAAO6D,GAAG;IACX,CAAC;;IAED;AACF;AACA;AACA;AACA;AACA;IACE9Q,GAAG,CAACyS,OAAO,GAAG,UAASxH,WAAW,EAAE;MACnC;MACA,IAAIhK,IAAI,GAAG,EAAE;;MAEb;MACA,IAAIkR,CAAC,GAAGnS,GAAG,CAACH,OAAO,CAACyB,OAAO,CAACuL,MAAM;MAClC,IAAIuF,CAAC,GAAGpS,GAAG,CAACH,OAAO,CAACoB,IAAI,CAAC4L,MAAM;;MAE/B;MACA,KAAK,IAAIoC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGmD,CAAC,EAAEnD,CAAC,EAAE,EAAE;QAC3B,IAAI6B,GAAG,GAAG,IAAI;QACd,KAAK,IAAI7D,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGkF,CAAC,EAAElF,CAAC,EAAE,EAAE;UAC3B,IAAI,CAAEhC,WAAW,IAAIjL,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAAChC,CAAC,CAAC,CAACnB,SAAS,CAACuG,QAAQ,CAAC,WAAW,CAAC,EAAE;YACvE,IAAIvB,GAAG,IAAI,IAAI,EAAE;cAChBA,GAAG,GAAG,CAAC,CAAC;YACT;YACA,IAAI,CAAE9Q,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAACC,IAAI,EAAE;cAClClN,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAACC,IAAI,GAAGD,CAAC;YAChC;YACA6D,GAAG,CAAC9Q,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAACC,IAAI,CAAC,GAAGlN,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACgO,CAAC,CAAC,CAAChC,CAAC,CAAC;UAC1D;QACD;QAEA,IAAI6D,GAAG,IAAI,IAAI,EAAE;UAChB7P,IAAI,CAACuM,IAAI,CAACsD,GAAG,CAAC;QACf;MACD;MAEA,OAAO7P,IAAI;IACZ,CAAC;;IAED;AACF;AACA;IACEjB,GAAG,CAACyM,WAAW,GAAG,UAASxL,IAAI,EAAE;MAChC,IAAII,IAAI,GAAG,EAAE;MACb,KAAK,IAAI4L,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGhM,IAAI,CAAC4L,MAAM,EAAEI,CAAC,EAAE,EAAE;QACrC,IAAIkF,CAAC,GAAGlR,IAAI,CAACgM,CAAC,CAAC,CAACkF,CAAC;QACjB,IAAIC,CAAC,GAAGnR,IAAI,CAACgM,CAAC,CAAC,CAACmF,CAAC;QACjB,IAAIhC,CAAC,GAAGpQ,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAACjF,IAAI,GAAGlN,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAACjF,IAAI,GAAGiF,CAAC;;QAErE;QACA,IAAI,CAAE9Q,IAAI,CAAC+Q,CAAC,CAAC,EAAE;UACd/Q,IAAI,CAAC+Q,CAAC,CAAC,GAAG;YACTtB,GAAG,EAAEsB,CAAC;YACNnR,IAAI,EAAE,CAAC;UACR,CAAC;QACF;QACAI,IAAI,CAAC+Q,CAAC,CAAC,CAACnR,IAAI,CAACmP,CAAC,CAAC,GAAGnP,IAAI,CAACgM,CAAC,CAAC,CAACyF,QAAQ;MACnC;;MAEA;MACA,OAAOrR,IAAI,CAAC+J,MAAM,CAAC,UAAUrL,EAAE,EAAE;QAChC,OAAOA,EAAE,IAAI,IAAI;MAClB,CAAC,CAAC;IACH,CAAC;;IAED;AACF;AACA;IACEC,GAAG,CAAC0M,IAAI,GAAG,UAAS5L,GAAG,EAAEG,IAAI,EAAE;MAC9B;MACA,IAAIiL,GAAG,GAAGlM,GAAG,CAACgM,QAAQ,CAAC,cAAc,EAAEjM,EAAE,EAAEC,GAAG,EAAEiB,IAAI,CAAC;MACrD,IAAIiL,GAAG,EAAE;QACR,IAAIjL,IAAI,GAAGiL,GAAG;MACf,CAAC,MAAM;QACN,IAAIA,GAAG,KAAK,KAAK,EAAE;UAClB,OAAO,KAAK;QACb;MACD;;MAEA;MACA2B,OAAO,CAACC,IAAI,CAAC;QACZhN,GAAG,EAAEA,GAAG;QACRC,MAAM,EAAE,MAAM;QACd2M,QAAQ,EAAE,MAAM;QAChBzM,IAAI,EAAE;UAAEA,IAAI,EAAE0P,IAAI,CAACgC,SAAS,CAAC1R,IAAI;QAAE,CAAC;QACpC0M,OAAO,EAAE,SAAAA,CAAS8C,MAAM,EAAE;UACzB;UACAzQ,GAAG,CAACgM,QAAQ,CAAC,QAAQ,EAAEjM,EAAE,EAAEC,GAAG,EAAEiB,IAAI,CAAC;QACtC;MACD,CAAC,CAAC;IACH,CAAC;;IAED;AACF;AACA;IACEjB,GAAG,CAAC4S,UAAU,GAAG,UAASL,SAAS,EAAE;MACpC,OAAOvS,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACsR,SAAS,CAAC;IACnC,CAAC;;IAED;AACF;AACA;IACEvS,GAAG,CAAC6S,UAAU,GAAG,UAASN,SAAS,EAAEtR,IAAI,EAAE;MAC1C,KAAK,IAAIgM,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjN,GAAG,CAAC2K,OAAO,CAACkC,MAAM,EAAEI,CAAC,EAAE,EAAE;QAC5C;QACA,IAAIhF,UAAU,GAAGxJ,MAAM,CAACqU,mBAAmB,CAAC,CAAE7F,CAAC,EAAEsF,SAAS,CAAE,CAAC;QAC7D;QACA,IAAItR,IAAI,CAACgM,CAAC,CAAC,IAAI,IAAI,EAAE;UACpBjN,GAAG,CAAC+S,QAAQ,CAAC9K,UAAU,EAAEhH,IAAI,CAACgM,CAAC,CAAC,CAAC;QAClC;MACD;IACD,CAAC;;IAED;AACF;AACA;IACEjN,GAAG,CAACgT,aAAa,GAAG,UAASC,YAAY,EAAE;MAC1C,IAAIjB,OAAO,GAAG,EAAE;MAChB;MACA,KAAK,IAAI/C,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjP,GAAG,CAACH,OAAO,CAACoB,IAAI,CAAC4L,MAAM,EAAEoC,CAAC,EAAE,EAAE;QACjD+C,OAAO,CAACxE,IAAI,CAACxN,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACgO,CAAC,CAAC,CAACgE,YAAY,CAAC,CAAC;MAChD;MACA,OAAOjB,OAAO;IACf,CAAC;;IAED;AACF;AACA;IACEhS,GAAG,CAACkT,aAAa,GAAG,UAASC,SAAS,EAAElS,IAAI,EAAE;MAC7C,KAAK,IAAIgO,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjP,GAAG,CAACqB,IAAI,CAACwL,MAAM,EAAEoC,CAAC,EAAE,EAAE;QACzC;QACA,IAAIhH,UAAU,GAAGxJ,MAAM,CAACqU,mBAAmB,CAAC,CAAEK,SAAS,EAAElE,CAAC,CAAE,CAAC;QAC7D;QACA,IAAIhO,IAAI,CAACgO,CAAC,CAAC,IAAI,IAAI,EAAE;UACpBjP,GAAG,CAAC+S,QAAQ,CAAC9K,UAAU,EAAEhH,IAAI,CAACgO,CAAC,CAAC,CAAC;QAClC;MACD;IACD,CAAC;;IAED;AACF;AACA;IACEjP,GAAG,CAAC0R,SAAS,GAAG,UAASzC,CAAC,EAAEhO,IAAI,EAAE;MACjC;MACA,IAAI,CAAEjB,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,EAAE;QACrBjP,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,GAAG,EAAE;MACpB;MACA;MACA,IAAI,CAAEhO,IAAI,EAAE;QACX,IAAIA,IAAI,GAAGjB,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACgO,CAAC,CAAC;MAC/B;MACA;MACAjP,GAAG,CAACqB,IAAI,CAAC4N,CAAC,CAAC,GAAGzO,QAAQ,CAACC,aAAa,CAAC,IAAI,CAAC;MAC1CT,GAAG,CAACqB,IAAI,CAAC4N,CAAC,CAAC,CAACD,YAAY,CAAC,QAAQ,EAAEC,CAAC,CAAC;MACrC;MACA,IAAIxB,KAAK,GAAG,IAAI;;MAEhB;MACA,IAAIzN,GAAG,CAACH,OAAO,CAACgC,gBAAgB,EAAE;QACjC7B,GAAG,CAACqB,IAAI,CAAC4N,CAAC,CAAC,CAACxK,KAAK,CAAC2O,MAAM,GAAGpT,GAAG,CAACH,OAAO,CAACgC,gBAAgB,GAAG,IAAI;MAC/D;;MAEA;MACA,IAAI7B,GAAG,CAACH,OAAO,CAACwB,IAAI,CAAC4N,CAAC,CAAC,EAAE;QACxB,IAAIjP,GAAG,CAACH,OAAO,CAACwB,IAAI,CAAC4N,CAAC,CAAC,CAACmE,MAAM,EAAE;UAC/BpT,GAAG,CAACqB,IAAI,CAAC4N,CAAC,CAAC,CAACxK,KAAK,CAAC2O,MAAM,GAAGpT,GAAG,CAACH,OAAO,CAACwB,IAAI,CAAC4N,CAAC,CAAC,CAACmE,MAAM;QACtD;QACA,IAAIpT,GAAG,CAACH,OAAO,CAACwB,IAAI,CAAC4N,CAAC,CAAC,CAACpQ,KAAK,EAAE;UAC9B4O,KAAK,GAAGzN,GAAG,CAACH,OAAO,CAACwB,IAAI,CAAC4N,CAAC,CAAC,CAACpQ,KAAK;QAClC;MACD;MACA,IAAI,CAAE4O,KAAK,EAAE;QACZA,KAAK,GAAGkB,QAAQ,CAACM,CAAC,GAAG,CAAC,CAAC;MACxB;MACA;MACA,IAAIG,EAAE,GAAG5O,QAAQ,CAACC,aAAa,CAAC,IAAI,CAAC;MACrC2O,EAAE,CAACN,SAAS,GAAGrB,KAAK;MACpB2B,EAAE,CAACJ,YAAY,CAAC,QAAQ,EAAEC,CAAC,CAAC;MAC5BG,EAAE,CAACC,SAAS,GAAG,YAAY;MAC3BrP,GAAG,CAACqB,IAAI,CAAC4N,CAAC,CAAC,CAACV,WAAW,CAACa,EAAE,CAAC;;MAE3B;MACA,KAAK,IAAInC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjN,GAAG,CAACH,OAAO,CAACyB,OAAO,CAACuL,MAAM,EAAEI,CAAC,EAAE,EAAE;QACpD;QACAjN,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAAChC,CAAC,CAAC,GAAGjN,GAAG,CAACqT,UAAU,CAACpG,CAAC,EAAEgC,CAAC,EAAEhO,IAAI,CAACgM,CAAC,CAAC,CAAC;QACjD;QACAjN,GAAG,CAACqB,IAAI,CAAC4N,CAAC,CAAC,CAACV,WAAW,CAACvO,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAAChC,CAAC,CAAC,CAAC;MAC3C;;MAEA;MACA,OAAOjN,GAAG,CAACqB,IAAI,CAAC4N,CAAC,CAAC;IACnB,CAAC;IAEDjP,GAAG,CAACsT,UAAU,GAAG,UAASrG,CAAC,EAAEgC,CAAC,EAAE5P,KAAK,EAAEgR,IAAI,EAAE;MAC5C,IAAI,CAAC,EAAE,GAAChR,KAAK,EAAEkU,MAAM,CAAC,CAAC,EAAC,CAAC,CAAC,IAAI,GAAG,IAAIvT,GAAG,CAACH,OAAO,CAAC8E,aAAa,IAAI,IAAI,EAAE;QACvEtF,KAAK,GAAGW,GAAG,CAACwT,cAAc,CAACnU,KAAK,EAAE4N,CAAC,EAAEgC,CAAC,CAAC;MACxC;;MAEA;MACA,IAAIpP,OAAO,GAAGG,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC;MACpC,IAAIpN,OAAO,IAAI,CAAET,SAAS,CAACC,KAAK,CAAC,EAAE;QAClC;QACA,IAAIO,GAAG,GAAG,IAAI;QACd,IAAIA,GAAG,GAAGL,OAAO,CAACM,OAAO,CAAC,EAAE;UAC3B,IAAIR,KAAK,IAAIA,KAAK,IAAIoU,MAAM,CAACpU,KAAK,CAAC,EAAE;YACpCA,KAAK,GAAGoU,MAAM,CAACpU,KAAK,CAAC;UACtB;UACA;UACA,IAAIqU,MAAM,GAAG7F,OAAO,CAACnO,IAAI,CAACiU,MAAM,CAACtU,KAAK,EAAEO,GAAG,EAAE,IAAI,CAAC;UAClD;UACA,IAAIyQ,IAAI,EAAE;YACT,IAAIzQ,GAAG,CAACF,IAAI,EAAE;cACb,IAAIkU,CAAC,GAAGhU,GAAG,CAACF,IAAI,CAACmU,KAAK,CAAC,GAAG,CAAC;cAC3B,IAAID,CAAC,CAAC,CAAC,CAAC,EAAE;gBACT,IAAIE,EAAE,GAAGF,CAAC,CAAC,CAAC,CAAC,CAACG,KAAK,CAAC,IAAIC,MAAM,CAAC,WAAW,EAAE,IAAI,CAAC,CAAC;gBAClD,IAAIF,EAAE,EAAE;kBACP,IAAIzU,KAAK,GAAG,CAAC,EAAE;oBACdgR,IAAI,CAACvE,SAAS,CAACC,GAAG,CAAC,KAAK,CAAC;kBAC1B,CAAC,MAAM;oBACNsE,IAAI,CAACvE,SAAS,CAAClL,MAAM,CAAC,KAAK,CAAC;kBAC7B;gBACD;gBACA,IAAIqT,EAAE,GAAGL,CAAC,CAAC,CAAC,CAAC,CAACG,KAAK,CAAC,IAAIC,MAAM,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC;gBAC5C,IAAIC,EAAE,EAAE;kBACP,IAAI5U,KAAK,GAAG,CAAC,EAAE;oBACdqU,MAAM,GAAG,GAAG,GAAGA,MAAM,GAAG,GAAG;kBAC5B;gBACD;cACD;YACD;UACD;UAEA,IAAIA,MAAM,EAAE;YACXrU,KAAK,GAAGqU,MAAM;UACf;QACD;MACD;MAEA,OAAOrU,KAAK;IACb,CAAC;IAED,IAAI6U,SAAS,GAAG,SAAAA,CAASC,IAAI,EAAE;MAC9BA,IAAI,GAAG,EAAE,GAACA,IAAI;MACd,IAAIA,IAAI,CAACZ,MAAM,CAAC,CAAC,EAAC,CAAC,CAAC,IAAI,GAAG,IAAIY,IAAI,CAACZ,MAAM,CAAC,CAAC,EAAC,CAAC,CAAC,IAAI,GAAG,EAAE;QACvD,OAAO,IAAI;MACZ,CAAC,MAAM;QACNY,IAAI,GAAGA,IAAI,CAACN,KAAK,CAAC,GAAG,CAAC;QACtB,IAAKM,IAAI,CAAC,CAAC,CAAC,CAACtH,MAAM,IAAI,CAAC,IAAIsH,IAAI,CAAC,CAAC,CAAC,IAAIV,MAAM,CAACU,IAAI,CAAC,CAAC,CAAC,CAAC,IAAIA,IAAI,CAAC,CAAC,CAAC,CAACtH,MAAM,IAAI,CAAC,IAAIsH,IAAI,CAAC,CAAC,CAAC,IAAIV,MAAM,CAACU,IAAI,CAAC,CAAC,CAAC,CAAC,EAAG;UAC7G,OAAO,IAAI;QACZ;MACD;MACA,OAAO,KAAK;IACb,CAAC;;IAED;AACF;AACA;IACEnU,GAAG,CAACqT,UAAU,GAAG,UAASpG,CAAC,EAAEgC,CAAC,EAAE5P,KAAK,EAAE;MACtC;MACA,IAAI+P,EAAE,GAAG5O,QAAQ,CAACC,aAAa,CAAC,IAAI,CAAC;MACrC2O,EAAE,CAACJ,YAAY,CAAC,QAAQ,EAAE/B,CAAC,CAAC;MAC5BmC,EAAE,CAACJ,YAAY,CAAC,QAAQ,EAAEC,CAAC,CAAC;;MAE5B;MACA,IAAI,CAAC,EAAE,GAAC5P,KAAK,EAAEkU,MAAM,CAAC,CAAC,EAAC,CAAC,CAAC,IAAI,GAAG,IAAIvT,GAAG,CAACH,OAAO,CAACiF,cAAc,IAAI,IAAI,EAAE;QACxE,IAAIsP,GAAG,GAAGC,aAAa,CAAChV,KAAK,CAAC;QAC9B,IAAI+U,GAAG,IAAI/U,KAAK,EAAE;UACjB;UACAA,KAAK,GAAG+U,GAAG;QACZ;MACD;;MAEA;MACA,IAAIpU,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAACG,MAAM,EAAE;QAClC,IAAIpN,GAAG,CAACH,OAAO,CAACkF,SAAS,KAAK,KAAK,IAAI/E,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAAClI,SAAS,KAAK,KAAK,EAAE;UAClFqK,EAAE,CAACN,SAAS,GAAGzP,KAAK;QACrB,CAAC,MAAM;UACN+P,EAAE,CAACkF,WAAW,GAAGjV,KAAK;QACvB;QACA,IAAI,OAAOW,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAACG,MAAM,CAACiG,UAAW,IAAI,UAAU,EAAE;UACnEjE,EAAE,GAAGpP,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAACG,MAAM,CAACiG,UAAU,CAACjE,EAAE,CAAC;QAClD;MACD,CAAC,MAAM;QACN;QACA,IAAIpP,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAAClO,IAAI,IAAI,QAAQ,EAAE;UAC5CqQ,EAAE,CAAC3K,KAAK,CAAC6K,OAAO,GAAG,MAAM;UACzBF,EAAE,CAACkF,WAAW,GAAGjV,KAAK;QACvB,CAAC,MAAM,IAAIW,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAAClO,IAAI,IAAI,UAAU,IAAIiB,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAAClO,IAAI,IAAI,OAAO,EAAE;UAC/F;UACA,IAAIwV,OAAO,GAAG/T,QAAQ,CAACC,aAAa,CAAC,OAAO,CAAC;UAC7C8T,OAAO,CAACxV,IAAI,GAAGiB,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAAClO,IAAI;UAC1CwV,OAAO,CAACrH,IAAI,GAAG,GAAG,GAAGD,CAAC;UACtBsH,OAAO,CAACC,OAAO,GAAInV,KAAK,IAAI,CAAC,IAAIA,KAAK,IAAI,IAAI,IAAIA,KAAK,IAAI,MAAM,GAAI,IAAI,GAAG,KAAK;UACjFkV,OAAO,CAAC7E,OAAO,GAAG,YAAW;YAC5B1P,GAAG,CAAC+S,QAAQ,CAAC3D,EAAE,EAAE,IAAI,CAACoF,OAAO,CAAC;UAC/B,CAAC;UAED,IAAIxU,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAACwH,QAAQ,IAAI,IAAI,IAAIzU,GAAG,CAACH,OAAO,CAAC4C,QAAQ,IAAI,KAAK,EAAE;YAC7E8R,OAAO,CAACvF,YAAY,CAAC,UAAU,EAAE,UAAU,CAAC;UAC7C;;UAEA;UACAI,EAAE,CAACb,WAAW,CAACgG,OAAO,CAAC;UACvB;UACAvU,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACgO,CAAC,CAAC,CAAChC,CAAC,CAAC,GAAGsH,OAAO,CAACC,OAAO;QACzC,CAAC,MAAM,IAAIxU,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAAClO,IAAI,IAAI,UAAU,EAAE;UACrD;UACA,IAAI2V,SAAS,GAAG,IAAI;UACpB,IAAI,CAAER,SAAS,CAAC7U,KAAK,CAAC,EAAE;YACvB,IAAIsV,GAAG,GAAG9G,OAAO,CAAC+G,QAAQ,CAACC,qBAAqB,CAACxV,KAAK,EAAEW,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAACpN,OAAO,CAACJ,MAAM,CAAC;YAC9F,IAAIkV,GAAG,EAAE;cACRD,SAAS,GAAGC,GAAG;YAChB;UACD;UACA;UACAvF,EAAE,CAACkF,WAAW,GAAGzG,OAAO,CAAC+G,QAAQ,CAACE,aAAa,CAACJ,SAAS,GAAGA,SAAS,GAAGrV,KAAK,EAAEW,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAACpN,OAAO,CAACJ,MAAM,CAAC;QACtH,CAAC,MAAM,IAAIO,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAAClO,IAAI,IAAI,UAAU,IAAIiB,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAAClO,IAAI,IAAI,cAAc,EAAE;UACtG;UACAqQ,EAAE,CAACtD,SAAS,CAACC,GAAG,CAAC,iBAAiB,CAAC;UACnCqD,EAAE,CAACkF,WAAW,GAAGtU,GAAG,CAAC+U,gBAAgB,CAAC9H,CAAC,EAAE5N,KAAK,CAAC;QAChD,CAAC,MAAM,IAAIW,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAAClO,IAAI,IAAI,OAAO,EAAE;UAClD,IAAIiB,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAAC0G,MAAM,IAAI,QAAQ,EAAE;YAC9C,IAAIqB,KAAK,GAAGxU,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;YACzCuU,KAAK,CAAC3F,SAAS,GAAG,OAAO;YACzB2F,KAAK,CAACvQ,KAAK,CAACwQ,eAAe,GAAG5V,KAAK;YACnC+P,EAAE,CAACb,WAAW,CAACyG,KAAK,CAAC;UACtB,CAAC,MAAM;YACN5F,EAAE,CAAC3K,KAAK,CAACuQ,KAAK,GAAG3V,KAAK;YACtB+P,EAAE,CAACkF,WAAW,GAAGjV,KAAK;UACvB;QACD,CAAC,MAAM,IAAIW,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAAClO,IAAI,IAAI,OAAO,EAAE;UAClD,IAAIM,KAAK,IAAIA,KAAK,CAACkU,MAAM,CAAC,CAAC,EAAE,EAAE,CAAC,IAAI,YAAY,EAAE;YACjD,IAAI2B,GAAG,GAAG1U,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;YACvCyU,GAAG,CAACC,GAAG,GAAG9V,KAAK;YACf+P,EAAE,CAACb,WAAW,CAAC2G,GAAG,CAAC;UACpB;QACD,CAAC,MAAM;UACN,IAAIlV,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAAClO,IAAI,IAAI,MAAM,EAAE;YAC1CqQ,EAAE,CAACN,SAAS,GAAGsG,WAAW,CAACpV,GAAG,CAACsT,UAAU,CAACrG,CAAC,EAAEgC,CAAC,EAAE5P,KAAK,EAAE+P,EAAE,CAAC,CAAC;UAC5D,CAAC,MAAM;YACN,IAAIpP,GAAG,CAACH,OAAO,CAACkF,SAAS,KAAK,KAAK,IAAI/E,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAAClI,SAAS,KAAK,KAAK,EAAE;cAClFqK,EAAE,CAACN,SAAS,GAAGsG,WAAW,CAACpV,GAAG,CAACsT,UAAU,CAACrG,CAAC,EAAEgC,CAAC,EAAE5P,KAAK,EAAE+P,EAAE,CAAC,CAAC;YAC5D,CAAC,MAAM;cACN;cACA;cACA,IAAI7O,GAAG,GAAGC,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;cACvCF,GAAG,CAAC+T,WAAW,GAAGtU,GAAG,CAACsT,UAAU,CAACrG,CAAC,EAAEgC,CAAC,EAAE5P,KAAK,EAAE+P,EAAE,CAAC;cACjDA,EAAE,CAACb,WAAW,CAAChO,GAAG,CAAC;YACpB;UACD;QACD;MACD;;MAEA;MACA,IAAIP,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAACwH,QAAQ,IAAI,IAAI,EAAE;QAC5CrF,EAAE,CAACC,SAAS,GAAG,UAAU;MAC1B;;MAEA;MACA,IAAIgG,QAAQ,GAAGrV,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAACM,KAAK,GAAGvN,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAACM,KAAK,GAAG,QAAQ;MACrF6B,EAAE,CAAC3K,KAAK,CAAC6Q,SAAS,GAAGD,QAAQ;;MAE7B;MACA,IAAIrV,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAAC9J,QAAQ,IAAI,KAAK,KAAKnD,GAAG,CAACH,OAAO,CAACsD,QAAQ,IAAI,IAAI,IAAInD,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAAC9J,QAAQ,IAAI,IAAI,IAAIiM,EAAE,CAACN,SAAS,CAACjC,MAAM,GAAG,GAAG,CAAC,EAAE;QACvJuC,EAAE,CAAC3K,KAAK,CAAC8Q,UAAU,GAAG,UAAU;MACjC;;MAEA;MACA,IAAItI,CAAC,GAAG,CAAC,EAAE;QACV,IAAI,IAAI,CAACpN,OAAO,CAAC0E,YAAY,IAAI,IAAI,EAAE;UACtC,IAAIlF,KAAK,IAAI+P,EAAE,CAACN,SAAS,EAAE;YAC1B9O,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAAChC,CAAC,GAAC,CAAC,CAAC,CAACxI,KAAK,CAAC+Q,QAAQ,GAAG,QAAQ;UAC9C,CAAC,MAAM;YACN,IAAIvI,CAAC,IAAIjN,GAAG,CAACH,OAAO,CAACyB,OAAO,CAACuL,MAAM,GAAG,CAAC,EAAE;cACxCuC,EAAE,CAAC3K,KAAK,CAAC+Q,QAAQ,GAAG,QAAQ;YAC7B;UACD;QACD;MACD;MACA,OAAOpG,EAAE;IACV,CAAC;IAEDpP,GAAG,CAACmP,gBAAgB,GAAG,UAASgE,SAAS,EAAE;MAC1C;MACA,IAAIsC,QAAQ,GAAGzV,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6R,SAAS,CAAC,CAAC7F,KAAK,GAAGtN,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6R,SAAS,CAAC,CAAC7F,KAAK,GAAGtN,GAAG,CAACH,OAAO,CAAC8B,eAAe;MACxH,IAAI0T,QAAQ,GAAGrV,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6R,SAAS,CAAC,CAAC5F,KAAK,GAAGvN,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6R,SAAS,CAAC,CAAC5F,KAAK,GAAGvN,GAAG,CAACH,OAAO,CAAC+B,eAAe;;MAExH;MACA5B,GAAG,CAAC2K,OAAO,CAACwI,SAAS,CAAC,GAAG3S,QAAQ,CAACC,aAAa,CAAC,IAAI,CAAC;MACrD,IAAIT,GAAG,CAACH,OAAO,CAACkF,SAAS,EAAE;QAC1B/E,GAAG,CAAC2K,OAAO,CAACwI,SAAS,CAAC,CAACmB,WAAW,GAAGtU,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6R,SAAS,CAAC,CAACtU,KAAK,GAAGmB,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6R,SAAS,CAAC,CAACtU,KAAK,GAAGJ,MAAM,CAACiX,aAAa,CAACvC,SAAS,CAAC;MACnJ,CAAC,MAAM;QACNnT,GAAG,CAAC2K,OAAO,CAACwI,SAAS,CAAC,CAACrE,SAAS,GAAG9O,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6R,SAAS,CAAC,CAACtU,KAAK,GAAGmB,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6R,SAAS,CAAC,CAACtU,KAAK,GAAGJ,MAAM,CAACiX,aAAa,CAACvC,SAAS,CAAC;MACjJ;MACAnT,GAAG,CAAC2K,OAAO,CAACwI,SAAS,CAAC,CAACnE,YAAY,CAAC,QAAQ,EAAEmE,SAAS,CAAC;MACxDnT,GAAG,CAAC2K,OAAO,CAACwI,SAAS,CAAC,CAAC1O,KAAK,CAAC6Q,SAAS,GAAGD,QAAQ;MACjD,IAAIrV,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6R,SAAS,CAAC,CAACtU,KAAK,EAAE;QACzCmB,GAAG,CAAC2K,OAAO,CAACwI,SAAS,CAAC,CAACnE,YAAY,CAAC,OAAO,EAAEhP,GAAG,CAAC2K,OAAO,CAACwI,SAAS,CAAC,CAACwC,SAAS,CAAC;MAC/E;MACA,IAAI3V,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6R,SAAS,CAAC,CAAC5D,EAAE,EAAE;QACtCvP,GAAG,CAAC2K,OAAO,CAACwI,SAAS,CAAC,CAACnE,YAAY,CAAC,IAAI,EAAEhP,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6R,SAAS,CAAC,CAAC5D,EAAE,CAAC;MAC7E;;MAEA;MACAvP,GAAG,CAAC+K,QAAQ,CAACoI,SAAS,CAAC,GAAG3S,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;MACvDT,GAAG,CAAC+K,QAAQ,CAACoI,SAAS,CAAC,CAACnE,YAAY,CAAC,OAAO,EAAEyG,QAAQ,CAAC;;MAEvD;MACA,IAAIzV,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6R,SAAS,CAAC,CAACpU,IAAI,IAAI,QAAQ,EAAE;QACpDiB,GAAG,CAAC2K,OAAO,CAACwI,SAAS,CAAC,CAAC1O,KAAK,CAAC6K,OAAO,GAAG,MAAM;QAC7CtP,GAAG,CAAC+K,QAAQ,CAACoI,SAAS,CAAC,CAAC1O,KAAK,CAAC6K,OAAO,GAAG,MAAM;MAC/C;IACD,CAAC;;IAED;AACF;AACA;IACEtP,GAAG,CAAC4V,kBAAkB,GAAG,UAASzD,CAAC,EAAEC,CAAC,EAAEvT,KAAK,EAAE;MAC9C,IAAImB,GAAG,CAACH,OAAO,CAAC6B,aAAa,CAAC0Q,CAAC,CAAC,CAACD,CAAC,CAAC,CAACtT,KAAK,EAAE;QAC1CmB,GAAG,CAACH,OAAO,CAAC6B,aAAa,CAAC0Q,CAAC,CAAC,CAACD,CAAC,CAAC,CAACtT,KAAK,GAAGA,KAAK;QAC7CmB,GAAG,CAACH,OAAO,CAAC6B,aAAa,CAAC0Q,CAAC,CAAC,CAACmC,OAAO,CAACsB,QAAQ,CAAC1D,CAAC,GAAC,CAAC,CAAC,CAACmC,WAAW,GAAGzV,KAAK;MACvE;IACD,CAAC;;IAED;AACF;AACA;IACEmB,GAAG,CAACkP,kBAAkB,GAAG,UAAS4G,iBAAiB,EAAE;MACpD,IAAIrE,EAAE,GAAGjR,QAAQ,CAACC,aAAa,CAAC,IAAI,CAAC;MACrCgR,EAAE,CAAC3F,SAAS,CAACC,GAAG,CAAC,eAAe,CAAC;MACjC,IAAIqD,EAAE,GAAG5O,QAAQ,CAACC,aAAa,CAAC,IAAI,CAAC;MACrCgR,EAAE,CAAClD,WAAW,CAACa,EAAE,CAAC;MAClB;MACA0G,iBAAiB,CAACvB,OAAO,GAAG9C,EAAE;MAE9B,IAAIsE,WAAW,GAAG,CAAC;MACnB,KAAK,IAAI9I,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG6I,iBAAiB,CAACjJ,MAAM,EAAEI,CAAC,EAAE,EAAE;QAClD;QACA,IAAI,CAAE6I,iBAAiB,CAAC7I,CAAC,CAAC,CAAC+I,OAAO,EAAE;UACnCF,iBAAiB,CAAC7I,CAAC,CAAC,CAAC+I,OAAO,GAAG,CAAC;QACjC;QACA,IAAI,CAAEF,iBAAiB,CAAC7I,CAAC,CAAC,CAACM,KAAK,EAAE;UACjCuI,iBAAiB,CAAC7I,CAAC,CAAC,CAACM,KAAK,GAAG,QAAQ;QACtC;QACA,IAAI,CAAEuI,iBAAiB,CAAC7I,CAAC,CAAC,CAACpO,KAAK,EAAE;UACjCiX,iBAAiB,CAAC7I,CAAC,CAAC,CAACpO,KAAK,GAAG,EAAE;QAChC;QACA,IAAI,CAAEiX,iBAAiB,CAAC7I,CAAC,CAAC,CAACsC,EAAE,EAAE;UAC9BuG,iBAAiB,CAAC7I,CAAC,CAAC,CAACsC,EAAE,GAAG,EAAE;QAC7B;;QAEA;QACA,IAAI0G,eAAe,GAAGH,iBAAiB,CAAC7I,CAAC,CAAC,CAAC+I,OAAO;;QAElD;QACA,IAAIE,MAAM,GAAG,EAAE;QACf;QACA,KAAK,IAAI/D,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG8D,eAAe,EAAE9D,CAAC,EAAE,EAAE;UACzC,IAAInS,GAAG,CAACH,OAAO,CAACyB,OAAO,CAACyU,WAAW,CAAC,IAAI/V,GAAG,CAACH,OAAO,CAACyB,OAAO,CAACyU,WAAW,CAAC,CAAChX,IAAI,IAAI,QAAQ,EAAE;YAC1FkX,eAAe,EAAE;UAClB;UACAC,MAAM,CAAC1I,IAAI,CAACuI,WAAW,CAAC;UACxBA,WAAW,EAAE;QACd;;QAEA;QACA,IAAI3G,EAAE,GAAG5O,QAAQ,CAACC,aAAa,CAAC,IAAI,CAAC;QACrC2O,EAAE,CAACJ,YAAY,CAAC,aAAa,EAAEkH,MAAM,CAAC/W,IAAI,CAAC,GAAG,CAAC,CAAC;QAChDiQ,EAAE,CAACJ,YAAY,CAAC,SAAS,EAAE8G,iBAAiB,CAAC7I,CAAC,CAAC,CAAC+I,OAAO,CAAC;QACxD5G,EAAE,CAACJ,YAAY,CAAC,OAAO,EAAE8G,iBAAiB,CAAC7I,CAAC,CAAC,CAACM,KAAK,CAAC;QACpD6B,EAAE,CAACJ,YAAY,CAAC,IAAI,EAAE8G,iBAAiB,CAAC7I,CAAC,CAAC,CAACsC,EAAE,CAAC;QAC9CH,EAAE,CAACkF,WAAW,GAAGwB,iBAAiB,CAAC7I,CAAC,CAAC,CAACpO,KAAK;QAC3C4S,EAAE,CAAClD,WAAW,CAACa,EAAE,CAAC;MACnB;MAEA,OAAOqC,EAAE;IACV,CAAC;;IAED;AACF;AACA;IACEzR,GAAG,CAACgQ,aAAa,GAAG,UAASnM,OAAO,EAAE;MACrC,IAAIA,OAAO,EAAE;QACZ7D,GAAG,CAACH,OAAO,CAACgE,OAAO,GAAGA,OAAO;MAC9B,CAAC,MAAM;QACN,IAAIA,OAAO,GAAG7D,GAAG,CAACH,OAAO,CAACgE,OAAO;MAClC;MACA,KAAK,IAAIoJ,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGpJ,OAAO,CAACgJ,MAAM,EAAEI,CAAC,EAAE,EAAE;QACxC,IAAIpJ,OAAO,CAACoJ,CAAC,CAAC,CAAClO,IAAI,IAAI,GAAG,EAAE;UAC3B,IAAIoX,WAAW,GAAG3V,QAAQ,CAACC,aAAa,CAAC,GAAG,CAAC;UAC7C0V,WAAW,CAACrK,SAAS,CAACC,GAAG,CAAC,qBAAqB,CAAC;UAChDoK,WAAW,CAACrK,SAAS,CAACC,GAAG,CAAC,gBAAgB,CAAC;UAC3CoK,WAAW,CAACnH,YAAY,CAAC,QAAQ,EAAEnL,OAAO,CAACoJ,CAAC,CAAC,CAACmD,CAAC,CAAC;UAChD+F,WAAW,CAACnH,YAAY,CAAC,QAAQ,EAAEnL,OAAO,CAACoJ,CAAC,CAAC,CAAC3N,CAAC,CAAC;UAChD6W,WAAW,CAACnH,YAAY,CAAC,IAAI,EAAEnL,OAAO,CAACoJ,CAAC,CAAC,CAACsC,EAAE,CAAC;;UAE7C;UACA,IAAI1L,OAAO,CAACoJ,CAAC,CAAC,CAACmJ,OAAO,EAAE;YACvBD,WAAW,CAACnH,YAAY,CAAC,OAAO,EAAEnL,OAAO,CAACoJ,CAAC,CAAC,CAACmJ,OAAO,CAAC;UACtD;UACA;UACA,IAAIvS,OAAO,CAACoJ,CAAC,CAAC,CAACyC,OAAO,IAAI,OAAO7L,OAAO,CAACoJ,CAAC,CAAC,CAACyC,OAAQ,EAAE;YACrDyG,WAAW,CAACzG,OAAO,GAAI,UAAU2G,CAAC,EAAE;cACnC,IAAIC,CAAC,GAAGD,CAAC;cACT,OAAO,YAAY;gBAClBxS,OAAO,CAACyS,CAAC,CAAC,CAAC5G,OAAO,CAAC3P,EAAE,EAAEC,GAAG,EAAE,IAAI,CAAC;cAClC,CAAC;YACF,CAAC,CAAEiN,CAAC,CAAC;UACN,CAAC,MAAM;YACNkJ,WAAW,CAACzG,OAAO,GAAG,YAAW;cAChC,IAAIU,CAAC,GAAG,IAAI,CAACmG,YAAY,CAAC,QAAQ,CAAC;cACnC,IAAIjX,CAAC,GAAG,IAAI,CAACiX,YAAY,CAAC,QAAQ,CAAC;cACnCvW,GAAG,CAACmQ,QAAQ,CAACnQ,GAAG,CAACiL,WAAW,EAAEmF,CAAC,EAAE9Q,CAAC,CAAC;YACpC,CAAC;UACF;UACA;UACA6W,WAAW,CAAC7B,WAAW,GAAGzQ,OAAO,CAACoJ,CAAC,CAAC,CAAC/C,OAAO;UAC5ClK,GAAG,CAAC6D,OAAO,CAAC0K,WAAW,CAAC4H,WAAW,CAAC;QACrC,CAAC,MAAM,IAAItS,OAAO,CAACoJ,CAAC,CAAC,CAAClO,IAAI,IAAI,QAAQ,EAAE;UACvC,IAAIoX,WAAW,GAAG3V,QAAQ,CAACC,aAAa,CAAC,QAAQ,CAAC;UAClD,IAAI+V,oBAAoB,GAAG,KAAK;UAChCL,WAAW,CAACrK,SAAS,CAACC,GAAG,CAAC,qBAAqB,CAAC;UAChDoK,WAAW,CAACnH,YAAY,CAAC,QAAQ,EAAEnL,OAAO,CAACoJ,CAAC,CAAC,CAACmD,CAAC,CAAC;UAChD;UACA,IAAIvM,OAAO,CAACoJ,CAAC,CAAC,CAACmJ,OAAO,EAAE;YACvBD,WAAW,CAACnH,YAAY,CAAC,OAAO,EAAEnL,OAAO,CAACoJ,CAAC,CAAC,CAACmJ,OAAO,CAAC;UACtD;UACA;UACA,IAAIvS,OAAO,CAACoJ,CAAC,CAAC,CAAC3H,QAAQ,IAAI,OAAOzB,OAAO,CAACoJ,CAAC,CAAC,CAAC3H,QAAS,EAAE;YACvD6Q,WAAW,CAAC7Q,QAAQ,GAAGzB,OAAO,CAACoJ,CAAC,CAAC,CAAC3H,QAAQ;YAC1CkR,oBAAoB,GAAG,IAAI;UAC5B,CAAC,MAAM;YACNL,WAAW,CAAC7Q,QAAQ,GAAG,YAAW;cACjC,IAAI8K,CAAC,GAAG,IAAI,CAACmG,YAAY,CAAC,QAAQ,CAAC;cACnCvW,GAAG,CAACmQ,QAAQ,CAACnQ,GAAG,CAACiL,WAAW,EAAEmF,CAAC,EAAE,IAAI,CAAC/Q,KAAK,CAAC;YAC7C,CAAC;UACF;UACA;UACA,KAAI,IAAI4P,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGpL,OAAO,CAACoJ,CAAC,CAAC,CAAC3N,CAAC,CAACuN,MAAM,EAAEoC,CAAC,EAAE,EAAE;YAC5C,IAAIwH,qBAAqB,GAAGjW,QAAQ,CAACC,aAAa,CAAC,QAAQ,CAAC;YAC5DgW,qBAAqB,CAACpX,KAAK,GAAGwE,OAAO,CAACoJ,CAAC,CAAC,CAAC3N,CAAC,CAAC2P,CAAC,CAAC;YAC7CwH,qBAAqB,CAACnC,WAAW,GAAGzQ,OAAO,CAACoJ,CAAC,CAAC,CAAC3N,CAAC,CAAC2P,CAAC,CAAC;YACnD,IAAIpL,OAAO,CAACoJ,CAAC,CAAC,CAACyJ,aAAa,IAAID,qBAAqB,CAACpX,KAAK,KAAKwE,OAAO,CAACoJ,CAAC,CAAC,CAACyJ,aAAa,EAAE;cACzFD,qBAAqB,CAACE,QAAQ,GAAG,IAAI;YACtC;YACAR,WAAW,CAAC5H,WAAW,CAACkI,qBAAqB,CAAC;UAC/C;UACA,IAAID,oBAAoB,EAAE;YACzBL,WAAW,CAACS,aAAa,CAAC,IAAIC,KAAK,CAAC,QAAQ,CAAC,CAAC;UAC/C;UACA7W,GAAG,CAAC6D,OAAO,CAAC0K,WAAW,CAAC4H,WAAW,CAAC;QACrC,CAAC,MAAM,IAAItS,OAAO,CAACoJ,CAAC,CAAC,CAAClO,IAAI,IAAI,OAAO,EAAE;UACrC,IAAIoX,WAAW,GAAG3V,QAAQ,CAACC,aAAa,CAAC,GAAG,CAAC;UAC7C0V,WAAW,CAACrK,SAAS,CAACC,GAAG,CAAC,qBAAqB,CAAC;UAChDoK,WAAW,CAACrK,SAAS,CAACC,GAAG,CAAC,gBAAgB,CAAC;UAC3CoK,WAAW,CAACnH,YAAY,CAAC,QAAQ,EAAEnL,OAAO,CAACoJ,CAAC,CAAC,CAACmD,CAAC,CAAC;UAChD+F,WAAW,CAACnH,YAAY,CAAC,QAAQ,EAAE,EAAE,CAAC;UACtC;UACA,IAAInL,OAAO,CAACoJ,CAAC,CAAC,CAACmJ,OAAO,EAAE;YACvBD,WAAW,CAACnH,YAAY,CAAC,OAAO,EAAEnL,OAAO,CAACoJ,CAAC,CAAC,CAACmJ,OAAO,CAAC;UACtD;UACApW,GAAG,CAAC6D,OAAO,CAAC0K,WAAW,CAAC4H,WAAW,CAAC;UACpCA,WAAW,CAAC7B,WAAW,GAAGzQ,OAAO,CAACoJ,CAAC,CAAC,CAAC/C,OAAO;UAC5C2D,OAAO,CAACmH,KAAK,CAACmB,WAAW,EAAE;YAC1B7Q,QAAQ,EAAC,SAAAA,CAAS9F,CAAC,EAAEF,CAAC,EAAE;cACvB,IAAI8Q,CAAC,GAAG5Q,CAAC,CAAC+W,YAAY,CAAC,QAAQ,CAAC;cAChCvW,GAAG,CAACmQ,QAAQ,CAACnQ,GAAG,CAACiL,WAAW,EAAEmF,CAAC,EAAE9Q,CAAC,CAAC;YACpC;UACD,CAAC,CAAC;QACJ;MACD;IACD,CAAC;;IAED;AACF;AACA;AACA;AACA;AACA;AACA;IACEU,GAAG,CAAC6R,QAAQ,GAAG,UAASiF,QAAQ,EAAEd,OAAO,EAAEe,OAAO,EAAEC,sBAAsB,EAAE;MAC3E,IAAIC,IAAI,GAAG,KAAK;MAEhB,IAAI,CAAEH,QAAQ,EAAE;QACf,IAAI,CAAE9W,GAAG,CAACiL,WAAW,CAAC4B,MAAM,EAAE;UAC7BqK,KAAK,CAAClX,GAAG,CAACH,OAAO,CAAC+H,IAAI,CAAC8B,eAAe,CAAC;UACvC,OAAO,IAAI;QACZ,CAAC,MAAM;UACN,IAAIyN,EAAE,GAAGxI,QAAQ,CAAC3O,GAAG,CAACiL,WAAW,CAAC,CAAC,CAAC,CAACsL,YAAY,CAAC,QAAQ,CAAC,CAAC;UAC5D,IAAIa,EAAE,GAAGzI,QAAQ,CAAC3O,GAAG,CAACiL,WAAW,CAAC,CAAC,CAAC,CAACsL,YAAY,CAAC,QAAQ,CAAC,CAAC;UAC5D,IAAIc,EAAE,GAAG1I,QAAQ,CAAC3O,GAAG,CAACiL,WAAW,CAACjL,GAAG,CAACiL,WAAW,CAAC4B,MAAM,GAAC,CAAC,CAAC,CAAC0J,YAAY,CAAC,QAAQ,CAAC,CAAC;UACnF,IAAIe,EAAE,GAAG3I,QAAQ,CAAC3O,GAAG,CAACiL,WAAW,CAACjL,GAAG,CAACiL,WAAW,CAAC4B,MAAM,GAAC,CAAC,CAAC,CAAC0J,YAAY,CAAC,QAAQ,CAAC,CAAC;UACnF,IAAIO,QAAQ,GAAGrY,MAAM,CAACqU,mBAAmB,CAAC,CAAEqE,EAAE,EAAEC,EAAE,CAAE,CAAC;UACrD,IAAIpB,OAAO,GAAIqB,EAAE,GAAGF,EAAE,GAAI,CAAC;UAC3B,IAAIJ,OAAO,GAAIO,EAAE,GAAGF,EAAE,GAAI,CAAC;QAC5B;MACD;MAEA,IAAI/G,IAAI,GAAG5R,MAAM,CAAC6R,mBAAmB,CAACwG,QAAQ,EAAE,IAAI,CAAC;MAErD,IAAI9W,GAAG,CAACH,OAAO,CAAC+D,UAAU,CAACkT,QAAQ,CAAC,EAAE;QACrC,IAAI9W,GAAG,CAAC4K,OAAO,CAACyF,IAAI,CAAC,CAAC,CAAC,CAAC,CAACA,IAAI,CAAC,CAAC,CAAC,CAAC,CAACkG,YAAY,CAAC,aAAa,CAAC,EAAE;UAC9DU,IAAI,GAAGjX,GAAG,CAACH,OAAO,CAAC+H,IAAI,CAAC6B,iBAAiB;QAC1C;MACD,CAAC,MAAM,IAAI,CAAC,CAAEuM,OAAO,IAAIA,OAAO,GAAG,CAAC,MAAM,CAAEe,OAAO,IAAIA,OAAO,GAAG,CAAC,CAAC,EAAE;QACpEE,IAAI,GAAGjX,GAAG,CAACH,OAAO,CAAC+H,IAAI,CAAC4B,sBAAsB;MAC/C,CAAC,MAAM;QACN,IAAI+N,KAAK,GAAG,EAAE;QACd,KAAK,IAAItI,CAAC,GAAGoB,IAAI,CAAC,CAAC,CAAC,EAAEpB,CAAC,GAAGoB,IAAI,CAAC,CAAC,CAAC,GAAG0G,OAAO,EAAE9H,CAAC,EAAE,EAAE;UACjD,KAAK,IAAIhC,CAAC,GAAGoD,IAAI,CAAC,CAAC,CAAC,EAAEpD,CAAC,GAAGoD,IAAI,CAAC,CAAC,CAAC,GAAG2F,OAAO,EAAE/I,CAAC,EAAE,EAAE;YACjD,IAAIhF,UAAU,GAAGxJ,MAAM,CAACqU,mBAAmB,CAAC,CAAC7F,CAAC,EAAEgC,CAAC,CAAC,CAAC;YACnD,IAAIjP,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAAChC,CAAC,CAAC,CAACsJ,YAAY,CAAC,aAAa,CAAC,EAAE;cAClDU,IAAI,GAAGjX,GAAG,CAACH,OAAO,CAAC+H,IAAI,CAAC2B,qCAAqC;YAC9D;UACD;QACD;MACD;MAEA,IAAI0N,IAAI,EAAE;QACTC,KAAK,CAACD,IAAI,CAAC;MACZ,CAAC,MAAM;QACN;QACA,IAAIjB,OAAO,GAAG,CAAC,EAAE;UAChBhW,GAAG,CAAC4K,OAAO,CAACyF,IAAI,CAAC,CAAC,CAAC,CAAC,CAACA,IAAI,CAAC,CAAC,CAAC,CAAC,CAACrB,YAAY,CAAC,SAAS,EAAEgH,OAAO,CAAC;QAC/D,CAAC,MAAM;UACNA,OAAO,GAAG,CAAC;QACZ;QACA,IAAIe,OAAO,GAAG,CAAC,EAAE;UAChB/W,GAAG,CAAC4K,OAAO,CAACyF,IAAI,CAAC,CAAC,CAAC,CAAC,CAACA,IAAI,CAAC,CAAC,CAAC,CAAC,CAACrB,YAAY,CAAC,SAAS,EAAE+H,OAAO,CAAC;QAC/D,CAAC,MAAM;UACNA,OAAO,GAAG,CAAC;QACZ;QACA;QACA/W,GAAG,CAACH,OAAO,CAAC+D,UAAU,CAACkT,QAAQ,CAAC,GAAG,CAAEd,OAAO,EAAEe,OAAO,EAAE,EAAE,CAAE;QAC3D;QACA/W,GAAG,CAAC4K,OAAO,CAACyF,IAAI,CAAC,CAAC,CAAC,CAAC,CAACA,IAAI,CAAC,CAAC,CAAC,CAAC,CAACrB,YAAY,CAAC,aAAa,EAAE,MAAM,CAAC;QACjE;QACAhP,GAAG,CAAC4K,OAAO,CAACyF,IAAI,CAAC,CAAC,CAAC,CAAC,CAACA,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC5L,KAAK,CAAC+Q,QAAQ,GAAG,QAAQ;QACvD;QACA,IAAIvU,IAAI,GAAG,EAAE;QACb;QACA,KAAK,IAAImR,CAAC,GAAG/B,IAAI,CAAC,CAAC,CAAC,EAAE+B,CAAC,GAAG/B,IAAI,CAAC,CAAC,CAAC,GAAG0G,OAAO,EAAE3E,CAAC,EAAE,EAAE;UACjD,KAAK,IAAID,CAAC,GAAG9B,IAAI,CAAC,CAAC,CAAC,EAAE8B,CAAC,GAAG9B,IAAI,CAAC,CAAC,CAAC,GAAG2F,OAAO,EAAE7D,CAAC,EAAE,EAAE;YACjD,IAAI,EAAG9B,IAAI,CAAC,CAAC,CAAC,IAAI8B,CAAC,IAAI9B,IAAI,CAAC,CAAC,CAAC,IAAI+B,CAAC,CAAC,EAAE;cACrCnR,IAAI,CAACuM,IAAI,CAACxN,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACmR,CAAC,CAAC,CAACD,CAAC,CAAC,CAAC;cACjCnS,GAAG,CAACwX,UAAU,CAACrF,CAAC,EAAEC,CAAC,EAAE,EAAE,EAAE,IAAI,CAAC;cAC9BpS,GAAG,CAACH,OAAO,CAAC+D,UAAU,CAACkT,QAAQ,CAAC,CAAC,CAAC,CAAC,CAACtJ,IAAI,CAACxN,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,CAACD,CAAC,CAAC,CAAC;cAC3DnS,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,CAACD,CAAC,CAAC,CAAC1N,KAAK,CAAC6K,OAAO,GAAG,MAAM;cACxCtP,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,CAACD,CAAC,CAAC,GAAGnS,GAAG,CAAC4K,OAAO,CAACyF,IAAI,CAAC,CAAC,CAAC,CAAC,CAACA,IAAI,CAAC,CAAC,CAAC,CAAC;YAClD;UACD;QACD;QACA;QACArQ,GAAG,CAACyX,eAAe,CAACzX,GAAG,CAAC4K,OAAO,CAACyF,IAAI,CAAC,CAAC,CAAC,CAAC,CAACA,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;QAElD,IAAI,CAAE2G,sBAAsB,EAAE;UAC7BhX,GAAG,CAAC0X,UAAU,CAAC;YACdC,MAAM,EAAC,UAAU;YACjBzB,MAAM,EAACY,QAAQ;YACfd,OAAO,EAACA,OAAO;YACfe,OAAO,EAACA,OAAO;YACf9V,IAAI,EAACA;UACN,CAAC,CAAC;UAEFjB,GAAG,CAACgM,QAAQ,CAAC,SAAS,EAAEjM,EAAE,EAAE+W,QAAQ,EAAEd,OAAO,EAAEe,OAAO,CAAC;QACxD;MACD;IACD,CAAC;;IAED;AACF;AACA;AACA;AACA;AACA;AACA;IACE/W,GAAG,CAAC4X,QAAQ,GAAG,UAASd,QAAQ,EAAE;MACjC,IAAI7V,IAAI,GAAG,CAAC,CAAC;MACb,IAAI6V,QAAQ,EAAE;QACb,IAAI9W,GAAG,CAACH,OAAO,CAAC+D,UAAU,CAACkT,QAAQ,CAAC,EAAE;UACrC7V,IAAI,GAAG,CAAEjB,GAAG,CAACH,OAAO,CAAC+D,UAAU,CAACkT,QAAQ,CAAC,CAAC,CAAC,CAAC,EAAE9W,GAAG,CAACH,OAAO,CAAC+D,UAAU,CAACkT,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAE;QACpF,CAAC,MAAM;UACN7V,IAAI,GAAG,IAAI;QACZ;MACD,CAAC,MAAM;QACN,IAAIjB,GAAG,CAACH,OAAO,CAAC+D,UAAU,EAAE;UAC3B,IAAIiU,WAAW,GAAG7X,GAAG,CAACH,OAAO,CAAC+D,UAAU;UACxC,IAAIkJ,IAAI,GAAGC,MAAM,CAACD,IAAI,CAAC9M,GAAG,CAACH,OAAO,CAAC+D,UAAU,CAAC;UAC9C,KAAK,IAAIqJ,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGH,IAAI,CAACD,MAAM,EAAEI,CAAC,EAAE,EAAE;YACrChM,IAAI,CAAC6L,IAAI,CAACG,CAAC,CAAC,CAAC,GAAG,CAAEjN,GAAG,CAACH,OAAO,CAAC+D,UAAU,CAACkJ,IAAI,CAACG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAEjN,GAAG,CAACH,OAAO,CAAC+D,UAAU,CAACkJ,IAAI,CAACG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAE;UAC3F;QACD;MACD;MAEA,OAAOhM,IAAI;IACZ,CAAC;;IAED;AACF;AACA;AACA;IACEjB,GAAG,CAAC8X,WAAW,GAAG,UAAShB,QAAQ,EAAE7V,IAAI,EAAE8W,WAAW,EAAE;MACvD,IAAI/X,GAAG,CAACH,OAAO,CAAC+D,UAAU,CAACkT,QAAQ,CAAC,EAAE;QACrC,IAAIzG,IAAI,GAAG5R,MAAM,CAAC6R,mBAAmB,CAACwG,QAAQ,EAAE,IAAI,CAAC;QACrD9W,GAAG,CAAC4K,OAAO,CAACyF,IAAI,CAAC,CAAC,CAAC,CAAC,CAACA,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC2H,eAAe,CAAC,SAAS,CAAC;QACxDhY,GAAG,CAAC4K,OAAO,CAACyF,IAAI,CAAC,CAAC,CAAC,CAAC,CAACA,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC2H,eAAe,CAAC,SAAS,CAAC;QACxDhY,GAAG,CAAC4K,OAAO,CAACyF,IAAI,CAAC,CAAC,CAAC,CAAC,CAACA,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC2H,eAAe,CAAC,aAAa,CAAC;QAC5D,IAAIpZ,IAAI,GAAGoB,GAAG,CAACH,OAAO,CAAC+D,UAAU,CAACkT,QAAQ,CAAC;QAE3C,IAAIrJ,KAAK,GAAG,CAAC;QACb,KAAK,IAAIwB,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGrQ,IAAI,CAAC,CAAC,CAAC,EAAEqQ,CAAC,EAAE,EAAE;UACjC,KAAK,IAAIhC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGrO,IAAI,CAAC,CAAC,CAAC,EAAEqO,CAAC,EAAE,EAAE;YACjC,IAAIgC,CAAC,GAAG,CAAC,IAAIhC,CAAC,GAAG,CAAC,EAAE;cACnBjN,GAAG,CAAC4K,OAAO,CAACyF,IAAI,CAAC,CAAC,CAAC,GAACpB,CAAC,CAAC,CAACoB,IAAI,CAAC,CAAC,CAAC,GAACpD,CAAC,CAAC,GAAGrO,IAAI,CAAC,CAAC,CAAC,CAAC6O,KAAK,CAAC;cAClDzN,GAAG,CAAC4K,OAAO,CAACyF,IAAI,CAAC,CAAC,CAAC,GAACpB,CAAC,CAAC,CAACoB,IAAI,CAAC,CAAC,CAAC,GAACpD,CAAC,CAAC,CAACxI,KAAK,CAAC6K,OAAO,GAAG,EAAE;cACpD;cACA,IAAIrO,IAAI,IAAIA,IAAI,CAACwM,KAAK,CAAC,EAAE;gBACxBzN,GAAG,CAACwX,UAAU,CAACnH,IAAI,CAAC,CAAC,CAAC,GAACpD,CAAC,EAAEoD,IAAI,CAAC,CAAC,CAAC,GAACpB,CAAC,EAAEhO,IAAI,CAACwM,KAAK,CAAC,CAAC;cAClD;cACAA,KAAK,EAAE;YACR;UACD;QACD;;QAEA;QACAzN,GAAG,CAACyX,eAAe,CAACzX,GAAG,CAAC4K,OAAO,CAACyF,IAAI,CAAC,CAAC,CAAC,CAAC,CAACA,IAAI,CAAC,CAAC,CAAC,CAAC,EAAErQ,GAAG,CAAC4K,OAAO,CAACyF,IAAI,CAAC,CAAC,CAAC,GAACpB,CAAC,GAAC,CAAC,CAAC,CAACoB,IAAI,CAAC,CAAC,CAAC,GAACpD,CAAC,GAAC,CAAC,CAAC,CAAC;QAEzF,IAAI,CAAE8K,WAAW,EAAE;UAClB,OAAO/X,GAAG,CAACH,OAAO,CAAC+D,UAAU,CAACkT,QAAQ,CAAE;QACzC;MACD;IACD,CAAC;;IAED;AACF;AACA;IACE9W,GAAG,CAACiY,aAAa,GAAG,UAASF,WAAW,EAAE;MACzC;MACA,IAAI/X,GAAG,CAACH,OAAO,CAAC+D,UAAU,EAAE;QAC3B,IAAIiU,WAAW,GAAG7X,GAAG,CAACH,OAAO,CAAC+D,UAAU;QACxC,IAAIkJ,IAAI,GAAGC,MAAM,CAACD,IAAI,CAAC9M,GAAG,CAACH,OAAO,CAAC+D,UAAU,CAAC;QAC9C,KAAK,IAAIqJ,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGH,IAAI,CAACD,MAAM,EAAEI,CAAC,EAAE,EAAE;UACrCjN,GAAG,CAAC8X,WAAW,CAAChL,IAAI,CAACG,CAAC,CAAC,EAAE,IAAI,EAAE8K,WAAW,CAAC;QAC5C;MACD;IACD,CAAC;;IAED;AACF;AACA;IACE/X,GAAG,CAACkY,WAAW,GAAG,UAAS/F,CAAC,EAAExR,YAAY,EAAE;MAC3C,IAAIwX,IAAI,GAAG,EAAE;MACb;MACA,IAAInY,GAAG,CAACH,OAAO,CAAC+D,UAAU,EAAE;QAC3B,IAAIkJ,IAAI,GAAGC,MAAM,CAACD,IAAI,CAAC9M,GAAG,CAACH,OAAO,CAAC+D,UAAU,CAAC;QAC9C,KAAK,IAAIqJ,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGH,IAAI,CAACD,MAAM,EAAEI,CAAC,EAAE,EAAE;UACrC,IAAIrO,IAAI,GAAGH,MAAM,CAAC6R,mBAAmB,CAACxD,IAAI,CAACG,CAAC,CAAC,EAAE,IAAI,CAAC;UACpD,IAAI+I,OAAO,GAAGhW,GAAG,CAACH,OAAO,CAAC+D,UAAU,CAACkJ,IAAI,CAACG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;UAChD,IAAIkK,EAAE,GAAGvY,IAAI,CAAC,CAAC,CAAC;UAChB,IAAIyY,EAAE,GAAGzY,IAAI,CAAC,CAAC,CAAC,IAAIoX,OAAO,GAAG,CAAC,GAAGA,OAAO,GAAG,CAAC,GAAG,CAAC,CAAC;UAElD,IAAIrV,YAAY,IAAI,IAAI,EAAE;YACzB,IAAKwW,EAAE,IAAIhF,CAAC,IAAIkF,EAAE,IAAIlF,CAAC,EAAG;cACzBgG,IAAI,CAAC3K,IAAI,CAACV,IAAI,CAACG,CAAC,CAAC,CAAC;YACnB;UACD,CAAC,MAAM;YACN,IAAItM,YAAY,EAAE;cACjB,IAAKwW,EAAE,GAAGhF,CAAC,IAAIkF,EAAE,IAAIlF,CAAC,EAAG;gBACxBgG,IAAI,CAAC3K,IAAI,CAACV,IAAI,CAACG,CAAC,CAAC,CAAC;cACnB;YACD,CAAC,MAAM;cACN,IAAKkK,EAAE,IAAIhF,CAAC,IAAIkF,EAAE,GAAGlF,CAAC,EAAG;gBACxBgG,IAAI,CAAC3K,IAAI,CAACV,IAAI,CAACG,CAAC,CAAC,CAAC;cACnB;YACD;UACD;QACD;MACD;MAEA,OAAOkL,IAAI;IACZ,CAAC;;IAED;AACF;AACA;IACEnY,GAAG,CAACoY,WAAW,GAAG,UAAShG,CAAC,EAAEzR,YAAY,EAAE;MAC3C,IAAIU,IAAI,GAAG,EAAE;MACb;MACA,IAAIrB,GAAG,CAACH,OAAO,CAAC+D,UAAU,EAAE;QAC3B,IAAIkJ,IAAI,GAAGC,MAAM,CAACD,IAAI,CAAC9M,GAAG,CAACH,OAAO,CAAC+D,UAAU,CAAC;QAC9C,KAAK,IAAIqJ,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGH,IAAI,CAACD,MAAM,EAAEI,CAAC,EAAE,EAAE;UACrC,IAAIrO,IAAI,GAAGH,MAAM,CAAC6R,mBAAmB,CAACxD,IAAI,CAACG,CAAC,CAAC,EAAE,IAAI,CAAC;UACpD,IAAI8J,OAAO,GAAG/W,GAAG,CAACH,OAAO,CAAC+D,UAAU,CAACkJ,IAAI,CAACG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;UAChD,IAAImK,EAAE,GAAGxY,IAAI,CAAC,CAAC,CAAC;UAChB,IAAI0Y,EAAE,GAAG1Y,IAAI,CAAC,CAAC,CAAC,IAAImY,OAAO,GAAG,CAAC,GAAGA,OAAO,GAAG,CAAC,GAAG,CAAC,CAAC;UAElD,IAAIpW,YAAY,IAAI,IAAI,EAAE;YACzB,IAAKyW,EAAE,IAAIhF,CAAC,IAAIkF,EAAE,IAAIlF,CAAC,EAAG;cACzB/Q,IAAI,CAACmM,IAAI,CAACV,IAAI,CAACG,CAAC,CAAC,CAAC;YACnB;UACD,CAAC,MAAM;YACN,IAAItM,YAAY,EAAE;cACjB,IAAKyW,EAAE,GAAGhF,CAAC,IAAIkF,EAAE,IAAIlF,CAAC,EAAG;gBACxB/Q,IAAI,CAACmM,IAAI,CAACV,IAAI,CAACG,CAAC,CAAC,CAAC;cACnB;YACD,CAAC,MAAM;cACN,IAAKmK,EAAE,IAAIhF,CAAC,IAAIkF,EAAE,GAAGlF,CAAC,EAAG;gBACxB/Q,IAAI,CAACmM,IAAI,CAACV,IAAI,CAACG,CAAC,CAAC,CAAC;cACnB;YACD;UACD;QACD;MACD;MAEA,OAAO5L,IAAI;IACZ,CAAC;;IAED;AACF;AACA;IACErB,GAAG,CAACqY,UAAU,GAAG,UAASC,QAAQ,EAAE;MACnC,IAAI,CAAEtY,GAAG,CAACH,OAAO,CAACoF,OAAO,EAAE;QAC1B9E,OAAO,CAACoY,GAAG,CAAC,oCAAoC,CAAC;MAClD,CAAC,MAAM;QACN;QACAD,QAAQ,GAAG3J,QAAQ,CAAC2J,QAAQ,CAAC;QAC7B;QACAtY,GAAG,CAACwO,cAAc,CAAC,CAAC;QACpB;QACA,IAAIgK,eAAe,GAAG,EAAE;QACxB,IAAIxY,GAAG,CAACH,OAAO,CAACyB,OAAO,CAACgX,QAAQ,CAAC,CAACvZ,IAAI,IAAI,UAAU,EAAE;UACrDyZ,eAAe,CAAChL,IAAI,CAAC;YAAE+B,EAAE,EAAE,MAAM;YAAErC,IAAI,EAAE;UAAO,CAAC,CAAC;UAClDsL,eAAe,CAAChL,IAAI,CAAC;YAAE+B,EAAE,EAAE,OAAO;YAAErC,IAAI,EAAE;UAAQ,CAAC,CAAC;QACrD,CAAC,MAAM;UACN,IAAIrN,OAAO,GAAG,EAAE;UAChB,IAAI4Y,SAAS,GAAG,KAAK;UACrB,KAAK,IAAIxJ,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjP,GAAG,CAACH,OAAO,CAACoB,IAAI,CAAC4L,MAAM,EAAEoC,CAAC,EAAE,EAAE;YACjD,IAAImB,CAAC,GAAGpQ,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACgO,CAAC,CAAC,CAACqJ,QAAQ,CAAC;YACrC,IAAIhZ,CAAC,GAAGU,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAACqJ,QAAQ,CAAC,CAACxJ,SAAS;YAC1C,IAAIsB,CAAC,IAAI9Q,CAAC,EAAE;cACXO,OAAO,CAACuQ,CAAC,CAAC,GAAG9Q,CAAC;YACf,CAAC,MAAM;cACN,IAAImZ,SAAS,GAAG,IAAI;YACrB;UACD;UACA,IAAI3L,IAAI,GAAGC,MAAM,CAACD,IAAI,CAACjN,OAAO,CAAC;UAC/B,IAAI2Y,eAAe,GAAG,EAAE;UACxB,KAAK,IAAIvJ,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGnC,IAAI,CAACD,MAAM,EAAEoC,CAAC,EAAE,EAAE;YACrCuJ,eAAe,CAAChL,IAAI,CAAC;cAAE+B,EAAE,EAAEzC,IAAI,CAACmC,CAAC,CAAC;cAAE/B,IAAI,EAAErN,OAAO,CAACiN,IAAI,CAACmC,CAAC,CAAC;YAAE,CAAC,CAAC;UAC9D;UACA;UACA,IAAIwJ,SAAS,EAAE;YACdD,eAAe,CAAChL,IAAI,CAAC;cAAEnO,KAAK,EAAE,EAAE;cAAEkQ,EAAE,EAAE,EAAE;cAAErC,IAAI,EAAE;YAAW,CAAC,CAAC;UAC9D;QACD;;QAEA;QACA,IAAI3M,GAAG,GAAGC,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;QACvCT,GAAG,CAACoL,MAAM,CAACyK,QAAQ,CAACyC,QAAQ,GAAG,CAAC,CAAC,CAACxJ,SAAS,GAAG,EAAE;QAChD9O,GAAG,CAACoL,MAAM,CAACyK,QAAQ,CAACyC,QAAQ,GAAG,CAAC,CAAC,CAAC/J,WAAW,CAAChO,GAAG,CAAC;QAClDP,GAAG,CAACoL,MAAM,CAACyK,QAAQ,CAACyC,QAAQ,GAAG,CAAC,CAAC,CAAC7T,KAAK,CAACiU,WAAW,GAAG,KAAK;QAC3D1Y,GAAG,CAACoL,MAAM,CAACyK,QAAQ,CAACyC,QAAQ,GAAG,CAAC,CAAC,CAAC7T,KAAK,CAACkU,YAAY,GAAG,KAAK;QAC5D3Y,GAAG,CAACoL,MAAM,CAACyK,QAAQ,CAACyC,QAAQ,GAAG,CAAC,CAAC,CAAC7T,KAAK,CAAC+Q,QAAQ,GAAG,SAAS;QAE5D,IAAI5V,GAAG,GAAG;UACTqB,IAAI,EAAEuX,eAAe;UACrBxL,QAAQ,EAAE,IAAI;UACd4L,YAAY,EAAE,IAAI;UAClBC,MAAM,EAAE,IAAI;UACZxZ,KAAK,EAAEW,GAAG,CAACiF,OAAO,CAACqT,QAAQ,CAAC,KAAKjH,SAAS,GAAGrR,GAAG,CAACiF,OAAO,CAACqT,QAAQ,CAAC,GAAG,IAAI;UACzEhL,KAAK,EAAC,MAAM;UACZwL,QAAQ,EAAG9Y,GAAG,CAACH,OAAO,CAACuE,aAAa,IAAI,IAAI,IAAIpE,GAAG,CAACH,OAAO,CAACoE,UAAU,IAAI,IAAI,GAAI,IAAI,GAAG,KAAK;UAC9F8U,OAAO,EAAE,SAAAA,CAASvZ,CAAC,EAAE;YACpBQ,GAAG,CAACgZ,YAAY,CAAC,CAAC;YAClBhZ,GAAG,CAACiF,OAAO,CAACqT,QAAQ,CAAC,GAAG9Y,CAAC,CAACyZ,QAAQ,CAACC,QAAQ,CAAC,IAAI,CAAC;YACjDlZ,GAAG,CAACoL,MAAM,CAACyK,QAAQ,CAACyC,QAAQ,GAAG,CAAC,CAAC,CAACxJ,SAAS,GAAGtP,CAAC,CAACyZ,QAAQ,CAACE,OAAO,CAAC,CAAC;YAClEnZ,GAAG,CAACoL,MAAM,CAACyK,QAAQ,CAACyC,QAAQ,GAAG,CAAC,CAAC,CAAC7T,KAAK,CAACiU,WAAW,GAAG,EAAE;YACxD1Y,GAAG,CAACoL,MAAM,CAACyK,QAAQ,CAACyC,QAAQ,GAAG,CAAC,CAAC,CAAC7T,KAAK,CAACkU,YAAY,GAAG,EAAE;YACzD3Y,GAAG,CAACoL,MAAM,CAACyK,QAAQ,CAACyC,QAAQ,GAAG,CAAC,CAAC,CAAC7T,KAAK,CAAC+Q,QAAQ,GAAG,EAAE;YACrDxV,GAAG,CAACoZ,WAAW,CAACd,QAAQ,CAAC;YACzBtY,GAAG,CAACqZ,gBAAgB,CAAC,CAAC;UACvB;QACD,CAAC;;QAED;QACAxL,OAAO,CAACoL,QAAQ,CAAC1Y,GAAG,EAAEX,GAAG,CAAC;MAC3B;IACD,CAAC;IAEDI,GAAG,CAACgZ,YAAY,GAAG,YAAW;MAC7B,IAAIhZ,GAAG,CAACH,OAAO,CAACoF,OAAO,EAAE;QACxB,KAAK,IAAIgI,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjN,GAAG,CAACoL,MAAM,CAACyK,QAAQ,CAAChJ,MAAM,EAAEI,CAAC,EAAE,EAAE;UACpDjN,GAAG,CAACoL,MAAM,CAACyK,QAAQ,CAAC5I,CAAC,CAAC,CAAC6B,SAAS,GAAG,QAAQ;UAC3C9O,GAAG,CAACiF,OAAO,CAACgI,CAAC,CAAC,GAAG,IAAI;QACtB;MACD;MAEAjN,GAAG,CAACsK,OAAO,GAAG,IAAI;MAClBtK,GAAG,CAACsZ,YAAY,CAAC,CAAC;IACnB,CAAC;IAEDtZ,GAAG,CAACoZ,WAAW,GAAG,UAASd,QAAQ,EAAE;MACpC,IAAI,CAAEA,QAAQ,EAAE;QACf,KAAK,IAAIrL,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjN,GAAG,CAACoL,MAAM,CAACyK,QAAQ,CAAChJ,MAAM,EAAEI,CAAC,EAAE,EAAE;UACpD,IAAIjN,GAAG,CAACiF,OAAO,CAACgI,CAAC,CAAC,EAAE;YACnBqL,QAAQ,GAAGrL,CAAC;UACb;QACD;MACD;;MAEA;MACA,IAAInJ,MAAM,GAAG,SAAAA,CAASyV,KAAK,EAAEpH,CAAC,EAAEC,CAAC,EAAE;QAClC,KAAK,IAAInF,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGsM,KAAK,CAAC1M,MAAM,EAAEI,CAAC,EAAE,EAAE;UACtC,IAAI5N,KAAK,GAAG,EAAE,GAACW,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACmR,CAAC,CAAC,CAACD,CAAC,CAAC;UACrC,IAAIqH,KAAK,GAAG,EAAE,GAACxZ,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,CAACD,CAAC,CAAC,CAACrD,SAAS;UAC1C,IAAIyK,KAAK,CAACtM,CAAC,CAAC,IAAI5N,KAAK,IAAIka,KAAK,CAACtM,CAAC,CAAC,IAAIuM,KAAK,EAAE;YAC3C,OAAO,IAAI;UACZ;QACD;QACA,OAAO,KAAK;MACb,CAAC;MAED,IAAID,KAAK,GAAGvZ,GAAG,CAACiF,OAAO,CAACqT,QAAQ,CAAC;MACjCtY,GAAG,CAACsK,OAAO,GAAG,EAAE;MAChB,KAAK,IAAI2E,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjP,GAAG,CAACH,OAAO,CAACoB,IAAI,CAAC4L,MAAM,EAAEoC,CAAC,EAAE,EAAE;QACjD,IAAInL,MAAM,CAACyV,KAAK,EAAEjB,QAAQ,EAAErJ,CAAC,CAAC,EAAE;UAC/BjP,GAAG,CAACsK,OAAO,CAACkD,IAAI,CAACyB,CAAC,CAAC;QACpB;MACD;MACA,IAAI,CAAEjP,GAAG,CAACsK,OAAO,CAACuC,MAAM,EAAE;QACzB7M,GAAG,CAACsK,OAAO,GAAG,IAAI;MACnB;MAEAtK,GAAG,CAACsZ,YAAY,CAAC,CAAC;IACnB,CAAC;;IAED;AACF;AACA;AACA;AACA;AACA;IACEtZ,GAAG,CAACyZ,UAAU,GAAG,UAASpJ,IAAI,EAAEqJ,KAAK,EAAE1L,CAAC,EAAE;MACzC;MACA,IAAIoE,CAAC,GAAG/B,IAAI,CAACkG,YAAY,CAAC,QAAQ,CAAC;MACnC,IAAIpE,CAAC,GAAG9B,IAAI,CAACkG,YAAY,CAAC,QAAQ,CAAC;;MAEnC;MACAvW,GAAG,CAACgM,QAAQ,CAAC,gBAAgB,EAAEjM,EAAE,EAAEsQ,IAAI,EAAE8B,CAAC,EAAEC,CAAC,CAAC;;MAE9C;MACA,IAAID,CAAC,GAAG,CAAC,EAAE;QACVnS,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,CAACD,CAAC,GAAC,CAAC,CAAC,CAAC1N,KAAK,CAAC+Q,QAAQ,GAAG,QAAQ;MAC9C;;MAEA;MACA,IAAImE,YAAY,GAAG,SAAAA,CAAS5a,IAAI,EAAE;QACjC;QACA,IAAIH,IAAI,GAAGyR,IAAI,CAACuJ,qBAAqB,CAAC,CAAC;;QAEvC;QACA,IAAIxM,MAAM,GAAG5M,QAAQ,CAACC,aAAa,CAAC1B,IAAI,CAAC;QACzC;QACAqO,MAAM,CAAC3I,KAAK,CAAC6I,KAAK,GAAI1O,IAAI,CAAC0O,KAAK,GAAG,CAAC,GAAI,IAAI;QAC5CF,MAAM,CAAC3I,KAAK,CAAC2O,MAAM,GAAIxU,IAAI,CAACwU,MAAM,GAAG,CAAC,GAAI,IAAI;QAC9ChG,MAAM,CAAC3I,KAAK,CAACoV,SAAS,GAAIjb,IAAI,CAACwU,MAAM,GAAG,CAAC,GAAI,IAAI;;QAEjD;QACA/C,IAAI,CAACvE,SAAS,CAACC,GAAG,CAAC,QAAQ,CAAC;QAC5BsE,IAAI,CAACvB,SAAS,GAAG,EAAE;QACnBuB,IAAI,CAAC9B,WAAW,CAACnB,MAAM,CAAC;;QAExB;QACApN,GAAG,CAACgM,QAAQ,CAAC,gBAAgB,EAAEjM,EAAE,EAAEsQ,IAAI,EAAE8B,CAAC,EAAEC,CAAC,EAAEhF,MAAM,CAAC;QAEtD,OAAOA,MAAM;MACd,CAAC;;MAED;MACA,IAAIiD,IAAI,CAACvE,SAAS,CAACuG,QAAQ,CAAC,UAAU,CAAC,IAAI,IAAI,EAAE;QAChD;MAAA,CACA,MAAM;QACN;QACArS,GAAG,CAACyL,OAAO,GAAG,CAAEzL,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,CAACD,CAAC,CAAC,EAAEnS,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,CAACD,CAAC,CAAC,CAACrD,SAAS,EAAEqD,CAAC,EAAEC,CAAC,CAAE;;QAEtE;QACA,IAAIpS,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAAC/E,MAAM,EAAE;UAClC;UACApN,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAAC/E,MAAM,CAACqM,UAAU,CAACpJ,IAAI,EAAEtQ,EAAE,EAAE2Z,KAAK,EAAE1L,CAAC,CAAC;QAC7D,CAAC,MAAM;UACN;UACA,IAAIhO,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAACpT,IAAI,IAAI,QAAQ,EAAE;YAC5C;UAAA,CACA,MAAM,IAAIiB,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAACpT,IAAI,IAAI,UAAU,IAAIiB,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAACpT,IAAI,IAAI,OAAO,EAAE;YAC/F;YACA,IAAIM,KAAK,GAAGgR,IAAI,CAACwF,QAAQ,CAAC,CAAC,CAAC,CAACrB,OAAO,GAAG,KAAK,GAAG,IAAI;YACnD;YACAxU,GAAG,CAAC+S,QAAQ,CAAC1C,IAAI,EAAEhR,KAAK,CAAC;YACzB;YACAW,GAAG,CAACyL,OAAO,GAAG,IAAI;UACnB,CAAC,MAAM,IAAIzL,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAACpT,IAAI,IAAI,UAAU,IAAIiB,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAACpT,IAAI,IAAI,cAAc,EAAE;YACtG;YACA,IAAIM,KAAK,GAAGW,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACmR,CAAC,CAAC,CAACD,CAAC,CAAC;YAClC,IAAInS,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAACnF,QAAQ,IAAI,CAACX,KAAK,CAACwE,OAAO,CAACxR,KAAK,CAAC,EAAE;cAC7DA,KAAK,GAAGA,KAAK,CAACwU,KAAK,CAAC,GAAG,CAAC;YACzB;;YAEA;YACA,IAAI,OAAO7T,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAAC/G,MAAO,IAAI,UAAU,EAAE;cACxD,IAAI+B,MAAM,GAAGnN,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAAC/G,MAAM,CAACrL,EAAE,EAAEsQ,IAAI,EAAE8B,CAAC,EAAEC,CAAC,EAAEpS,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAAChF,MAAM,CAAC;YAC1F,CAAC,MAAM;cACN,IAAIA,MAAM,GAAGnN,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAAChF,MAAM;YAC3C;;YAEA;YACA,IAAIlM,IAAI,GAAG,EAAE;YACb,KAAK,IAAIgO,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG9B,MAAM,CAACN,MAAM,EAAEoC,CAAC,EAAE,EAAE;cACvChO,IAAI,CAACuM,IAAI,CAACL,MAAM,CAAC8B,CAAC,CAAC,CAAC;YACrB;;YAEA;YACA,IAAI7B,MAAM,GAAGuM,YAAY,CAAC,KAAK,CAAC;YAChC,IAAI9Z,OAAO,GAAG;cACboB,IAAI,EAAEA,IAAI;cACV+L,QAAQ,EAAEhN,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAACnF,QAAQ,GAAG,IAAI,GAAG,KAAK;cACxD4L,YAAY,EAAE5Y,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAACyG,YAAY,IAAI5Y,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAACpT,IAAI,IAAI,cAAc,GAAG,IAAI,GAAG,KAAK;cACjH8Z,MAAM,EAAC,IAAI;cACXxZ,KAAK,EAAEA,KAAK;cACZiO,KAAK,EAAC,MAAM;cACZ8F,MAAM,EAAChG,MAAM,CAAC3I,KAAK,CAACoV,SAAS;cAC7Bf,QAAQ,EAAG9Y,GAAG,CAACH,OAAO,CAACuE,aAAa,IAAI,IAAI,IAAIpE,GAAG,CAACH,OAAO,CAACoE,UAAU,IAAI,IAAI,GAAI,IAAI,GAAG,KAAK;cAC9F8U,OAAO,EAAC,SAAAA,CAAA,EAAW;gBAClB/Y,GAAG,CAAC8Z,WAAW,CAACzJ,IAAI,EAAE,IAAI,CAAC;cAC5B;YACD,CAAC;YACD,IAAIrQ,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAACtS,OAAO,IAAIG,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAACtS,OAAO,CAACd,IAAI,EAAE;cAC1Ec,OAAO,CAACd,IAAI,GAAGiB,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAACtS,OAAO,CAACd,IAAI;YACnD;YACA8O,OAAO,CAACoL,QAAQ,CAAC7L,MAAM,EAAEvN,OAAO,CAAC;UAClC,CAAC,MAAM,IAAIG,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAACpT,IAAI,IAAI,UAAU,IAAIiB,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAACpT,IAAI,IAAI,OAAO,EAAE;YAC/F;YACA,IAAIM,KAAK,GAAGW,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACmR,CAAC,CAAC,CAACD,CAAC,CAAC;YAClC;YACA,IAAI/E,MAAM,GAAGuM,YAAY,CAAC,OAAO,CAAC;YAClCvM,MAAM,CAAC/N,KAAK,GAAGA,KAAK;YAEpB,IAAIW,GAAG,CAACH,OAAO,CAACuE,aAAa,IAAI,IAAI,IAAIpE,GAAG,CAACH,OAAO,CAACoE,UAAU,IAAI,IAAI,EAAE;cACxEjE,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAACtS,OAAO,CAACiZ,QAAQ,GAAG,IAAI;YAC/C;YACA9Y,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAACtS,OAAO,CAACR,KAAK,GAAGW,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACmR,CAAC,CAAC,CAACD,CAAC,CAAC;YAC7DnS,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAACtS,OAAO,CAACgZ,MAAM,GAAG,IAAI;YAC5C7Y,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAACtS,OAAO,CAACkZ,OAAO,GAAG,UAAShZ,EAAE,EAAEV,KAAK,EAAE;cAC5DW,GAAG,CAAC8Z,WAAW,CAACzJ,IAAI,EAAE,IAAI,CAAC;YAC5B,CAAC;YACD;YACA,IAAIrQ,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAACpT,IAAI,IAAI,OAAO,EAAE;cAC3C8O,OAAO,CAACmH,KAAK,CAAC5H,MAAM,EAAEpN,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAACtS,OAAO,CAAC;YACtD,CAAC,MAAM;cACNgO,OAAO,CAAC+G,QAAQ,CAACxH,MAAM,EAAEpN,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAACtS,OAAO,CAAC;YACzD;YACA;YACAuN,MAAM,CAAC2M,KAAK,CAAC,CAAC;UACf,CAAC,MAAM,IAAI/Z,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAACpT,IAAI,IAAI,MAAM,EAAE;YACjD,IAAIM,KAAK,GAAGW,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACmR,CAAC,CAAC,CAACD,CAAC,CAAC;YAClC;YACA,IAAI/E,MAAM,GAAGuM,YAAY,CAAC,KAAK,CAAC;YAChCvM,MAAM,CAAC3I,KAAK,CAACqU,QAAQ,GAAG,UAAU;YAClC,IAAIvY,GAAG,GAAGC,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;YACvCF,GAAG,CAACuL,SAAS,CAACC,GAAG,CAAC,iBAAiB,CAAC;YACpCqB,MAAM,CAACmB,WAAW,CAAChO,GAAG,CAAC;YACvBsN,OAAO,CAACT,MAAM,CAAC7M,GAAG,EAAE;cACnBwZ,KAAK,EAAE,IAAI;cACX1a,KAAK,EAAEA;YACR,CAAC,CAAC;YACF,IAAI2a,IAAI,GAAG3J,IAAI,CAACuJ,qBAAqB,CAAC,CAAC;YACvC,IAAIK,WAAW,GAAG1Z,GAAG,CAACqZ,qBAAqB,CAAC,CAAC;YAC7C,IAAIlb,MAAM,CAACwb,WAAW,GAAGF,IAAI,CAACG,MAAM,GAAGF,WAAW,CAAC7G,MAAM,EAAE;cAC1D7S,GAAG,CAACkE,KAAK,CAAC2V,GAAG,GAAIJ,IAAI,CAACI,GAAG,IAAIH,WAAW,CAAC7G,MAAM,GAAG,CAAC,CAAC,GAAI,IAAI;YAC7D,CAAC,MAAM;cACN7S,GAAG,CAACkE,KAAK,CAAC2V,GAAG,GAAIJ,IAAI,CAACI,GAAG,GAAI,IAAI;YAClC;UACD,CAAC,MAAM,IAAIpa,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAACpT,IAAI,IAAI,OAAO,EAAE;YAClD;YACA,IAAImW,GAAG,GAAG7E,IAAI,CAACwF,QAAQ,CAAC,CAAC,CAAC;YAC1B;YACA,IAAIzI,MAAM,GAAGuM,YAAY,CAAC,KAAK,CAAC;YAChCvM,MAAM,CAAC3I,KAAK,CAACqU,QAAQ,GAAG,UAAU;YAClC,IAAIvY,GAAG,GAAGC,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;YACvCF,GAAG,CAACuL,SAAS,CAACC,GAAG,CAAC,QAAQ,CAAC;YAC3B,IAAImJ,GAAG,IAAIA,GAAG,CAACC,GAAG,EAAE;cACnB5U,GAAG,CAACgO,WAAW,CAAC2G,GAAG,CAAC;YACrB;YACA9H,MAAM,CAACmB,WAAW,CAAChO,GAAG,CAAC;YACvBsN,OAAO,CAACwM,KAAK,CAAC9Z,GAAG,EAAEP,GAAG,CAACH,OAAO,CAACuD,YAAY,CAAC;YAC5C,IAAI4W,IAAI,GAAG3J,IAAI,CAACuJ,qBAAqB,CAAC,CAAC;YACvC,IAAIK,WAAW,GAAG1Z,GAAG,CAACqZ,qBAAqB,CAAC,CAAC;YAC7C,IAAIlb,MAAM,CAACwb,WAAW,GAAGF,IAAI,CAACG,MAAM,GAAGF,WAAW,CAAC7G,MAAM,EAAE;cAC1D7S,GAAG,CAACkE,KAAK,CAAC2V,GAAG,GAAIJ,IAAI,CAACI,GAAG,IAAIH,WAAW,CAAC7G,MAAM,GAAG,CAAC,CAAC,GAAI,IAAI;YAC7D,CAAC,MAAM;cACN7S,GAAG,CAACkE,KAAK,CAAC2V,GAAG,GAAIJ,IAAI,CAACI,GAAG,GAAI,IAAI;YAClC;UACD,CAAC,MAAM;YACN;YACA/J,IAAI,CAACvE,SAAS,CAACC,GAAG,CAAC,SAAS,CAAC;YAC7B,IAAIuO,WAAW,GAAGjK,IAAI,CAACuJ,qBAAqB,CAAC,CAAC,CAACxG,MAAM;YACrDpT,GAAG,CAACqB,IAAI,CAAC+Q,CAAC,CAAC,CAAC3N,KAAK,CAAC8V,WAAW,CAAE,mCAAmC,EAAEC,IAAI,CAACC,KAAK,CAAE,CAACH,WAAW,GAAC,EAAE,IAAI,EAAG,CAAE,CAAC;YACzGta,GAAG,CAAC0a,oBAAoB,CAAC,CAAC;;YAE1B;YACA,IAAIrb,KAAK,GAAGqa,KAAK,IAAI,IAAI,GAAG,EAAE,GAAG1Z,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACmR,CAAC,CAAC,CAACD,CAAC,CAAC;;YAEvD;YACA,IAAInS,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAAChP,QAAQ,IAAI,KAAK,KAAKnD,GAAG,CAACH,OAAO,CAACsD,QAAQ,IAAI,IAAI,IAAInD,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAAChP,QAAQ,IAAI,IAAI,CAAC,EAAE;cAC1H,IAAIiK,MAAM,GAAGuM,YAAY,CAAC,UAAU,CAAC;YACtC,CAAC,MAAM;cACN,IAAIvM,MAAM,GAAGuM,YAAY,CAAC,OAAO,CAAC;YACnC;YAEAvM,MAAM,CAAC2M,KAAK,CAAC,CAAC;YACd3M,MAAM,CAAC/N,KAAK,GAAGA,KAAK;;YAEpB;YACA,IAAIQ,OAAO,GAAGG,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC;YACpC;YACA,IAAIvS,GAAG,GAAG,IAAI;;YAEd;YACA,IAAI,CAAER,SAAS,CAACC,KAAK,CAAC,EAAE;cACvB;cACA,IAAIO,GAAG,GAAGL,OAAO,CAACM,OAAO,CAAC,EAAE;gBAC3B;gBACA,IAAI,CAAEA,OAAO,CAAC8a,qBAAqB,EAAE;kBACpC,IAAI9a,OAAO,CAACH,IAAI,EAAE;oBACjB,IAAIkb,CAAC,GAAG/a,OAAO,CAACH,IAAI,CAACmU,KAAK,CAAC,GAAG,CAAC;oBAC/BzG,MAAM,CAAC4B,YAAY,CAAC,WAAW,EAAE4L,CAAC,CAAC,CAAC,CAAC,CAAC;kBACvC,CAAC,MAAM,IAAI/a,OAAO,CAACF,MAAM,EAAE;oBAC1ByN,MAAM,CAAC4B,YAAY,CAAC,aAAa,EAAEnP,OAAO,CAACF,MAAM,CAAC;kBACnD;gBACD;gBACA;gBACAC,GAAG,CAACib,KAAK,GAAGzN,MAAM;gBAClB;gBACAA,MAAM,CAAC1N,IAAI,GAAGE,GAAG;gBACjB;gBACAiO,OAAO,CAACnO,IAAI,CAACiU,MAAM,CAACtU,KAAK,EAAEO,GAAG,EAAE,KAAK,CAAC;cACvC;YACD;YAEAwN,MAAM,CAACvG,MAAM,GAAG,YAAW;cAC1B7G,GAAG,CAAC8Z,WAAW,CAACzJ,IAAI,EAAE,IAAI,CAAC;YAC5B,CAAC;YACDjD,MAAM,CAAC0N,UAAU,GAAG1N,MAAM,CAAC2N,WAAW;UACvC;QACD;MACD;IACD,CAAC;;IAED;AACF;AACA;AACA;AACA;AACA;AACA;IACE/a,GAAG,CAAC8Z,WAAW,GAAG,UAASzJ,IAAI,EAAE3D,IAAI,EAAE;MACtC,IAAIyF,CAAC,GAAGxD,QAAQ,CAAC0B,IAAI,CAACkG,YAAY,CAAC,QAAQ,CAAC,CAAC;MAC7C,IAAInE,CAAC,GAAGzD,QAAQ,CAAC0B,IAAI,CAACkG,YAAY,CAAC,QAAQ,CAAC,CAAC;;MAE7C;MACAlG,IAAI,CAACvE,SAAS,CAAClL,MAAM,CAAC,SAAS,CAAC;MAChCZ,GAAG,CAACqB,IAAI,CAAC+Q,CAAC,CAAC,CAAC3N,KAAK,CAACuW,cAAc,CAAE,mCAAoC,CAAC;MACvEhb,GAAG,CAAC0a,oBAAoB,CAAC,CAAC;;MAE1B;MACA,IAAIhO,IAAI,IAAI,IAAI,EAAE;QACjB;QACA,IAAI1M,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAAC/E,MAAM,EAAE;UAClC;UACA,IAAI/N,KAAK,GAAGW,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAAC/E,MAAM,CAAC0M,WAAW,CAACzJ,IAAI,EAAE3D,IAAI,CAAC;QAClE,CAAC,MAAM;UACN;UACA,IAAI1M,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAACpT,IAAI,IAAI,UAAU,IAAIiB,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAACpT,IAAI,IAAI,OAAO,IAAIiB,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAACpT,IAAI,IAAI,QAAQ,EAAE;YACnI;UAAA,CACA,MAAM,IAAIiB,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAACpT,IAAI,IAAI,UAAU,IAAIiB,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAACpT,IAAI,IAAI,cAAc,EAAE;YACtG,IAAIM,KAAK,GAAGgR,IAAI,CAACwF,QAAQ,CAAC,CAAC,CAAC,CAACoD,QAAQ,CAACtJ,KAAK,CAAC,IAAI,CAAC;UAClD,CAAC,MAAM,IAAI3P,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAACpT,IAAI,IAAI,UAAU,EAAE;YACrD,IAAIM,KAAK,GAAGgR,IAAI,CAACwF,QAAQ,CAAC,CAAC,CAAC,CAACjB,QAAQ,CAACjF,KAAK,CAAC,IAAI,CAAC;UAClD,CAAC,MAAM,IAAI3P,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAACpT,IAAI,IAAI,OAAO,EAAE;YAClD,IAAIM,KAAK,GAAGgR,IAAI,CAACwF,QAAQ,CAAC,CAAC,CAAC,CAACb,KAAK,CAACrF,KAAK,CAAC,IAAI,CAAC;UAC/C,CAAC,MAAM,IAAI3P,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAACpT,IAAI,IAAI,MAAM,EAAE;YACjD,IAAIM,KAAK,GAAGgR,IAAI,CAACwF,QAAQ,CAAC,CAAC,CAAC,CAACA,QAAQ,CAAC,CAAC,CAAC,CAACzI,MAAM,CAAC0E,OAAO,CAAC,CAAC;UAC1D,CAAC,MAAM,IAAI9R,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAACpT,IAAI,IAAI,OAAO,EAAE;YAClD,IAAImW,GAAG,GAAG7E,IAAI,CAACwF,QAAQ,CAAC,CAAC,CAAC,CAACA,QAAQ,CAAC,CAAC,CAAC,CAACA,QAAQ,CAAC,CAAC,CAAC;YAClD,IAAIxW,KAAK,GAAG6V,GAAG,IAAIA,GAAG,CAAC7U,OAAO,IAAI,KAAK,GAAG6U,GAAG,CAACC,GAAG,GAAG,EAAE;UACvD,CAAC,MAAM,IAAInV,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAACpT,IAAI,IAAI,SAAS,EAAE;YACpD,IAAIM,KAAK,GAAGgR,IAAI,CAACwF,QAAQ,CAAC,CAAC,CAAC,CAACxW,KAAK;YAClC,IAAI,CAAC,EAAE,GAACA,KAAK,EAAEkU,MAAM,CAAC,CAAC,EAAC,CAAC,CAAC,IAAI,GAAG,EAAE;cAClC,IAAIlU,KAAK,IAAI,EAAE,EAAE;gBAChBA,KAAK,GAAGW,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAAC9E,UAAU,GAAG,EAAE,GAAG,CAAC;cACnD;YACD;YACAgD,IAAI,CAACwF,QAAQ,CAAC,CAAC,CAAC,CAAChP,MAAM,GAAG,IAAI;UAC/B,CAAC,MAAM;YACN,IAAIxH,KAAK,GAAGgR,IAAI,CAACwF,QAAQ,CAAC,CAAC,CAAC,CAACxW,KAAK;YAClCgR,IAAI,CAACwF,QAAQ,CAAC,CAAC,CAAC,CAAChP,MAAM,GAAG,IAAI;;YAE9B;YACA,IAAIhH,OAAO,GAAGG,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC;YACpC;YACA,IAAIvS,GAAG,GAAG,IAAI;YACd,IAAIA,GAAG,GAAGL,OAAO,CAACM,OAAO,CAAC,EAAE;cAC3B;cACA,IAAIR,KAAK,KAAK,EAAE,IAAI,CAAED,SAAS,CAACC,KAAK,CAAC,IAAI,OAAOA,KAAM,KAAK,QAAQ,EAAE;gBACrE,IAAIuU,CAAC,GAAG/F,OAAO,CAACnO,IAAI,CAACub,OAAO,CAAC5b,KAAK,EAAEO,GAAG,EAAE,IAAI,CAAC;gBAC9C,IAAIgU,CAAC,IAAIA,CAAC,CAACvU,KAAK,KAAK,EAAE,EAAE;kBACxBA,KAAK,GAAGuU,CAAC,CAACvU,KAAK;gBAChB;cACD;YACD;UACD;QACD;;QAEA;QACA,IAAIW,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACmR,CAAC,CAAC,CAACD,CAAC,CAAC,IAAI9S,KAAK,EAAE;UACpCgR,IAAI,CAACvB,SAAS,GAAG9O,GAAG,CAACyL,OAAO,CAAC,CAAC,CAAC;QAChC,CAAC,MAAM;UACNzL,GAAG,CAAC+S,QAAQ,CAAC1C,IAAI,EAAEhR,KAAK,CAAC;QAC1B;MACD,CAAC,MAAM;QACN,IAAIW,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAAC/E,MAAM,EAAE;UAClC;UACApN,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAAC/E,MAAM,CAAC0M,WAAW,CAACzJ,IAAI,EAAE3D,IAAI,CAAC;QACtD,CAAC,MAAM;UACN,IAAI1M,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAACpT,IAAI,IAAI,UAAU,IAAIiB,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAACpT,IAAI,IAAI,cAAc,EAAE;YAC/FsR,IAAI,CAACwF,QAAQ,CAAC,CAAC,CAAC,CAACoD,QAAQ,CAACtJ,KAAK,CAAC,IAAI,CAAC;UACtC,CAAC,MAAM,IAAI3P,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAACpT,IAAI,IAAI,UAAU,EAAE;YACrDsR,IAAI,CAACwF,QAAQ,CAAC,CAAC,CAAC,CAACjB,QAAQ,CAACjF,KAAK,CAAC,IAAI,CAAC;UACtC,CAAC,MAAM,IAAI3P,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAACpT,IAAI,IAAI,OAAO,EAAE;YAClDsR,IAAI,CAACwF,QAAQ,CAAC,CAAC,CAAC,CAACb,KAAK,CAACrF,KAAK,CAAC,IAAI,CAAC;UACnC,CAAC,MAAM;YACNU,IAAI,CAACwF,QAAQ,CAAC,CAAC,CAAC,CAAChP,MAAM,GAAG,IAAI;UAC/B;QACD;;QAEA;QACAwJ,IAAI,CAACvB,SAAS,GAAG9O,GAAG,CAACyL,OAAO,IAAIzL,GAAG,CAACyL,OAAO,CAAC,CAAC,CAAC,GAAGzL,GAAG,CAACyL,OAAO,CAAC,CAAC,CAAC,GAAG,EAAE;MACrE;;MAEA;MACAzL,GAAG,CAACgM,QAAQ,CAAC,cAAc,EAAEjM,EAAE,EAAEsQ,IAAI,EAAE8B,CAAC,EAAEC,CAAC,EAAE/S,KAAK,EAAEqN,IAAI,CAAC;;MAEzD;MACA2D,IAAI,CAACvE,SAAS,CAAClL,MAAM,CAAC,QAAQ,CAAC;;MAE/B;MACAZ,GAAG,CAACyL,OAAO,GAAG,IAAI;IACnB,CAAC;;IAED;AACF;AACA;AACA;AACA;AACA;IACEzL,GAAG,CAACkb,OAAO,GAAG,UAAS7K,IAAI,EAAE;MAC5B;MACAA,IAAI,GAAG5R,MAAM,CAAC6R,mBAAmB,CAACD,IAAI,EAAE,IAAI,CAAC;MAC7C,IAAI8B,CAAC,GAAG9B,IAAI,CAAC,CAAC,CAAC;MACf,IAAI+B,CAAC,GAAG/B,IAAI,CAAC,CAAC,CAAC;MAEf,OAAOrQ,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,CAACD,CAAC,CAAC;IACzB,CAAC;;IAED;AACF;AACA;AACA;AACA;AACA;IACEnS,GAAG,CAACmb,gBAAgB,GAAG,UAAShJ,CAAC,EAAEC,CAAC,EAAE;MACrC;MACA,IAAIvS,OAAO,GAAGG,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC;;MAEpC;MACA,IAAI,CAAEtS,OAAO,EAAE;QACdA,OAAO,GAAG;UAAEd,IAAI,EAAE;QAAO,CAAC;MAC3B;MAEA,OAAOc,OAAO;IACf,CAAC;;IAED;AACF;AACA;AACA;AACA;AACA;IACEG,GAAG,CAACob,iBAAiB,GAAG,UAASjJ,CAAC,EAAEC,CAAC,EAAE;MACtC,OAAOpS,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,CAACD,CAAC,CAAC;IACzB,CAAC;;IAED;AACF;AACA;AACA;AACA;AACA;IACEnS,GAAG,CAACqb,QAAQ,GAAG,UAAShL,IAAI,EAAE;MAC7B;MACAA,IAAI,GAAG5R,MAAM,CAAC6R,mBAAmB,CAACD,IAAI,EAAE,IAAI,CAAC;MAC7C,IAAI8B,CAAC,GAAG9B,IAAI,CAAC,CAAC,CAAC;MACf,IAAI+B,CAAC,GAAG/B,IAAI,CAAC,CAAC,CAAC;MAEf,OAAOrQ,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,CAACD,CAAC,CAAC,CAACrD,SAAS;IACnC,CAAC;;IAED;AACF;AACA;AACA;AACA;AACA;IACE9O,GAAG,CAACsb,kBAAkB,GAAG,UAASnJ,CAAC,EAAEC,CAAC,EAAE;MACvC,OAAOpS,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,CAACD,CAAC,CAAC,CAACrD,SAAS;IACnC,CAAC;;IAED;AACF;AACA;AACA;AACA;AACA;IACE9O,GAAG,CAACkZ,QAAQ,GAAG,UAAS7I,IAAI,EAAEkL,cAAc,EAAE;MAC7C,IAAI,OAAOlL,IAAK,IAAI,QAAQ,EAAE;QAC7B,IAAI8B,CAAC,GAAG9B,IAAI,CAACkG,YAAY,CAAC,QAAQ,CAAC;QACnC,IAAInE,CAAC,GAAG/B,IAAI,CAACkG,YAAY,CAAC,QAAQ,CAAC;MACpC,CAAC,MAAM;QACNlG,IAAI,GAAG5R,MAAM,CAAC6R,mBAAmB,CAACD,IAAI,EAAE,IAAI,CAAC;QAC7C,IAAI8B,CAAC,GAAG9B,IAAI,CAAC,CAAC,CAAC;QACf,IAAI+B,CAAC,GAAG/B,IAAI,CAAC,CAAC,CAAC;MAChB;MAEA,IAAIhR,KAAK,GAAG,IAAI;MAEhB,IAAI8S,CAAC,IAAI,IAAI,IAAIC,CAAC,IAAI,IAAI,EAAE;QAC3B,IAAIpS,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,IAAIpS,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,CAACD,CAAC,CAAC,KAAKoJ,cAAc,IAAIvb,GAAG,CAACH,OAAO,CAACsB,iBAAiB,IAAI,IAAI,CAAC,EAAE;UACrG9B,KAAK,GAAGW,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,CAACD,CAAC,CAAC,CAACrD,SAAS;QACpC,CAAC,MAAM;UACN,IAAI9O,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACmR,CAAC,CAAC,IAAIpS,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACmR,CAAC,CAAC,CAACD,CAAC,CAAC,IAAI,WAAW,EAAE;YACjE9S,KAAK,GAAGW,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACmR,CAAC,CAAC,CAACD,CAAC,CAAC;UAC/B;QACD;MACD;MAEA,OAAO9S,KAAK;IACb,CAAC;;IAED;AACF;AACA;AACA;AACA;AACA;AACA;IACEW,GAAG,CAACwb,kBAAkB,GAAG,UAASrJ,CAAC,EAAEC,CAAC,EAAEmJ,cAAc,EAAE;MACvD,IAAIlc,KAAK,GAAG,IAAI;MAEhB,IAAI8S,CAAC,IAAI,IAAI,IAAIC,CAAC,IAAI,IAAI,EAAE;QAC3B,IAAKpS,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,IAAIpS,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,CAACD,CAAC,CAAC,IAAKoJ,cAAc,IAAIvb,GAAG,CAACH,OAAO,CAACsB,iBAAiB,IAAI,IAAI,EAAE;UACrG9B,KAAK,GAAGW,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,CAACD,CAAC,CAAC,CAACrD,SAAS;QACpC,CAAC,MAAM;UACN,IAAI9O,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACmR,CAAC,CAAC,IAAIpS,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACmR,CAAC,CAAC,CAACD,CAAC,CAAC,IAAI,WAAW,EAAE;YACjE9S,KAAK,GAAGW,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACmR,CAAC,CAAC,CAACD,CAAC,CAAC;UAC/B;QACD;MACD;MAEA,OAAO9S,KAAK;IACb,CAAC;;IAED;AACF;AACA;AACA;AACA;AACA;AACA;IACEW,GAAG,CAAC+S,QAAQ,GAAG,UAAS1C,IAAI,EAAEhR,KAAK,EAAEoc,KAAK,EAAE;MAC3C,IAAI7Q,OAAO,GAAG,EAAE;MAEhB,IAAI,OAAOyF,IAAK,IAAI,QAAQ,EAAE;QAC7B,IAAIiI,QAAQ,GAAG7Z,MAAM,CAAC6R,mBAAmB,CAACD,IAAI,EAAE,IAAI,CAAC;QACrD,IAAI8B,CAAC,GAAGmG,QAAQ,CAAC,CAAC,CAAC;QACnB,IAAIlG,CAAC,GAAGkG,QAAQ,CAAC,CAAC,CAAC;;QAEnB;QACA1N,OAAO,CAAC4C,IAAI,CAACxN,GAAG,CAACwX,UAAU,CAACrF,CAAC,EAAEC,CAAC,EAAE/S,KAAK,EAAEoc,KAAK,CAAC,CAAC;;QAEhD;QACAzb,GAAG,CAAC0b,kBAAkB,CAACvJ,CAAC,EAAEC,CAAC,EAAExH,OAAO,CAAC;MACtC,CAAC,MAAM;QACN,IAAIuH,CAAC,GAAG,IAAI;QACZ,IAAIC,CAAC,GAAG,IAAI;QACZ,IAAI/B,IAAI,IAAIA,IAAI,CAACkG,YAAY,EAAE;UAC9B,IAAIpE,CAAC,GAAG9B,IAAI,CAACkG,YAAY,CAAC,QAAQ,CAAC;UACnC,IAAInE,CAAC,GAAG/B,IAAI,CAACkG,YAAY,CAAC,QAAQ,CAAC;QACpC;;QAEA;QACA,IAAIpE,CAAC,IAAI,IAAI,IAAIC,CAAC,IAAI,IAAI,EAAE;UAC3BxH,OAAO,CAAC4C,IAAI,CAACxN,GAAG,CAACwX,UAAU,CAACrF,CAAC,EAAEC,CAAC,EAAE/S,KAAK,EAAEoc,KAAK,CAAC,CAAC;;UAEhD;UACAzb,GAAG,CAAC0b,kBAAkB,CAACvJ,CAAC,EAAEC,CAAC,EAAExH,OAAO,CAAC;QACtC,CAAC,MAAM;UACN,IAAIkC,IAAI,GAAGC,MAAM,CAACD,IAAI,CAACuD,IAAI,CAAC;UAC5B,IAAIvD,IAAI,CAACD,MAAM,GAAG,CAAC,EAAE;YACpB,KAAK,IAAII,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGH,IAAI,CAACD,MAAM,EAAEI,CAAC,EAAE,EAAE;cACrC,IAAI,OAAOoD,IAAI,CAACpD,CAAC,CAAE,IAAI,QAAQ,EAAE;gBAChC,IAAIqL,QAAQ,GAAG7Z,MAAM,CAAC6R,mBAAmB,CAACD,IAAI,CAACpD,CAAC,CAAC,EAAE,IAAI,CAAC;gBACxD,IAAIkF,CAAC,GAAGmG,QAAQ,CAAC,CAAC,CAAC;gBACnB,IAAIlG,CAAC,GAAGkG,QAAQ,CAAC,CAAC,CAAC;cACpB,CAAC,MAAM;gBACN,IAAIjI,IAAI,CAACpD,CAAC,CAAC,CAACkF,CAAC,IAAI,IAAI,IAAI9B,IAAI,CAACpD,CAAC,CAAC,CAACmF,CAAC,IAAI,IAAI,EAAE;kBAC3C,IAAID,CAAC,GAAG9B,IAAI,CAACpD,CAAC,CAAC,CAACkF,CAAC;kBACjB,IAAIC,CAAC,GAAG/B,IAAI,CAACpD,CAAC,CAAC,CAACmF,CAAC;kBACjB;kBACA,IAAI/B,IAAI,CAACpD,CAAC,CAAC,CAACyF,QAAQ,IAAI,IAAI,EAAE;oBAC7BrT,KAAK,GAAGgR,IAAI,CAACpD,CAAC,CAAC,CAACyF,QAAQ;kBACzB,CAAC,MAAM,IAAIrC,IAAI,CAACpD,CAAC,CAAC,CAAC5N,KAAK,IAAI,IAAI,EAAE;oBACjCA,KAAK,GAAGgR,IAAI,CAACpD,CAAC,CAAC,CAAC5N,KAAK;kBACtB;gBACD,CAAC,MAAM;kBACN,IAAI8S,CAAC,GAAG9B,IAAI,CAACpD,CAAC,CAAC,CAACsJ,YAAY,CAAC,QAAQ,CAAC;kBACtC,IAAInE,CAAC,GAAG/B,IAAI,CAACpD,CAAC,CAAC,CAACsJ,YAAY,CAAC,QAAQ,CAAC;gBACvC;cACD;;cAEC;cACD,IAAIpE,CAAC,IAAI,IAAI,IAAIC,CAAC,IAAI,IAAI,EAAE;gBAC3BxH,OAAO,CAAC4C,IAAI,CAACxN,GAAG,CAACwX,UAAU,CAACrF,CAAC,EAAEC,CAAC,EAAE/S,KAAK,EAAEoc,KAAK,CAAC,CAAC;;gBAEhD;gBACAzb,GAAG,CAAC0b,kBAAkB,CAACvJ,CAAC,EAAEC,CAAC,EAAExH,OAAO,CAAC;cACtC;YACD;UACD;QACD;MACD;;MAEA;MACA5K,GAAG,CAAC0X,UAAU,CAAC;QACdC,MAAM,EAAC,UAAU;QACjB/M,OAAO,EAACA,OAAO;QACfI,SAAS,EAAChL,GAAG,CAACkL;MACf,CAAC,CAAC;;MAEF;MACAlL,GAAG,CAACyH,WAAW,CAAC,CAAC;;MAEjB;MACAzH,GAAG,CAACyF,cAAc,CAAC1F,EAAE,EAAE6K,OAAO,CAAC;IAChC,CAAC;;IAED;AACF;AACA;AACA;AACA;AACA;AACA;AACA;IACE5K,GAAG,CAAC2b,kBAAkB,GAAG,UAASxJ,CAAC,EAAEC,CAAC,EAAE/S,KAAK,EAAEoc,KAAK,EAAE;MACrD,IAAI7Q,OAAO,GAAG,EAAE;MAChBA,OAAO,CAAC4C,IAAI,CAACxN,GAAG,CAACwX,UAAU,CAACrF,CAAC,EAAEC,CAAC,EAAE/S,KAAK,EAAEoc,KAAK,CAAC,CAAC;;MAEhD;MACAzb,GAAG,CAAC0b,kBAAkB,CAACvJ,CAAC,EAAEC,CAAC,EAAExH,OAAO,CAAC;;MAErC;MACA5K,GAAG,CAAC0X,UAAU,CAAC;QACdC,MAAM,EAAC,UAAU;QACjB/M,OAAO,EAACA,OAAO;QACfI,SAAS,EAAChL,GAAG,CAACkL;MACf,CAAC,CAAC;;MAEF;MACAlL,GAAG,CAACyH,WAAW,CAAC,CAAC;;MAEjB;MACAzH,GAAG,CAACyF,cAAc,CAAC1F,EAAE,EAAE6K,OAAO,CAAC;IAChC,CAAC;;IAED;AACF;AACA;IACE5K,GAAG,CAAC4b,kBAAkB,GAAG,YAAW;MACnC,IAAIhR,OAAO,GAAG,EAAE;MAChB,IAAIkC,IAAI,GAAGC,MAAM,CAACD,IAAI,CAAC9M,GAAG,CAACiL,WAAW,CAAC;MACvC,KAAK,IAAIgC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGH,IAAI,CAACD,MAAM,EAAEI,CAAC,EAAE,EAAE;QACrC,IAAIkF,CAAC,GAAGnS,GAAG,CAACiL,WAAW,CAACgC,CAAC,CAAC,CAACsJ,YAAY,CAAC,QAAQ,CAAC;QACjD,IAAInE,CAAC,GAAGpS,GAAG,CAACiL,WAAW,CAACgC,CAAC,CAAC,CAACsJ,YAAY,CAAC,QAAQ,CAAC;QAEjD,IAAIvW,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAACpT,IAAI,IAAI,UAAU,IAAIiB,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAACpT,IAAI,IAAI,OAAO,EAAE;UACxF;UACA6L,OAAO,CAAC4C,IAAI,CAACxN,GAAG,CAACwX,UAAU,CAACrF,CAAC,EAAEC,CAAC,EAAE,CAAEpS,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACmR,CAAC,CAAC,CAACD,CAAC,CAAC,CAAC,CAAC;QAC7D;MACD;MAEA,IAAIvH,OAAO,CAACiC,MAAM,EAAE;QACnB;QACA7M,GAAG,CAAC0X,UAAU,CAAC;UACdC,MAAM,EAAC,UAAU;UACjB/M,OAAO,EAACA,OAAO;UACfI,SAAS,EAAChL,GAAG,CAACkL;QACf,CAAC,CAAC;;QAEF;QACAlL,GAAG,CAACyF,cAAc,CAAC1F,EAAE,EAAE6K,OAAO,CAAC;MAChC;IACD,CAAC;IACD;AACF;AACA;IACE,IAAIwK,WAAW,GAAG,SAAAA,CAASiB,CAAC,EAAE;MAC7B,IAAIC,CAAC,GAAG,IAAIuF,MAAM,CAAD,CAAC;MAClBvF,CAAC,CAACxH,SAAS,GAAGuH,CAAC;MACf,IAAIyF,CAAC,GAAG,IAAI;MACZ,KAAKzF,CAAC,GAAGC,CAAC,CAACyF,oBAAoB,CAAC,QAAQ,CAAC,EAAED,CAAC,GAACzF,CAAC,CAAC,CAAC,CAAC,GAAGyF,CAAC,CAACpb,UAAU,CAACsb,WAAW,CAACF,CAAC,CAAC;MAC/E,OAAOxF,CAAC,CAACxH,SAAS;IACnB,CAAC;;IAED;AACF;AACA;AACA;AACA;AACA;IACE9O,GAAG,CAACwX,UAAU,GAAG,UAASrF,CAAC,EAAEC,CAAC,EAAE/S,KAAK,EAAEoc,KAAK,EAAE;MAC7C;MACA,IAAIzb,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,CAACD,CAAC,CAAC,CAACrG,SAAS,CAACuG,QAAQ,CAAC,UAAU,CAAC,IAAI,IAAI,IAAI,CAAEoJ,KAAK,EAAE;QACxE;QACA,IAAIQ,MAAM,GAAG;UACZ9J,CAAC,EAAEA,CAAC;UACJC,CAAC,EAAEA,CAAC;UACJ8J,GAAG,EAAE/J,CAAC;UACNrB,GAAG,EAAEsB;QACN,CAAC;MACF,CAAC,MAAM;QACN;QACA,IAAI,CAAC,EAAE,GAAC/S,KAAK,EAAEkU,MAAM,CAAC,CAAC,EAAC,CAAC,CAAC,IAAI,GAAG,IAAIvT,GAAG,CAACH,OAAO,CAACiF,cAAc,IAAI,IAAI,EAAE;UACxE,IAAIsP,GAAG,GAAGC,aAAa,CAAChV,KAAK,CAAC;UAC9B,IAAI+U,GAAG,IAAI/U,KAAK,EAAE;YACjB;YACAA,KAAK,GAAG+U,GAAG;UACZ;QACD;;QAEA;QACA,IAAIA,GAAG,GAAGpU,GAAG,CAACgM,QAAQ,CAAC,gBAAgB,EAAEjM,EAAE,EAAEC,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,CAACD,CAAC,CAAC,EAAEA,CAAC,EAAEC,CAAC,EAAE/S,KAAK,CAAC;;QAE5E;QACA,IAAI+U,GAAG,IAAI/C,SAAS,EAAE;UACrBhS,KAAK,GAAG+U,GAAG;QACZ;QAEA,IAAIpU,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAAC/E,MAAM,IAAI,OAAOpN,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAAC/E,MAAM,CAACoK,UAAW,IAAI,UAAU,EAAE;UACpGnY,KAAK,GAAGW,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAAC/E,MAAM,CAACoK,UAAU,CAACxX,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,CAACD,CAAC,CAAC,EAAE9S,KAAK,EAAEoc,KAAK,CAAC;QAClF;;QAEA;QACA,IAAIQ,MAAM,GAAG;UACZ9J,CAAC,EAAEA,CAAC;UACJC,CAAC,EAAEA,CAAC;UACJ8J,GAAG,EAAE/J,CAAC;UACNrB,GAAG,EAAEsB,CAAC;UACNM,QAAQ,EAAErT,KAAK;UACf8c,QAAQ,EAAEnc,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACmR,CAAC,CAAC,CAACD,CAAC;QAChC,CAAC;QAED,IAAI/E,MAAM,GAAGpN,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAAC/E,MAAM;QAC1C,IAAIA,MAAM,EAAE;UACX;UACApN,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACmR,CAAC,CAAC,CAACD,CAAC,CAAC,GAAG9S,KAAK;UAC9B,IAAI,OAAO+N,MAAM,CAAC2F,QAAS,KAAK,UAAU,EAAE;YAC3C3F,MAAM,CAAC2F,QAAQ,CAAC/S,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,CAACD,CAAC,CAAC,EAAE9S,KAAK,CAAC;UAC1C;QACD,CAAC,MAAM;UACN;UACA,IAAIW,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAACpT,IAAI,IAAI,UAAU,IAAIiB,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAACpT,IAAI,IAAI,OAAO,EAAE;YACxF;YACA,IAAIiB,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAACpT,IAAI,IAAI,OAAO,EAAE;cAC3C,KAAK,IAAIkQ,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjP,GAAG,CAACH,OAAO,CAACoB,IAAI,CAAC4L,MAAM,EAAEoC,CAAC,EAAE,EAAE;gBACjDjP,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACgO,CAAC,CAAC,CAACkD,CAAC,CAAC,GAAG,KAAK;cAC/B;YACD;;YAEA;YACAnS,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,CAACD,CAAC,CAAC,CAAC0D,QAAQ,CAAC,CAAC,CAAC,CAACrB,OAAO,GAAInV,KAAK,IAAI,CAAC,IAAIA,KAAK,IAAI,IAAI,IAAIA,KAAK,IAAI,MAAM,IAAIA,KAAK,IAAI,MAAM,GAAI,IAAI,GAAG,KAAK;YAC1HW,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACmR,CAAC,CAAC,CAACD,CAAC,CAAC,GAAGnS,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,CAACD,CAAC,CAAC,CAAC0D,QAAQ,CAAC,CAAC,CAAC,CAACrB,OAAO;UAC/D,CAAC,MAAM,IAAIxU,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAACpT,IAAI,IAAI,UAAU,IAAIiB,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAACpT,IAAI,IAAI,cAAc,EAAE;YACtG;YACAiB,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACmR,CAAC,CAAC,CAACD,CAAC,CAAC,GAAG9S,KAAK;YAC9BW,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,CAACD,CAAC,CAAC,CAACmC,WAAW,GAAGtU,GAAG,CAAC+U,gBAAgB,CAAC5C,CAAC,EAAE9S,KAAK,CAAC;UAC/D,CAAC,MAAM,IAAIW,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAACpT,IAAI,IAAI,UAAU,EAAE;YACrD;YACA,IAAI2V,SAAS,GAAG,IAAI;YACpB,IAAI,CAAER,SAAS,CAAC7U,KAAK,CAAC,EAAE;cACvB,IAAIsV,GAAG,GAAG9G,OAAO,CAAC+G,QAAQ,CAACC,qBAAqB,CAACxV,KAAK,EAAEW,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAACtS,OAAO,CAACJ,MAAM,CAAC;cAC9F,IAAIkV,GAAG,EAAE;gBACRD,SAAS,GAAGC,GAAG;cAChB;YACD;YACA;YACA3U,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACmR,CAAC,CAAC,CAACD,CAAC,CAAC,GAAG9S,KAAK;YAC9BW,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,CAACD,CAAC,CAAC,CAACmC,WAAW,GAAGzG,OAAO,CAAC+G,QAAQ,CAACE,aAAa,CAACJ,SAAS,GAAGA,SAAS,GAAGrV,KAAK,EAAEW,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAACtS,OAAO,CAACJ,MAAM,CAAC;UACrI,CAAC,MAAM,IAAIO,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAACpT,IAAI,IAAI,OAAO,EAAE;YAClD;YACAiB,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACmR,CAAC,CAAC,CAACD,CAAC,CAAC,GAAG9S,KAAK;YAC9B;YACA,IAAIW,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAACwB,MAAM,IAAI,QAAQ,EAAE;cAC9C,IAAIqB,KAAK,GAAGxU,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;cACzCuU,KAAK,CAAC3F,SAAS,GAAG,OAAO;cACzB2F,KAAK,CAACvQ,KAAK,CAACwQ,eAAe,GAAG5V,KAAK;cACnCW,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,CAACD,CAAC,CAAC,CAACmC,WAAW,GAAG,EAAE;cAClCtU,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,CAACD,CAAC,CAAC,CAAC5D,WAAW,CAACyG,KAAK,CAAC;YACrC,CAAC,MAAM;cACNhV,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,CAACD,CAAC,CAAC,CAAC1N,KAAK,CAACuQ,KAAK,GAAG3V,KAAK;cACrCW,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,CAACD,CAAC,CAAC,CAACmC,WAAW,GAAGjV,KAAK;YACtC;UACD,CAAC,MAAM,IAAIW,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAACpT,IAAI,IAAI,OAAO,EAAE;YAClDM,KAAK,GAAG,EAAE,GAACA,KAAK;YAChBW,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACmR,CAAC,CAAC,CAACD,CAAC,CAAC,GAAG9S,KAAK;YAC9BW,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,CAACD,CAAC,CAAC,CAACrD,SAAS,GAAG,EAAE;YAChC,IAAIzP,KAAK,IAAIA,KAAK,CAACkU,MAAM,CAAC,CAAC,EAAE,EAAE,CAAC,IAAI,YAAY,EAAE;cACjD,IAAI2B,GAAG,GAAG1U,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;cACvCyU,GAAG,CAACC,GAAG,GAAG9V,KAAK;cACfW,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,CAACD,CAAC,CAAC,CAAC5D,WAAW,CAAC2G,GAAG,CAAC;YACnC;UACD,CAAC,MAAM;YACN;YACAlV,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACmR,CAAC,CAAC,CAACD,CAAC,CAAC,GAAG9S,KAAK;YAC9B;YACA,IAAIW,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAACpT,IAAI,IAAI,MAAM,EAAE;cAC1CiB,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,CAACD,CAAC,CAAC,CAACrD,SAAS,GAAGsG,WAAW,CAACpV,GAAG,CAACsT,UAAU,CAACnB,CAAC,EAAEC,CAAC,EAAE/S,KAAK,CAAC,CAAC;YACvE,CAAC,MAAM;cACN,IAAIW,GAAG,CAACH,OAAO,CAACkF,SAAS,KAAK,KAAK,IAAI/E,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAACpN,SAAS,KAAK,KAAK,EAAE;gBAClF/E,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,CAACD,CAAC,CAAC,CAACrD,SAAS,GAAGsG,WAAW,CAACpV,GAAG,CAACsT,UAAU,CAACnB,CAAC,EAAEC,CAAC,EAAE/S,KAAK,EAAEW,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,CAACD,CAAC,CAAC,CAAC,CAAC;cAC1F,CAAC,MAAM;gBACN;gBACA;gBACA,IAAI5R,GAAG,GAAGC,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;gBACvCF,GAAG,CAAC+T,WAAW,GAAGtU,GAAG,CAACsT,UAAU,CAACnB,CAAC,EAAEC,CAAC,EAAE/S,KAAK,EAAEW,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,CAACD,CAAC,CAAC,CAAC;gBAChEnS,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,CAACD,CAAC,CAAC,CAACmC,WAAW,GAAG,EAAE;gBAClCtU,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,CAACD,CAAC,CAAC,CAAC5D,WAAW,CAAChO,GAAG,CAAC;cACnC;YACD;YACA;YACA,IAAIP,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAAChP,QAAQ,IAAI,KAAK,KAAKnD,GAAG,CAACH,OAAO,CAACsD,QAAQ,IAAI,IAAI,IAAInD,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC6Q,CAAC,CAAC,CAAChP,QAAQ,IAAI,IAAI,IAAInD,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,CAACD,CAAC,CAAC,CAACrD,SAAS,CAACjC,MAAM,GAAG,GAAG,CAAC,EAAE;cACtK7M,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,CAACD,CAAC,CAAC,CAAC1N,KAAK,CAAC8Q,UAAU,GAAG,UAAU;YAChD,CAAC,MAAM;cACNvV,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,CAACD,CAAC,CAAC,CAAC1N,KAAK,CAAC8Q,UAAU,GAAG,EAAE;YACxC;UACD;QACD;;QAEA;QACA,IAAIpD,CAAC,GAAG,CAAC,EAAE;UACV,IAAI9S,KAAK,EAAE;YACVW,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,CAACD,CAAC,GAAC,CAAC,CAAC,CAAC1N,KAAK,CAAC+Q,QAAQ,GAAG,QAAQ;UAC9C,CAAC,MAAM;YACNxV,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,CAACD,CAAC,GAAC,CAAC,CAAC,CAAC1N,KAAK,CAAC+Q,QAAQ,GAAG,EAAE;UACxC;QACD;;QAEA;QACAxV,GAAG,CAACgM,QAAQ,CAAC,UAAU,EAAEjM,EAAE,EAAGC,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,IAAIpS,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,CAACD,CAAC,CAAC,GAAGnS,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,CAACD,CAAC,CAAC,GAAG,IAAI,EAAGA,CAAC,EAAEC,CAAC,EAAE/S,KAAK,EAAE4c,MAAM,CAACE,QAAQ,CAAC;MAC7H;MAEA,OAAOF,MAAM;IACd,CAAC;;IAED;AACF;AACA;IACEjc,GAAG,CAACoc,QAAQ,GAAG,UAAS5c,CAAC,EAAE6c,CAAC,EAAE;MAC7B;MACA,IAAIpb,IAAI,GAAGjB,GAAG,CAAC8R,OAAO,CAAC,IAAI,EAAE,IAAI,CAAC;;MAElC;MACA,IAAIwK,CAAC,GAAGtc,GAAG,CAACmL,iBAAiB;;MAE7B;MACA,IAAIgM,EAAE,GAAGxI,QAAQ,CAACnP,CAAC,CAAC+W,YAAY,CAAC,QAAQ,CAAC,CAAC;MAC3C,IAAIa,EAAE,GAAGzI,QAAQ,CAACnP,CAAC,CAAC+W,YAAY,CAAC,QAAQ,CAAC,CAAC;MAC3C,IAAIc,EAAE,GAAG1I,QAAQ,CAAC0N,CAAC,CAAC9F,YAAY,CAAC,QAAQ,CAAC,CAAC;MAC3C,IAAIe,EAAE,GAAG3I,QAAQ,CAAC0N,CAAC,CAAC9F,YAAY,CAAC,QAAQ,CAAC,CAAC;;MAE3C;MACA,IAAI3L,OAAO,GAAG,EAAE;MAChB,IAAI2R,YAAY,GAAG,KAAK;MAExB,IAAID,CAAC,CAAC,CAAC,CAAC,IAAInF,EAAE,EAAE;QACf;QACA,IAAIC,EAAE,GAAGkF,CAAC,CAAC,CAAC,CAAC,EAAE;UACd,IAAI/J,SAAS,GAAG6E,EAAE,GAAGkF,CAAC,CAAC,CAAC,CAAC;QAC1B,CAAC,MAAM;UACN,IAAI/J,SAAS,GAAG,CAAC;QAClB;QACA,IAAIY,SAAS,GAAG,CAAC;MAClB,CAAC,MAAM;QACN,IAAIgE,EAAE,GAAGmF,CAAC,CAAC,CAAC,CAAC,EAAE;UACd,IAAInJ,SAAS,GAAGgE,EAAE,GAAGmF,CAAC,CAAC,CAAC,CAAC;QAC1B,CAAC,MAAM;UACN,IAAInJ,SAAS,GAAG,CAAC;QAClB;QACA,IAAIZ,SAAS,GAAG,CAAC;MAClB;;MAEA;MACA,IAAIiK,IAAI,GAAG,CAAC;MACZ,IAAIC,IAAI,GAAG,CAAC;MAEZ,KAAK,IAAIxN,CAAC,GAAGmI,EAAE,EAAEnI,CAAC,IAAIqI,EAAE,EAAErI,CAAC,EAAE,EAAE;QAC9B;QACA,IAAIjP,GAAG,CAACqB,IAAI,CAAC4N,CAAC,CAAC,IAAIjP,GAAG,CAACqB,IAAI,CAAC4N,CAAC,CAAC,CAACxK,KAAK,CAAC6K,OAAO,IAAI,MAAM,EAAE;UACvD;QACD;;QAEA;QACA,IAAIrO,IAAI,CAACwb,IAAI,CAAC,IAAIpL,SAAS,EAAE;UAC5BoL,IAAI,GAAG,CAAC;QACT;QACAD,IAAI,GAAG,CAAC;;QAER;QACA,IAAIF,CAAC,CAAC,CAAC,CAAC,IAAInF,EAAE,EAAE;UACf,IAAIA,EAAE,GAAGmF,CAAC,CAAC,CAAC,CAAC,EAAE;YACd,IAAInJ,SAAS,GAAGgE,EAAE,GAAGmF,CAAC,CAAC,CAAC,CAAC;UAC1B,CAAC,MAAM;YACN,IAAInJ,SAAS,GAAG,CAAC;UAClB;QACD;QACA;QACA,KAAK,IAAIlG,CAAC,GAAGkK,EAAE,EAAElK,CAAC,IAAIoK,EAAE,EAAEpK,CAAC,EAAE,EAAE;UAC9B;UACA,IAAIjN,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAAChC,CAAC,CAAC,IAAI,CAAEjN,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAAChC,CAAC,CAAC,CAACnB,SAAS,CAACuG,QAAQ,CAAC,UAAU,CAAC,IAAIrS,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAAChC,CAAC,CAAC,CAACxI,KAAK,CAAC6K,OAAO,IAAI,MAAM,IAAIiN,YAAY,IAAI,KAAK,EAAE;YAClJ;YACA,IAAI,CAAEvc,GAAG,CAACgL,SAAS,CAAC6B,MAAM,EAAE;cAC3B,IAAI7M,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACgO,CAAC,CAAC,CAAChC,CAAC,CAAC,IAAI,EAAE,EAAE;gBACjCsP,YAAY,GAAG,IAAI;gBACnB;cACD;YACD;;YAEA;YACA,IAAItb,IAAI,CAACwb,IAAI,CAAC,IAAIpL,SAAS,EAAE;cAC5BmL,IAAI,GAAG,CAAC;YACT,CAAC,MAAM,IAAIvb,IAAI,CAACwb,IAAI,CAAC,CAACD,IAAI,CAAC,IAAInL,SAAS,EAAE;cACzCmL,IAAI,GAAG,CAAC;YACT;;YAEA;YACA,IAAInd,KAAK,GAAG4B,IAAI,CAACwb,IAAI,CAAC,CAACD,IAAI,CAAC;YAE5B,IAAInd,KAAK,IAAI,CAAE4B,IAAI,CAAC,CAAC,CAAC,IAAIjB,GAAG,CAACH,OAAO,CAAC+E,aAAa,IAAI,IAAI,EAAE;cAC5D,IAAI5E,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAAClO,IAAI,IAAI,MAAM,IAAIiB,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAAClO,IAAI,IAAI,QAAQ,EAAE;gBACrF,IAAI,CAAC,EAAE,GAACM,KAAK,EAAEkU,MAAM,CAAC,CAAC,EAAC,CAAC,CAAC,IAAI,GAAG,EAAE;kBAClC,IAAImJ,MAAM,GAAGrd,KAAK,CAAC0U,KAAK,CAAC,iBAAiB,CAAC;kBAE3C,IAAI2I,MAAM,EAAE;oBACX,IAAIC,cAAc,GAAG,EAAE;oBACvB,KAAK,IAAIlP,KAAK,GAAG,CAAC,EAAEA,KAAK,GAAGiP,MAAM,CAAC7P,MAAM,EAAEY,KAAK,EAAE,EAAE;sBACnD,IAAIqL,QAAQ,GAAGra,MAAM,CAAC6R,mBAAmB,CAACoM,MAAM,CAACjP,KAAK,CAAC,EAAE,CAAC,CAAC;sBAC3DqL,QAAQ,CAAC,CAAC,CAAC,IAAI3F,SAAS;sBACxB2F,QAAQ,CAAC,CAAC,CAAC,IAAIvG,SAAS;sBACxB,IAAIuG,QAAQ,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE;wBACpBA,QAAQ,CAAC,CAAC,CAAC,GAAG,CAAC;sBAChB;sBACA,IAAI8D,KAAK,GAAGne,MAAM,CAACqU,mBAAmB,CAAC,CAACgG,QAAQ,CAAC,CAAC,CAAC,EAAEA,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;sBAElE,IAAI8D,KAAK,IAAIF,MAAM,CAACjP,KAAK,CAAC,EAAE;wBAC3BkP,cAAc,CAACD,MAAM,CAACjP,KAAK,CAAC,CAAC,GAAGmP,KAAK;sBACtC;oBACD;oBACA;oBACA,IAAID,cAAc,EAAE;sBACnBtd,KAAK,GAAGW,GAAG,CAAC6c,aAAa,CAACxd,KAAK,EAAEsd,cAAc,CAAC;oBACjD;kBACD;gBACD,CAAC,MAAM;kBACN,IAAItd,KAAK,IAAIoU,MAAM,CAACpU,KAAK,CAAC,EAAE;oBAC3BA,KAAK,GAAGoU,MAAM,CAACpU,KAAK,CAAC,GAAGkT,SAAS;kBAClC;gBACD;cACD,CAAC,MAAM,IAAIvS,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAAClO,IAAI,IAAI,UAAU,EAAE;gBACrD,IAAIoV,IAAI,GAAG,IAAI2I,IAAI,CAACzd,KAAK,CAAC;gBAC1B8U,IAAI,CAAC4I,OAAO,CAAC5I,IAAI,CAAC6I,OAAO,CAAC,CAAC,GAAGzK,SAAS,CAAC;gBACxClT,KAAK,GAAG8U,IAAI,CAAC8I,WAAW,CAAC,CAAC,GAAG,GAAG,GAAGxe,MAAM,CAACye,iBAAiB,CAACvO,QAAQ,CAACwF,IAAI,CAACgJ,QAAQ,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,GAAG,GAAG1e,MAAM,CAACye,iBAAiB,CAAC/I,IAAI,CAAC6I,OAAO,CAAC,CAAC,CAAC,GAAG,GAAG,GAAG,UAAU;cAC/J;YACD;YAEApS,OAAO,CAAC4C,IAAI,CAACxN,GAAG,CAACwX,UAAU,CAACvK,CAAC,EAAEgC,CAAC,EAAE5P,KAAK,CAAC,CAAC;;YAEzC;YACAW,GAAG,CAAC0b,kBAAkB,CAACzO,CAAC,EAAEgC,CAAC,EAAErE,OAAO,CAAC;UACtC;UACA4R,IAAI,EAAE;UACN,IAAIF,CAAC,CAAC,CAAC,CAAC,IAAInF,EAAE,EAAE;YACfhE,SAAS,EAAE;UACZ;QACD;QACAsJ,IAAI,EAAE;QACNlK,SAAS,EAAE;MACZ;;MAEA;MACAvS,GAAG,CAAC0X,UAAU,CAAC;QACdC,MAAM,EAAC,UAAU;QACjB/M,OAAO,EAACA,OAAO;QACfI,SAAS,EAAChL,GAAG,CAACkL;MACf,CAAC,CAAC;;MAEF;MACAlL,GAAG,CAACyH,WAAW,CAAC,CAAC;;MAEjB;MACAzH,GAAG,CAACyF,cAAc,CAAC1F,EAAE,EAAE6K,OAAO,CAAC;IAChC,CAAC;;IAED;AACF;AACA;IACE5K,GAAG,CAACqZ,gBAAgB,GAAG,YAAW;MACjC,IAAIrZ,GAAG,CAACkL,YAAY,EAAE;QACrBlL,GAAG,CAACod,yBAAyB,CAACpd,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,EAAElL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,EAAElL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,EAAElL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,CAAC;MAClH;IACD,CAAC;;IAED;AACF;AACA;IACElL,GAAG,CAACqd,0BAA0B,GAAG,UAASte,IAAI,EAAES,CAAC,EAAE6c,CAAC,EAAE;MACrD,IAAItd,IAAI,IAAI,CAAC,EAAE;QACd,IAAIiB,GAAG,CAACkL,YAAY,KAAM1L,CAAC,IAAIQ,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,IAAI1L,CAAC,IAAIQ,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,IAAMmR,CAAC,IAAIrc,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,IAAImR,CAAC,IAAIrc,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAE,CAAC,EAAE;UAC3IlL,GAAG,CAACwO,cAAc,CAAC,CAAC;UACpB;QACD;MACD,CAAC,MAAM;QACN,IAAIxO,GAAG,CAACkL,YAAY,KAAM1L,CAAC,IAAIQ,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,IAAI1L,CAAC,IAAIQ,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,IAAMmR,CAAC,IAAIrc,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,IAAImR,CAAC,IAAIrc,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAE,CAAC,EAAE;UAC3IlL,GAAG,CAACwO,cAAc,CAAC,CAAC;UACpB;QACD;MACD;IACD,CAAC;;IAED;AACF;AACA;IACExO,GAAG,CAACwO,cAAc,GAAG,UAAS8O,IAAI,EAAE;MACnC;MACA,IAAI,CAAEtd,GAAG,CAACiL,WAAW,CAAC4B,MAAM,EAAE;QAC7B,IAAI0Q,cAAc,GAAG,CAAC;MACvB,CAAC,MAAM;QACN,IAAIA,cAAc,GAAG,CAAC;QAEtB,KAAK,IAAItQ,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjN,GAAG,CAACiL,WAAW,CAAC4B,MAAM,EAAEI,CAAC,EAAE,EAAE;UAChDjN,GAAG,CAACiL,WAAW,CAACgC,CAAC,CAAC,CAACnB,SAAS,CAAClL,MAAM,CAAC,WAAW,CAAC;UAChDZ,GAAG,CAACiL,WAAW,CAACgC,CAAC,CAAC,CAACnB,SAAS,CAAClL,MAAM,CAAC,gBAAgB,CAAC;UACrDZ,GAAG,CAACiL,WAAW,CAACgC,CAAC,CAAC,CAACnB,SAAS,CAAClL,MAAM,CAAC,iBAAiB,CAAC;UACtDZ,GAAG,CAACiL,WAAW,CAACgC,CAAC,CAAC,CAACnB,SAAS,CAAClL,MAAM,CAAC,eAAe,CAAC;UACpDZ,GAAG,CAACiL,WAAW,CAACgC,CAAC,CAAC,CAACnB,SAAS,CAAClL,MAAM,CAAC,kBAAkB,CAAC;UACvDZ,GAAG,CAACiL,WAAW,CAACgC,CAAC,CAAC,CAACnB,SAAS,CAAClL,MAAM,CAAC,oBAAoB,CAAC;UAEzD,IAAIqR,EAAE,GAAGtD,QAAQ,CAAC3O,GAAG,CAACiL,WAAW,CAACgC,CAAC,CAAC,CAACsJ,YAAY,CAAC,QAAQ,CAAC,CAAC;UAC5D,IAAIrE,EAAE,GAAGvD,QAAQ,CAAC3O,GAAG,CAACiL,WAAW,CAACgC,CAAC,CAAC,CAACsJ,YAAY,CAAC,QAAQ,CAAC,CAAC;;UAE5D;UACA,IAAIvW,GAAG,CAACiL,WAAW,CAACgC,CAAC,CAAC,CAACsJ,YAAY,CAAC,aAAa,CAAC,EAAE;YACnD,IAAIP,OAAO,GAAGrH,QAAQ,CAAC3O,GAAG,CAACiL,WAAW,CAACgC,CAAC,CAAC,CAACsJ,YAAY,CAAC,SAAS,CAAC,CAAC;YAClE,IAAIQ,OAAO,GAAGpI,QAAQ,CAAC3O,GAAG,CAACiL,WAAW,CAACgC,CAAC,CAAC,CAACsJ,YAAY,CAAC,SAAS,CAAC,CAAC;YAClE,IAAIiH,EAAE,GAAGxH,OAAO,GAAG,CAAC,GAAG/D,EAAE,IAAI+D,OAAO,GAAG,CAAC,CAAC,GAAG/D,EAAE;YAC9C,IAAIwL,EAAE,GAAG1G,OAAO,GAAG,CAAC,GAAG7E,EAAE,IAAI6E,OAAO,GAAG,CAAC,CAAC,GAAE7E,EAAE;UAC9C,CAAC,MAAM;YACN,IAAIsL,EAAE,GAAGvL,EAAE;YACX,IAAIwL,EAAE,GAAGvL,EAAE;UACZ;;UAEA;UACA,KAAK,IAAIjD,CAAC,GAAGgD,EAAE,EAAEhD,CAAC,IAAIuO,EAAE,EAAEvO,CAAC,EAAE,EAAE;YAC9B,IAAIjP,GAAG,CAAC2K,OAAO,CAACsE,CAAC,CAAC,EAAE;cACnBjP,GAAG,CAAC2K,OAAO,CAACsE,CAAC,CAAC,CAACnD,SAAS,CAAClL,MAAM,CAAC,UAAU,CAAC;YAC5C;UACD;;UAEA;UACA,KAAK,IAAIqO,CAAC,GAAGiD,EAAE,EAAEjD,CAAC,IAAIwO,EAAE,EAAExO,CAAC,EAAE,EAAE;YAC9B,IAAIjP,GAAG,CAACqB,IAAI,CAAC4N,CAAC,CAAC,EAAE;cAChBjP,GAAG,CAACqB,IAAI,CAAC4N,CAAC,CAAC,CAACnD,SAAS,CAAClL,MAAM,CAAC,UAAU,CAAC;YACzC;UACD;QACD;MACD;;MAEA;MACAZ,GAAG,CAACiL,WAAW,GAAG,EAAE;;MAEpB;MACAjL,GAAG,CAACkL,YAAY,GAAG,IAAI;;MAEvB;MACAlL,GAAG,CAAC8J,MAAM,CAACrF,KAAK,CAAC2V,GAAG,GAAG,SAAS;MAChCpa,GAAG,CAAC8J,MAAM,CAACrF,KAAK,CAACiZ,IAAI,GAAG,SAAS;MAEjC,IAAIJ,IAAI,IAAI,IAAI,IAAIC,cAAc,IAAI,CAAC,EAAE;QACxCvd,GAAG,CAACgM,QAAQ,CAAC,QAAQ,EAAEjM,EAAE,CAAC;MAC3B;MAEA,OAAOwd,cAAc;IACtB,CAAC;;IAED;AACF;AACA;IACEvd,GAAG,CAACyX,eAAe,GAAG,UAASkG,GAAG,EAAEC,GAAG,EAAEC,MAAM,EAAE;MAChD,IAAI1G,EAAE,GAAGwG,GAAG,CAACpH,YAAY,CAAC,QAAQ,CAAC;MACnC,IAAIa,EAAE,GAAGuG,GAAG,CAACpH,YAAY,CAAC,QAAQ,CAAC;MACnC,IAAIqH,GAAG,EAAE;QACR,IAAIvG,EAAE,GAAGuG,GAAG,CAACrH,YAAY,CAAC,QAAQ,CAAC;QACnC,IAAIe,EAAE,GAAGsG,GAAG,CAACrH,YAAY,CAAC,QAAQ,CAAC;MACpC,CAAC,MAAM;QACN,IAAIc,EAAE,GAAGF,EAAE;QACX,IAAIG,EAAE,GAAGF,EAAE;MACZ;MAEApX,GAAG,CAACod,yBAAyB,CAACjG,EAAE,EAAEC,EAAE,EAAEC,EAAE,EAAEC,EAAE,EAAEuG,MAAM,CAAC;IACtD,CAAC;;IAED;AACF;AACA;IACE7d,GAAG,CAACod,yBAAyB,GAAG,UAASjG,EAAE,EAAEC,EAAE,EAAEC,EAAE,EAAEC,EAAE,EAAEuG,MAAM,EAAE;MAChE;MACA,IAAIC,OAAO,GAAG,IAAI;MAClB,IAAIC,aAAa,GAAG/d,GAAG,CAACwO,cAAc,CAAC,CAAC;;MAExC;MACA,IAAI4I,EAAE,IAAI,IAAI,EAAE;QACfA,EAAE,GAAG,CAAC;QACNE,EAAE,GAAGtX,GAAG,CAACqB,IAAI,CAACwL,MAAM,GAAG,CAAC;MACzB;;MAEA;MACA,IAAIwK,EAAE,IAAI,IAAI,EAAE;QACfA,EAAE,GAAGF,EAAE;MACR;MACA,IAAIG,EAAE,IAAI,IAAI,EAAE;QACfA,EAAE,GAAGF,EAAE;MACR;;MAEA;MACA,IAAID,EAAE,IAAInX,GAAG,CAAC2K,OAAO,CAACkC,MAAM,EAAE;QAC7BsK,EAAE,GAAGnX,GAAG,CAAC2K,OAAO,CAACkC,MAAM,GAAG,CAAC;MAC5B;MACA,IAAIuK,EAAE,IAAIpX,GAAG,CAACqB,IAAI,CAACwL,MAAM,EAAE;QAC1BuK,EAAE,GAAGpX,GAAG,CAACqB,IAAI,CAACwL,MAAM,GAAG,CAAC;MACzB;MACA,IAAIwK,EAAE,IAAIrX,GAAG,CAAC2K,OAAO,CAACkC,MAAM,EAAE;QAC7BwK,EAAE,GAAGrX,GAAG,CAAC2K,OAAO,CAACkC,MAAM,GAAG,CAAC;MAC5B;MACA,IAAIyK,EAAE,IAAItX,GAAG,CAACqB,IAAI,CAACwL,MAAM,EAAE;QAC1ByK,EAAE,GAAGtX,GAAG,CAACqB,IAAI,CAACwL,MAAM,GAAG,CAAC;MACzB;;MAEA;MACA7M,GAAG,CAACkL,YAAY,GAAG,CAACiM,EAAE,EAAEC,EAAE,EAAEC,EAAE,EAAEC,EAAE,CAAC;;MAEnC;MACA,IAAIH,EAAE,IAAI,IAAI,EAAE;QACf;QACA,IAAInX,GAAG,CAAC4K,OAAO,CAACwM,EAAE,CAAC,CAACD,EAAE,CAAC,EAAE;UACxBnX,GAAG,CAAC4K,OAAO,CAACwM,EAAE,CAAC,CAACD,EAAE,CAAC,CAACrL,SAAS,CAACC,GAAG,CAAC,oBAAoB,CAAC;QACxD;;QAEA;QACA,IAAI4C,QAAQ,CAACwI,EAAE,CAAC,GAAGxI,QAAQ,CAAC0I,EAAE,CAAC,EAAE;UAChC,IAAIpF,EAAE,GAAGtD,QAAQ,CAACwI,EAAE,CAAC;UACrB,IAAIqG,EAAE,GAAG7O,QAAQ,CAAC0I,EAAE,CAAC;QACtB,CAAC,MAAM;UACN,IAAIpF,EAAE,GAAGtD,QAAQ,CAAC0I,EAAE,CAAC;UACrB,IAAImG,EAAE,GAAG7O,QAAQ,CAACwI,EAAE,CAAC;QACtB;QAEA,IAAIxI,QAAQ,CAACyI,EAAE,CAAC,GAAGzI,QAAQ,CAAC2I,EAAE,CAAC,EAAE;UAChC,IAAIpF,EAAE,GAAGvD,QAAQ,CAACyI,EAAE,CAAC;UACrB,IAAIqG,EAAE,GAAG9O,QAAQ,CAAC2I,EAAE,CAAC;QACtB,CAAC,MAAM;UACN,IAAIpF,EAAE,GAAGvD,QAAQ,CAAC2I,EAAE,CAAC;UACrB,IAAImG,EAAE,GAAG9O,QAAQ,CAACyI,EAAE,CAAC;QACtB;;QAEA;QACA,KAAK,IAAInK,CAAC,GAAGgF,EAAE,EAAEhF,CAAC,IAAIuQ,EAAE,EAAEvQ,CAAC,EAAE,EAAE;UAC9B,KAAK,IAAIgC,CAAC,GAAGiD,EAAE,EAAEjD,CAAC,IAAIwO,EAAE,EAAExO,CAAC,EAAE,EAAE;YAC9B,IAAIjP,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAAChC,CAAC,CAAC,IAAIjN,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAAChC,CAAC,CAAC,CAACsJ,YAAY,CAAC,aAAa,CAAC,EAAE;cACvE,IAAIpE,CAAC,GAAGxD,QAAQ,CAAC3O,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAAChC,CAAC,CAAC,CAACsJ,YAAY,CAAC,QAAQ,CAAC,CAAC;cAC1D,IAAInE,CAAC,GAAGzD,QAAQ,CAAC3O,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAAChC,CAAC,CAAC,CAACsJ,YAAY,CAAC,QAAQ,CAAC,CAAC;cAC1D,IAAIP,OAAO,GAAGrH,QAAQ,CAAC3O,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAAChC,CAAC,CAAC,CAACsJ,YAAY,CAAC,SAAS,CAAC,CAAC;cACjE,IAAIQ,OAAO,GAAGpI,QAAQ,CAAC3O,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAAChC,CAAC,CAAC,CAACsJ,YAAY,CAAC,SAAS,CAAC,CAAC;cAEjE,IAAIP,OAAO,GAAG,CAAC,EAAE;gBAChB,IAAI7D,CAAC,GAAGF,EAAE,EAAE;kBACXA,EAAE,GAAGE,CAAC;gBACP;gBACA,IAAIA,CAAC,GAAG6D,OAAO,GAAGwH,EAAE,EAAE;kBACrBA,EAAE,GAAGrL,CAAC,GAAG6D,OAAO,GAAG,CAAC;gBACrB;cACD;cAEA,IAAIe,OAAO,EAAE;gBACZ,IAAI3E,CAAC,GAAGF,EAAE,EAAE;kBACXA,EAAE,GAAGE,CAAC;gBAEP;gBACA,IAAIA,CAAC,GAAG2E,OAAO,GAAG0G,EAAE,EAAE;kBACrBA,EAAE,GAAGrL,CAAC,GAAG2E,OAAO,GAAG,CAAC;gBACrB;cACD;YACD;UACD;QACD;;QAEA;QACA,IAAIiH,UAAU,GAAG,IAAI;QACrB,IAAIC,WAAW,GAAG,IAAI;QACtB,IAAIC,SAAS,GAAG,IAAI;QACpB,IAAIC,YAAY,GAAG,IAAI;;QAEvB;QACA,KAAK,IAAIlP,CAAC,GAAGiD,EAAE,EAAEjD,CAAC,IAAIwO,EAAE,EAAExO,CAAC,EAAE,EAAE;UAC9B,IAAIjP,GAAG,CAACqB,IAAI,CAAC4N,CAAC,CAAC,CAACxK,KAAK,CAAC6K,OAAO,IAAI,MAAM,EAAE;YACxC,IAAI4O,SAAS,IAAI,IAAI,EAAE;cACtBA,SAAS,GAAGjP,CAAC;YACd;YACAkP,YAAY,GAAGlP,CAAC;UACjB;QACD;;QAEA;QACA,KAAK,IAAIhC,CAAC,GAAGgF,EAAE,EAAEhF,CAAC,IAAIuQ,EAAE,EAAEvQ,CAAC,EAAE,EAAE;UAC9B,KAAK,IAAIgC,CAAC,GAAGiD,EAAE,EAAEjD,CAAC,IAAIwO,EAAE,EAAExO,CAAC,EAAE,EAAE;YAC9B,IAAIjP,GAAG,CAACqB,IAAI,CAAC4N,CAAC,CAAC,CAACxK,KAAK,CAAC6K,OAAO,IAAI,MAAM,IAAItP,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAAChC,CAAC,CAAC,CAACxI,KAAK,CAAC6K,OAAO,IAAI,MAAM,EAAE;cACrFtP,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAAChC,CAAC,CAAC,CAACnB,SAAS,CAACC,GAAG,CAAC,WAAW,CAAC;cAC5C/L,GAAG,CAACiL,WAAW,CAACuC,IAAI,CAACxN,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAAChC,CAAC,CAAC,CAAC;YACxC;UACD;;UAEA;UACA,IAAIjN,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAAClO,IAAI,IAAI,QAAQ,EAAE;YAC5C,IAAIif,UAAU,IAAI,IAAI,EAAE;cACvBA,UAAU,GAAG/Q,CAAC;YACf;YACAgR,WAAW,GAAGhR,CAAC;UAChB;QACD;;QAEA;QACA,IAAI,CAAE+Q,UAAU,EAAE;UACjBA,UAAU,GAAG,CAAC;QACf;QACA,IAAI,CAAEC,WAAW,EAAE;UAClBA,WAAW,GAAG,CAAC;QAChB;QACA,KAAK,IAAIhR,CAAC,GAAG+Q,UAAU,EAAE/Q,CAAC,IAAIgR,WAAW,EAAEhR,CAAC,EAAE,EAAE;UAC/C,IAAIjN,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAAClO,IAAI,IAAI,QAAQ,IAAIiB,GAAG,CAAC+K,QAAQ,CAACkC,CAAC,CAAC,CAACxI,KAAK,IAAIzE,GAAG,CAAC+K,QAAQ,CAACkC,CAAC,CAAC,CAACxI,KAAK,CAAC6K,OAAO,IAAI,MAAM,EAAE;YAChH;YACA,IAAItP,GAAG,CAAC4K,OAAO,CAACsT,SAAS,CAAC,IAAIle,GAAG,CAAC4K,OAAO,CAACsT,SAAS,CAAC,CAACjR,CAAC,CAAC,EAAE;cACxDjN,GAAG,CAAC4K,OAAO,CAACsT,SAAS,CAAC,CAACjR,CAAC,CAAC,CAACnB,SAAS,CAACC,GAAG,CAAC,eAAe,CAAC;YACzD;YACA;YACA,IAAI/L,GAAG,CAAC4K,OAAO,CAACuT,YAAY,CAAC,IAAIne,GAAG,CAAC4K,OAAO,CAACuT,YAAY,CAAC,CAAClR,CAAC,CAAC,EAAE;cAC9DjN,GAAG,CAAC4K,OAAO,CAACuT,YAAY,CAAC,CAAClR,CAAC,CAAC,CAACnB,SAAS,CAACC,GAAG,CAAC,kBAAkB,CAAC;YAC/D;YACA;YACA/L,GAAG,CAAC2K,OAAO,CAACsC,CAAC,CAAC,CAACnB,SAAS,CAACC,GAAG,CAAC,UAAU,CAAC;UACzC;QACD;QAEA,KAAK,IAAIkD,CAAC,GAAGiP,SAAS,EAAEjP,CAAC,IAAIkP,YAAY,EAAElP,CAAC,EAAE,EAAE;UAC/C,IAAIjP,GAAG,CAACqB,IAAI,CAAC4N,CAAC,CAAC,IAAIjP,GAAG,CAACqB,IAAI,CAAC4N,CAAC,CAAC,CAACxK,KAAK,CAAC6K,OAAO,IAAI,MAAM,EAAE;YACvD;YACAtP,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAAC+O,UAAU,CAAC,CAAClS,SAAS,CAACC,GAAG,CAAC,gBAAgB,CAAC;YAC1D;YACA/L,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAACgP,WAAW,CAAC,CAACnS,SAAS,CAACC,GAAG,CAAC,iBAAiB,CAAC;YAC5D;YACA/L,GAAG,CAACqB,IAAI,CAAC4N,CAAC,CAAC,CAACnD,SAAS,CAACC,GAAG,CAAC,UAAU,CAAC;UACtC;QACD;QAEA/L,GAAG,CAACmL,iBAAiB,GAAG,CAAE6S,UAAU,EAAEE,SAAS,EAAED,WAAW,EAAEE,YAAY,CAAE;MAC7E;;MAEA;MACA,IAAIJ,aAAa,IAAI,CAAC,EAAE;QACvB/d,GAAG,CAACgM,QAAQ,CAAC,SAAS,EAAEjM,EAAE,CAAC;QAE3BC,GAAG,CAACoe,sBAAsB,CAAC,CAAC;MAC7B;MAEApe,GAAG,CAACgM,QAAQ,CAAC,aAAa,EAAEjM,EAAE,EAAEie,UAAU,EAAEE,SAAS,EAAED,WAAW,EAAEE,YAAY,EAAEN,MAAM,CAAC;;MAEzF;MACA7d,GAAG,CAAC0a,oBAAoB,CAAC,CAAC;IAC3B,CAAC;;IAED;AACF;AACA;AACA;AACA;IACE1a,GAAG,CAACqe,mBAAmB,GAAG,YAAW;MACpC;MACA,KAAK,IAAIpR,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjN,GAAG,CAACgL,SAAS,CAAC6B,MAAM,EAAEI,CAAC,EAAE,EAAE;QAC9CjN,GAAG,CAACgL,SAAS,CAACiC,CAAC,CAAC,CAACnB,SAAS,CAAClL,MAAM,CAAC,WAAW,CAAC;QAC9CZ,GAAG,CAACgL,SAAS,CAACiC,CAAC,CAAC,CAACnB,SAAS,CAAClL,MAAM,CAAC,gBAAgB,CAAC;QACnDZ,GAAG,CAACgL,SAAS,CAACiC,CAAC,CAAC,CAACnB,SAAS,CAAClL,MAAM,CAAC,iBAAiB,CAAC;QACpDZ,GAAG,CAACgL,SAAS,CAACiC,CAAC,CAAC,CAACnB,SAAS,CAAClL,MAAM,CAAC,eAAe,CAAC;QAClDZ,GAAG,CAACgL,SAAS,CAACiC,CAAC,CAAC,CAACnB,SAAS,CAAClL,MAAM,CAAC,kBAAkB,CAAC;MACtD;MAEAZ,GAAG,CAACgL,SAAS,GAAG,EAAE;IACnB,CAAC;;IAED;AACF;AACA;AACA;AACA;AACA;IACEhL,GAAG,CAACse,mBAAmB,GAAG,UAASC,EAAE,EAAEC,EAAE,EAAE;MAC1C;MACAxe,GAAG,CAACqe,mBAAmB,CAAC,CAAC;;MAEzB;MACA,IAAIlH,EAAE,GAAGnX,GAAG,CAACmL,iBAAiB,CAAC,CAAC,CAAC;MACjC,IAAIiM,EAAE,GAAGpX,GAAG,CAACmL,iBAAiB,CAAC,CAAC,CAAC;MACjC,IAAIkM,EAAE,GAAGrX,GAAG,CAACmL,iBAAiB,CAAC,CAAC,CAAC;MACjC,IAAImM,EAAE,GAAGtX,GAAG,CAACmL,iBAAiB,CAAC,CAAC,CAAC;MAEjC,IAAIoT,EAAE,IAAI,IAAI,IAAIC,EAAE,IAAI,IAAI,EAAE;QAC7B,IAAID,EAAE,GAAGlH,EAAE,GAAG,CAAC,EAAE;UAChB,IAAIpF,EAAE,GAAGtD,QAAQ,CAAC0I,EAAE,CAAC,GAAG,CAAC;UACzB,IAAImG,EAAE,GAAG7O,QAAQ,CAAC4P,EAAE,CAAC;QACtB,CAAC,MAAM;UACN,IAAItM,EAAE,GAAGtD,QAAQ,CAAC4P,EAAE,CAAC;UACrB,IAAIf,EAAE,GAAG7O,QAAQ,CAACwI,EAAE,CAAC,GAAG,CAAC;QAC1B;QAEA,IAAIqH,EAAE,GAAGlH,EAAE,GAAG,CAAC,EAAE;UAChB,IAAIpF,EAAE,GAAGvD,QAAQ,CAAC2I,EAAE,CAAC,GAAG,CAAC;UACzB,IAAImG,EAAE,GAAG9O,QAAQ,CAAC6P,EAAE,CAAC;QACtB,CAAC,MAAM;UACN,IAAItM,EAAE,GAAGvD,QAAQ,CAAC6P,EAAE,CAAC;UACrB,IAAIf,EAAE,GAAG9O,QAAQ,CAACyI,EAAE,CAAC,GAAG,CAAC;QAC1B;QAEA,IAAIoG,EAAE,GAAGvL,EAAE,IAAIwL,EAAE,GAAGvL,EAAE,EAAE;UACvB,IAAID,EAAE,GAAGtD,QAAQ,CAACwI,EAAE,CAAC;UACrB,IAAIqG,EAAE,GAAG7O,QAAQ,CAAC0I,EAAE,CAAC;QACtB,CAAC,MAAM;UACN,IAAInF,EAAE,GAAGvD,QAAQ,CAACyI,EAAE,CAAC;UACrB,IAAIqG,EAAE,GAAG9O,QAAQ,CAAC2I,EAAE,CAAC;QACtB;QAEA,KAAK,IAAIrI,CAAC,GAAGiD,EAAE,EAAEjD,CAAC,IAAIwO,EAAE,EAAExO,CAAC,EAAE,EAAE;UAC9B,KAAK,IAAIhC,CAAC,GAAGgF,EAAE,EAAEhF,CAAC,IAAIuQ,EAAE,EAAEvQ,CAAC,EAAE,EAAE;YAC9B,IAAIjN,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAAChC,CAAC,CAAC,IAAIjN,GAAG,CAACqB,IAAI,CAAC4N,CAAC,CAAC,CAACxK,KAAK,CAAC6K,OAAO,IAAI,MAAM,IAAItP,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAAChC,CAAC,CAAC,CAACxI,KAAK,CAAC6K,OAAO,IAAI,MAAM,EAAE;cAC1GtP,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAAChC,CAAC,CAAC,CAACnB,SAAS,CAACC,GAAG,CAAC,WAAW,CAAC;cAC5C/L,GAAG,CAAC4K,OAAO,CAACsH,EAAE,CAAC,CAACjF,CAAC,CAAC,CAACnB,SAAS,CAACC,GAAG,CAAC,eAAe,CAAC;cACjD/L,GAAG,CAAC4K,OAAO,CAAC6S,EAAE,CAAC,CAACxQ,CAAC,CAAC,CAACnB,SAAS,CAACC,GAAG,CAAC,kBAAkB,CAAC;cACpD/L,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAACgD,EAAE,CAAC,CAACnG,SAAS,CAACC,GAAG,CAAC,gBAAgB,CAAC;cAClD/L,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAACuO,EAAE,CAAC,CAAC1R,SAAS,CAACC,GAAG,CAAC,iBAAiB,CAAC;;cAEnD;cACA/L,GAAG,CAACgL,SAAS,CAACwC,IAAI,CAACxN,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAAChC,CAAC,CAAC,CAAC;YACtC;UACD;QACD;MACD;IACD,CAAC;;IAED;AACF;AACA;AACA;AACA;IACEjN,GAAG,CAAC0a,oBAAoB,GAAG,YAAW;MACrC;MACA,IAAI,CAAE1a,GAAG,CAACiL,WAAW,CAAC4B,MAAM,EAAE;QAC7B7M,GAAG,CAAC8J,MAAM,CAACrF,KAAK,CAAC2V,GAAG,GAAG,SAAS;QAChCpa,GAAG,CAAC8J,MAAM,CAACrF,KAAK,CAACiZ,IAAI,GAAG,SAAS;MAClC,CAAC,MAAM;QACN;QACA,IAAIe,IAAI,GAAGze,GAAG,CAACiL,WAAW,CAACjL,GAAG,CAACiL,WAAW,CAAC4B,MAAM,GAAC,CAAC,CAAC;QACpD,IAAI6R,KAAK,GAAGD,IAAI,CAAClI,YAAY,CAAC,QAAQ,CAAC;QAEvC,IAAIoI,WAAW,GAAG3e,GAAG,CAACkK,OAAO,CAAC0P,qBAAqB,CAAC,CAAC;QACrD,IAAIzC,EAAE,GAAGwH,WAAW,CAACjB,IAAI;QACzB,IAAItG,EAAE,GAAGuH,WAAW,CAACvE,GAAG;QAExB,IAAIwE,QAAQ,GAAGH,IAAI,CAAC7E,qBAAqB,CAAC,CAAC;QAC3C,IAAIvC,EAAE,GAAGuH,QAAQ,CAAClB,IAAI;QACtB,IAAIpG,EAAE,GAAGsH,QAAQ,CAACxE,GAAG;QACrB,IAAIyE,EAAE,GAAGD,QAAQ,CAACtR,KAAK;QACvB,IAAIwR,EAAE,GAAGF,QAAQ,CAACxL,MAAM;QAExB,IAAIjB,CAAC,GAAIkF,EAAE,GAAGF,EAAE,GAAInX,GAAG,CAACkK,OAAO,CAAC4Q,UAAU,GAAG+D,EAAE,GAAG,CAAC;QACnD,IAAIzM,CAAC,GAAIkF,EAAE,GAAGF,EAAE,GAAIpX,GAAG,CAACkK,OAAO,CAAC6U,SAAS,GAAGD,EAAE,GAAG,CAAC;;QAElD;QACA9e,GAAG,CAAC8J,MAAM,CAACrF,KAAK,CAAC2V,GAAG,GAAGhI,CAAC,GAAG,IAAI;QAC/BpS,GAAG,CAAC8J,MAAM,CAACrF,KAAK,CAACiZ,IAAI,GAAGvL,CAAC,GAAG,IAAI;QAEhC,IAAInS,GAAG,CAACH,OAAO,CAAC8H,aAAa,EAAE;UAC9B,IAAI2F,KAAK,GAAGtN,GAAG,CAACgf,cAAc,CAAC,CAAC;UAChC;UACA,IAAIN,KAAK,GAAG1e,GAAG,CAACH,OAAO,CAAC8H,aAAa,GAAC,CAAC,IAAI0P,EAAE,GAAGF,EAAE,GAAG0H,EAAE,GAAGvR,KAAK,EAAE;YAChEtN,GAAG,CAAC8J,MAAM,CAACrF,KAAK,CAAC6K,OAAO,GAAG,MAAM;UAClC,CAAC,MAAM;YACN,IAAItP,GAAG,CAACH,OAAO,CAAC8D,aAAa,IAAI,IAAI,EAAE;cACtC3D,GAAG,CAAC8J,MAAM,CAACrF,KAAK,CAAC6K,OAAO,GAAG,EAAE;YAC9B;UACD;QACD,CAAC,MAAM;UACN,IAAItP,GAAG,CAACH,OAAO,CAAC8D,aAAa,IAAI,IAAI,EAAE;YACtC3D,GAAG,CAAC8J,MAAM,CAACrF,KAAK,CAAC6K,OAAO,GAAG,EAAE;UAC9B;QACD;MACD;IACD,CAAC;;IAED;AACF;AACA;IACEtP,GAAG,CAACif,YAAY,GAAG,UAASC,SAAS,EAAE;MACtC;MACA,IAAIP,WAAW,GAAG3e,GAAG,CAACkK,OAAO,CAAC0P,qBAAqB,CAAC,CAAC;MACrD,IAAIzC,EAAE,GAAGwH,WAAW,CAACjB,IAAI;MACzB,IAAItG,EAAE,GAAGuH,WAAW,CAACvE,GAAG;MACxB,IAAI+E,EAAE,GAAGR,WAAW,CAACrR,KAAK;MAC1B,IAAI8R,EAAE,GAAGT,WAAW,CAACvL,MAAM;;MAE3B;MACA,IAAIiM,SAAS,GAAGrf,GAAG,CAAC4K,OAAO,CAAC5K,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,CAAC,CAAClL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,CAAC;;MAErE;MACA,IAAIoU,aAAa,GAAGD,SAAS,CAACzF,qBAAqB,CAAC,CAAC;MACrD,IAAIvC,EAAE,GAAGiI,aAAa,CAAC5B,IAAI;MAC3B,IAAIpG,EAAE,GAAGgI,aAAa,CAAClF,GAAG;MAC1B,IAAIyE,EAAE,GAAGS,aAAa,CAAChS,KAAK;MAC5B,IAAIwR,EAAE,GAAGQ,aAAa,CAAClM,MAAM;;MAE7B;MACA,IAAI8L,SAAS,IAAI,CAAC,IAAIA,SAAS,IAAI,CAAC,EAAE;QACrC,IAAI/M,CAAC,GAAIkF,EAAE,GAAGF,EAAE,GAAInX,GAAG,CAACkK,OAAO,CAAC4Q,UAAU;QAC1C,IAAI1I,CAAC,GAAIkF,EAAE,GAAGF,EAAE,GAAIpX,GAAG,CAACkK,OAAO,CAAC6U,SAAS,GAAG,CAAC;MAC9C,CAAC,MAAM;QACN,IAAI5M,CAAC,GAAIkF,EAAE,GAAGF,EAAE,GAAInX,GAAG,CAACkK,OAAO,CAAC4Q,UAAU,GAAG+D,EAAE;QAC/C,IAAIzM,CAAC,GAAIkF,EAAE,GAAGF,EAAE,GAAIpX,GAAG,CAACkK,OAAO,CAAC6U,SAAS,GAAGD,EAAE;MAC/C;;MAEA;MACA,IAAI1M,CAAC,GAAIpS,GAAG,CAACkK,OAAO,CAAC6U,SAAS,GAAG,EAAG,IAAI3M,CAAC,GAAIpS,GAAG,CAACkK,OAAO,CAAC6U,SAAS,GAAGK,EAAG,EAAE;QACzE;MAAA,CACA,MAAM;QACN;QACA,IAAIhN,CAAC,GAAGpS,GAAG,CAACkK,OAAO,CAAC6U,SAAS,GAAG,EAAE,EAAE;UACnC/e,GAAG,CAACkK,OAAO,CAAC6U,SAAS,GAAG3M,CAAC,GAAG0M,EAAE;QAC/B,CAAC,MAAM;UACN9e,GAAG,CAACkK,OAAO,CAAC6U,SAAS,GAAG3M,CAAC,IAAIgN,EAAE,GAAG,CAAC,CAAC;QACrC;MACD;;MAEA;MACA,IAAIG,OAAO,GAAGvf,GAAG,CAACgf,cAAc,CAAC,CAAC;;MAElC;MACA,IAAI7M,CAAC,GAAInS,GAAG,CAACkK,OAAO,CAAC4Q,UAAU,GAAGyE,OAAQ,IAAIpN,CAAC,GAAInS,GAAG,CAACkK,OAAO,CAAC4Q,UAAU,GAAGqE,EAAG,EAAE;QAChF;MAAA,CACA,MAAM;QACN;QACA,IAAIhN,CAAC,GAAGnS,GAAG,CAACkK,OAAO,CAAC4Q,UAAU,GAAG,EAAE,EAAE;UACpC9a,GAAG,CAACkK,OAAO,CAAC4Q,UAAU,GAAG3I,CAAC;UAC1B,IAAInS,GAAG,CAACkK,OAAO,CAAC4Q,UAAU,GAAG,EAAE,EAAE;YAChC9a,GAAG,CAACkK,OAAO,CAAC4Q,UAAU,GAAG,CAAC;UAC3B;QACD,CAAC,MAAM,IAAI3I,CAAC,GAAGnS,GAAG,CAACkK,OAAO,CAAC4Q,UAAU,GAAGyE,OAAO,EAAE;UAChDvf,GAAG,CAACkK,OAAO,CAAC4Q,UAAU,GAAG3I,CAAC,GAAGoN,OAAO,GAAG,CAAC;QACzC,CAAC,MAAM;UACNvf,GAAG,CAACkK,OAAO,CAAC4Q,UAAU,GAAG3I,CAAC,IAAIgN,EAAE,GAAG,EAAE,CAAC;QACvC;MACD;IACD,CAAC;;IAED;AACF;AACA;AACA;AACA;AACA;IACEnf,GAAG,CAACwf,QAAQ,GAAG,UAAStJ,MAAM,EAAE;MAC/B,IAAI,OAAOA,MAAM,KAAK,WAAW,EAAE;QAClC;QACA,IAAIjV,IAAI,GAAG,EAAE;QACb,KAAK,IAAIgM,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjN,GAAG,CAAC2K,OAAO,CAACkC,MAAM,EAAEI,CAAC,EAAE,EAAE;UAC5ChM,IAAI,CAACuM,IAAI,CAACxN,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAACK,KAAK,CAAC;QACxC;MACD,CAAC,MAAM;QACN;QACA,IAAI,OAAO4I,MAAO,IAAI,QAAQ,EAAE;UAC/BA,MAAM,GAAGA,MAAM,CAACK,YAAY,CAAC,QAAQ,CAAC;QACvC;QAEAtV,IAAI,GAAGjB,GAAG,CAAC+K,QAAQ,CAACmL,MAAM,CAAC,CAACK,YAAY,CAAC,OAAO,CAAC;MAClD;MAEA,OAAOtV,IAAI;IACZ,CAAC;;IAGD;AACF;AACA;AACA;AACA;AACA;AACA;IACEjB,GAAG,CAACyf,QAAQ,GAAG,UAAUvJ,MAAM,EAAE5I,KAAK,EAAEoS,QAAQ,EAAE;MACjD,IAAIpS,KAAK,EAAE;QACV,IAAIjB,KAAK,CAACwE,OAAO,CAACqF,MAAM,CAAC,EAAE;UAC1B;UACA,IAAI,CAAEwJ,QAAQ,EAAE;YACf,IAAIA,QAAQ,GAAG,EAAE;UAClB;UACA;UACA,KAAK,IAAIzS,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGiJ,MAAM,CAACrJ,MAAM,EAAEI,CAAC,EAAE,EAAE;YACvC,IAAI,CAAEyS,QAAQ,CAACzS,CAAC,CAAC,EAAE;cAClByS,QAAQ,CAACzS,CAAC,CAAC,GAAGjN,GAAG,CAAC+K,QAAQ,CAACmL,MAAM,CAACjJ,CAAC,CAAC,CAAC,CAACsJ,YAAY,CAAC,OAAO,CAAC;YAC5D;YACA,IAAIoJ,CAAC,GAAGtT,KAAK,CAACwE,OAAO,CAACvD,KAAK,CAAC,IAAIA,KAAK,CAACL,CAAC,CAAC,GAAGK,KAAK,CAACL,CAAC,CAAC,GAAGK,KAAK;YAC3DtN,GAAG,CAAC+K,QAAQ,CAACmL,MAAM,CAACjJ,CAAC,CAAC,CAAC,CAAC+B,YAAY,CAAC,OAAO,EAAE2Q,CAAC,CAAC;YAChD3f,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC4U,MAAM,CAACjJ,CAAC,CAAC,CAAC,CAACK,KAAK,GAAGqS,CAAC;UACzC;QACD,CAAC,MAAM;UACN;UACA,IAAI,CAAED,QAAQ,EAAE;YACfA,QAAQ,GAAG1f,GAAG,CAAC+K,QAAQ,CAACmL,MAAM,CAAC,CAACK,YAAY,CAAC,OAAO,CAAC;UACtD;UACA;UACAvW,GAAG,CAAC+K,QAAQ,CAACmL,MAAM,CAAC,CAAClH,YAAY,CAAC,OAAO,EAAE1B,KAAK,CAAC;UACjDtN,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC4U,MAAM,CAAC,CAAC5I,KAAK,GAAGA,KAAK;QAC1C;;QAEA;QACAtN,GAAG,CAAC0X,UAAU,CAAC;UACdC,MAAM,EAAC,UAAU;UACjBzB,MAAM,EAACA,MAAM;UACbiG,QAAQ,EAACuD,QAAQ;UACjBhN,QAAQ,EAACpF;QACV,CAAC,CAAC;;QAEF;QACAtN,GAAG,CAACgM,QAAQ,CAAC,gBAAgB,EAAEjM,EAAE,EAAEmW,MAAM,EAAE5I,KAAK,EAAEoS,QAAQ,CAAC;;QAE3D;QACA1f,GAAG,CAAC0a,oBAAoB,CAAC,CAAC;MAC3B;IACD,CAAC;;IAED;AACF;AACA;AACA;AACA;AACA;AACA;IACE1a,GAAG,CAAC4f,SAAS,GAAG,UAAU9O,GAAG,EAAEsC,MAAM,EAAEyM,SAAS,EAAE;MACjD,IAAIzM,MAAM,GAAG,CAAC,EAAE;QACf;QACA,IAAI,OAAOtC,GAAI,IAAI,QAAQ,EAAE;UAC5BA,GAAG,GAAGA,GAAG,CAACyF,YAAY,CAAC,QAAQ,CAAC;QACjC;;QAEA;QACA,IAAI,CAAEsJ,SAAS,EAAE;UAChBA,SAAS,GAAG7f,GAAG,CAACqB,IAAI,CAACyP,GAAG,CAAC,CAACyF,YAAY,CAAC,QAAQ,CAAC;UAEhD,IAAI,CAAEsJ,SAAS,EAAE;YAChB,IAAI7F,IAAI,GAAGha,GAAG,CAACqB,IAAI,CAACyP,GAAG,CAAC,CAAC8I,qBAAqB,CAAC,CAAC;YAChDiG,SAAS,GAAG7F,IAAI,CAAC5G,MAAM;UACxB;QACD;;QAEA;QACAA,MAAM,GAAGzE,QAAQ,CAACyE,MAAM,CAAC;;QAEzB;QACApT,GAAG,CAACqB,IAAI,CAACyP,GAAG,CAAC,CAACrM,KAAK,CAAC8V,WAAW,CAAE,2BAA2B,EAAEC,IAAI,CAACC,KAAK,CAAE,CAACrH,MAAM,GAAC,EAAE,IAAI,EAAG,CAAE,CAAC;;QAE9F;QACA;QACA;;QAEA;QACA,IAAI,CAAEpT,GAAG,CAACH,OAAO,CAACwB,IAAI,CAACyP,GAAG,CAAC,EAAE;UAC5B9Q,GAAG,CAACH,OAAO,CAACwB,IAAI,CAACyP,GAAG,CAAC,GAAG,CAAC,CAAC;QAC3B;QACA9Q,GAAG,CAACH,OAAO,CAACwB,IAAI,CAACyP,GAAG,CAAC,CAACsC,MAAM,GAAGA,MAAM;;QAErC;QACApT,GAAG,CAAC0X,UAAU,CAAC;UACdC,MAAM,EAAC,WAAW;UAClB7G,GAAG,EAACA,GAAG;UACPqL,QAAQ,EAAC0D,SAAS;UAClBnN,QAAQ,EAACU;QACV,CAAC,CAAC;;QAEF;QACApT,GAAG,CAACgM,QAAQ,CAAC,aAAa,EAAEjM,EAAE,EAAE+Q,GAAG,EAAEsC,MAAM,EAAEyM,SAAS,CAAC;;QAEvD;QACA7f,GAAG,CAAC0a,oBAAoB,CAAC,CAAC;MAC3B;IACD,CAAC;;IAED;AACF;AACA;AACA;AACA;AACA;IACE1a,GAAG,CAAC8f,SAAS,GAAG,UAAShP,GAAG,EAAE;MAC7B,IAAI,OAAOA,GAAG,KAAK,WAAW,EAAE;QAC/B;QACA,IAAI7P,IAAI,GAAG,EAAE;QACb,KAAK,IAAIgO,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjP,GAAG,CAACqB,IAAI,CAACwL,MAAM,EAAEoC,CAAC,EAAE,EAAE;UACzC,IAAIqN,CAAC,GAAGtc,GAAG,CAACqB,IAAI,CAAC4N,CAAC,CAAC,CAACxK,KAAK,CAAC2O,MAAM;UAChC,IAAIkJ,CAAC,EAAE;YACNrb,IAAI,CAACgO,CAAC,CAAC,GAAGqN,CAAC;UACZ;QACD;MACD,CAAC,MAAM;QACN;QACA,IAAI,OAAOxL,GAAI,IAAI,QAAQ,EAAE;UAC5BA,GAAG,GAAGiP,CAAC,CAACjP,GAAG,CAAC,CAACyF,YAAY,CAAC,QAAQ,CAAC;QACpC;QAEA,IAAItV,IAAI,GAAGjB,GAAG,CAACqB,IAAI,CAACyP,GAAG,CAAC,CAACrM,KAAK,CAAC2O,MAAM;MACtC;MAEA,OAAOnS,IAAI;IACZ,CAAC;IAEDjB,GAAG,CAACggB,SAAS,GAAG,UAAS/e,IAAI,EAAE;MAC9B,IAAIA,IAAI,EAAE;QACTjB,GAAG,CAACH,OAAO,CAACqF,OAAO,GAAGjE,IAAI;MAC3B;MAEA,IAAIjB,GAAG,CAACH,OAAO,CAACqF,OAAO,EAAE;QACxB,IAAI,CAAElF,GAAG,CAACigB,KAAK,EAAE;UAChBjgB,GAAG,CAACigB,KAAK,GAAGzf,QAAQ,CAACC,aAAa,CAAC,OAAO,CAAC;UAC3CT,GAAG,CAACmK,KAAK,CAACoE,WAAW,CAACvO,GAAG,CAACigB,KAAK,CAAC;QACjC;QAEA,KAAK,IAAIhR,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjP,GAAG,CAACH,OAAO,CAACqF,OAAO,CAAC2H,MAAM,EAAEoC,CAAC,EAAE,EAAE;UACpD,IAAIjP,GAAG,CAACigB,KAAK,CAACpK,QAAQ,CAAC5G,CAAC,CAAC,EAAE;YAC1B,IAAIwC,EAAE,GAAGzR,GAAG,CAACigB,KAAK,CAACpK,QAAQ,CAAC5G,CAAC,CAAC;UAC/B,CAAC,MAAM;YACN,IAAIwC,EAAE,GAAGjR,QAAQ,CAACC,aAAa,CAAC,IAAI,CAAC;YACrC,IAAI2O,EAAE,GAAG5O,QAAQ,CAACC,aAAa,CAAC,IAAI,CAAC;YACrCgR,EAAE,CAAClD,WAAW,CAACa,EAAE,CAAC;YAClBpP,GAAG,CAACigB,KAAK,CAAC1R,WAAW,CAACkD,EAAE,CAAC;UAC1B;UACA,KAAK,IAAIxE,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjN,GAAG,CAAC2K,OAAO,CAACkC,MAAM,EAAEI,CAAC,EAAE,EAAE;YAC5C,IAAI,CAAEjN,GAAG,CAACH,OAAO,CAACqF,OAAO,CAAC+J,CAAC,CAAC,CAAChC,CAAC,CAAC,EAAE;cAChCjN,GAAG,CAACH,OAAO,CAACqF,OAAO,CAAC+J,CAAC,CAAC,CAAChC,CAAC,CAAC,GAAG,EAAE;YAC/B;YACA,IAAIjN,GAAG,CAACigB,KAAK,CAACpK,QAAQ,CAAC5G,CAAC,CAAC,CAAC4G,QAAQ,CAAC5I,CAAC,GAAC,CAAC,CAAC,EAAE;cACxC,IAAImC,EAAE,GAAGpP,GAAG,CAACigB,KAAK,CAACpK,QAAQ,CAAC5G,CAAC,CAAC,CAAC4G,QAAQ,CAAC5I,CAAC,GAAC,CAAC,CAAC;YAC7C,CAAC,MAAM;cACN,IAAImC,EAAE,GAAG5O,QAAQ,CAACC,aAAa,CAAC,IAAI,CAAC;cACrCgR,EAAE,CAAClD,WAAW,CAACa,EAAE,CAAC;;cAElB;cACA,IAAIiG,QAAQ,GAAGrV,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAACM,KAAK,GAAGvN,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAACM,KAAK,GAAG,QAAQ;cACrF6B,EAAE,CAAC3K,KAAK,CAAC6Q,SAAS,GAAGD,QAAQ;YAC9B;YACAjG,EAAE,CAACkF,WAAW,GAAGtU,GAAG,CAACsT,UAAU,CAAC,CAACtT,GAAG,CAAC4K,OAAO,CAACiC,MAAM,GAAGI,CAAC,EAAEgC,CAAC,EAAEjP,GAAG,CAACH,OAAO,CAACqF,OAAO,CAAC+J,CAAC,CAAC,CAAChC,CAAC,CAAC,CAAC;;YAEtF;YACAmC,EAAE,CAAC3K,KAAK,CAAC6K,OAAO,GAAGtP,GAAG,CAAC+K,QAAQ,CAACkC,CAAC,CAAC,CAACxI,KAAK,CAAC6K,OAAO;UACjD;QACD;MACD;IACD,CAAC;;IAED;AACF;AACA;AACA;AACA;AACA;IACEtP,GAAG,CAACkgB,SAAS,GAAG,UAAShK,MAAM,EAAE;MAChC,OAAOlW,GAAG,CAAC2K,OAAO,CAACuL,MAAM,CAAC,CAAC5B,WAAW;IACvC,CAAC;;IAED;AACF;AACA;AACA;AACA;AACA;IACEtU,GAAG,CAACmgB,SAAS,GAAG,UAASjK,MAAM,EAAExD,QAAQ,EAAE;MAC1C,IAAI1S,GAAG,CAAC2K,OAAO,CAACuL,MAAM,CAAC,EAAE;QACxB,IAAIiG,QAAQ,GAAGnc,GAAG,CAAC2K,OAAO,CAACuL,MAAM,CAAC,CAAC5B,WAAW;QAE9C,IAAI,CAAE5B,QAAQ,EAAE;UACfA,QAAQ,GAAG0N,MAAM,CAACpgB,GAAG,CAACH,OAAO,CAAC+H,IAAI,CAACK,UAAU,EAAEkU,QAAQ,CAAC;QACzD;QAEA,IAAIzJ,QAAQ,EAAE;UACb1S,GAAG,CAAC2K,OAAO,CAACuL,MAAM,CAAC,CAAC5B,WAAW,GAAG5B,QAAQ;UAC1C;UACA1S,GAAG,CAAC2K,OAAO,CAACuL,MAAM,CAAC,CAAClH,YAAY,CAAC,OAAO,EAAE0D,QAAQ,CAAC;UACnD;UACA1S,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC4U,MAAM,CAAC,CAACrX,KAAK,GAAG6T,QAAQ;QAC7C;QAEA1S,GAAG,CAAC0X,UAAU,CAAC;UACdC,MAAM,EAAE,WAAW;UACnBzB,MAAM,EAAEA,MAAM;UACdiG,QAAQ,EAAEA,QAAQ;UAClBzJ,QAAQ,EAAEA;QACX,CAAC,CAAC;;QAEF;QACA1S,GAAG,CAACgM,QAAQ,CAAC,gBAAgB,EAAEjM,EAAE,EAAEmW,MAAM,EAAEiG,QAAQ,EAAEzJ,QAAQ,CAAC;MAC/D;IACD,CAAC;;IAED;AACF;AACA;AACA;AACA;AACA;IACE1S,GAAG,CAACqgB,UAAU,GAAG,UAAUC,OAAO,EAAE;MACnC,IAAIzhB,KAAK,GAAG,EAAE;MAEd,KAAK,IAAIoO,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjN,GAAG,CAAC2K,OAAO,CAACkC,MAAM,EAAEI,CAAC,EAAE,EAAE;QAC5CpO,KAAK,CAAC2O,IAAI,CAACxN,GAAG,CAACkgB,SAAS,CAACjT,CAAC,CAAC,CAAC;MAC7B;MAEA,OAAOqT,OAAO,GAAGzhB,KAAK,GAAGA,KAAK,CAACM,IAAI,CAACa,GAAG,CAACH,OAAO,CAAC2D,YAAY,CAAC;IAC9D,CAAC;;IAED;AACF;AACA;AACA;AACA;IACExD,GAAG,CAACugB,OAAO,GAAG,UAASlQ,IAAI,EAAEmQ,GAAG,EAAE;MACjC,IAAI,CAAEnQ,IAAI,EAAE;QACX,OAAOrQ,GAAG,CAACH,OAAO,CAAC2E,IAAI;MACxB,CAAC,MAAM;QACN,IAAIgc,GAAG,EAAE;UACR,OAAOxgB,GAAG,CAACH,OAAO,CAAC2E,IAAI,CAAC6L,IAAI,CAAC,IAAIrQ,GAAG,CAACH,OAAO,CAAC2E,IAAI,CAAC6L,IAAI,CAAC,CAACmQ,GAAG,CAAC,GAAGxgB,GAAG,CAACH,OAAO,CAAC2E,IAAI,CAAC6L,IAAI,CAAC,CAACmQ,GAAG,CAAC,GAAG,IAAI;QAClG,CAAC,MAAM;UACN,OAAOxgB,GAAG,CAACH,OAAO,CAAC2E,IAAI,CAAC6L,IAAI,CAAC,GAAGrQ,GAAG,CAACH,OAAO,CAAC2E,IAAI,CAAC6L,IAAI,CAAC,GAAG,IAAI;QAC9D;MACD;IACD,CAAC;;IAED;AACF;AACA;AACA;AACA;IACErQ,GAAG,CAACygB,OAAO,GAAG,UAASjhB,CAAC,EAAE4Q,CAAC,EAAE9Q,CAAC,EAAE;MAC/B,IAAI,CAAEU,GAAG,CAACH,OAAO,CAAC2E,IAAI,EAAE;QACvBxE,GAAG,CAACH,OAAO,CAAC2E,IAAI,GAAG,CAAC,CAAC;MACtB;MAEA,IAAI4L,CAAC,IAAI9Q,CAAC,EAAE;QACX;QACA,IAAI,CAAEU,GAAG,CAACH,OAAO,CAAC2E,IAAI,CAAChF,CAAC,CAAC,EAAE;UAC1BQ,GAAG,CAACH,OAAO,CAAC2E,IAAI,CAAChF,CAAC,CAAC,GAAG,CAAC,CAAC;QACzB;QACAQ,GAAG,CAACH,OAAO,CAAC2E,IAAI,CAAChF,CAAC,CAAC,CAAC4Q,CAAC,CAAC,GAAG9Q,CAAC;MAC3B,CAAC,MAAM;QACN;QACA,IAAIwN,IAAI,GAAGC,MAAM,CAACD,IAAI,CAACtN,CAAC,CAAC;QACzB,KAAK,IAAIyN,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGH,IAAI,CAACD,MAAM,EAAEI,CAAC,EAAE,EAAE;UACrC,IAAI,CAAEjN,GAAG,CAACH,OAAO,CAAC2E,IAAI,CAACsI,IAAI,CAACG,CAAC,CAAC,CAAC,EAAE;YAChCjN,GAAG,CAACH,OAAO,CAAC2E,IAAI,CAACsI,IAAI,CAACG,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;UAC/B;UAEA,IAAIyT,IAAI,GAAG3T,MAAM,CAACD,IAAI,CAACtN,CAAC,CAACsN,IAAI,CAACG,CAAC,CAAC,CAAC,CAAC;UAClC,KAAK,IAAIgC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGyR,IAAI,CAAC7T,MAAM,EAAEoC,CAAC,EAAE,EAAE;YACrCjP,GAAG,CAACH,OAAO,CAAC2E,IAAI,CAACsI,IAAI,CAACG,CAAC,CAAC,CAAC,CAACyT,IAAI,CAACzR,CAAC,CAAC,CAAC,GAAGzP,CAAC,CAACsN,IAAI,CAACG,CAAC,CAAC,CAAC,CAACyT,IAAI,CAACzR,CAAC,CAAC,CAAC;UACzD;QACD;MACD;MAEAjP,GAAG,CAACgM,QAAQ,CAAC,cAAc,EAAEjM,EAAE,EAAEP,CAAC,EAAE4Q,CAAC,EAAE9Q,CAAC,CAAC;IAC1C,CAAC;;IAED;AACF;AACA;AACA;AACA;IACEU,GAAG,CAAC2gB,UAAU,GAAG,UAASC,aAAa,EAAE;MACxC,IAAI5gB,GAAG,CAACH,OAAO,CAAC2E,IAAI,EAAE;QACrB,IAAIqc,OAAO,GAAG,CAAC,CAAC;QAChB,IAAI/T,IAAI,GAAGC,MAAM,CAACD,IAAI,CAAC9M,GAAG,CAACH,OAAO,CAAC2E,IAAI,CAAC;QACxC,KAAK,IAAIyI,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGH,IAAI,CAACD,MAAM,EAAEI,CAAC,EAAE,EAAE;UACrC,IAAI2T,aAAa,CAAC9T,IAAI,CAACG,CAAC,CAAC,CAAC,EAAE;YAC3B4T,OAAO,CAACD,aAAa,CAAC9T,IAAI,CAACG,CAAC,CAAC,CAAC,CAAC,GAAGjN,GAAG,CAACH,OAAO,CAAC2E,IAAI,CAACsI,IAAI,CAACG,CAAC,CAAC,CAAC;UAC5D,CAAC,MAAM;YACN4T,OAAO,CAAC/T,IAAI,CAACG,CAAC,CAAC,CAAC,GAAGjN,GAAG,CAACH,OAAO,CAAC2E,IAAI,CAACsI,IAAI,CAACG,CAAC,CAAC,CAAC;UAC7C;QACD;QACA;QACAjN,GAAG,CAACH,OAAO,CAAC2E,IAAI,GAAGqc,OAAO;MAC3B;IACD,CAAC;;IAED;AACF;AACA;AACA;AACA;IACE7gB,GAAG,CAAC8gB,QAAQ,GAAG,UAASzQ,IAAI,EAAEmQ,GAAG,EAAE;MAClC;MACA,IAAI,CAAEnQ,IAAI,EAAE;QACX;QACA,IAAIpP,IAAI,GAAG,CAAC,CAAC;;QAEb;QACA,IAAIkR,CAAC,GAAGnS,GAAG,CAACH,OAAO,CAACoB,IAAI,CAAC,CAAC,CAAC,CAAC4L,MAAM;QAClC,IAAIuF,CAAC,GAAGpS,GAAG,CAACH,OAAO,CAACoB,IAAI,CAAC4L,MAAM;;QAE/B;QACA,KAAK,IAAIoC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGmD,CAAC,EAAEnD,CAAC,EAAE,EAAE;UAC3B,KAAK,IAAIhC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGkF,CAAC,EAAElF,CAAC,EAAE,EAAE;YAC3B;YACA,IAAI3N,CAAC,GAAGkhB,GAAG,GAAGxgB,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAAChC,CAAC,CAAC,CAACxI,KAAK,CAAC+b,GAAG,CAAC,GAAGxgB,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAAChC,CAAC,CAAC,CAACsJ,YAAY,CAAC,OAAO,CAAC;;YAEpF;YACA,IAAIjX,CAAC,EAAE;cACN;cACA,IAAI8Q,CAAC,GAAG3R,MAAM,CAACqU,mBAAmB,CAAC,CAAC7F,CAAC,EAAEgC,CAAC,CAAC,CAAC;cAC1C;cACAhO,IAAI,CAACmP,CAAC,CAAC,GAAG9Q,CAAC;YACZ;UACD;QACD;QAEA,OAAO2B,IAAI;MACZ,CAAC,MAAM;QACNoP,IAAI,GAAG5R,MAAM,CAAC6R,mBAAmB,CAACD,IAAI,EAAE,IAAI,CAAC;QAE7C,OAAOmQ,GAAG,GAAGxgB,GAAG,CAAC4K,OAAO,CAACyF,IAAI,CAAC,CAAC,CAAC,CAAC,CAACA,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC5L,KAAK,CAAC+b,GAAG,CAAC,GAAGxgB,GAAG,CAAC4K,OAAO,CAACyF,IAAI,CAAC,CAAC,CAAC,CAAC,CAACA,IAAI,CAAC,CAAC,CAAC,CAAC,CAACkG,YAAY,CAAC,OAAO,CAAC;MAC5G;IACD,CAAC,EAEDvW,GAAG,CAAC+gB,UAAU,GAAG,UAASvhB,CAAC,EAAEwX,sBAAsB,EAAE;MACpD,IAAIlK,IAAI,GAAGC,MAAM,CAACD,IAAI,CAACtN,CAAC,CAAC;MACzB,KAAK,IAAIyN,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGH,IAAI,CAACD,MAAM,EAAEI,CAAC,EAAE,EAAE;QACrC;QACA,IAAIoD,IAAI,GAAG5R,MAAM,CAAC6R,mBAAmB,CAACxD,IAAI,CAACG,CAAC,CAAC,EAAE,IAAI,CAAC;QACpD,IAAIjN,GAAG,CAAC4K,OAAO,CAACyF,IAAI,CAAC,CAAC,CAAC,CAAC,IAAIrQ,GAAG,CAAC4K,OAAO,CAACyF,IAAI,CAAC,CAAC,CAAC,CAAC,CAACA,IAAI,CAAC,CAAC,CAAC,CAAC,EAAE;UAC1DrQ,GAAG,CAAC4K,OAAO,CAACyF,IAAI,CAAC,CAAC,CAAC,CAAC,CAACA,IAAI,CAAC,CAAC,CAAC,CAAC,CAACrB,YAAY,CAAC,OAAO,EAAE,EAAE,CAAC;QACxD;MACD;MACAhP,GAAG,CAACmQ,QAAQ,CAAC3Q,CAAC,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAEwX,sBAAsB,CAAC;IAC1D,CAAC;;IAED;AACF;AACA;AACA;AACA;IACEhX,GAAG,CAACmQ,QAAQ,GAAG,UAAS3Q,CAAC,EAAE4Q,CAAC,EAAE9Q,CAAC,EAAEmc,KAAK,EAAEzE,sBAAsB,EAAE;MAC/D,IAAItE,QAAQ,GAAG,CAAC,CAAC;MACjB,IAAIyJ,QAAQ,GAAG,CAAC,CAAC;;MAEjB;MACA,IAAI6E,UAAU,GAAG,SAAAA,CAASC,MAAM,EAAET,GAAG,EAAEnhB,KAAK,EAAE;QAC7C;QACA,IAAIgR,IAAI,GAAG5R,MAAM,CAAC6R,mBAAmB,CAAC2Q,MAAM,EAAE,IAAI,CAAC;QAEnD,IAAIjhB,GAAG,CAAC4K,OAAO,CAACyF,IAAI,CAAC,CAAC,CAAC,CAAC,IAAIrQ,GAAG,CAAC4K,OAAO,CAACyF,IAAI,CAAC,CAAC,CAAC,CAAC,CAACA,IAAI,CAAC,CAAC,CAAC,CAAC,KAAKrQ,GAAG,CAAC4K,OAAO,CAACyF,IAAI,CAAC,CAAC,CAAC,CAAC,CAACA,IAAI,CAAC,CAAC,CAAC,CAAC,CAACvE,SAAS,CAACuG,QAAQ,CAAC,UAAU,CAAC,IAAE,KAAK,IAAIoJ,KAAK,CAAC,EAAE;UAC5I;UACA,IAAIyF,YAAY,GAAGlhB,GAAG,CAAC4K,OAAO,CAACyF,IAAI,CAAC,CAAC,CAAC,CAAC,CAACA,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC5L,KAAK,CAAC+b,GAAG,CAAC;;UAE3D;UACA,IAAIU,YAAY,IAAI7hB,KAAK,IAAI,CAAEoc,KAAK,EAAE;YACrCpc,KAAK,GAAG,EAAE;YACVW,GAAG,CAAC4K,OAAO,CAACyF,IAAI,CAAC,CAAC,CAAC,CAAC,CAACA,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC5L,KAAK,CAAC+b,GAAG,CAAC,GAAG,EAAE;UAC9C,CAAC,MAAM;YACNxgB,GAAG,CAAC4K,OAAO,CAACyF,IAAI,CAAC,CAAC,CAAC,CAAC,CAACA,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC5L,KAAK,CAAC+b,GAAG,CAAC,GAAGnhB,KAAK;UACjD;;UAEA;UACA,IAAI,CAAE8c,QAAQ,CAAC8E,MAAM,CAAC,EAAE;YACvB9E,QAAQ,CAAC8E,MAAM,CAAC,GAAG,EAAE;UACtB;UACA,IAAI,CAAEvO,QAAQ,CAACuO,MAAM,CAAC,EAAE;YACvBvO,QAAQ,CAACuO,MAAM,CAAC,GAAG,EAAE;UACtB;UAEA9E,QAAQ,CAAC8E,MAAM,CAAC,CAACzT,IAAI,CAAC,CAACgT,GAAG,GAAG,GAAG,GAAGU,YAAY,CAAC,CAAC;UACjDxO,QAAQ,CAACuO,MAAM,CAAC,CAACzT,IAAI,CAAC,CAACgT,GAAG,GAAG,GAAG,GAAGnhB,KAAK,CAAC,CAAC;QAC3C;MACD,CAAC;MAED,IAAI+Q,CAAC,IAAI9Q,CAAC,EAAE;QACX;QACA,IAAI,OAAOE,CAAE,IAAI,QAAQ,EAAE;UAC1BwhB,UAAU,CAACxhB,CAAC,EAAE4Q,CAAC,EAAE9Q,CAAC,CAAC;QACpB,CAAC,MAAM;UACN;UACA,IAAI6hB,cAAc,GAAG,EAAE;UACvB;UACA,KAAK,IAAIlU,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGzN,CAAC,CAACqN,MAAM,EAAEI,CAAC,EAAE,EAAE;YAClC,IAAIkF,CAAC,GAAG3S,CAAC,CAACyN,CAAC,CAAC,CAACsJ,YAAY,CAAC,QAAQ,CAAC;YACnC,IAAInE,CAAC,GAAG5S,CAAC,CAACyN,CAAC,CAAC,CAACsJ,YAAY,CAAC,QAAQ,CAAC;YACnC,IAAIO,QAAQ,GAAGrY,MAAM,CAACqU,mBAAmB,CAAC,CAACX,CAAC,EAAEC,CAAC,CAAC,CAAC;YACjD;YACA,IAAI,CAAE+O,cAAc,CAACrK,QAAQ,CAAC,EAAE;cAC/BkK,UAAU,CAAClK,QAAQ,EAAE1G,CAAC,EAAE9Q,CAAC,CAAC;cAC1B6hB,cAAc,CAACrK,QAAQ,CAAC,GAAG,IAAI;YAChC;UACD;QACD;MACD,CAAC,MAAM;QACN,IAAIhK,IAAI,GAAGC,MAAM,CAACD,IAAI,CAACtN,CAAC,CAAC;QACzB,KAAK,IAAIyN,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGH,IAAI,CAACD,MAAM,EAAEI,CAAC,EAAE,EAAE;UACrC,IAAIxI,KAAK,GAAGjF,CAAC,CAACsN,IAAI,CAACG,CAAC,CAAC,CAAC;UACtB,IAAI,OAAOxI,KAAM,IAAI,QAAQ,EAAE;YAC9BA,KAAK,GAAGA,KAAK,CAACoP,KAAK,CAAC,GAAG,CAAC;UACzB;UACA,KAAK,IAAI5E,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGxK,KAAK,CAACoI,MAAM,EAAEoC,CAAC,EAAE,EAAE;YACtC,IAAI,OAAOxK,KAAK,CAACwK,CAAC,CAAE,IAAI,QAAQ,EAAE;cACjCxK,KAAK,CAACwK,CAAC,CAAC,GAAGxK,KAAK,CAACwK,CAAC,CAAC,CAAC4E,KAAK,CAAC,GAAG,CAAC;YAC/B;YACA;YACA,IAAIpP,KAAK,CAACwK,CAAC,CAAC,CAAC,CAAC,CAAC,CAACmS,IAAI,CAAC,CAAC,EAAE;cACvBJ,UAAU,CAAClU,IAAI,CAACG,CAAC,CAAC,EAAExI,KAAK,CAACwK,CAAC,CAAC,CAAC,CAAC,CAAC,CAACmS,IAAI,CAAC,CAAC,EAAE3c,KAAK,CAACwK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YACrD;UACD;QACD;MACD;MAEA,IAAInC,IAAI,GAAGC,MAAM,CAACD,IAAI,CAACqP,QAAQ,CAAC;MAChC,KAAK,IAAIlP,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGH,IAAI,CAACD,MAAM,EAAEI,CAAC,EAAE,EAAE;QACrCkP,QAAQ,CAACrP,IAAI,CAACG,CAAC,CAAC,CAAC,GAAGkP,QAAQ,CAACrP,IAAI,CAACG,CAAC,CAAC,CAAC,CAAC9N,IAAI,CAAC,GAAG,CAAC;MAChD;MACA,IAAI2N,IAAI,GAAGC,MAAM,CAACD,IAAI,CAAC4F,QAAQ,CAAC;MAChC,KAAK,IAAIzF,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGH,IAAI,CAACD,MAAM,EAAEI,CAAC,EAAE,EAAE;QACrCyF,QAAQ,CAAC5F,IAAI,CAACG,CAAC,CAAC,CAAC,GAAGyF,QAAQ,CAAC5F,IAAI,CAACG,CAAC,CAAC,CAAC,CAAC9N,IAAI,CAAC,GAAG,CAAC;MAChD;MAEA,IAAI,CAAE6X,sBAAsB,EAAE;QAC7B;QACAhX,GAAG,CAAC0X,UAAU,CAAC;UACdC,MAAM,EAAE,UAAU;UAClBwE,QAAQ,EAAEA,QAAQ;UAClBzJ,QAAQ,EAAEA;QACX,CAAC,CAAC;MACH;MAEA1S,GAAG,CAACgM,QAAQ,CAAC,eAAe,EAAEjM,EAAE,EAAEP,CAAC,EAAE4Q,CAAC,EAAE9Q,CAAC,CAAC;IAC3C,CAAC;;IAED;AACF;AACA;IACEU,GAAG,CAACqhB,WAAW,GAAG,UAAShR,IAAI,EAAEiR,UAAU,EAAE;MAC5C,IAAIjR,IAAI,EAAE;QACT,IAAI,OAAOA,IAAK,IAAI,QAAQ,EAAE;UAC7B,IAAIA,IAAI,GAAG5R,MAAM,CAAC6R,mBAAmB,CAACD,IAAI,EAAE,IAAI,CAAC;QAClD;QAEA,IAAIiR,UAAU,EAAE;UACf,OAAO,CAACthB,GAAG,CAAC4K,OAAO,CAACyF,IAAI,CAAC,CAAC,CAAC,CAAC,CAACA,IAAI,CAAC,CAAC,CAAC,CAAC,CAACkG,YAAY,CAAC,OAAO,CAAC,EAAEvW,GAAG,CAAC4K,OAAO,CAACyF,IAAI,CAAC,CAAC,CAAC,CAAC,CAACA,IAAI,CAAC,CAAC,CAAC,CAAC,CAACkG,YAAY,CAAC,QAAQ,CAAC,CAAC;QACnH,CAAC,MAAM;UACN,OAAOvW,GAAG,CAAC4K,OAAO,CAACyF,IAAI,CAAC,CAAC,CAAC,CAAC,CAACA,IAAI,CAAC,CAAC,CAAC,CAAC,CAACkG,YAAY,CAAC,OAAO,CAAC,IAAI,EAAE;QACjE;MACD,CAAC,MAAM;QACN,IAAItV,IAAI,GAAG,CAAC,CAAC;QACb,KAAK,IAAIgO,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjP,GAAG,CAACH,OAAO,CAACoB,IAAI,CAAC4L,MAAM,EAAEoC,CAAC,EAAE,EAAE;UACjD,KAAK,IAAIhC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjN,GAAG,CAACH,OAAO,CAACyB,OAAO,CAACuL,MAAM,EAAEI,CAAC,EAAE,EAAE;YACpD,IAAIpE,QAAQ,GAAG7I,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAAChC,CAAC,CAAC,CAACsJ,YAAY,CAAC,OAAO,CAAC;YACtD,IAAI1N,QAAQ,EAAE;cACb,IAAIwH,IAAI,GAAG5R,MAAM,CAACqU,mBAAmB,CAAC,CAAC7F,CAAC,EAAEgC,CAAC,CAAC,CAAC;cAC7ChO,IAAI,CAACoP,IAAI,CAAC,GAAGxH,QAAQ;YACtB;UACD;QACD;QACA,OAAO5H,IAAI;MACZ;IACD,CAAC;;IAED;AACF;AACA;IACEjB,GAAG,CAACuhB,WAAW,GAAG,UAASN,MAAM,EAAEpY,QAAQ,EAAE2Y,MAAM,EAAE;MACpD,IAAI,OAAOP,MAAO,IAAI,QAAQ,EAAE;QAC/B,IAAI5Q,IAAI,GAAG5R,MAAM,CAAC6R,mBAAmB,CAAC2Q,MAAM,EAAE,IAAI,CAAC;MACpD,CAAC,MAAM;QACN,IAAI5Q,IAAI,GAAG4Q,MAAM;MAClB;;MAEA;MACA,IAAIpiB,KAAK,GAAGmB,GAAG,CAAC4K,OAAO,CAACyF,IAAI,CAAC,CAAC,CAAC,CAAC,CAACA,IAAI,CAAC,CAAC,CAAC,CAAC,CAACkG,YAAY,CAAC,OAAO,CAAC;MAC/D,IAAIiL,MAAM,GAAGxhB,GAAG,CAAC4K,OAAO,CAACyF,IAAI,CAAC,CAAC,CAAC,CAAC,CAACA,IAAI,CAAC,CAAC,CAAC,CAAC,CAACkG,YAAY,CAAC,aAAa,CAAC;MACtE,IAAI4F,QAAQ,GAAG,CAAEtd,KAAK,EAAE2iB,MAAM,CAAE;;MAEhC;MACAxhB,GAAG,CAAC4K,OAAO,CAACyF,IAAI,CAAC,CAAC,CAAC,CAAC,CAACA,IAAI,CAAC,CAAC,CAAC,CAAC,CAACrB,YAAY,CAAC,OAAO,EAAEnG,QAAQ,GAAGA,QAAQ,GAAG,EAAE,CAAC;MAC7E7I,GAAG,CAAC4K,OAAO,CAACyF,IAAI,CAAC,CAAC,CAAC,CAAC,CAACA,IAAI,CAAC,CAAC,CAAC,CAAC,CAACrB,YAAY,CAAC,aAAa,EAAEwS,MAAM,GAAGA,MAAM,GAAG,EAAE,CAAC;;MAE/E;MACA,IAAI3Y,QAAQ,EAAE;QACb7I,GAAG,CAAC4K,OAAO,CAACyF,IAAI,CAAC,CAAC,CAAC,CAAC,CAACA,IAAI,CAAC,CAAC,CAAC,CAAC,CAACvE,SAAS,CAACC,GAAG,CAAC,iBAAiB,CAAC;MAC/D,CAAC,MAAM;QACN/L,GAAG,CAAC4K,OAAO,CAACyF,IAAI,CAAC,CAAC,CAAC,CAAC,CAACA,IAAI,CAAC,CAAC,CAAC,CAAC,CAACvE,SAAS,CAAClL,MAAM,CAAC,iBAAiB,CAAC;MAClE;;MAEA;MACAZ,GAAG,CAAC0X,UAAU,CAAC;QACdC,MAAM,EAAC,aAAa;QACpBzB,MAAM,EAAE+K,MAAM;QACdvO,QAAQ,EAAE,CAAE7J,QAAQ,EAAE2Y,MAAM,CAAE;QAC9BrF,QAAQ,EAAEA;MACX,CAAC,CAAC;MACF;MACAnc,GAAG,CAACgM,QAAQ,CAAC,YAAY,EAAEjM,EAAE,EAAE8I,QAAQ,EAAEhK,KAAK,EAAEwR,IAAI,EAAEA,IAAI,CAAC,CAAC,CAAC,EAAEA,IAAI,CAAC,CAAC,CAAC,CAAC;IACxE,CAAC;;IAED;AACF;AACA;IACErQ,GAAG,CAACyhB,SAAS,GAAG,YAAW;MAC1B,IAAI5hB,OAAO,GAAGG,GAAG,CAACH,OAAO;MACzBA,OAAO,CAAC4E,KAAK,GAAGzE,GAAG,CAAC8gB,QAAQ,CAAC,CAAC;MAC9BjhB,OAAO,CAAC+D,UAAU,GAAG5D,GAAG,CAAC4X,QAAQ,CAAC,CAAC;MACnC/X,OAAO,CAACgJ,QAAQ,GAAG7I,GAAG,CAACqhB,WAAW,CAAC,CAAC;MAEpC,OAAOxhB,OAAO;IACf,CAAC;;IAED;AACF;AACA;IACEG,GAAG,CAAC0hB,OAAO,GAAG,UAASxL,MAAM,EAAEyL,KAAK,EAAE;MACrC,IAAIzL,MAAM,IAAI,CAAC,EAAE;QAChB;QACA,IAAInJ,MAAM,CAACD,IAAI,CAAC9M,GAAG,CAACH,OAAO,CAAC+D,UAAU,CAAC,CAACiJ,MAAM,GAAG,CAAC,EAAE;UACnD,IAAI,CAAE+U,OAAO,CAAC5hB,GAAG,CAACH,OAAO,CAAC+H,IAAI,CAACyB,qDAAqD,CAAC,EAAE;YACtF,OAAO,KAAK;UACb,CAAC,MAAM;YACN;YACArJ,GAAG,CAACiY,aAAa,CAAC,CAAC;UACpB;QACD;;QAEA;QACA,IAAI0J,KAAK,IAAI,IAAI,EAAE;UAClBA,KAAK,GAAG3hB,GAAG,CAAC2K,OAAO,CAACuL,MAAM,CAAC,CAACpK,SAAS,CAACuG,QAAQ,CAAC,YAAY,CAAC,GAAG,CAAC,GAAG,CAAC;QACrE,CAAC,MAAM;UACNsP,KAAK,GAAGA,KAAK,GAAG,CAAC,GAAG,CAAC;QACtB;;QAEA;QACA,IAAI9S,IAAI,GAAG,EAAE;QACb,IAAI7O,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC4U,MAAM,CAAC,CAACnX,IAAI,IAAI,QAAQ,IAAIiB,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC4U,MAAM,CAAC,CAACnX,IAAI,IAAI,SAAS,IAAIiB,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC4U,MAAM,CAAC,CAACnX,IAAI,IAAI,YAAY,IAAIiB,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC4U,MAAM,CAAC,CAACnX,IAAI,IAAI,YAAY,IAAIiB,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC4U,MAAM,CAAC,CAACnX,IAAI,IAAI,OAAO,EAAE;UACzP,KAAK,IAAIkQ,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjP,GAAG,CAACH,OAAO,CAACoB,IAAI,CAAC4L,MAAM,EAAEoC,CAAC,EAAE,EAAE;YACjDJ,IAAI,CAACI,CAAC,CAAC,GAAG,CAAEA,CAAC,EAAEwE,MAAM,CAACzT,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACgO,CAAC,CAAC,CAACiH,MAAM,CAAC,CAAC,CAAE;UACrD;QACD,CAAC,MAAM,IAAIlW,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC4U,MAAM,CAAC,CAACnX,IAAI,IAAI,UAAU,IAAIiB,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC4U,MAAM,CAAC,CAACnX,IAAI,IAAI,UAAU,IAAIiB,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC4U,MAAM,CAAC,CAACnX,IAAI,IAAI,OAAO,EAAE;UAC3J,KAAK,IAAIkQ,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjP,GAAG,CAACH,OAAO,CAACoB,IAAI,CAAC4L,MAAM,EAAEoC,CAAC,EAAE,EAAE;YACjDJ,IAAI,CAACI,CAAC,CAAC,GAAG,CAAEA,CAAC,EAAEjP,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACgO,CAAC,CAAC,CAACiH,MAAM,CAAC,CAAE;UAC7C;QACD,CAAC,MAAM;UACN,KAAK,IAAIjH,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjP,GAAG,CAACH,OAAO,CAACoB,IAAI,CAAC4L,MAAM,EAAEoC,CAAC,EAAE,EAAE;YACjDJ,IAAI,CAACI,CAAC,CAAC,GAAG,CAAEA,CAAC,EAAEjP,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAACiH,MAAM,CAAC,CAAC5B,WAAW,CAACuN,WAAW,CAAC,CAAC,CAAE;UAClE;QACD;;QAEA;QACA,IAAI,OAAO7hB,GAAG,CAACH,OAAO,CAACqB,OAAQ,KAAK,UAAU,EAAE;UAC/ClB,GAAG,CAACH,OAAO,CAACqB,OAAO,GAAG,UAASge,SAAS,EAAE;YACzC,OAAO,UAAS7I,CAAC,EAAEC,CAAC,EAAE;cACrB,IAAIwL,MAAM,GAAGzL,CAAC,CAAC,CAAC,CAAC;cACjB,IAAI0L,MAAM,GAAGzL,CAAC,CAAC,CAAC,CAAC;cAEjB,IAAI,CAAE4I,SAAS,EAAE;gBAChB,OAAQ4C,MAAM,KAAK,EAAE,IAAIC,MAAM,KAAK,EAAE,GAAI,CAAC,GAAID,MAAM,KAAK,EAAE,IAAIC,MAAM,KAAK,EAAE,GAAI,CAAC,CAAC,GAAID,MAAM,GAAGC,MAAM,GAAI,CAAC,GAAID,MAAM,GAAGC,MAAM,GAAI,CAAC,CAAC,GAAI,CAAC;cAC1I,CAAC,MAAM;gBACN,OAAQD,MAAM,KAAK,EAAE,IAAIC,MAAM,KAAK,EAAE,GAAI,CAAC,GAAID,MAAM,KAAK,EAAE,IAAIC,MAAM,KAAK,EAAE,GAAI,CAAC,CAAC,GAAID,MAAM,GAAGC,MAAM,GAAI,CAAC,CAAC,GAAID,MAAM,GAAGC,MAAM,GAAI,CAAC,GAAI,CAAC;cAC1I;YACD,CAAC;UACF,CAAC;QACF;QAEAlT,IAAI,GAAGA,IAAI,CAACmT,IAAI,CAAChiB,GAAG,CAACH,OAAO,CAACqB,OAAO,CAACygB,KAAK,CAAC,CAAC;;QAE5C;QACA,IAAIjP,QAAQ,GAAG,EAAE;QACjB,KAAK,IAAIzD,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGJ,IAAI,CAAChC,MAAM,EAAEoC,CAAC,EAAE,EAAE;UACrCyD,QAAQ,CAACzD,CAAC,CAAC,GAAGJ,IAAI,CAACI,CAAC,CAAC,CAAC,CAAC,CAAC;QACzB;;QAEA;QACA,IAAKvQ,MAAM,EAAEujB,EAAE,EAAE9X,KAAK,EAAEtK,OAAO,EAAEqiB,UAAU,EAAG;UAC7C,MAAMC,aAAa,GAAG,CAAC;UACvBzP,QAAQ,GAAGA,QAAQ,CAACtH,MAAM,CAAIgX,OAAO,IAAQA,OAAO,GAAGD,aAAgB,CAAC;UACxEzP,QAAQ,CAAC2P,OAAO,CAAEF,aAAc,CAAC;QAClC;QACA,IAAKzjB,MAAM,EAAEujB,EAAE,EAAE9X,KAAK,EAAEtK,OAAO,EAAEyiB,UAAU,EAAG;UAC7C,MAAMC,YAAY,GAAG7P,QAAQ,CAAC7F,MAAM,GAAG,CAAC;UACxC6F,QAAQ,GAAGA,QAAQ,CAACtH,MAAM,CAAIgX,OAAO,IAAQA,OAAO,GAAGG,YAAe,CAAC;UACvE7P,QAAQ,CAAClF,IAAI,CAAE+U,YAAa,CAAC;QAC9B;;QAEA;QACAviB,GAAG,CAAC0X,UAAU,CAAC;UACdC,MAAM,EAAE,SAAS;UACjBtW,IAAI,EAAEqR,QAAQ;UACdwD,MAAM,EAAEA,MAAM;UACdyL,KAAK,EAAEA;QACR,CAAC,CAAC;;QAEF;QACA3hB,GAAG,CAACwiB,gBAAgB,CAACtM,MAAM,EAAEyL,KAAK,CAAC;QACnC3hB,GAAG,CAACyiB,WAAW,CAAC/P,QAAQ,CAAC;;QAEzB;QACA1S,GAAG,CAACgM,QAAQ,CAAC,QAAQ,EAAEjM,EAAE,EAAEmW,MAAM,EAAEyL,KAAK,CAAC;QAEzC,OAAO,IAAI;MACZ;IACD,CAAC;;IAED;AACF;AACA;IACE3hB,GAAG,CAACwiB,gBAAgB,GAAG,UAAStM,MAAM,EAAEyL,KAAK,EAAE;MAC9C;MACA,KAAK,IAAI1U,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjN,GAAG,CAAC2K,OAAO,CAACkC,MAAM,EAAEI,CAAC,EAAE,EAAE;QAC5CjN,GAAG,CAAC2K,OAAO,CAACsC,CAAC,CAAC,CAACnB,SAAS,CAAClL,MAAM,CAAC,UAAU,CAAC;QAC3CZ,GAAG,CAAC2K,OAAO,CAACsC,CAAC,CAAC,CAACnB,SAAS,CAAClL,MAAM,CAAC,YAAY,CAAC;MAC9C;;MAEA;MACA,IAAI+gB,KAAK,EAAE;QACV3hB,GAAG,CAAC2K,OAAO,CAACuL,MAAM,CAAC,CAACpK,SAAS,CAACC,GAAG,CAAC,UAAU,CAAC;MAC9C,CAAC,MAAM;QACN/L,GAAG,CAAC2K,OAAO,CAACuL,MAAM,CAAC,CAACpK,SAAS,CAACC,GAAG,CAAC,YAAY,CAAC;MAChD;IACD,CAAC;;IAED;AACF;AACA;IACE/L,GAAG,CAACyiB,WAAW,GAAG,UAASphB,IAAI,EAAE;MAChC;MACA,IAAIJ,IAAI,GAAG,EAAE;MACb,KAAK,IAAIgO,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG5N,IAAI,CAACwL,MAAM,EAAEoC,CAAC,EAAE,EAAE;QACrChO,IAAI,CAACgO,CAAC,CAAC,GAAGjP,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACI,IAAI,CAAC4N,CAAC,CAAC,CAAC;MACpC;MACAjP,GAAG,CAACH,OAAO,CAACoB,IAAI,GAAGA,IAAI;MAEvB,IAAIA,IAAI,GAAG,EAAE;MACb,KAAK,IAAIgO,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG5N,IAAI,CAACwL,MAAM,EAAEoC,CAAC,EAAE,EAAE;QACrChO,IAAI,CAACgO,CAAC,CAAC,GAAGjP,GAAG,CAAC4K,OAAO,CAACvJ,IAAI,CAAC4N,CAAC,CAAC,CAAC;MAC/B;MACAjP,GAAG,CAAC4K,OAAO,GAAG3J,IAAI;MAElB,IAAIA,IAAI,GAAG,EAAE;MACb,KAAK,IAAIgO,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG5N,IAAI,CAACwL,MAAM,EAAEoC,CAAC,EAAE,EAAE;QACrChO,IAAI,CAACgO,CAAC,CAAC,GAAGjP,GAAG,CAACqB,IAAI,CAACA,IAAI,CAAC4N,CAAC,CAAC,CAAC;MAC5B;MACAjP,GAAG,CAACqB,IAAI,GAAGJ,IAAI;;MAEf;MACAjB,GAAG,CAAC0iB,qBAAqB,CAAC,CAAC;;MAE3B;MACA,IAAI1iB,GAAG,CAACsK,OAAO,IAAItK,GAAG,CAACsK,OAAO,CAACuC,MAAM,EAAE;QACtC,IAAI7M,GAAG,CAACuK,WAAW,CAAClL,KAAK,EAAE;UAC1BW,GAAG,CAAC8D,MAAM,CAAC9D,GAAG,CAACuK,WAAW,CAAClL,KAAK,CAAC;QAClC,CAAC,MAAM;UACNW,GAAG,CAACoZ,WAAW,CAAC,CAAC;QAClB;MACD,CAAC,MAAM;QACN;QACApZ,GAAG,CAACsK,OAAO,GAAG,IAAI;QAClBtK,GAAG,CAACwK,UAAU,GAAG,CAAC;QAElB,IAAIxK,GAAG,CAACH,OAAO,CAACkE,UAAU,GAAG,CAAC,EAAE;UAC/B/D,GAAG,CAAC4O,IAAI,CAAC,CAAC,CAAC;QACZ,CAAC,MAAM,IAAI5O,GAAG,CAACH,OAAO,CAACqE,WAAW,IAAI,IAAI,EAAE;UAC3ClE,GAAG,CAAC2iB,QAAQ,CAAC,CAAC,CAAC;QAChB,CAAC,MAAM;UACN,KAAK,IAAI1T,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjP,GAAG,CAACqB,IAAI,CAACwL,MAAM,EAAEoC,CAAC,EAAE,EAAE;YACzCjP,GAAG,CAACqK,KAAK,CAACkE,WAAW,CAACvO,GAAG,CAACqB,IAAI,CAAC4N,CAAC,CAAC,CAAC;UACnC;QACD;MACD;IACD,CAAC;;IAED;AACF;AACA;AACA;AACA;IACEjP,GAAG,CAAC4iB,OAAO,GAAG,UAASpjB,CAAC,EAAE6c,CAAC,EAAEwG,SAAS,EAAE;MACvC,IAAI9V,MAAM,CAACD,IAAI,CAAC9M,GAAG,CAACH,OAAO,CAAC+D,UAAU,CAAC,CAACiJ,MAAM,GAAG,CAAC,EAAE;QACnD,IAAIrN,CAAC,GAAG6c,CAAC,EAAE;UACV,IAAI1b,YAAY,GAAG,CAAC;QACrB,CAAC,MAAM;UACN,IAAIA,YAAY,GAAG,CAAC;QACrB;QAEA,IAAIX,GAAG,CAACoY,WAAW,CAAC5Y,CAAC,CAAC,CAACqN,MAAM,IAAI7M,GAAG,CAACoY,WAAW,CAACiE,CAAC,EAAE1b,YAAY,CAAC,CAACkM,MAAM,EAAE;UACzE,IAAI,CAAE+U,OAAO,CAAC5hB,GAAG,CAACH,OAAO,CAAC+H,IAAI,CAACyB,qDAAqD,CAAC,EAAE;YACtF,OAAO,KAAK;UACb,CAAC,MAAM;YACNrJ,GAAG,CAACiY,aAAa,CAAC,CAAC;UACpB;QACD;MACD;MAEA,IAAIjY,GAAG,CAACH,OAAO,CAACiE,MAAM,IAAI,IAAI,EAAE;QAC/B,IAAI9D,GAAG,CAACsK,OAAO,IAAItK,GAAG,CAACsK,OAAO,CAACuC,MAAM,IAAI7M,GAAG,CAACqB,IAAI,CAACwL,MAAM,EAAE;UACzD,IAAI+U,OAAO,CAAC5hB,GAAG,CAACH,OAAO,CAAC+H,IAAI,CAAC0B,8CAA8C,CAAC,EAAE;YAC7EtJ,GAAG,CAAC8iB,WAAW,CAAC,CAAC;UAClB,CAAC,MAAM;YACN,OAAO,KAAK;UACb;QACD;QAEA9iB,GAAG,CAACsK,OAAO,GAAG,IAAI;MACnB;MAEA,IAAI,CAAEuY,SAAS,EAAE;QAChB,IAAIxW,KAAK,CAACC,SAAS,CAACyW,OAAO,CAACvW,IAAI,CAACxM,GAAG,CAACqK,KAAK,CAACwL,QAAQ,EAAE7V,GAAG,CAACqB,IAAI,CAACgb,CAAC,CAAC,CAAC,IAAI,CAAC,EAAE;UACvE,IAAI7c,CAAC,GAAG6c,CAAC,EAAE;YACVrc,GAAG,CAACqK,KAAK,CAAC1J,YAAY,CAACX,GAAG,CAACqB,IAAI,CAAC7B,CAAC,CAAC,EAAEQ,GAAG,CAACqB,IAAI,CAACgb,CAAC,CAAC,CAAC;UACjD,CAAC,MAAM;YACNrc,GAAG,CAACqK,KAAK,CAAC1J,YAAY,CAACX,GAAG,CAACqB,IAAI,CAAC7B,CAAC,CAAC,EAAEQ,GAAG,CAACqB,IAAI,CAACgb,CAAC,CAAC,CAAC2G,WAAW,CAAC;UAC7D;QACD,CAAC,MAAM;UACNhjB,GAAG,CAACqK,KAAK,CAAC2R,WAAW,CAAChc,GAAG,CAACqB,IAAI,CAAC7B,CAAC,CAAC,CAAC;QACnC;MACD;;MAEA;MACAQ,GAAG,CAACqB,IAAI,CAAC4hB,MAAM,CAAC5G,CAAC,EAAE,CAAC,EAAErc,GAAG,CAACqB,IAAI,CAAC4hB,MAAM,CAACzjB,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;MAC/CQ,GAAG,CAAC4K,OAAO,CAACqY,MAAM,CAAC5G,CAAC,EAAE,CAAC,EAAErc,GAAG,CAAC4K,OAAO,CAACqY,MAAM,CAACzjB,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;MACrDQ,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACgiB,MAAM,CAAC5G,CAAC,EAAE,CAAC,EAAErc,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACgiB,MAAM,CAACzjB,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;;MAE/D;MACA,IAAIQ,GAAG,CAACH,OAAO,CAACkE,UAAU,GAAG,CAAC,IAAI/D,GAAG,CAACqK,KAAK,CAACwL,QAAQ,CAAChJ,MAAM,IAAI7M,GAAG,CAACH,OAAO,CAACkE,UAAU,EAAE;QACtF/D,GAAG,CAAC4O,IAAI,CAAC5O,GAAG,CAACwK,UAAU,CAAC;MACzB;;MAEA;MACAxK,GAAG,CAAC0X,UAAU,CAAC;QACdC,MAAM,EAAC,SAAS;QAChBwE,QAAQ,EAAE3c,CAAC;QACXkT,QAAQ,EAAE2J;MACX,CAAC,CAAC;;MAEF;MACArc,GAAG,CAAC0iB,qBAAqB,CAAC,CAAC;;MAE3B;MACA1iB,GAAG,CAACgM,QAAQ,CAAC,WAAW,EAAEjM,EAAE,EAAEP,CAAC,EAAE6c,CAAC,CAAC;IACpC,CAAC;;IAED;AACF;AACA;AACA;AACA;AACA;AACA;AACA;IACErc,GAAG,CAACkjB,SAAS,GAAG,UAASC,KAAK,EAAE5Q,SAAS,EAAE5R,YAAY,EAAE;MACxD;MACA,IAAIX,GAAG,CAACH,OAAO,CAAC6C,cAAc,IAAI,IAAI,EAAE;QACvC;QACA,IAAIkI,OAAO,GAAG,EAAE;;QAEhB;QACA,IAAI3J,IAAI,GAAG,EAAE;;QAEb;QACA,IAAIkiB,KAAK,GAAG,CAAC,EAAE;UACd,IAAIC,SAAS,GAAGD,KAAK;QACtB,CAAC,MAAM;UACN,IAAIC,SAAS,GAAG,CAAC;UAEjB,IAAID,KAAK,EAAE;YACVliB,IAAI,GAAGkiB,KAAK;UACb;QACD;;QAEA;QACA,IAAIxiB,YAAY,GAAGA,YAAY,GAAG,IAAI,GAAG,KAAK;;QAE9C;QACA,IAAI0iB,OAAO,GAAGrjB,GAAG,CAACH,OAAO,CAACoB,IAAI,CAAC4L,MAAM,GAAG,CAAC;QAEzC,IAAI0F,SAAS,IAAIlB,SAAS,IAAIkB,SAAS,IAAI5D,QAAQ,CAAC0U,OAAO,CAAC,IAAI9Q,SAAS,GAAG,CAAC,EAAE;UAC9EA,SAAS,GAAG8Q,OAAO;QACpB;;QAEA;QACA,IAAIrjB,GAAG,CAACgM,QAAQ,CAAC,mBAAmB,EAAEjM,EAAE,EAAEwS,SAAS,EAAE6Q,SAAS,EAAEziB,YAAY,CAAC,KAAK,KAAK,EAAE;UACxF,OAAO,KAAK;QACb;;QAEA;QACA,IAAIoM,MAAM,CAACD,IAAI,CAAC9M,GAAG,CAACH,OAAO,CAAC+D,UAAU,CAAC,CAACiJ,MAAM,GAAG,CAAC,EAAE;UACnD,IAAI7M,GAAG,CAACoY,WAAW,CAAC7F,SAAS,EAAE5R,YAAY,CAAC,CAACkM,MAAM,EAAE;YACpD,IAAI,CAAE+U,OAAO,CAAC5hB,GAAG,CAACH,OAAO,CAAC+H,IAAI,CAACyB,qDAAqD,CAAC,EAAE;cACtF,OAAO,KAAK;YACb,CAAC,MAAM;cACNrJ,GAAG,CAACiY,aAAa,CAAC,CAAC;YACpB;UACD;QACD;;QAEA;QACA,IAAIjY,GAAG,CAACH,OAAO,CAACiE,MAAM,IAAI,IAAI,EAAE;UAC/B,IAAI9D,GAAG,CAACsK,OAAO,IAAItK,GAAG,CAACsK,OAAO,CAACuC,MAAM,IAAI7M,GAAG,CAACqB,IAAI,CAACwL,MAAM,EAAE;YACzD,IAAI+U,OAAO,CAAC5hB,GAAG,CAACH,OAAO,CAAC+H,IAAI,CAAC0B,8CAA8C,CAAC,EAAE;cAC7EtJ,GAAG,CAAC8iB,WAAW,CAAC,CAAC;YAClB,CAAC,MAAM;cACN,OAAO,KAAK;YACb;UACD;UAEA9iB,GAAG,CAACsK,OAAO,GAAG,IAAI;QACnB;;QAEA;QACA,IAAIgZ,QAAQ,GAAI,CAAE3iB,YAAY,GAAI4R,SAAS,GAAG,CAAC,GAAGA,SAAS;;QAE3D;QACA,IAAIgR,cAAc,GAAGvjB,GAAG,CAAC4K,OAAO,CAACqY,MAAM,CAACK,QAAQ,CAAC;QACjD,IAAIE,WAAW,GAAGxjB,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACgiB,MAAM,CAACK,QAAQ,CAAC;QACnD,IAAIG,WAAW,GAAGzjB,GAAG,CAACqB,IAAI,CAAC4hB,MAAM,CAACK,QAAQ,CAAC;;QAE3C;QACA,IAAII,UAAU,GAAG,EAAE;QACnB,IAAIlR,OAAO,GAAG,EAAE;QAChB,IAAImR,OAAO,GAAG,EAAE;QAEhB,KAAK,IAAI7S,GAAG,GAAGwS,QAAQ,EAAExS,GAAG,GAAIsS,SAAS,GAAGE,QAAS,EAAExS,GAAG,EAAE,EAAE;UAC7D;UACA9Q,GAAG,CAACH,OAAO,CAACoB,IAAI,CAAC6P,GAAG,CAAC,GAAG,EAAE;UAC1B,KAAK,IAAIoL,GAAG,GAAG,CAAC,EAAEA,GAAG,GAAGlc,GAAG,CAACH,OAAO,CAACyB,OAAO,CAACuL,MAAM,EAAEqP,GAAG,EAAE,EAAE;YAC1Dlc,GAAG,CAACH,OAAO,CAACoB,IAAI,CAAC6P,GAAG,CAAC,CAACoL,GAAG,CAAC,GAAIjb,IAAI,CAACib,GAAG,CAAC,GAAGjb,IAAI,CAACib,GAAG,CAAC,GAAG,EAAE;UACzD;UACA;UACA,IAAIzK,EAAE,GAAGzR,GAAG,CAAC0R,SAAS,CAACZ,GAAG,EAAE9Q,GAAG,CAACH,OAAO,CAACoB,IAAI,CAAC6P,GAAG,CAAC,CAAC;UAClD;UACA,IAAI2S,WAAW,CAAC,CAAC,CAAC,EAAE;YACnB,IAAIpX,KAAK,CAACC,SAAS,CAACyW,OAAO,CAACvW,IAAI,CAACxM,GAAG,CAACqK,KAAK,CAACwL,QAAQ,EAAE4N,WAAW,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,EAAE;cAC1EzjB,GAAG,CAACqK,KAAK,CAAC1J,YAAY,CAAC8Q,EAAE,EAAEgS,WAAW,CAAC,CAAC,CAAC,CAAC;YAC3C;UACD,CAAC,MAAM;YACN,IAAIpX,KAAK,CAACC,SAAS,CAACyW,OAAO,CAACvW,IAAI,CAACxM,GAAG,CAACqK,KAAK,CAACwL,QAAQ,EAAE7V,GAAG,CAACqB,IAAI,CAACkR,SAAS,CAAC,CAAC,IAAI,CAAC,EAAE;cAC/EvS,GAAG,CAACqK,KAAK,CAACkE,WAAW,CAACkD,EAAE,CAAC;YAC1B;UACD;UACA;UACAiS,UAAU,CAAClW,IAAI,CAACxN,GAAG,CAAC4K,OAAO,CAACkG,GAAG,CAAC,CAAC;UACjC0B,OAAO,CAAChF,IAAI,CAACxN,GAAG,CAACH,OAAO,CAACoB,IAAI,CAAC6P,GAAG,CAAC,CAAC;UACnC6S,OAAO,CAACnW,IAAI,CAACiE,EAAE,CAAC;QACjB;;QAEA;QACApF,KAAK,CAACC,SAAS,CAACkB,IAAI,CAACrB,KAAK,CAACnM,GAAG,CAAC4K,OAAO,EAAE2Y,cAAc,CAAC;QACvDlX,KAAK,CAACC,SAAS,CAACkB,IAAI,CAACrB,KAAK,CAACnM,GAAG,CAACH,OAAO,CAACoB,IAAI,EAAEuiB,WAAW,CAAC;QACzDnX,KAAK,CAACC,SAAS,CAACkB,IAAI,CAACrB,KAAK,CAACnM,GAAG,CAACqB,IAAI,EAAEoiB,WAAW,CAAC;;QAEjD;QACA,IAAIzjB,GAAG,CAACH,OAAO,CAACkE,UAAU,GAAG,CAAC,EAAE;UAC/B/D,GAAG,CAAC4O,IAAI,CAAC5O,GAAG,CAACwK,UAAU,CAAC;QACzB;;QAEA;QACAxK,GAAG,CAAC0X,UAAU,CAAC;UACdC,MAAM,EAAE,WAAW;UACnBpF,SAAS,EAAEA,SAAS;UACpB6Q,SAAS,EAAEA,SAAS;UACpBziB,YAAY,EAAEA,YAAY;UAC1B+iB,UAAU,EAAEA,UAAU;UACtBlR,OAAO,EAAEA,OAAO;UAChBmR,OAAO,EAAEA;QACV,CAAC,CAAC;;QAEF;QACA3jB,GAAG,CAAC0iB,qBAAqB,CAAC,CAAC;;QAE3B;QACA1iB,GAAG,CAACgM,QAAQ,CAAC,aAAa,EAAEjM,EAAE,EAAEwS,SAAS,EAAE6Q,SAAS,EAAEM,UAAU,EAAE/iB,YAAY,CAAC;MAChF;IACD,CAAC;;IAED;AACF;AACA;AACA;AACA;AACA;AACA;IACEX,GAAG,CAAC4jB,SAAS,GAAG,UAASrR,SAAS,EAAE6Q,SAAS,EAAE;MAC9C;MACA,IAAIpjB,GAAG,CAACH,OAAO,CAACiD,cAAc,IAAI,IAAI,EAAE;QACvC,IAAI9C,GAAG,CAACH,OAAO,CAACkD,oBAAoB,IAAI,IAAI,IAAI/C,GAAG,CAACH,OAAO,CAACoB,IAAI,CAAC4L,MAAM,GAAG,CAAC,EAAE;UAC5E;UACA,IAAI0F,SAAS,IAAIlB,SAAS,EAAE;YAC3B,IAAIwS,MAAM,GAAG7jB,GAAG,CAAC8jB,eAAe,CAAC,CAAC;YAElC,IAAI,CAAED,MAAM,CAAC,CAAC,CAAC,EAAE;cAChBtR,SAAS,GAAGvS,GAAG,CAACH,OAAO,CAACoB,IAAI,CAAC4L,MAAM,GAAG,CAAC;cACvCuW,SAAS,GAAG,CAAC;YACd,CAAC,MAAM;cACN7Q,SAAS,GAAG5D,QAAQ,CAACkV,MAAM,CAAC,CAAC,CAAC,CAACtN,YAAY,CAAC,QAAQ,CAAC,CAAC;cACtD6M,SAAS,GAAGS,MAAM,CAAChX,MAAM;YAC1B;UACD;;UAEA;UACA,IAAIwW,OAAO,GAAGrjB,GAAG,CAACH,OAAO,CAACoB,IAAI,CAAC4L,MAAM,GAAG,CAAC;UAEzC,IAAI0F,SAAS,IAAIlB,SAAS,IAAIkB,SAAS,GAAG8Q,OAAO,IAAI9Q,SAAS,GAAG,CAAC,EAAE;YACnEA,SAAS,GAAG8Q,OAAO;UACpB;UAEA,IAAI,CAAED,SAAS,EAAE;YAChBA,SAAS,GAAG,CAAC;UACd;;UAEA;UACA,IAAI7Q,SAAS,GAAG6Q,SAAS,IAAIpjB,GAAG,CAACH,OAAO,CAACoB,IAAI,CAAC4L,MAAM,EAAE;YACrDuW,SAAS,GAAGpjB,GAAG,CAACH,OAAO,CAACoB,IAAI,CAAC4L,MAAM,GAAG0F,SAAS;UAChD;;UAEA;UACA,IAAIvS,GAAG,CAACgM,QAAQ,CAAC,mBAAmB,EAAEjM,EAAE,EAAEwS,SAAS,EAAE6Q,SAAS,CAAC,KAAK,KAAK,EAAE;YAC1E,OAAO,KAAK;UACb;UAEA,IAAIzU,QAAQ,CAAC4D,SAAS,CAAC,GAAG,CAAC,CAAC,EAAE;YAC7B;YACA,IAAIwR,WAAW,GAAG,KAAK;YACvB,IAAIhX,MAAM,CAACD,IAAI,CAAC9M,GAAG,CAACH,OAAO,CAAC+D,UAAU,CAAC,CAACiJ,MAAM,GAAG,CAAC,EAAE;cACnD,KAAK,IAAIiE,GAAG,GAAGyB,SAAS,EAAEzB,GAAG,GAAGyB,SAAS,GAAG6Q,SAAS,EAAEtS,GAAG,EAAE,EAAE;gBAC7D,IAAI9Q,GAAG,CAACoY,WAAW,CAACtH,GAAG,EAAE,KAAK,CAAC,CAACjE,MAAM,EAAE;kBACvCkX,WAAW,GAAG,IAAI;gBACnB;cACD;YACD;YACA,IAAIA,WAAW,EAAE;cAChB,IAAI,CAAEnC,OAAO,CAAC5hB,GAAG,CAACH,OAAO,CAAC+H,IAAI,CAACyB,qDAAqD,CAAC,EAAE;gBACtF,OAAO,KAAK;cACb,CAAC,MAAM;gBACNrJ,GAAG,CAACiY,aAAa,CAAC,CAAC;cACpB;YACD;;YAEA;YACA,IAAIjY,GAAG,CAACH,OAAO,CAACiE,MAAM,IAAI,IAAI,EAAE;cAC/B,IAAI9D,GAAG,CAACsK,OAAO,IAAItK,GAAG,CAACsK,OAAO,CAACuC,MAAM,IAAI7M,GAAG,CAACqB,IAAI,CAACwL,MAAM,EAAE;gBACzD,IAAI+U,OAAO,CAAC5hB,GAAG,CAACH,OAAO,CAAC+H,IAAI,CAAC0B,8CAA8C,CAAC,EAAE;kBAC7EtJ,GAAG,CAAC8iB,WAAW,CAAC,CAAC;gBAClB,CAAC,MAAM;kBACN,OAAO,KAAK;gBACb;cACD;cAEA9iB,GAAG,CAACsK,OAAO,GAAG,IAAI;YACnB;;YAEA;YACA,IAAItK,GAAG,CAACH,OAAO,CAACkD,oBAAoB,IAAI,KAAK,IAAIsgB,OAAO,GAAG,CAAC,KAAKD,SAAS,EAAE;cAC3EA,SAAS,EAAE;cACXjjB,OAAO,CAACC,KAAK,CAAC,yDAAyD,CAAC;YACzE;;YAEA;YACA,KAAK,IAAI0Q,GAAG,GAAGyB,SAAS,EAAEzB,GAAG,GAAGyB,SAAS,GAAG6Q,SAAS,EAAEtS,GAAG,EAAE,EAAE;cAC7D,IAAIzE,KAAK,CAACC,SAAS,CAACyW,OAAO,CAACvW,IAAI,CAACxM,GAAG,CAACqK,KAAK,CAACwL,QAAQ,EAAE7V,GAAG,CAACqB,IAAI,CAACyP,GAAG,CAAC,CAAC,IAAI,CAAC,EAAE;gBACzE9Q,GAAG,CAACqB,IAAI,CAACyP,GAAG,CAAC,CAACzB,SAAS,GAAG,EAAE;gBAC5BrP,GAAG,CAACqB,IAAI,CAACyP,GAAG,CAAC,CAACpQ,UAAU,CAACsb,WAAW,CAAChc,GAAG,CAACqB,IAAI,CAACyP,GAAG,CAAC,CAAC;cACpD;YACD;;YAEA;YACA,IAAI4S,UAAU,GAAG1jB,GAAG,CAAC4K,OAAO,CAACqY,MAAM,CAAC1Q,SAAS,EAAE6Q,SAAS,CAAC;YACzD,IAAI5Q,OAAO,GAAGxS,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACgiB,MAAM,CAAC1Q,SAAS,EAAE6Q,SAAS,CAAC;YAC3D,IAAIO,OAAO,GAAG3jB,GAAG,CAACqB,IAAI,CAAC4hB,MAAM,CAAC1Q,SAAS,EAAE6Q,SAAS,CAAC;;YAEnD;YACA,IAAIpjB,GAAG,CAACH,OAAO,CAACkE,UAAU,GAAG,CAAC,IAAI/D,GAAG,CAACqK,KAAK,CAACwL,QAAQ,CAAChJ,MAAM,IAAI7M,GAAG,CAACH,OAAO,CAACkE,UAAU,EAAE;cACtF/D,GAAG,CAAC4O,IAAI,CAAC5O,GAAG,CAACwK,UAAU,CAAC;YACzB;;YAEA;YACAxK,GAAG,CAACqd,0BAA0B,CAAC,CAAC,EAAE9K,SAAS,EAAGA,SAAS,GAAG6Q,SAAS,GAAI,CAAC,CAAC;;YAEzE;YACApjB,GAAG,CAAC0X,UAAU,CAAC;cACdC,MAAM,EAAE,WAAW;cACnBpF,SAAS,EAAEA,SAAS;cACpB6Q,SAAS,EAAEA,SAAS;cACpBziB,YAAY,EAAE,CAAC;cACf+iB,UAAU,EAAEA,UAAU;cACtBlR,OAAO,EAAEA,OAAO;cAChBmR,OAAO,EAAEA;YACV,CAAC,CAAC;;YAEF;YACA3jB,GAAG,CAAC0iB,qBAAqB,CAAC,CAAC;;YAE3B;YACA1iB,GAAG,CAACgM,QAAQ,CAAC,aAAa,EAAEjM,EAAE,EAAEwS,SAAS,EAAE6Q,SAAS,EAAEM,UAAU,CAAC;UAClE;QACD,CAAC,MAAM;UACNvjB,OAAO,CAACC,KAAK,CAAC,yDAAyD,CAAC;QACzE;MACD;IACD,CAAC;;IAGD;AACF;AACA;AACA;AACA;IACEJ,GAAG,CAACgkB,UAAU,GAAG,UAASxkB,CAAC,EAAE6c,CAAC,EAAE;MAC/B,IAAItP,MAAM,CAACD,IAAI,CAAC9M,GAAG,CAACH,OAAO,CAAC+D,UAAU,CAAC,CAACiJ,MAAM,GAAG,CAAC,EAAE;QACnD,IAAIrN,CAAC,GAAG6c,CAAC,EAAE;UACV,IAAI1b,YAAY,GAAG,CAAC;QACrB,CAAC,MAAM;UACN,IAAIA,YAAY,GAAG,CAAC;QACrB;QAEA,IAAIX,GAAG,CAACkY,WAAW,CAAC1Y,CAAC,CAAC,CAACqN,MAAM,IAAI7M,GAAG,CAACkY,WAAW,CAACmE,CAAC,EAAE1b,YAAY,CAAC,CAACkM,MAAM,EAAE;UACzE,IAAI,CAAE+U,OAAO,CAAC5hB,GAAG,CAACH,OAAO,CAAC+H,IAAI,CAACyB,qDAAqD,CAAC,EAAE;YACtF,OAAO,KAAK;UACb,CAAC,MAAM;YACNrJ,GAAG,CAACiY,aAAa,CAAC,CAAC;UACpB;QACD;MACD;MAEA,IAAIzY,CAAC,GAAGmP,QAAQ,CAACnP,CAAC,CAAC;MACnB,IAAI6c,CAAC,GAAG1N,QAAQ,CAAC0N,CAAC,CAAC;MAEnB,IAAI7c,CAAC,GAAG6c,CAAC,EAAE;QACVrc,GAAG,CAACyK,eAAe,CAAC9J,YAAY,CAACX,GAAG,CAAC2K,OAAO,CAACnL,CAAC,CAAC,EAAEQ,GAAG,CAAC2K,OAAO,CAAC0R,CAAC,CAAC,CAAC;QAChErc,GAAG,CAAC0K,iBAAiB,CAAC/J,YAAY,CAACX,GAAG,CAAC+K,QAAQ,CAACvL,CAAC,CAAC,EAAEQ,GAAG,CAAC+K,QAAQ,CAACsR,CAAC,CAAC,CAAC;QAEpE,KAAK,IAAIpN,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjP,GAAG,CAACqB,IAAI,CAACwL,MAAM,EAAEoC,CAAC,EAAE,EAAE;UACzCjP,GAAG,CAACqB,IAAI,CAAC4N,CAAC,CAAC,CAACtO,YAAY,CAACX,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAACzP,CAAC,CAAC,EAAEQ,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAACoN,CAAC,CAAC,CAAC;QAC/D;MACD,CAAC,MAAM;QACNrc,GAAG,CAACyK,eAAe,CAAC9J,YAAY,CAACX,GAAG,CAAC2K,OAAO,CAACnL,CAAC,CAAC,EAAEQ,GAAG,CAAC2K,OAAO,CAAC0R,CAAC,CAAC,CAAC2G,WAAW,CAAC;QAC5EhjB,GAAG,CAAC0K,iBAAiB,CAAC/J,YAAY,CAACX,GAAG,CAAC+K,QAAQ,CAACvL,CAAC,CAAC,EAAEQ,GAAG,CAAC+K,QAAQ,CAACsR,CAAC,CAAC,CAAC2G,WAAW,CAAC;QAEhF,KAAK,IAAI/T,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjP,GAAG,CAACqB,IAAI,CAACwL,MAAM,EAAEoC,CAAC,EAAE,EAAE;UACzCjP,GAAG,CAACqB,IAAI,CAAC4N,CAAC,CAAC,CAACtO,YAAY,CAACX,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAACzP,CAAC,CAAC,EAAEQ,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAACoN,CAAC,CAAC,CAAC2G,WAAW,CAAC;QAC3E;MACD;MAEAhjB,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2hB,MAAM,CAAC5G,CAAC,EAAE,CAAC,EAAErc,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2hB,MAAM,CAACzjB,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;MACrEQ,GAAG,CAAC2K,OAAO,CAACsY,MAAM,CAAC5G,CAAC,EAAE,CAAC,EAAErc,GAAG,CAAC2K,OAAO,CAACsY,MAAM,CAACzjB,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;MACrDQ,GAAG,CAAC+K,QAAQ,CAACkY,MAAM,CAAC5G,CAAC,EAAE,CAAC,EAAErc,GAAG,CAAC+K,QAAQ,CAACkY,MAAM,CAACzjB,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;MAEvD,KAAK,IAAIyP,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjP,GAAG,CAACqB,IAAI,CAACwL,MAAM,EAAEoC,CAAC,EAAE,EAAE;QACzCjP,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACgO,CAAC,CAAC,CAACgU,MAAM,CAAC5G,CAAC,EAAE,CAAC,EAAErc,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACgO,CAAC,CAAC,CAACgU,MAAM,CAACzjB,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QACrEQ,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAACgU,MAAM,CAAC5G,CAAC,EAAE,CAAC,EAAErc,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAACgU,MAAM,CAACzjB,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;MAC5D;;MAEA;MACA,IAAIQ,GAAG,CAACH,OAAO,CAACqF,OAAO,EAAE;QACxB,KAAK,IAAI+J,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjP,GAAG,CAACH,OAAO,CAACqF,OAAO,CAAC2H,MAAM,EAAEoC,CAAC,EAAE,EAAE;UACpDjP,GAAG,CAACH,OAAO,CAACqF,OAAO,CAAC+J,CAAC,CAAC,CAACgU,MAAM,CAAC5G,CAAC,EAAE,CAAC,EAAErc,GAAG,CAACH,OAAO,CAACqF,OAAO,CAAC+J,CAAC,CAAC,CAACgU,MAAM,CAACzjB,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QAC5E;MACD;;MAEA;MACAQ,GAAG,CAAC0X,UAAU,CAAC;QACdC,MAAM,EAAC,YAAY;QACnBwE,QAAQ,EAAE3c,CAAC;QACXkT,QAAQ,EAAE2J;MACX,CAAC,CAAC;;MAEF;MACArc,GAAG,CAAC0iB,qBAAqB,CAAC,CAAC;;MAE3B;MACA1iB,GAAG,CAACgM,QAAQ,CAAC,cAAc,EAAEjM,EAAE,EAAEP,CAAC,EAAE6c,CAAC,CAAC;IACvC,CAAC;;IAED;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;IACErc,GAAG,CAACikB,YAAY,GAAG,UAASd,KAAK,EAAElQ,YAAY,EAAEtS,YAAY,EAAEujB,UAAU,EAAE;MAC1E;MACA,IAAIlkB,GAAG,CAACH,OAAO,CAAC+C,iBAAiB,IAAI,IAAI,EAAE;QAC1C;QACA,IAAIgI,OAAO,GAAG,EAAE;;QAEhB;QACA,IAAI3J,IAAI,GAAG,EAAE;;QAEb;QACA,IAAIkiB,KAAK,GAAG,CAAC,EAAE;UACd,IAAIgB,YAAY,GAAGhB,KAAK;QACzB,CAAC,MAAM;UACN,IAAIgB,YAAY,GAAG,CAAC;UAEpB,IAAIhB,KAAK,EAAE;YACVliB,IAAI,GAAGkiB,KAAK;UACb;QACD;;QAEA;QACA,IAAIxiB,YAAY,GAAGA,YAAY,GAAG,IAAI,GAAG,KAAK;;QAE9C;QACA,IAAIyjB,UAAU,GAAGpkB,GAAG,CAACH,OAAO,CAACyB,OAAO,CAACuL,MAAM,GAAG,CAAC;;QAE/C;QACA,IAAIoG,YAAY,IAAI5B,SAAS,IAAI4B,YAAY,IAAItE,QAAQ,CAACyV,UAAU,CAAC,IAAInR,YAAY,GAAG,CAAC,EAAE;UAC1FA,YAAY,GAAGmR,UAAU;QAC1B;;QAEA;QACA,IAAIpkB,GAAG,CAACgM,QAAQ,CAAC,sBAAsB,EAAEjM,EAAE,EAAEkT,YAAY,EAAEkR,YAAY,EAAExjB,YAAY,CAAC,KAAK,KAAK,EAAE;UACjG,OAAO,KAAK;QACb;;QAEA;QACA,IAAIoM,MAAM,CAACD,IAAI,CAAC9M,GAAG,CAACH,OAAO,CAAC+D,UAAU,CAAC,CAACiJ,MAAM,GAAG,CAAC,EAAE;UACnD,IAAI7M,GAAG,CAACkY,WAAW,CAACjF,YAAY,EAAEtS,YAAY,CAAC,CAACkM,MAAM,EAAE;YACvD,IAAI,CAAE+U,OAAO,CAAC5hB,GAAG,CAACH,OAAO,CAAC+H,IAAI,CAACyB,qDAAqD,CAAC,EAAE;cACtF,OAAO,KAAK;YACb,CAAC,MAAM;cACNrJ,GAAG,CAACiY,aAAa,CAAC,CAAC;YACpB;UACD;QACD;;QAEA;QACA,IAAI,CAAEiM,UAAU,EAAE;UACjBA,UAAU,GAAG,EAAE;QAChB;QAEA,KAAK,IAAIjX,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGkX,YAAY,EAAElX,CAAC,EAAE,EAAE;UACtC,IAAI,CAAEiX,UAAU,CAACjX,CAAC,CAAC,EAAE;YACpBiX,UAAU,CAACjX,CAAC,CAAC,GAAG;cAAElO,IAAI,EAAC,MAAM;cAAEoO,MAAM,EAAC,EAAE;cAAEtN,OAAO,EAAC,EAAE;cAAEyN,KAAK,EAACtN,GAAG,CAACH,OAAO,CAAC8B,eAAe;cAAE4L,KAAK,EAACvN,GAAG,CAACH,OAAO,CAAC+B;YAAgB,CAAC;UAC7H;QACD;;QAEA;QACA,IAAIyiB,WAAW,GAAI,CAAE1jB,YAAY,GAAIsS,YAAY,GAAG,CAAC,GAAGA,YAAY;QACpEjT,GAAG,CAACH,OAAO,CAACyB,OAAO,GAAG7C,MAAM,CAAC6lB,WAAW,CAACtkB,GAAG,CAACH,OAAO,CAACyB,OAAO,EAAE+iB,WAAW,EAAEH,UAAU,CAAC;;QAEtF;QACA,IAAIK,cAAc,GAAGvkB,GAAG,CAAC2K,OAAO,CAACsY,MAAM,CAACoB,WAAW,CAAC;QACpD,IAAIG,eAAe,GAAGxkB,GAAG,CAAC+K,QAAQ,CAACkY,MAAM,CAACoB,WAAW,CAAC;;QAEtD;QACA,IAAII,cAAc,GAAG,EAAE;QACvB,IAAIC,eAAe,GAAG,EAAE;QACxB,IAAIC,cAAc,GAAG,EAAE;QACvB,IAAIC,WAAW,GAAG,EAAE;QACpB,IAAIC,cAAc,GAAG,EAAE;;QAEvB;QACA,KAAK,IAAI3I,GAAG,GAAGmI,WAAW,EAAEnI,GAAG,GAAIiI,YAAY,GAAGE,WAAY,EAAEnI,GAAG,EAAE,EAAE;UACtElc,GAAG,CAACmP,gBAAgB,CAAC+M,GAAG,CAAC;UACzBlc,GAAG,CAACyK,eAAe,CAAC9J,YAAY,CAACX,GAAG,CAAC2K,OAAO,CAACuR,GAAG,CAAC,EAAElc,GAAG,CAACyK,eAAe,CAACoL,QAAQ,CAACqG,GAAG,GAAC,CAAC,CAAC,CAAC;UACvFlc,GAAG,CAAC0K,iBAAiB,CAAC/J,YAAY,CAACX,GAAG,CAAC+K,QAAQ,CAACmR,GAAG,CAAC,EAAElc,GAAG,CAAC0K,iBAAiB,CAACmL,QAAQ,CAACqG,GAAG,GAAC,CAAC,CAAC,CAAC;UAE5FuI,cAAc,CAACjX,IAAI,CAACxN,GAAG,CAAC2K,OAAO,CAACuR,GAAG,CAAC,CAAC;UACrCwI,eAAe,CAAClX,IAAI,CAACxN,GAAG,CAAC+K,QAAQ,CAACmR,GAAG,CAAC,CAAC;QACxC;;QAEA;QACA,IAAIlc,GAAG,CAACH,OAAO,CAACqF,OAAO,EAAE;UACxB,KAAK,IAAI+J,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjP,GAAG,CAACH,OAAO,CAACqF,OAAO,CAAC2H,MAAM,EAAEoC,CAAC,EAAE,EAAE;YACpD4V,cAAc,CAAC5V,CAAC,CAAC,GAAG,EAAE;YACtB,KAAK,IAAIhC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGkX,YAAY,EAAElX,CAAC,EAAE,EAAE;cACtC4X,cAAc,CAAC5V,CAAC,CAAC,CAACzB,IAAI,CAAC,EAAE,CAAC;YAC3B;YACAxN,GAAG,CAACH,OAAO,CAACqF,OAAO,CAAC+J,CAAC,CAAC,CAACgU,MAAM,CAACoB,WAAW,EAAE,CAAC,EAAEQ,cAAc,CAAC5V,CAAC,CAAC,CAAC;UACjE;QACD;;QAEA;QACA,KAAK,IAAI6B,GAAG,GAAG,CAAC,EAAEA,GAAG,GAAG9Q,GAAG,CAACH,OAAO,CAACoB,IAAI,CAAC4L,MAAM,EAAEiE,GAAG,EAAE,EAAE;UACvD;UACA,IAAI0S,WAAW,GAAGxjB,GAAG,CAACH,OAAO,CAACoB,IAAI,CAAC6P,GAAG,CAAC,CAACmS,MAAM,CAACoB,WAAW,CAAC;UAC3D,IAAIS,aAAa,GAAG9kB,GAAG,CAAC4K,OAAO,CAACkG,GAAG,CAAC,CAACmS,MAAM,CAACoB,WAAW,CAAC;;UAExD;UACAO,WAAW,CAAC9T,GAAG,CAAC,GAAG,EAAE;UACrB6T,cAAc,CAAC7T,GAAG,CAAC,GAAG,EAAE;UAExB,KAAK,IAAIoL,GAAG,GAAGmI,WAAW,EAAEnI,GAAG,GAAIiI,YAAY,GAAGE,WAAY,EAAEnI,GAAG,EAAE,EAAE;YACtE;YACA,IAAI7c,KAAK,GAAG4B,IAAI,CAAC6P,GAAG,CAAC,GAAG7P,IAAI,CAAC6P,GAAG,CAAC,GAAG,EAAE;YACtC9Q,GAAG,CAACH,OAAO,CAACoB,IAAI,CAAC6P,GAAG,CAAC,CAACoL,GAAG,CAAC,GAAG7c,KAAK;YAClC;YACA,IAAI+P,EAAE,GAAGpP,GAAG,CAACqT,UAAU,CAAC6I,GAAG,EAAEpL,GAAG,EAAE9Q,GAAG,CAACH,OAAO,CAACoB,IAAI,CAAC6P,GAAG,CAAC,CAACoL,GAAG,CAAC,CAAC;YAC7Dlc,GAAG,CAAC4K,OAAO,CAACkG,GAAG,CAAC,CAACoL,GAAG,CAAC,GAAG9M,EAAE;YAC1B;YACA,IAAIpP,GAAG,CAACqB,IAAI,CAACyP,GAAG,CAAC,EAAE;cAClB9Q,GAAG,CAACqB,IAAI,CAACyP,GAAG,CAAC,CAACnQ,YAAY,CAACyO,EAAE,EAAEpP,GAAG,CAACqB,IAAI,CAACyP,GAAG,CAAC,CAAC+E,QAAQ,CAACqG,GAAG,GAAC,CAAC,CAAC,CAAC;YAC9D;;YAEA;YACA0I,WAAW,CAAC9T,GAAG,CAAC,CAACtD,IAAI,CAACnO,KAAK,CAAC;YAC5BslB,cAAc,CAAC7T,GAAG,CAAC,CAACtD,IAAI,CAAC4B,EAAE,CAAC;UAC7B;;UAEA;UACA/C,KAAK,CAACC,SAAS,CAACkB,IAAI,CAACrB,KAAK,CAACnM,GAAG,CAACH,OAAO,CAACoB,IAAI,CAAC6P,GAAG,CAAC,EAAE0S,WAAW,CAAC;UAC9DnX,KAAK,CAACC,SAAS,CAACkB,IAAI,CAACrB,KAAK,CAACnM,GAAG,CAAC4K,OAAO,CAACkG,GAAG,CAAC,EAAEgU,aAAa,CAAC;QAC5D;QAEAzY,KAAK,CAACC,SAAS,CAACkB,IAAI,CAACrB,KAAK,CAACnM,GAAG,CAAC2K,OAAO,EAAE4Z,cAAc,CAAC;QACvDlY,KAAK,CAACC,SAAS,CAACkB,IAAI,CAACrB,KAAK,CAACnM,GAAG,CAAC+K,QAAQ,EAAEyZ,eAAe,CAAC;;QAEzD;QACA,IAAIxkB,GAAG,CAACH,OAAO,CAAC6B,aAAa,IAAI1B,GAAG,CAACH,OAAO,CAAC6B,aAAa,CAACmL,MAAM,GAAG,CAAC,EAAE;UACtE;UACA,IAAI7M,GAAG,CAACH,OAAO,CAAC6B,aAAa,CAAC,CAAC,CAAC,IAAI1B,GAAG,CAACH,OAAO,CAAC6B,aAAa,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;YACpE,KAAK,IAAIuN,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjP,GAAG,CAACH,OAAO,CAAC6B,aAAa,CAACmL,MAAM,EAAEoC,CAAC,EAAE,EAAE;cAC1D,IAAI+G,OAAO,GAAGrH,QAAQ,CAAC3O,GAAG,CAACH,OAAO,CAAC6B,aAAa,CAACuN,CAAC,CAAC,CAACjP,GAAG,CAACH,OAAO,CAAC6B,aAAa,CAACuN,CAAC,CAAC,CAACpC,MAAM,GAAC,CAAC,CAAC,CAACmJ,OAAO,CAAC,GAAGmO,YAAY;cAClHnkB,GAAG,CAACH,OAAO,CAAC6B,aAAa,CAACuN,CAAC,CAAC,CAACjP,GAAG,CAACH,OAAO,CAAC6B,aAAa,CAACuN,CAAC,CAAC,CAACpC,MAAM,GAAC,CAAC,CAAC,CAACmJ,OAAO,GAAGA,OAAO;cACrFhW,GAAG,CAACoK,KAAK,CAACyL,QAAQ,CAAC5G,CAAC,CAAC,CAAC4G,QAAQ,CAAC7V,GAAG,CAACoK,KAAK,CAACyL,QAAQ,CAAC5G,CAAC,CAAC,CAAC4G,QAAQ,CAAChJ,MAAM,GAAC,CAAC,CAAC,CAACmC,YAAY,CAAC,SAAS,EAAEgH,OAAO,CAAC;cACxG,IAAIxW,CAAC,GAAGQ,GAAG,CAACoK,KAAK,CAACyL,QAAQ,CAAC5G,CAAC,CAAC,CAAC4G,QAAQ,CAAC7V,GAAG,CAACoK,KAAK,CAACyL,QAAQ,CAAC5G,CAAC,CAAC,CAAC4G,QAAQ,CAAChJ,MAAM,GAAC,CAAC,CAAC,CAAC0J,YAAY,CAAC,aAAa,CAAC;cAC3G/W,CAAC,GAAGA,CAAC,CAACqU,KAAK,CAAC,GAAG,CAAC;cAChB,KAAK,IAAIqI,GAAG,GAAGmI,WAAW,EAAEnI,GAAG,GAAIiI,YAAY,GAAGE,WAAY,EAAEnI,GAAG,EAAE,EAAE;gBACtE1c,CAAC,CAACgO,IAAI,CAAC0O,GAAG,CAAC;cACZ;cACAlc,GAAG,CAACoK,KAAK,CAACyL,QAAQ,CAAC5G,CAAC,CAAC,CAAC4G,QAAQ,CAAC7V,GAAG,CAACoK,KAAK,CAACyL,QAAQ,CAAC5G,CAAC,CAAC,CAAC4G,QAAQ,CAAChJ,MAAM,GAAC,CAAC,CAAC,CAACmC,YAAY,CAAC,aAAa,EAAExP,CAAC,CAAC;YACvG;UACD,CAAC,MAAM;YACN,IAAIwW,OAAO,GAAGrH,QAAQ,CAAC3O,GAAG,CAACH,OAAO,CAAC6B,aAAa,CAAC,CAAC,CAAC,CAACsU,OAAO,CAAC,GAAGmO,YAAY;YAC3EnkB,GAAG,CAACH,OAAO,CAAC6B,aAAa,CAAC,CAAC,CAAC,CAACsU,OAAO,GAAGA,OAAO;YAC9ChW,GAAG,CAACoK,KAAK,CAACyL,QAAQ,CAAC,CAAC,CAAC,CAACA,QAAQ,CAAC7V,GAAG,CAACoK,KAAK,CAACyL,QAAQ,CAAC,CAAC,CAAC,CAACA,QAAQ,CAAChJ,MAAM,GAAC,CAAC,CAAC,CAACmC,YAAY,CAAC,SAAS,EAAEgH,OAAO,CAAC;UACzG;QACD;;QAEA;QACAhW,GAAG,CAAC0X,UAAU,CAAC;UACdC,MAAM,EAAE,cAAc;UACtB1E,YAAY,EAACA,YAAY;UACzBkR,YAAY,EAACA,YAAY;UACzBxjB,YAAY,EAACA,YAAY;UACzBW,OAAO,EAAC4iB,UAAU;UAClBvZ,OAAO,EAAC8Z,cAAc;UACtB1Z,QAAQ,EAAC2Z,eAAe;UACxB9Z,OAAO,EAAC+Z,cAAc;UACtBzf,OAAO,EAAC2f,cAAc;UACtB5jB,IAAI,EAAC2jB;QACN,CAAC,CAAC;;QAEF;QACA5kB,GAAG,CAAC0iB,qBAAqB,CAAC,CAAC;;QAE3B;QACA1iB,GAAG,CAACgM,QAAQ,CAAC,gBAAgB,EAAEjM,EAAE,EAAEkT,YAAY,EAAEkR,YAAY,EAAEQ,cAAc,EAAEhkB,YAAY,CAAC;MAC7F;IACD,CAAC;;IAED;AACF;AACA;AACA;AACA;AACA;AACA;IACEX,GAAG,CAAC+kB,YAAY,GAAG,UAAS9R,YAAY,EAAEkR,YAAY,EAAE;MACvD;MACA,IAAInkB,GAAG,CAACH,OAAO,CAACmD,iBAAiB,IAAI,IAAI,EAAE;QAC1C,IAAIhD,GAAG,CAAC2K,OAAO,CAACkC,MAAM,GAAG,CAAC,EAAE;UAC3B;UACA,IAAIoG,YAAY,IAAI5B,SAAS,EAAE;YAC9B,IAAIwS,MAAM,GAAG7jB,GAAG,CAACglB,kBAAkB,CAAC,IAAI,CAAC;YAEzC,IAAI,CAAEnB,MAAM,CAAChX,MAAM,EAAE;cACpB;cACAoG,YAAY,GAAGjT,GAAG,CAAC2K,OAAO,CAACkC,MAAM,GAAG,CAAC;cACrCsX,YAAY,GAAG,CAAC;YACjB,CAAC,MAAM;cACN;cACAlR,YAAY,GAAGtE,QAAQ,CAACkV,MAAM,CAAC,CAAC,CAAC,CAAC;cAClCM,YAAY,GAAGxV,QAAQ,CAACkV,MAAM,CAAChX,MAAM,CAAC;YACvC;UACD;;UAEA;UACA,IAAIuX,UAAU,GAAGpkB,GAAG,CAACH,OAAO,CAACoB,IAAI,CAAC,CAAC,CAAC,CAAC4L,MAAM,GAAG,CAAC;UAE/C,IAAIoG,YAAY,IAAI5B,SAAS,IAAI4B,YAAY,GAAGmR,UAAU,IAAInR,YAAY,GAAG,CAAC,EAAE;YAC/EA,YAAY,GAAGmR,UAAU;UAC1B;;UAEA;UACA,IAAI,CAAED,YAAY,EAAE;YACnBA,YAAY,GAAG,CAAC;UACjB;;UAEA;UACA,IAAIA,YAAY,GAAGnkB,GAAG,CAACH,OAAO,CAACoB,IAAI,CAAC,CAAC,CAAC,CAAC4L,MAAM,GAAGoG,YAAY,EAAE;YAC7DkR,YAAY,GAAGnkB,GAAG,CAACH,OAAO,CAACoB,IAAI,CAAC,CAAC,CAAC,CAAC4L,MAAM,GAAGoG,YAAY;UACzD;;UAEA;UACA,IAAIjT,GAAG,CAACgM,QAAQ,CAAC,sBAAsB,EAAEjM,EAAE,EAAEkT,YAAY,EAAEkR,YAAY,CAAC,KAAK,KAAK,EAAE;YACnF,OAAO,KAAK;UACb;;UAEA;UACA,IAAIxV,QAAQ,CAACsE,YAAY,CAAC,GAAG,CAAC,CAAC,EAAE;YAChC;YACA,IAAI8Q,WAAW,GAAG,KAAK;YACvB,IAAIhX,MAAM,CAACD,IAAI,CAAC9M,GAAG,CAACH,OAAO,CAAC+D,UAAU,CAAC,CAACiJ,MAAM,GAAG,CAAC,EAAE;cACnD,KAAK,IAAIqP,GAAG,GAAGjJ,YAAY,EAAEiJ,GAAG,GAAGjJ,YAAY,GAAGkR,YAAY,EAAEjI,GAAG,EAAE,EAAE;gBACtE,IAAIlc,GAAG,CAACkY,WAAW,CAACgE,GAAG,EAAE,KAAK,CAAC,CAACrP,MAAM,EAAE;kBACvCkX,WAAW,GAAG,IAAI;gBACnB;cACD;YACD;YACA,IAAIA,WAAW,EAAE;cAChB,IAAI,CAAEnC,OAAO,CAAC5hB,GAAG,CAACH,OAAO,CAAC+H,IAAI,CAACyB,qDAAqD,CAAC,EAAE;gBACtF,OAAO,KAAK;cACb,CAAC,MAAM;gBACNrJ,GAAG,CAACiY,aAAa,CAAC,CAAC;cACpB;YACD;;YAEA;YACA,IAAI3W,OAAO,GAAGtB,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2hB,MAAM,CAAChQ,YAAY,EAAEkR,YAAY,CAAC;YAEpE,KAAK,IAAIjI,GAAG,GAAGjJ,YAAY,EAAEiJ,GAAG,GAAGjJ,YAAY,GAAGkR,YAAY,EAAEjI,GAAG,EAAE,EAAE;cACtElc,GAAG,CAAC+K,QAAQ,CAACmR,GAAG,CAAC,CAAC7M,SAAS,GAAG,EAAE;cAChCrP,GAAG,CAAC2K,OAAO,CAACuR,GAAG,CAAC,CAAC7M,SAAS,GAAG,EAAE;cAC/BrP,GAAG,CAAC+K,QAAQ,CAACmR,GAAG,CAAC,CAACxb,UAAU,CAACsb,WAAW,CAAChc,GAAG,CAAC+K,QAAQ,CAACmR,GAAG,CAAC,CAAC;cAC3Dlc,GAAG,CAAC2K,OAAO,CAACuR,GAAG,CAAC,CAACxb,UAAU,CAACsb,WAAW,CAAChc,GAAG,CAAC2K,OAAO,CAACuR,GAAG,CAAC,CAAC;YAC1D;YAEA,IAAIuI,cAAc,GAAGzkB,GAAG,CAAC2K,OAAO,CAACsY,MAAM,CAAChQ,YAAY,EAAEkR,YAAY,CAAC;YACnE,IAAIO,eAAe,GAAG1kB,GAAG,CAAC+K,QAAQ,CAACkY,MAAM,CAAChQ,YAAY,EAAEkR,YAAY,CAAC;YACrE,IAAIQ,cAAc,GAAG,EAAE;YACvB,IAAIC,WAAW,GAAG,EAAE;YACpB,IAAIC,cAAc,GAAG,EAAE;YAEvB,KAAK,IAAI/T,GAAG,GAAG,CAAC,EAAEA,GAAG,GAAG9Q,GAAG,CAACH,OAAO,CAACoB,IAAI,CAAC4L,MAAM,EAAEiE,GAAG,EAAE,EAAE;cACvD,KAAK,IAAIoL,GAAG,GAAGjJ,YAAY,EAAEiJ,GAAG,GAAGjJ,YAAY,GAAGkR,YAAY,EAAEjI,GAAG,EAAE,EAAE;gBACtElc,GAAG,CAAC4K,OAAO,CAACkG,GAAG,CAAC,CAACoL,GAAG,CAAC,CAAC7M,SAAS,GAAG,EAAE;gBACpCrP,GAAG,CAAC4K,OAAO,CAACkG,GAAG,CAAC,CAACoL,GAAG,CAAC,CAACxb,UAAU,CAACsb,WAAW,CAAChc,GAAG,CAAC4K,OAAO,CAACkG,GAAG,CAAC,CAACoL,GAAG,CAAC,CAAC;cACpE;YACD;;YAEA;YACA,KAAK,IAAIpL,GAAG,GAAG,CAAC,EAAEA,GAAG,GAAG9Q,GAAG,CAACH,OAAO,CAACoB,IAAI,CAAC4L,MAAM,EAAEiE,GAAG,EAAE,EAAE;cACvD;cACA8T,WAAW,CAAC9T,GAAG,CAAC,GAAG9Q,GAAG,CAACH,OAAO,CAACoB,IAAI,CAAC6P,GAAG,CAAC,CAACmS,MAAM,CAAChQ,YAAY,EAAEkR,YAAY,CAAC;cAC3EQ,cAAc,CAAC7T,GAAG,CAAC,GAAG9Q,GAAG,CAAC4K,OAAO,CAACkG,GAAG,CAAC,CAACmS,MAAM,CAAChQ,YAAY,EAAEkR,YAAY,CAAC;YAC1E;;YAEA;YACA,IAAInkB,GAAG,CAACH,OAAO,CAACqF,OAAO,EAAE;cACxB,KAAK,IAAI4L,GAAG,GAAG,CAAC,EAAEA,GAAG,GAAG9Q,GAAG,CAACH,OAAO,CAACqF,OAAO,CAAC2H,MAAM,EAAEiE,GAAG,EAAE,EAAE;gBAC1D+T,cAAc,CAAC/T,GAAG,CAAC,GAAG9Q,GAAG,CAACH,OAAO,CAACqF,OAAO,CAAC4L,GAAG,CAAC,CAACmS,MAAM,CAAChQ,YAAY,EAAEkR,YAAY,CAAC;cAClF;YACD;;YAEA;YACAnkB,GAAG,CAACqd,0BAA0B,CAAC,CAAC,EAAEpK,YAAY,EAAGA,YAAY,GAAGkR,YAAY,GAAI,CAAC,CAAC;;YAElF;YACA,IAAInkB,GAAG,CAACH,OAAO,CAAC6B,aAAa,IAAI1B,GAAG,CAACH,OAAO,CAAC6B,aAAa,CAACmL,MAAM,GAAG,CAAC,EAAE;cACtE;cACA,IAAI7M,GAAG,CAACH,OAAO,CAAC6B,aAAa,CAAC,CAAC,CAAC,IAAI1B,GAAG,CAACH,OAAO,CAAC6B,aAAa,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;gBACpE,KAAK,IAAIuN,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjP,GAAG,CAACH,OAAO,CAAC6B,aAAa,CAACmL,MAAM,EAAEoC,CAAC,EAAE,EAAE;kBAC1D,IAAI+G,OAAO,GAAGrH,QAAQ,CAAC3O,GAAG,CAACH,OAAO,CAAC6B,aAAa,CAACuN,CAAC,CAAC,CAACjP,GAAG,CAACH,OAAO,CAAC6B,aAAa,CAACuN,CAAC,CAAC,CAACpC,MAAM,GAAC,CAAC,CAAC,CAACmJ,OAAO,CAAC,GAAGmO,YAAY;kBAClHnkB,GAAG,CAACH,OAAO,CAAC6B,aAAa,CAACuN,CAAC,CAAC,CAACjP,GAAG,CAACH,OAAO,CAAC6B,aAAa,CAACuN,CAAC,CAAC,CAACpC,MAAM,GAAC,CAAC,CAAC,CAACmJ,OAAO,GAAGA,OAAO;kBACrFhW,GAAG,CAACoK,KAAK,CAACyL,QAAQ,CAAC5G,CAAC,CAAC,CAAC4G,QAAQ,CAAC7V,GAAG,CAACoK,KAAK,CAACyL,QAAQ,CAAC5G,CAAC,CAAC,CAAC4G,QAAQ,CAAChJ,MAAM,GAAC,CAAC,CAAC,CAACmC,YAAY,CAAC,SAAS,EAAEgH,OAAO,CAAC;gBACzG;cACD,CAAC,MAAM;gBACN,IAAIA,OAAO,GAAGrH,QAAQ,CAAC3O,GAAG,CAACH,OAAO,CAAC6B,aAAa,CAAC,CAAC,CAAC,CAACsU,OAAO,CAAC,GAAGmO,YAAY;gBAC3EnkB,GAAG,CAACH,OAAO,CAAC6B,aAAa,CAAC,CAAC,CAAC,CAACsU,OAAO,GAAGA,OAAO;gBAC9ChW,GAAG,CAACoK,KAAK,CAACyL,QAAQ,CAAC,CAAC,CAAC,CAACA,QAAQ,CAAC7V,GAAG,CAACoK,KAAK,CAACyL,QAAQ,CAAC,CAAC,CAAC,CAACA,QAAQ,CAAChJ,MAAM,GAAC,CAAC,CAAC,CAACmC,YAAY,CAAC,SAAS,EAAEgH,OAAO,CAAC;cACzG;YACD;;YAEA;YACAhW,GAAG,CAAC0X,UAAU,CAAC;cACdC,MAAM,EAAC,cAAc;cACrB1E,YAAY,EAACA,YAAY;cACzBkR,YAAY,EAACA,YAAY;cACzBxjB,YAAY,EAAE,CAAC;cACfW,OAAO,EAACA,OAAO;cACfqJ,OAAO,EAAC8Z,cAAc;cACtB1Z,QAAQ,EAAC2Z,eAAe;cACxB9Z,OAAO,EAAC+Z,cAAc;cACtBzf,OAAO,EAAC2f,cAAc;cACtB5jB,IAAI,EAAC2jB;YACN,CAAC,CAAC;;YAEF;YACA5kB,GAAG,CAAC0iB,qBAAqB,CAAC,CAAC;;YAE3B;YACA1iB,GAAG,CAACgM,QAAQ,CAAC,gBAAgB,EAAEjM,EAAE,EAAEkT,YAAY,EAAEkR,YAAY,EAAEQ,cAAc,CAAC;UAC/E;QACD,CAAC,MAAM;UACNxkB,OAAO,CAACC,KAAK,CAAC,4DAA4D,CAAC;QAC5E;MACD;IACD,CAAC;;IAED;AACF;AACA;AACA;AACA;IACEJ,GAAG,CAAC8jB,eAAe,GAAG,UAASmB,KAAK,EAAE;MACrC,IAAI5jB,IAAI,GAAG,EAAE;MACb;MACA,KAAK,IAAI4N,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjP,GAAG,CAACqB,IAAI,CAACwL,MAAM,EAAEoC,CAAC,EAAE,EAAE;QACzC,IAAIjP,GAAG,CAACqB,IAAI,CAAC4N,CAAC,CAAC,CAACnD,SAAS,CAACuG,QAAQ,CAAC,UAAU,CAAC,EAAE;UAC/C,IAAI4S,KAAK,EAAE;YACV5jB,IAAI,CAACmM,IAAI,CAACyB,CAAC,CAAC;UACb,CAAC,MAAM;YACN5N,IAAI,CAACmM,IAAI,CAACxN,GAAG,CAACqB,IAAI,CAAC4N,CAAC,CAAC,CAAC;UACvB;QACD;MACD;MAEA,OAAO5N,IAAI;IACZ,CAAC;IAED;AACF;AACA;AACA;AACA;IACErB,GAAG,CAACglB,kBAAkB,GAAG,YAAW;MACnC,IAAI7M,IAAI,GAAG,EAAE;MACb;MACA,KAAK,IAAIlL,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjN,GAAG,CAAC2K,OAAO,CAACkC,MAAM,EAAEI,CAAC,EAAE,EAAE;QAC5C,IAAIjN,GAAG,CAAC2K,OAAO,CAACsC,CAAC,CAAC,CAACnB,SAAS,CAACuG,QAAQ,CAAC,UAAU,CAAC,EAAE;UAClD8F,IAAI,CAAC3K,IAAI,CAACP,CAAC,CAAC;QACb;MACD;MAEA,OAAOkL,IAAI;IACZ,CAAC;;IAED;AACF;AACA;AACA;AACA;IACEnY,GAAG,CAACklB,cAAc,GAAG,YAAW;MAC/B,OAAOllB,GAAG,CAACiL,WAAW;IACvB,CAAC;;IAED;AACF;AACA;AACA;AACA;IACEjL,GAAG,CAAC0iB,qBAAqB,GAAG,YAAW;MACtC;MACA,KAAK,IAAIzV,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjN,GAAG,CAAC2K,OAAO,CAACkC,MAAM,EAAEI,CAAC,EAAE,EAAE;QAC5C,IAAIkF,CAAC,GAAGnS,GAAG,CAAC2K,OAAO,CAACsC,CAAC,CAAC,CAACsJ,YAAY,CAAC,QAAQ,CAAC;QAE7C,IAAIpE,CAAC,IAAIlF,CAAC,EAAE;UACX;UACAjN,GAAG,CAAC2K,OAAO,CAACsC,CAAC,CAAC,CAAC+B,YAAY,CAAC,QAAQ,EAAE/B,CAAC,CAAC;UACxC;UACA,IAAI,CAAEjN,GAAG,CAAC2K,OAAO,CAACsC,CAAC,CAAC,CAACsJ,YAAY,CAAC,OAAO,CAAC,EAAE;YAC3CvW,GAAG,CAAC2K,OAAO,CAACsC,CAAC,CAAC,CAAC6B,SAAS,GAAGrQ,MAAM,CAACiX,aAAa,CAACzI,CAAC,CAAC;UACnD;QACD;MACD;;MAEA;MACA,KAAK,IAAIgC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjP,GAAG,CAACqB,IAAI,CAACwL,MAAM,EAAEoC,CAAC,EAAE,EAAE;QACzC,IAAIjP,GAAG,CAACqB,IAAI,CAAC4N,CAAC,CAAC,EAAE;UAChB,IAAImD,CAAC,GAAGpS,GAAG,CAACqB,IAAI,CAAC4N,CAAC,CAAC,CAACsH,YAAY,CAAC,QAAQ,CAAC;UAE1C,IAAInE,CAAC,IAAInD,CAAC,EAAE;YACX;YACAjP,GAAG,CAACqB,IAAI,CAAC4N,CAAC,CAAC,CAACD,YAAY,CAAC,QAAQ,EAAEC,CAAC,CAAC;YACrCjP,GAAG,CAACqB,IAAI,CAAC4N,CAAC,CAAC,CAAC4G,QAAQ,CAAC,CAAC,CAAC,CAAC7G,YAAY,CAAC,QAAQ,EAAEC,CAAC,CAAC;YACjD;YACAjP,GAAG,CAACqB,IAAI,CAAC4N,CAAC,CAAC,CAAC4G,QAAQ,CAAC,CAAC,CAAC,CAAC/G,SAAS,GAAGG,CAAC,GAAG,CAAC;UAC1C;QACD;MACD;;MAEA;MACA,IAAI0N,cAAc,GAAG,EAAE;MACvB,IAAIwI,gBAAgB,GAAG,EAAE;;MAEzB;MACA,IAAIC,cAAc,GAAG,SAAAA,CAASjT,CAAC,EAACC,CAAC,EAACnF,CAAC,EAACgC,CAAC,EAAE;QACtC,IAAIkD,CAAC,IAAIlF,CAAC,EAAE;UACXjN,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAAChC,CAAC,CAAC,CAAC+B,YAAY,CAAC,QAAQ,EAAE/B,CAAC,CAAC;QAC5C;QACA,IAAImF,CAAC,IAAInD,CAAC,EAAE;UACXjP,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAAChC,CAAC,CAAC,CAAC+B,YAAY,CAAC,QAAQ,EAAEC,CAAC,CAAC;QAC5C;;QAEA;QACA,IAAIkD,CAAC,IAAIlF,CAAC,IAAImF,CAAC,IAAInD,CAAC,EAAE;UACrB,IAAIoW,YAAY,GAAG5mB,MAAM,CAACqU,mBAAmB,CAAC,CAACX,CAAC,EAAEC,CAAC,CAAC,CAAC;UACrD,IAAIkT,UAAU,GAAG7mB,MAAM,CAACqU,mBAAmB,CAAC,CAAC7F,CAAC,EAAEgC,CAAC,CAAC,CAAC;UACnD0N,cAAc,CAAC0I,YAAY,CAAC,GAAGC,UAAU;QAC1C;MACD,CAAC;MAED,KAAK,IAAIrW,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjP,GAAG,CAAC4K,OAAO,CAACiC,MAAM,EAAEoC,CAAC,EAAE,EAAE;QAC5C,KAAK,IAAIhC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjN,GAAG,CAAC4K,OAAO,CAAC,CAAC,CAAC,CAACiC,MAAM,EAAEI,CAAC,EAAE,EAAE;UAC/C,IAAIjN,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAAChC,CAAC,CAAC,EAAE;YACtB;YACA,IAAIkF,CAAC,GAAGnS,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAAChC,CAAC,CAAC,CAACsJ,YAAY,CAAC,QAAQ,CAAC;YAChD,IAAInE,CAAC,GAAGpS,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAAChC,CAAC,CAAC,CAACsJ,YAAY,CAAC,QAAQ,CAAC;;YAEhD;YACA,IAAIvW,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAAChC,CAAC,CAAC,CAACsJ,YAAY,CAAC,aAAa,CAAC,EAAE;cAClD,IAAI8O,YAAY,GAAG5mB,MAAM,CAACqU,mBAAmB,CAAC,CAACX,CAAC,EAAEC,CAAC,CAAC,CAAC;cACrD,IAAIkT,UAAU,GAAG7mB,MAAM,CAACqU,mBAAmB,CAAC,CAAC7F,CAAC,EAAEgC,CAAC,CAAC,CAAC;cACnD,IAAIkW,gBAAgB,CAACE,YAAY,CAAC,IAAI,IAAI,EAAE;gBAC3C,IAAIA,YAAY,IAAIC,UAAU,EAAE;kBAC/BH,gBAAgB,CAACE,YAAY,CAAC,GAAG,KAAK;gBACvC,CAAC,MAAM;kBACN,IAAIE,MAAM,GAAG5W,QAAQ,CAAC1B,CAAC,GAAGkF,CAAC,CAAC;kBAC5B,IAAIqT,MAAM,GAAG7W,QAAQ,CAACM,CAAC,GAAGmD,CAAC,CAAC;kBAC5B+S,gBAAgB,CAACE,YAAY,CAAC,GAAG,CAAEC,UAAU,EAAEC,MAAM,EAAEC,MAAM,CAAE;gBAChE;cACD;YACD,CAAC,MAAM;cACNJ,cAAc,CAACjT,CAAC,EAACC,CAAC,EAACnF,CAAC,EAACgC,CAAC,CAAC;YACxB;UACD;QACD;MACD;;MAEA;MACA,IAAInC,IAAI,GAAGC,MAAM,CAACD,IAAI,CAACqY,gBAAgB,CAAC;MACxC,IAAIrY,IAAI,CAACD,MAAM,EAAE;QAChB,KAAK,IAAII,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGH,IAAI,CAACD,MAAM,EAAEI,CAAC,EAAE,EAAE;UACrC,IAAIkY,gBAAgB,CAACrY,IAAI,CAACG,CAAC,CAAC,CAAC,EAAE;YAC9B,IAAIrO,IAAI,GAAGH,MAAM,CAAC6R,mBAAmB,CAACxD,IAAI,CAACG,CAAC,CAAC,EAAE,IAAI,CAAC;YACpD,IAAIkF,CAAC,GAAGvT,IAAI,CAAC,CAAC,CAAC;YACf,IAAIwT,CAAC,GAAGxT,IAAI,CAAC,CAAC,CAAC;YACfwmB,cAAc,CAACjT,CAAC,EAACC,CAAC,EAACD,CAAC,GAAGgT,gBAAgB,CAACrY,IAAI,CAACG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAACmF,CAAC,GAAG+S,gBAAgB,CAACrY,IAAI,CAACG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YAErF,IAAIoY,YAAY,GAAGvY,IAAI,CAACG,CAAC,CAAC;YAC1B,IAAIqY,UAAU,GAAGH,gBAAgB,CAACrY,IAAI,CAACG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YAC7C,KAAK,IAAIgC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjP,GAAG,CAACH,OAAO,CAAC+D,UAAU,CAACyhB,YAAY,CAAC,CAAC,CAAC,CAAC,CAACxY,MAAM,EAAEoC,CAAC,EAAE,EAAE;cACxE,IAAIkD,CAAC,GAAGxD,QAAQ,CAAC3O,GAAG,CAACH,OAAO,CAAC+D,UAAU,CAACyhB,YAAY,CAAC,CAAC,CAAC,CAAC,CAACpW,CAAC,CAAC,CAACsH,YAAY,CAAC,QAAQ,CAAC,CAAC;cACnF,IAAInE,CAAC,GAAGzD,QAAQ,CAAC3O,GAAG,CAACH,OAAO,CAAC+D,UAAU,CAACyhB,YAAY,CAAC,CAAC,CAAC,CAAC,CAACpW,CAAC,CAAC,CAACsH,YAAY,CAAC,QAAQ,CAAC,CAAC;cACnFvW,GAAG,CAACH,OAAO,CAAC+D,UAAU,CAACyhB,YAAY,CAAC,CAAC,CAAC,CAAC,CAACpW,CAAC,CAAC,CAACD,YAAY,CAAC,QAAQ,EAAEmD,CAAC,GAAGgT,gBAAgB,CAACrY,IAAI,CAACG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;cACnGjN,GAAG,CAACH,OAAO,CAAC+D,UAAU,CAACyhB,YAAY,CAAC,CAAC,CAAC,CAAC,CAACpW,CAAC,CAAC,CAACD,YAAY,CAAC,QAAQ,EAAEoD,CAAC,GAAG+S,gBAAgB,CAACrY,IAAI,CAACG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YACpG;YAEAjN,GAAG,CAACH,OAAO,CAAC+D,UAAU,CAAC0hB,UAAU,CAAC,GAAGtlB,GAAG,CAACH,OAAO,CAAC+D,UAAU,CAACyhB,YAAY,CAAC;YACzE,OAAOrlB,GAAG,CAACH,OAAO,CAAC+D,UAAU,CAACyhB,YAAY,CAAE;UAC7C;QACD;MACD;;MAEA;MACArlB,GAAG,CAACylB,cAAc,CAAC9I,cAAc,CAAC;;MAElC;MACA3c,GAAG,CAAC2gB,UAAU,CAAChE,cAAc,CAAC;;MAE9B;MACA3c,GAAG,CAACqZ,gBAAgB,CAAC,CAAC;;MAEtB;MACArZ,GAAG,CAACyH,WAAW,CAAC,CAAC;IAClB,CAAC;;IAED;AACF;AACA;IACEzH,GAAG,CAACyH,WAAW,GAAG,YAAW;MAC5B;MACA,IAAIzH,GAAG,CAACH,OAAO,CAACiC,YAAY,GAAG,CAAC,EAAE;QACjC,IAAI4jB,YAAY,GAAG,CAAC;QACpB,KAAK,IAAIzW,CAAC,GAAGjP,GAAG,CAACqB,IAAI,CAACwL,MAAM,GAAG,CAAC,EAAEoC,CAAC,IAAI,CAAC,EAAEA,CAAC,EAAE,EAAE;UAC9C,IAAIgI,IAAI,GAAG,KAAK;UAChB,KAAK,IAAIhK,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjN,GAAG,CAAC2K,OAAO,CAACkC,MAAM,EAAEI,CAAC,EAAE,EAAE;YAC5C,IAAIjN,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACgO,CAAC,CAAC,CAAChC,CAAC,CAAC,EAAE;cAC3BgK,IAAI,GAAG,IAAI;YACZ;UACD;UACA,IAAIA,IAAI,EAAE;YACT;UACD,CAAC,MAAM;YACNyO,YAAY,EAAE;UACf;QACD;QAEA,IAAI1lB,GAAG,CAACH,OAAO,CAACiC,YAAY,GAAG4jB,YAAY,GAAG,CAAC,EAAE;UAChD1lB,GAAG,CAACkjB,SAAS,CAACljB,GAAG,CAACH,OAAO,CAACiC,YAAY,GAAG4jB,YAAY,CAAC;QACvD;MACD;MAEA,IAAI1lB,GAAG,CAACH,OAAO,CAACkC,YAAY,GAAG,CAAC,EAAE;QACjC,IAAI4jB,YAAY,GAAG,CAAC;QACpB,KAAK,IAAI1Y,CAAC,GAAGjN,GAAG,CAAC2K,OAAO,CAACkC,MAAM,GAAG,CAAC,EAAEI,CAAC,IAAI,CAAC,EAAGA,CAAC,EAAE,EAAE;UAClD,IAAIgK,IAAI,GAAG,KAAK;UAChB,KAAK,IAAIhI,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjP,GAAG,CAACqB,IAAI,CAACwL,MAAM,EAAEoC,CAAC,EAAE,EAAE;YACzC,IAAIjP,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACgO,CAAC,CAAC,CAAChC,CAAC,CAAC,EAAE;cAC3BgK,IAAI,GAAG,IAAI;YACZ;UACD;UACA,IAAIA,IAAI,EAAE;YACT;UACD,CAAC,MAAM;YACN0O,YAAY,EAAE;UACf;QACD;QAEA,IAAI3lB,GAAG,CAACH,OAAO,CAACkC,YAAY,GAAG4jB,YAAY,GAAG,CAAC,EAAE;UAChD3lB,GAAG,CAACikB,YAAY,CAACjkB,GAAG,CAACH,OAAO,CAACkC,YAAY,GAAG4jB,YAAY,CAAC;QAC1D;MACD;;MAEA;MACA,IAAI,OAAO3lB,GAAG,CAACH,OAAO,CAAC4H,WAAY,IAAI,UAAU,EAAE;QAClD,IAAIzH,GAAG,CAACH,OAAO,CAAC6H,gBAAgB,EAAE;UACjC3H,EAAE,CAACic,WAAW,CAAChc,GAAG,CAACkK,OAAO,CAAC;QAC5B;QAEA,KAAK,IAAI+E,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjP,GAAG,CAACqB,IAAI,CAACwL,MAAM,EAAEoC,CAAC,EAAE,EAAE;UACzC,KAAK,IAAIhC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjN,GAAG,CAAC2K,OAAO,CAACkC,MAAM,EAAEI,CAAC,EAAE,EAAE;YAC5CjN,GAAG,CAACH,OAAO,CAAC4H,WAAW,CAAC1H,EAAE,EAAEC,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAAChC,CAAC,CAAC,EAAEA,CAAC,EAAEgC,CAAC,EAAEjP,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACgO,CAAC,CAAC,CAAChC,CAAC,CAAC,EAAEjN,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAAChC,CAAC,CAAC,CAACqH,WAAW,EAAE7V,MAAM,CAACqU,mBAAmB,CAAC,CAAC7F,CAAC,EAAEgC,CAAC,CAAC,CAAC,CAAC;UAChJ;QACD;QAEA,IAAIjP,GAAG,CAACH,OAAO,CAAC6H,gBAAgB,EAAE;UACjC3H,EAAE,CAACY,YAAY,CAACX,GAAG,CAACkK,OAAO,EAAElK,GAAG,CAAC+D,UAAU,CAAC;QAC7C;MACD;;MAEA;MACA,IAAI/D,GAAG,CAACH,OAAO,CAACqF,OAAO,EAAE;QACxBlF,GAAG,CAACggB,SAAS,CAAC,CAAC;MAChB;;MAEA;MACA4F,UAAU,CAAC,YAAW;QACrB5lB,GAAG,CAAC0a,oBAAoB,CAAC,CAAC;MAC3B,CAAC,EAAC,CAAC,CAAC;IACL,CAAC;;IAED;AACF;AACA;IACE1a,GAAG,CAAC6lB,UAAU,GAAG,UAASxV,IAAI,EAAE;MAC/B,IAAIA,IAAI,GAAGrQ,GAAG,CAACkb,OAAO,CAAC7K,IAAI,CAAC,EAAE;QAC7B,OAAOA,IAAI,CAACvE,SAAS,CAACuG,QAAQ,CAAC,UAAU,CAAC,GAAG,IAAI,GAAG,KAAK;MAC1D;IACD,CAAC;;IAED;AACF;AACA;IACErS,GAAG,CAAC8lB,WAAW,GAAG,UAASzV,IAAI,EAAE0V,KAAK,EAAE;MACvC,IAAI1V,IAAI,GAAGrQ,GAAG,CAACkb,OAAO,CAAC7K,IAAI,CAAC,EAAE;QAC7B,IAAI0V,KAAK,EAAE;UACV1V,IAAI,CAACvE,SAAS,CAACC,GAAG,CAAC,UAAU,CAAC;QAC/B,CAAC,MAAM;UACNsE,IAAI,CAACvE,SAAS,CAAClL,MAAM,CAAC,UAAU,CAAC;QAClC;MACD;IACD,CAAC;;IAED;AACF;AACA;IACEZ,GAAG,CAACgmB,OAAO,GAAG,UAASzT,SAAS,EAAE;MACjCvS,GAAG,CAACqB,IAAI,CAACkR,SAAS,CAAC,CAAC9N,KAAK,CAAC6K,OAAO,GAAG,EAAE;IACvC,CAAC;;IAED;AACF;AACA;IACEtP,GAAG,CAACimB,OAAO,GAAG,UAAS1T,SAAS,EAAE;MACjCvS,GAAG,CAACqB,IAAI,CAACkR,SAAS,CAAC,CAAC9N,KAAK,CAAC6K,OAAO,GAAG,MAAM;IAC3C,CAAC;;IAED;AACF;AACA;IACEtP,GAAG,CAACkmB,UAAU,GAAG,UAAS/S,SAAS,EAAE;MACpCnT,GAAG,CAAC2K,OAAO,CAACwI,SAAS,CAAC,CAAC1O,KAAK,CAAC6K,OAAO,GAAG,EAAE;MACzCtP,GAAG,CAAC+K,QAAQ,CAACoI,SAAS,CAAC,CAAC1O,KAAK,CAAC6K,OAAO,GAAG,EAAE;MAC1C,IAAItP,GAAG,CAACoL,MAAM,IAAIpL,GAAG,CAACoL,MAAM,CAACyK,QAAQ,CAAChJ,MAAM,GAAGsG,SAAS,GAAG,CAAC,EAAE;QAC7DnT,GAAG,CAACoL,MAAM,CAACyK,QAAQ,CAAC1C,SAAS,GAAG,CAAC,CAAC,CAAC1O,KAAK,CAAC6K,OAAO,GAAG,EAAE;MACtD;MACA,KAAK,IAAIL,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjP,GAAG,CAACH,OAAO,CAACoB,IAAI,CAAC4L,MAAM,EAAEoC,CAAC,EAAE,EAAE;QACjDjP,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAACkE,SAAS,CAAC,CAAC1O,KAAK,CAAC6K,OAAO,GAAG,EAAE;MAC7C;;MAEA;MACA,IAAItP,GAAG,CAACH,OAAO,CAACqF,OAAO,EAAE;QACxBlF,GAAG,CAACggB,SAAS,CAAC,CAAC;MAChB;MAEAhgB,GAAG,CAACwO,cAAc,CAAC,CAAC;IACrB,CAAC;;IAED;AACF;AACA;IACExO,GAAG,CAACmmB,UAAU,GAAG,UAAShT,SAAS,EAAE;MACpCnT,GAAG,CAAC2K,OAAO,CAACwI,SAAS,CAAC,CAAC1O,KAAK,CAAC6K,OAAO,GAAG,MAAM;MAC7CtP,GAAG,CAAC+K,QAAQ,CAACoI,SAAS,CAAC,CAAC1O,KAAK,CAAC6K,OAAO,GAAG,MAAM;MAC9C,IAAItP,GAAG,CAACoL,MAAM,IAAIpL,GAAG,CAACoL,MAAM,CAACyK,QAAQ,CAAChJ,MAAM,GAAGsG,SAAS,GAAG,CAAC,EAAE;QAC7DnT,GAAG,CAACoL,MAAM,CAACyK,QAAQ,CAAC1C,SAAS,GAAG,CAAC,CAAC,CAAC1O,KAAK,CAAC6K,OAAO,GAAG,MAAM;MAC1D;MACA,KAAK,IAAIL,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjP,GAAG,CAACH,OAAO,CAACoB,IAAI,CAAC4L,MAAM,EAAEoC,CAAC,EAAE,EAAE;QACjDjP,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAACkE,SAAS,CAAC,CAAC1O,KAAK,CAAC6K,OAAO,GAAG,MAAM;MACjD;;MAEA;MACA,IAAItP,GAAG,CAACH,OAAO,CAACqF,OAAO,EAAE;QACxBlF,GAAG,CAACggB,SAAS,CAAC,CAAC;MAChB;MAEAhgB,GAAG,CAACwO,cAAc,CAAC,CAAC;IACrB,CAAC;;IAED;AACF;AACA;IACExO,GAAG,CAAComB,SAAS,GAAG,YAAW;MAC1BpmB,GAAG,CAACmK,KAAK,CAAC2B,SAAS,CAAClL,MAAM,CAAC,qBAAqB,CAAC;IAClD,CAAC;;IAED;AACF;AACA;IACEZ,GAAG,CAACqmB,SAAS,GAAG,YAAW;MAC1BrmB,GAAG,CAACmK,KAAK,CAAC2B,SAAS,CAACC,GAAG,CAAC,qBAAqB,CAAC;IAC/C,CAAC;;IAED;AACF;AACA;IACE,IAAIua,mBAAmB,GAAG,EAAE;IAE5BtmB,GAAG,CAAC0b,kBAAkB,GAAG,UAASvJ,CAAC,EAAEC,CAAC,EAAExH,OAAO,EAAE;MAChD,IAAIqW,MAAM,GAAGxiB,MAAM,CAACqU,mBAAmB,CAAC,CAACX,CAAC,EAAEC,CAAC,CAAC,CAAC;MAC/C,IAAIpS,GAAG,CAAC8K,OAAO,CAACmW,MAAM,CAAC,IAAIjhB,GAAG,CAAC8K,OAAO,CAACmW,MAAM,CAAC,CAACpU,MAAM,GAAG,CAAC,EAAE;QAC1D,IAAIyZ,mBAAmB,CAACrF,MAAM,CAAC,EAAE;UAChCjhB,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,CAACD,CAAC,CAAC,CAACrD,SAAS,GAAG,QAAQ;UACtC9O,GAAG,CAAC8K,OAAO,CAACmW,MAAM,CAAC,GAAG,EAAE;QACzB,CAAC,MAAM;UACN;UACAqF,mBAAmB,CAACrF,MAAM,CAAC,GAAG,IAAI;UAElC,KAAK,IAAIhU,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjN,GAAG,CAAC8K,OAAO,CAACmW,MAAM,CAAC,CAACpU,MAAM,EAAEI,CAAC,EAAE,EAAE;YACpD,IAAIoD,IAAI,GAAG5R,MAAM,CAAC6R,mBAAmB,CAACtQ,GAAG,CAAC8K,OAAO,CAACmW,MAAM,CAAC,CAAChU,CAAC,CAAC,EAAE,IAAI,CAAC;YACnE;YACA,IAAI5N,KAAK,GAAG,EAAE,GAACW,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACoP,IAAI,CAAC,CAAC,CAAC,CAAC,CAACA,IAAI,CAAC,CAAC,CAAC,CAAC;YACjD,IAAIhR,KAAK,CAACkU,MAAM,CAAC,CAAC,EAAC,CAAC,CAAC,IAAI,GAAG,EAAE;cAC7B3I,OAAO,CAAC4C,IAAI,CAACxN,GAAG,CAACwX,UAAU,CAACnH,IAAI,CAAC,CAAC,CAAC,EAAEA,IAAI,CAAC,CAAC,CAAC,EAAEhR,KAAK,EAAE,IAAI,CAAC,CAAC;YAC5D,CAAC,MAAM;cACN;cACA0N,MAAM,CAACD,IAAI,CAAC9M,GAAG,CAAC8K,OAAO,CAAC,CAACmC,CAAC,CAAC,GAAG,IAAI;YACnC;YACAjN,GAAG,CAAC0b,kBAAkB,CAACrL,IAAI,CAAC,CAAC,CAAC,EAAEA,IAAI,CAAC,CAAC,CAAC,EAAEzF,OAAO,CAAC;UAClD;QACD;MACD;MAEA0b,mBAAmB,GAAG,EAAE;IACzB,CAAC;;IAED;AACF;AACA;IACEtmB,GAAG,CAACylB,cAAc,GAAG,UAASc,kBAAkB,EAAE;MACjD;MACA,KAAK,IAAItX,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjP,GAAG,CAACH,OAAO,CAACoB,IAAI,CAAC4L,MAAM,EAAEoC,CAAC,EAAE,EAAE;QACjD,KAAK,IAAIhC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjN,GAAG,CAACH,OAAO,CAACoB,IAAI,CAAC,CAAC,CAAC,CAAC4L,MAAM,EAAEI,CAAC,EAAE,EAAE;UACpD,IAAI5N,KAAK,GAAG,EAAE,GAAGW,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACgO,CAAC,CAAC,CAAChC,CAAC,CAAC;UACvC;UACA,IAAI5N,KAAK,CAACkU,MAAM,CAAC,CAAC,EAAC,CAAC,CAAC,IAAI,GAAG,EAAE;YAC7B;YACA,IAAIiT,UAAU,GAAGxmB,GAAG,CAAC6c,aAAa,CAACxd,KAAK,EAAEknB,kBAAkB,CAAC;YAC7D,IAAIC,UAAU,IAAInnB,KAAK,EAAE;cACxB;cACA;cACAW,GAAG,CAACwX,UAAU,CAAEvK,CAAC,EAAEgC,CAAC,EAAEuX,UAAW,CAAC;YACnC;UACD;QACD;MACD;;MAEA;MACA,IAAI1b,OAAO,GAAG,EAAE;MAChB,IAAIgC,IAAI,GAAGC,MAAM,CAACD,IAAI,CAAC9M,GAAG,CAAC8K,OAAO,CAAC;MACnC,KAAK,IAAImE,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGnC,IAAI,CAACD,MAAM,EAAEoC,CAAC,EAAE,EAAE;QACrC;QACA,IAAIuR,GAAG,GAAG1T,IAAI,CAACmC,CAAC,CAAC;QACjB,IAAI5P,KAAK,GAAGW,GAAG,CAAC8K,OAAO,CAAC0V,GAAG,CAAC;QAC5B;QACA,IAAI+F,kBAAkB,CAAC/F,GAAG,CAAC,EAAE;UAC5BA,GAAG,GAAG+F,kBAAkB,CAAC/F,GAAG,CAAC;QAC9B;QACA;QACA1V,OAAO,CAAC0V,GAAG,CAAC,GAAG,EAAE;QACjB,KAAK,IAAIvT,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG5N,KAAK,CAACwN,MAAM,EAAEI,CAAC,EAAE,EAAE;UACtC,IAAIwZ,MAAM,GAAGpnB,KAAK,CAAC4N,CAAC,CAAC;UACrB,IAAIsZ,kBAAkB,CAACE,MAAM,CAAC,EAAE;YAC/BA,MAAM,GAAGF,kBAAkB,CAACE,MAAM,CAAC;UACpC;UACA3b,OAAO,CAAC0V,GAAG,CAAC,CAAChT,IAAI,CAACiZ,MAAM,CAAC;QAC1B;MACD;MACAzmB,GAAG,CAAC8K,OAAO,GAAGA,OAAO;IACtB,CAAC;;IAED;AACF;AACA;AACA;AACA;AACA;IACE9K,GAAG,CAAC6c,aAAa,GAAG,UAAS/R,OAAO,EAAEyb,kBAAkB,EAAE;MACzD,IAAIG,UAAU,GAAG,OAAO;MACxB,IAAIC,UAAU,GAAG,OAAO;MAExB,IAAIH,UAAU,GAAG,EAAE;MACnB,IAAIC,MAAM,GAAG,IAAI;MACjB,IAAI5C,MAAM,GAAG,IAAI;MACjB,IAAIjH,KAAK,GAAG,EAAE;MAEd,KAAK,IAAInP,KAAK,GAAG,CAAC,EAAEA,KAAK,GAAG3C,OAAO,CAAC+B,MAAM,EAAEY,KAAK,EAAE,EAAE;QACpD,IAAIiZ,UAAU,CAACE,IAAI,CAAC9b,OAAO,CAAC2C,KAAK,CAAC,CAAC,EAAE;UACpCgZ,MAAM,GAAG,CAAC;UACV5C,MAAM,GAAG,CAAC;UACVjH,KAAK,IAAI9R,OAAO,CAAC2C,KAAK,CAAC;QACxB,CAAC,MAAM,IAAIkZ,UAAU,CAACC,IAAI,CAAC9b,OAAO,CAAC2C,KAAK,CAAC,CAAC,EAAE;UAC3CoW,MAAM,GAAG4C,MAAM,GAAG,CAAC,GAAG,CAAC;UACvB7J,KAAK,IAAI9R,OAAO,CAAC2C,KAAK,CAAC;QACxB,CAAC,MAAM;UACN,IAAIgZ,MAAM,IAAI5C,MAAM,EAAE;YACrBjH,KAAK,GAAG2J,kBAAkB,CAAC3J,KAAK,CAAC,GAAG2J,kBAAkB,CAAC3J,KAAK,CAAC,GAAGA,KAAK;UACtE;UACA4J,UAAU,IAAI5J,KAAK;UACnB4J,UAAU,IAAI1b,OAAO,CAAC2C,KAAK,CAAC;UAC5BgZ,MAAM,GAAG,CAAC;UACV5C,MAAM,GAAG,CAAC;UACVjH,KAAK,GAAG,EAAE;QACX;MACD;MAEA,IAAIA,KAAK,EAAE;QACV,IAAI6J,MAAM,IAAI5C,MAAM,EAAE;UACrBjH,KAAK,GAAG2J,kBAAkB,CAAC3J,KAAK,CAAC,GAAG2J,kBAAkB,CAAC3J,KAAK,CAAC,GAAGA,KAAK;QACtE;QACA4J,UAAU,IAAI5J,KAAK;MACpB;MAEA,OAAO4J,UAAU;IAClB,CAAC;;IAED;AACF;AACA;IACE,IAAInS,aAAa,GAAG,SAAAA,CAAS8H,QAAQ,EAAE;MACtC,IAAIzJ,QAAQ,GAAG,EAAE;MACjB,IAAImU,MAAM,GAAG,CAAC;MAEd,KAAK,IAAI5Z,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGkP,QAAQ,CAACtP,MAAM,EAAEI,CAAC,EAAE,EAAE;QACzC,IAAIkP,QAAQ,CAAClP,CAAC,CAAC,IAAI,GAAG,EAAE;UACvB,IAAI4Z,MAAM,IAAI,CAAC,EAAE;YAChBA,MAAM,GAAG,CAAC;UACX,CAAC,MAAM;YACNA,MAAM,GAAG,CAAC;UACX;QACD;QAEA,IAAIA,MAAM,IAAI,CAAC,EAAE;UAChBnU,QAAQ,IAAIyJ,QAAQ,CAAClP,CAAC,CAAC;QACxB,CAAC,MAAM;UACNyF,QAAQ,IAAIyJ,QAAQ,CAAClP,CAAC,CAAC,CAAC6Z,WAAW,CAAC,CAAC;QACtC;MACD;MAEA,OAAOpU,QAAQ;IAChB,CAAC;;IAED;AACF;AACA;IACE1S,GAAG,CAACwT,cAAc,GAAG,UAASuT,UAAU,EAAE5U,CAAC,EAAEC,CAAC,EAAE;MAE/C,IAAI4U,cAAc,GAAG,EAAE;MACvB,IAAIC,qBAAqB,GAAG,EAAE;;MAE9B;MACA,IAAIC,OAAO,GAAG,SAAAA,CAASH,UAAU,EAAE5U,CAAC,EAAEC,CAAC,EAAE;QACxC;QACA,IAAI+U,QAAQ,GAAG1oB,MAAM,CAACqU,mBAAmB,CAAC,CAACX,CAAC,EAAEC,CAAC,CAAC,CAAC;;QAEjD;QACA,IAAI6U,qBAAqB,CAACE,QAAQ,CAAC,EAAE;UACpChnB,OAAO,CAACC,KAAK,CAAC,yBAAyB,CAAC;UACxC,OAAO,QAAQ;QAChB;QAEA6mB,qBAAqB,CAACE,QAAQ,CAAC,GAAG,IAAI;;QAEtC;QACA,IAAIC,YAAY,GAAG,SAAAA,CAAS1K,MAAM,EAAE;UACnC,KAAK,IAAIjP,KAAK,GAAG,CAAC,EAAEA,KAAK,GAAGiP,MAAM,CAAC7P,MAAM,EAAEY,KAAK,EAAE,EAAE;YACnD,IAAI4Z,CAAC,GAAG,EAAE;YACV,IAAIzK,KAAK,GAAGF,MAAM,CAACjP,KAAK,CAAC,CAACoG,KAAK,CAAC,GAAG,CAAC;YACpC,IAAIyT,EAAE,GAAG7oB,MAAM,CAAC6R,mBAAmB,CAACsM,KAAK,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC;YACnD,IAAI2K,EAAE,GAAG9oB,MAAM,CAAC6R,mBAAmB,CAACsM,KAAK,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC;YAEnD,IAAI0K,EAAE,CAAC,CAAC,CAAC,IAAIC,EAAE,CAAC,CAAC,CAAC,EAAE;cACnB,IAAIpQ,EAAE,GAAGmQ,EAAE,CAAC,CAAC,CAAC;cACd,IAAIjQ,EAAE,GAAGkQ,EAAE,CAAC,CAAC,CAAC;YACf,CAAC,MAAM;cACN,IAAIpQ,EAAE,GAAGoQ,EAAE,CAAC,CAAC,CAAC;cACd,IAAIlQ,EAAE,GAAGiQ,EAAE,CAAC,CAAC,CAAC;YACf;YAEA,IAAIA,EAAE,CAAC,CAAC,CAAC,IAAIC,EAAE,CAAC,CAAC,CAAC,EAAE;cACnB,IAAInQ,EAAE,GAAGkQ,EAAE,CAAC,CAAC,CAAC;cACd,IAAIhQ,EAAE,GAAGiQ,EAAE,CAAC,CAAC,CAAC;YACf,CAAC,MAAM;cACN,IAAInQ,EAAE,GAAGmQ,EAAE,CAAC,CAAC,CAAC;cACd,IAAIjQ,EAAE,GAAGgQ,EAAE,CAAC,CAAC,CAAC;YACf;YAEA,KAAK,IAAIrY,CAAC,GAAGmI,EAAE,EAAEnI,CAAC,IAAIqI,EAAE,EAAErI,CAAC,EAAE,EAAE;cAC9B,KAAK,IAAIhC,CAAC,GAAGkK,EAAE,EAAElK,CAAC,IAAIoK,EAAE,EAAEpK,CAAC,EAAE,EAAE;gBAC9Boa,CAAC,CAAC7Z,IAAI,CAAC/O,MAAM,CAACqU,mBAAmB,CAAC,CAAC7F,CAAC,EAAEgC,CAAC,CAAC,CAAC,CAAC;cAC3C;YACD;YAEA8X,UAAU,GAAGA,UAAU,CAACS,OAAO,CAAC9K,MAAM,CAACjP,KAAK,CAAC,EAAE4Z,CAAC,CAACloB,IAAI,CAAC,GAAG,CAAC,CAAC;UAC5D;QACD,CAAC;;QAED;QACA4nB,UAAU,GAAGA,UAAU,CAACS,OAAO,CAAC,yBAAyB,EAAE,MAAM,CAAC;QAElE,IAAI9K,MAAM,GAAGqK,UAAU,CAAChT,KAAK,CAAC,iCAAiC,CAAC;QAChE,IAAI2I,MAAM,IAAIA,MAAM,CAAC7P,MAAM,EAAE;UAC5Bua,YAAY,CAAC1K,MAAM,CAAC;QACrB;;QAEA;QACA,IAAIA,MAAM,GAAGqK,UAAU,CAAChT,KAAK,CAAC,iBAAiB,CAAC;;QAEhD;QACA,IAAI2I,MAAM,IAAIA,MAAM,CAACqG,OAAO,CAACoE,QAAQ,CAAC,GAAG,CAAC,CAAC,EAAE;UAC5ChnB,OAAO,CAACC,KAAK,CAAC,yBAAyB,CAAC;UACxC,OAAO,QAAQ;QAChB,CAAC,MAAM;UACN;UACA,IAAIqnB,kBAAkB,GAAG,CAAC,CAAC;UAE3B,IAAI/K,MAAM,EAAE;YACX,KAAK,IAAIzP,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGyP,MAAM,CAAC7P,MAAM,EAAEI,CAAC,EAAE,EAAE;cACvC;cACA,IAAI,CAAEjN,GAAG,CAAC8K,OAAO,CAAC4R,MAAM,CAACzP,CAAC,CAAC,CAAC,EAAE;gBAC7BjN,GAAG,CAAC8K,OAAO,CAAC4R,MAAM,CAACzP,CAAC,CAAC,CAAC,GAAG,EAAE;cAC5B;cACA;cACA,IAAIjN,GAAG,CAAC8K,OAAO,CAAC4R,MAAM,CAACzP,CAAC,CAAC,CAAC,CAAC8V,OAAO,CAACoE,QAAQ,CAAC,GAAG,CAAC,EAAE;gBACjDnnB,GAAG,CAAC8K,OAAO,CAAC4R,MAAM,CAACzP,CAAC,CAAC,CAAC,CAACO,IAAI,CAAC2Z,QAAQ,CAAC;cACtC;;cAEA;cACA,IAAIO,IAAI,CAAC,SAAS,GAAGhL,MAAM,CAACzP,CAAC,CAAC,GAAG,kBAAkB,CAAC,EAAE;gBACrD;gBACA,IAAI6L,QAAQ,GAAGra,MAAM,CAAC6R,mBAAmB,CAACoM,MAAM,CAACzP,CAAC,CAAC,EAAE,CAAC,CAAC;gBACvD;gBACA,IAAI,OAAOjN,GAAG,CAACH,OAAO,CAACoB,IAAI,CAAC6X,QAAQ,CAAC,CAAC,CAAC,CAAE,IAAI,WAAW,IAAI,OAAO9Y,GAAG,CAACH,OAAO,CAACoB,IAAI,CAAC6X,QAAQ,CAAC,CAAC,CAAC,CAAC,CAACA,QAAQ,CAAC,CAAC,CAAC,CAAE,IAAI,WAAW,EAAE;kBAC9H,IAAIzZ,KAAK,GAAGW,GAAG,CAACH,OAAO,CAACoB,IAAI,CAAC6X,QAAQ,CAAC,CAAC,CAAC,CAAC,CAACA,QAAQ,CAAC,CAAC,CAAC,CAAC;gBACvD,CAAC,MAAM;kBACN,IAAIzZ,KAAK,GAAG,EAAE;gBACf;gBACA;gBACA,IAAI,CAAC,EAAE,GAACA,KAAK,EAAEkU,MAAM,CAAC,CAAC,EAAC,CAAC,CAAC,IAAI,GAAG,EAAE;kBAClC,IAAI,OAAOyT,cAAc,CAACtK,MAAM,CAACzP,CAAC,CAAC,CAAC,KAAK,WAAW,EAAE;oBACrD5N,KAAK,GAAG2nB,cAAc,CAACtK,MAAM,CAACzP,CAAC,CAAC,CAAC;kBAClC,CAAC,MAAM;oBACN5N,KAAK,GAAG6nB,OAAO,CAAC7nB,KAAK,EAAEyZ,QAAQ,CAAC,CAAC,CAAC,EAAEA,QAAQ,CAAC,CAAC,CAAC,CAAC;oBAChDkO,cAAc,CAACtK,MAAM,CAACzP,CAAC,CAAC,CAAC,GAAG5N,KAAK;kBAClC;gBACD;gBACA;gBACA,IAAI,CAAC,EAAE,GAACA,KAAK,EAAE+hB,IAAI,CAAC,CAAC,IAAI,EAAE,EAAE;kBAC5B;kBACAqG,kBAAkB,CAAC/K,MAAM,CAACzP,CAAC,CAAC,CAAC,GAAG,IAAI;gBACrC,CAAC,MAAM;kBACN,IAAI5N,KAAK,IAAIoU,MAAM,CAACpU,KAAK,CAAC,IAAIW,GAAG,CAACH,OAAO,CAACgF,WAAW,IAAI,IAAI,EAAE;oBAC9D;oBACA4iB,kBAAkB,CAAC/K,MAAM,CAACzP,CAAC,CAAC,CAAC,GAAGwG,MAAM,CAACpU,KAAK,CAAC;kBAC9C,CAAC,MAAM;oBACN;oBACA,IAAIwkB,MAAM,GAAG7jB,GAAG,CAAC2nB,WAAW,CAACtoB,KAAK,EAAEyZ,QAAQ,CAAC,CAAC,CAAC,CAAC;oBAChD,IAAI9Y,GAAG,CAACH,OAAO,CAACgF,WAAW,IAAI,IAAI,IAAIgf,MAAM,EAAE;sBAC9C4D,kBAAkB,CAAC/K,MAAM,CAACzP,CAAC,CAAC,CAAC,GAAG4W,MAAM;oBACvC,CAAC,MAAM;sBACN4D,kBAAkB,CAAC/K,MAAM,CAACzP,CAAC,CAAC,CAAC,GAAG,GAAG,GAAG5N,KAAK,GAAG,GAAG;oBAClD;kBACD;gBACD;cACD;YACD;UACD;;UAEA;UACA,IAAI;YACH,IAAIuoB,GAAG,GAAGnpB,MAAM,CAACqM,OAAO,CAACic,UAAU,CAACxT,MAAM,CAAC,CAAC,CAAC,EAAEkU,kBAAkB,EAAEtV,CAAC,EAAEC,CAAC,EAAEpS,GAAG,CAAC;UAC9E,CAAC,CAAC,OAAOgO,CAAC,EAAE;YACX,IAAI4Z,GAAG,GAAG,QAAQ;YAClBznB,OAAO,CAACoY,GAAG,CAACvK,CAAC,CAAC;UACf;UAEA,OAAO4Z,GAAG;QACX;MACD,CAAC;MAED,OAAOV,OAAO,CAACH,UAAU,EAAE5U,CAAC,EAAEC,CAAC,CAAC;IACjC,CAAC;;IAED;AACF;AACA;IACEpS,GAAG,CAAC2nB,WAAW,GAAG,UAAStoB,KAAK,EAAE4T,YAAY,EAAE;MAC/C;MACA,IAAInT,OAAO,GAAGmT,YAAY,IAAIjT,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2R,YAAY,CAAC,CAACnT,OAAO,GAAGE,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2R,YAAY,CAAC,CAACnT,OAAO,GAAG,GAAG;;MAEzH;MACA,IAAI+jB,MAAM,GAAI,EAAE,GAAGxkB,KAAM;MACzBwkB,MAAM,GAAGA,MAAM,CAAChQ,KAAK,CAAC/T,OAAO,CAAC;MAC9B+jB,MAAM,CAAC,CAAC,CAAC,GAAGA,MAAM,CAAC,CAAC,CAAC,CAAC9P,KAAK,CAAC,aAAa,CAAC;MAC1C,IAAI8P,MAAM,CAAC,CAAC,CAAC,EAAE;QACdA,MAAM,CAAC,CAAC,CAAC,GAAGA,MAAM,CAAC,CAAC,CAAC,CAAC1kB,IAAI,CAAC,EAAE,CAAC;MAC/B;MACA,IAAI0kB,MAAM,CAAC,CAAC,CAAC,EAAE;QACdA,MAAM,CAAC,CAAC,CAAC,GAAGA,MAAM,CAAC,CAAC,CAAC,CAAC9P,KAAK,CAAC,SAAS,CAAC,CAAC5U,IAAI,CAAC,EAAE,CAAC;MAChD;;MAEA;MACA,IAAI0kB,MAAM,CAAC,CAAC,CAAC,IAAIpQ,MAAM,CAACoU,SAAS,CAACpU,MAAM,CAACoQ,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;QACrD,IAAI,CAAEA,MAAM,CAAC,CAAC,CAAC,EAAE;UAChB,IAAIxkB,KAAK,GAAGoU,MAAM,CAACoQ,MAAM,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC;QACtC,CAAC,MAAM;UACN,IAAIxkB,KAAK,GAAGoU,MAAM,CAACoQ,MAAM,CAAC,CAAC,CAAC,GAAG,GAAG,GAAGA,MAAM,CAAC,CAAC,CAAC,CAAC;QAChD;MACD,CAAC,MAAM;QACN,IAAIxkB,KAAK,GAAG,IAAI;MACjB;MAEA,OAAOA,KAAK;IACb,CAAC;;IAED;AACF;AACA;IACEW,GAAG,CAAC8Q,GAAG,GAAG,UAAST,IAAI,EAAE,CACzB,CAAC;;IAED;AACF;AACA;IACErQ,GAAG,CAACkc,GAAG,GAAG,UAAS7L,IAAI,EAAE,CACzB,CAAC;IAEDrQ,GAAG,CAAC8nB,EAAE,GAAG,UAASC,QAAQ,EAAEC,OAAO,EAAE;MACpC,IAAID,QAAQ,EAAE;QACb,IAAI/nB,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE;UAC5BlL,GAAG,CAAC8nB,EAAE,CAACG,OAAO,CAAC,CAAC,EAAED,OAAO,GAAG,CAAC,GAAG,CAAC,CAAC;QACnC;MACD,CAAC,MAAM;QACN,IAAIhoB,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE;UAC5BlL,GAAG,CAAC8nB,EAAE,CAACG,OAAO,CAAC,CAAC,EAAED,OAAO,GAAG,CAAC,GAAG,CAAC,CAAC;QACnC;QACAhoB,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,GAAGlL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC;QACzClL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,GAAGlL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC;MAC1C;;MAEA;MACAlL,GAAG,CAACod,yBAAyB,CAACpd,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,EAAElL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,EAAElL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,EAAElL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,CAAC;;MAEjH;MACA,IAAIlL,GAAG,CAACH,OAAO,CAACqE,WAAW,IAAI,IAAI,EAAE;QACpC,IAAIlE,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,IAAI,CAAC,IAAIlL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,IAAI,CAAC,EAAE;UACzDlL,GAAG,CAAC2iB,QAAQ,CAAC,CAAC,CAAC;UACf3iB,GAAG,CAACod,yBAAyB,CAACpd,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,EAAElL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,EAAElL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,EAAElL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,CAAC;QAClH,CAAC,MAAM;UACN,IAAIlL,GAAG,CAACkoB,cAAc,CAAC,CAAC,EAAE;YACzBloB,GAAG,CAACod,yBAAyB,CAACpd,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,EAAElL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,EAAElL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,EAAElL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,CAAC;UAClH,CAAC,MAAM;YACN,IAAIid,IAAI,GAAGxZ,QAAQ,CAAC3O,GAAG,CAACqK,KAAK,CAAC+d,UAAU,CAAC7R,YAAY,CAAC,QAAQ,CAAC,CAAC;YAChE,IAAIvW,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,GAAGid,IAAI,GAAG,EAAE,EAAE;cACpCnoB,GAAG,CAACqoB,MAAM,CAAC,CAAC;cACZroB,GAAG,CAACod,yBAAyB,CAACpd,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,EAAElL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,EAAElL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,EAAElL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,CAAC;YAClH;UACD;QACD;MACD,CAAC,MAAM,IAAIlL,GAAG,CAACH,OAAO,CAACkE,UAAU,GAAG,CAAC,EAAE;QACtC,IAAIyG,UAAU,GAAGxK,GAAG,CAACsoB,SAAS,CAACtoB,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,CAAC;QACnD,IAAIV,UAAU,IAAIxK,GAAG,CAACwK,UAAU,EAAE;UACjCxK,GAAG,CAAC4O,IAAI,CAACpE,UAAU,CAAC;QACrB;MACD;MAEAxK,GAAG,CAACif,YAAY,CAAC,CAAC,CAAC;IACpB,CAAC;IAEDjf,GAAG,CAAC8nB,EAAE,CAACG,OAAO,GAAG,UAASM,KAAK,EAAErJ,SAAS,EAAE;MAC3C,IAAIqJ,KAAK,IAAI,CAAC,EAAE;QACf,IAAIpW,CAAC,GAAGxD,QAAQ,CAAC3O,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,CAAC;QACrC,IAAIkH,CAAC,GAAGzD,QAAQ,CAAC3O,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,CAAC;MACtC,CAAC,MAAM;QACN,IAAIiH,CAAC,GAAGxD,QAAQ,CAAC3O,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,CAAC;QACrC,IAAIkH,CAAC,GAAGzD,QAAQ,CAAC3O,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,CAAC;MACtC;MAEA,IAAIgU,SAAS,IAAI,CAAC,EAAE;QACnB,KAAK,IAAIjQ,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGmD,CAAC,EAAEnD,CAAC,EAAE,EAAE;UAC3B,IAAIjP,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAACkD,CAAC,CAAC,CAAC1N,KAAK,CAAC6K,OAAO,IAAI,MAAM,IAAItP,GAAG,CAACqB,IAAI,CAAC4N,CAAC,CAAC,CAACxK,KAAK,CAAC6K,OAAO,IAAI,MAAM,EAAE;YACrF8C,CAAC,GAAGnD,CAAC;YACL;UACD;QACD;MACD,CAAC,MAAM;QACNmD,CAAC,GAAGpS,GAAG,CAAC8nB,EAAE,CAACU,GAAG,CAACrW,CAAC,EAAEC,CAAC,CAAC;MACrB;MAEA,IAAImW,KAAK,IAAI,CAAC,EAAE;QACfvoB,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,GAAGiH,CAAC;QACvBnS,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,GAAGkH,CAAC;MACxB,CAAC,MAAM;QACNpS,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,GAAGiH,CAAC;QACvBnS,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,GAAGkH,CAAC;MACxB;IACD,CAAC;IAEDpS,GAAG,CAAC8nB,EAAE,CAACU,GAAG,GAAG,UAASrW,CAAC,EAAEC,CAAC,EAAE;MAC3B,IAAID,CAAC,GAAGxD,QAAQ,CAACwD,CAAC,CAAC;MACnB,IAAIC,CAAC,GAAGzD,QAAQ,CAACyD,CAAC,CAAC;MACnB,KAAK,IAAInD,CAAC,GAAImD,CAAC,GAAG,CAAE,EAAEnD,CAAC,IAAI,CAAC,EAAEA,CAAC,EAAE,EAAE;QAClC,IAAIjP,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAACkD,CAAC,CAAC,CAAC1N,KAAK,CAAC6K,OAAO,IAAI,MAAM,IAAItP,GAAG,CAACqB,IAAI,CAAC4N,CAAC,CAAC,CAACxK,KAAK,CAAC6K,OAAO,IAAI,MAAM,EAAE;UACrF,IAAItP,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAACkD,CAAC,CAAC,CAACoE,YAAY,CAAC,aAAa,CAAC,EAAE;YAClD,IAAIvW,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAACkD,CAAC,CAAC,IAAInS,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,CAACD,CAAC,CAAC,EAAE;cAC3C;YACD;UACD;UACAC,CAAC,GAAGnD,CAAC;UACL;QACD;MACD;MAEA,OAAOmD,CAAC;IACT,CAAC;IAEDpS,GAAG,CAACyoB,IAAI,GAAG,UAASV,QAAQ,EAAEC,OAAO,EAAE;MACtC,IAAID,QAAQ,EAAE;QACb,IAAI/nB,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,GAAGlL,GAAG,CAAC4K,OAAO,CAACiC,MAAM,GAAG,CAAC,EAAE;UACjD7M,GAAG,CAACyoB,IAAI,CAACR,OAAO,CAAC,CAAC,EAAED,OAAO,GAAG,CAAC,GAAG,CAAC,CAAC;QACrC;MACD,CAAC,MAAM;QACN,IAAIhoB,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,GAAGlL,GAAG,CAAC4K,OAAO,CAACiC,MAAM,GAAG,CAAC,EAAE;UACjD7M,GAAG,CAACyoB,IAAI,CAACR,OAAO,CAAC,CAAC,EAAED,OAAO,GAAG,CAAC,GAAG,CAAC,CAAC;QACrC;QACAhoB,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,GAAGlL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC;QACzClL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,GAAGlL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC;MAC1C;MAEAlL,GAAG,CAACod,yBAAyB,CAACpd,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,EAAElL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,EAAElL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,EAAElL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,CAAC;;MAEjH;MACA,IAAIlL,GAAG,CAACH,OAAO,CAACqE,WAAW,IAAI,IAAI,EAAE;QACpC,IAAKlE,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,IAAIlL,GAAG,CAAC4K,OAAO,CAACiC,MAAM,GAAG,CAAC,IAAI7M,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,IAAIlL,GAAG,CAAC4K,OAAO,CAACiC,MAAM,GAAG,CAAC,EAAG;UACrG7M,GAAG,CAAC2iB,QAAQ,CAAC,CAAC,CAAC,CAAC;UAChB3iB,GAAG,CAACod,yBAAyB,CAACpd,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,EAAElL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,EAAElL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,EAAElL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,CAAC;QAClH,CAAC,MAAM;UACN,IAAIlL,GAAG,CAACkoB,cAAc,CAAC,CAAC,EAAE;YACzBloB,GAAG,CAACod,yBAAyB,CAACpd,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,EAAElL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,EAAElL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,EAAElL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,CAAC;UAClH,CAAC,MAAM;YACN,IAAIid,IAAI,GAAGxZ,QAAQ,CAAC3O,GAAG,CAACqK,KAAK,CAACqe,SAAS,CAACnS,YAAY,CAAC,QAAQ,CAAC,CAAC;YAC/D,IAAI4R,IAAI,GAAGnoB,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,GAAG,EAAE,EAAE;cACpClL,GAAG,CAAC2oB,QAAQ,CAAC,CAAC;cACd3oB,GAAG,CAACod,yBAAyB,CAACpd,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,EAAElL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,EAAElL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,EAAElL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,CAAC;YAClH;UACD;QACD;MACD,CAAC,MAAM,IAAIlL,GAAG,CAACH,OAAO,CAACkE,UAAU,GAAG,CAAC,EAAE;QACtC,IAAIyG,UAAU,GAAGxK,GAAG,CAACsoB,SAAS,CAACtoB,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,CAAC;QACnD,IAAIV,UAAU,IAAIxK,GAAG,CAACwK,UAAU,EAAE;UACjCxK,GAAG,CAAC4O,IAAI,CAACpE,UAAU,CAAC;QACrB;MACD;MAEAxK,GAAG,CAACif,YAAY,CAAC,CAAC,CAAC;IACpB,CAAC;IAEDjf,GAAG,CAACyoB,IAAI,CAACR,OAAO,GAAG,UAASM,KAAK,EAAErJ,SAAS,EAAE;MAC7C,IAAIqJ,KAAK,IAAI,CAAC,EAAE;QACf,IAAIpW,CAAC,GAAGxD,QAAQ,CAAC3O,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,CAAC;QACrC,IAAIkH,CAAC,GAAGzD,QAAQ,CAAC3O,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,CAAC;MACtC,CAAC,MAAM;QACN,IAAIiH,CAAC,GAAGxD,QAAQ,CAAC3O,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,CAAC;QACrC,IAAIkH,CAAC,GAAGzD,QAAQ,CAAC3O,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,CAAC;MACtC;MAEA,IAAIgU,SAAS,IAAI,CAAC,EAAE;QACnB,KAAK,IAAIjQ,CAAC,GAAGjP,GAAG,CAACqB,IAAI,CAACwL,MAAM,GAAG,CAAC,EAAEoC,CAAC,GAAGmD,CAAC,EAAEnD,CAAC,EAAE,EAAE;UAC7C,IAAIjP,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAACkD,CAAC,CAAC,CAAC1N,KAAK,CAAC6K,OAAO,IAAI,MAAM,IAAItP,GAAG,CAACqB,IAAI,CAAC4N,CAAC,CAAC,CAACxK,KAAK,CAAC6K,OAAO,IAAI,MAAM,EAAE;YACrF8C,CAAC,GAAGnD,CAAC;YACL;UACD;QACD;MACD,CAAC,MAAM;QACNmD,CAAC,GAAGpS,GAAG,CAACyoB,IAAI,CAACD,GAAG,CAACrW,CAAC,EAAEC,CAAC,CAAC;MACvB;MAEA,IAAImW,KAAK,IAAI,CAAC,EAAE;QACfvoB,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,GAAGiH,CAAC;QACvBnS,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,GAAGkH,CAAC;MACxB,CAAC,MAAM;QACNpS,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,GAAGiH,CAAC;QACvBnS,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,GAAGkH,CAAC;MACxB;IACD,CAAC;IAEDpS,GAAG,CAACyoB,IAAI,CAACD,GAAG,GAAG,UAASrW,CAAC,EAAEC,CAAC,EAAE;MAC7B,IAAID,CAAC,GAAGxD,QAAQ,CAACwD,CAAC,CAAC;MACnB,IAAIC,CAAC,GAAGzD,QAAQ,CAACyD,CAAC,CAAC;MACnB,KAAK,IAAInD,CAAC,GAAImD,CAAC,GAAG,CAAE,EAAEnD,CAAC,GAAGjP,GAAG,CAACqB,IAAI,CAACwL,MAAM,EAAEoC,CAAC,EAAE,EAAE;QAC/C,IAAIjP,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAACkD,CAAC,CAAC,CAAC1N,KAAK,CAAC6K,OAAO,IAAI,MAAM,IAAItP,GAAG,CAACqB,IAAI,CAAC4N,CAAC,CAAC,CAACxK,KAAK,CAAC6K,OAAO,IAAI,MAAM,EAAE;UACrF,IAAItP,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAACkD,CAAC,CAAC,CAACoE,YAAY,CAAC,aAAa,CAAC,EAAE;YAClD,IAAIvW,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAACkD,CAAC,CAAC,IAAInS,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,CAACD,CAAC,CAAC,EAAE;cAC3C;YACD;UACD;UACAC,CAAC,GAAGnD,CAAC;UACL;QACD;MACD;MAEA,OAAOmD,CAAC;IACT,CAAC;IAEDpS,GAAG,CAAC4oB,KAAK,GAAG,UAASb,QAAQ,EAAEC,OAAO,EAAE;MACvC,IAAID,QAAQ,EAAE;QACb,IAAI/nB,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,GAAGlL,GAAG,CAAC2K,OAAO,CAACkC,MAAM,GAAG,CAAC,EAAE;UACjD7M,GAAG,CAAC4oB,KAAK,CAACX,OAAO,CAAC,CAAC,EAAED,OAAO,GAAG,CAAC,GAAG,CAAC,CAAC;QACtC;MACD,CAAC,MAAM;QACN,IAAIhoB,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,GAAGlL,GAAG,CAAC2K,OAAO,CAACkC,MAAM,GAAG,CAAC,EAAE;UACjD7M,GAAG,CAAC4oB,KAAK,CAACX,OAAO,CAAC,CAAC,EAAED,OAAO,GAAG,CAAC,GAAG,CAAC,CAAC;QACtC;QACAhoB,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,GAAGlL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC;QACzClL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,GAAGlL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC;MAC1C;MAEAlL,GAAG,CAACod,yBAAyB,CAACpd,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,EAAElL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,EAAElL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,EAAElL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,CAAC;MACjHlL,GAAG,CAACif,YAAY,CAAC,CAAC,CAAC;IACpB,CAAC;IAEDjf,GAAG,CAAC4oB,KAAK,CAACX,OAAO,GAAG,UAASM,KAAK,EAAErJ,SAAS,EAAE;MAC9C,IAAIqJ,KAAK,IAAI,CAAC,EAAE;QACf,IAAIpW,CAAC,GAAGxD,QAAQ,CAAC3O,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,CAAC;QACrC,IAAIkH,CAAC,GAAGzD,QAAQ,CAAC3O,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,CAAC;MACtC,CAAC,MAAM;QACN,IAAIiH,CAAC,GAAGxD,QAAQ,CAAC3O,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,CAAC;QACrC,IAAIkH,CAAC,GAAGzD,QAAQ,CAAC3O,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,CAAC;MACtC;MAEA,IAAIgU,SAAS,IAAI,CAAC,EAAE;QACnB,KAAK,IAAIjS,CAAC,GAAGjN,GAAG,CAAC2K,OAAO,CAACkC,MAAM,GAAG,CAAC,EAAEI,CAAC,GAAGkF,CAAC,EAAElF,CAAC,EAAE,EAAE;UAChD,IAAIjN,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,CAACnF,CAAC,CAAC,CAACxI,KAAK,CAAC6K,OAAO,IAAI,MAAM,EAAE;YAC9C6C,CAAC,GAAGlF,CAAC;YACL;UACD;QACD;MACD,CAAC,MAAM;QACNkF,CAAC,GAAGnS,GAAG,CAAC4oB,KAAK,CAACJ,GAAG,CAACrW,CAAC,EAAEC,CAAC,CAAC;MACxB;MAEA,IAAImW,KAAK,IAAI,CAAC,EAAE;QACfvoB,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,GAAGiH,CAAC;QACvBnS,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,GAAGkH,CAAC;MACxB,CAAC,MAAM;QACNpS,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,GAAGiH,CAAC;QACvBnS,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,GAAGkH,CAAC;MACxB;IACD,CAAC;IAEDpS,GAAG,CAAC4oB,KAAK,CAACJ,GAAG,GAAG,UAASrW,CAAC,EAAEC,CAAC,EAAE;MAC9B,IAAID,CAAC,GAAGxD,QAAQ,CAACwD,CAAC,CAAC;MACnB,IAAIC,CAAC,GAAGzD,QAAQ,CAACyD,CAAC,CAAC;MAEnB,KAAK,IAAInF,CAAC,GAAIkF,CAAC,GAAG,CAAE,EAAElF,CAAC,GAAGjN,GAAG,CAAC2K,OAAO,CAACkC,MAAM,EAAEI,CAAC,EAAE,EAAE;QAClD,IAAIjN,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,CAACnF,CAAC,CAAC,CAACxI,KAAK,CAAC6K,OAAO,IAAI,MAAM,EAAE;UAC9C,IAAItP,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,CAACnF,CAAC,CAAC,CAACsJ,YAAY,CAAC,aAAa,CAAC,EAAE;YAClD,IAAIvW,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,CAACnF,CAAC,CAAC,IAAIjN,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,CAACD,CAAC,CAAC,EAAE;cAC3C;YACD;UACD;UACAA,CAAC,GAAGlF,CAAC;UACL;QACD;MACD;MAEA,OAAOkF,CAAC;IACT,CAAC;IAEDnS,GAAG,CAAC0d,IAAI,GAAG,UAASqK,QAAQ,EAAEC,OAAO,EAAE;MACtC,IAAID,QAAQ,EAAE;QACb,IAAI/nB,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE;UAC5BlL,GAAG,CAAC0d,IAAI,CAACuK,OAAO,CAAC,CAAC,EAAED,OAAO,GAAG,CAAC,GAAG,CAAC,CAAC;QACrC;MACD,CAAC,MAAM;QACN,IAAIhoB,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE;UAC5BlL,GAAG,CAAC0d,IAAI,CAACuK,OAAO,CAAC,CAAC,EAAED,OAAO,GAAG,CAAC,GAAG,CAAC,CAAC;QACrC;QACAhoB,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,GAAGlL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC;QACzClL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,GAAGlL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC;MAC1C;MAEAlL,GAAG,CAACod,yBAAyB,CAACpd,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,EAAElL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,EAAElL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,EAAElL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,CAAC;MACjHlL,GAAG,CAACif,YAAY,CAAC,CAAC,CAAC;IACpB,CAAC;IAEDjf,GAAG,CAAC0d,IAAI,CAACuK,OAAO,GAAG,UAASM,KAAK,EAAErJ,SAAS,EAAE;MAC7C,IAAIqJ,KAAK,IAAI,CAAC,EAAE;QACf,IAAIpW,CAAC,GAAGxD,QAAQ,CAAC3O,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,CAAC;QACrC,IAAIkH,CAAC,GAAGzD,QAAQ,CAAC3O,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,CAAC;MACtC,CAAC,MAAM;QACN,IAAIiH,CAAC,GAAGxD,QAAQ,CAAC3O,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,CAAC;QACrC,IAAIkH,CAAC,GAAGzD,QAAQ,CAAC3O,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,CAAC;MACtC;MAEA,IAAIgU,SAAS,IAAI,CAAC,EAAE;QACnB,KAAK,IAAIjS,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGkF,CAAC,EAAElF,CAAC,EAAE,EAAE;UAC3B,IAAIjN,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,CAACnF,CAAC,CAAC,CAACxI,KAAK,CAAC6K,OAAO,IAAI,MAAM,EAAE;YAC9C6C,CAAC,GAAGlF,CAAC;YACL;UACD;QACD;MACD,CAAC,MAAM;QACNkF,CAAC,GAAGnS,GAAG,CAAC0d,IAAI,CAAC8K,GAAG,CAACrW,CAAC,EAAEC,CAAC,CAAC;MACvB;MAEA,IAAImW,KAAK,IAAI,CAAC,EAAE;QACfvoB,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,GAAGiH,CAAC;QACvBnS,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,GAAGkH,CAAC;MACxB,CAAC,MAAM;QACNpS,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,GAAGiH,CAAC;QACvBnS,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,GAAGkH,CAAC;MACxB;IACD,CAAC;IAEDpS,GAAG,CAAC0d,IAAI,CAAC8K,GAAG,GAAG,UAASrW,CAAC,EAAEC,CAAC,EAAE;MAC7B,IAAID,CAAC,GAAGxD,QAAQ,CAACwD,CAAC,CAAC;MACnB,IAAIC,CAAC,GAAGzD,QAAQ,CAACyD,CAAC,CAAC;MACnB,KAAK,IAAInF,CAAC,GAAIkF,CAAC,GAAG,CAAE,EAAElF,CAAC,IAAI,CAAC,EAAEA,CAAC,EAAE,EAAE;QAClC,IAAIjN,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,CAACnF,CAAC,CAAC,CAACxI,KAAK,CAAC6K,OAAO,IAAI,MAAM,EAAE;UAC9C,IAAItP,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,CAACnF,CAAC,CAAC,CAACsJ,YAAY,CAAC,aAAa,CAAC,EAAE;YAClD,IAAIvW,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,CAACnF,CAAC,CAAC,IAAIjN,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,CAACD,CAAC,CAAC,EAAE;cAC3C;YACD;UACD;UACAA,CAAC,GAAGlF,CAAC;UACL;QACD;MACD;MAEA,OAAOkF,CAAC;IACT,CAAC;IAEDnS,GAAG,CAAC6oB,KAAK,GAAG,UAASd,QAAQ,EAAEC,OAAO,EAAE;MACvC,IAAID,QAAQ,EAAE;QACb,IAAIC,OAAO,EAAE;UACZhoB,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,GAAG,CAAC;QACxB,CAAC,MAAM;UACNlL,GAAG,CAAC0d,IAAI,CAACuK,OAAO,CAAC,CAAC,EAAE,CAAC,CAAC;QACvB;MACD,CAAC,MAAM;QACN,IAAID,OAAO,EAAE;UACZhoB,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,GAAG,CAAC;QACxB,CAAC,MAAM;UACNlL,GAAG,CAAC0d,IAAI,CAACuK,OAAO,CAAC,CAAC,EAAE,CAAC,CAAC;QACvB;QACAjoB,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,GAAGlL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC;QACzClL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,GAAGlL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC;MAC1C;;MAEA;MACA,IAAIlL,GAAG,CAACH,OAAO,CAACqE,WAAW,IAAI,IAAI,KAAKlE,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,IAAI,CAAC,IAAIlL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,EAAE;QAC9FlL,GAAG,CAAC2iB,QAAQ,CAAC,CAAC,CAAC;MAChB,CAAC,MAAM,IAAI3iB,GAAG,CAACH,OAAO,CAACkE,UAAU,GAAG,CAAC,EAAE;QACtC,IAAIyG,UAAU,GAAGxK,GAAG,CAACsoB,SAAS,CAACtoB,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,CAAC;QACnD,IAAIV,UAAU,IAAIxK,GAAG,CAACwK,UAAU,EAAE;UACjCxK,GAAG,CAAC4O,IAAI,CAACpE,UAAU,CAAC;QACrB;MACD;MAEAxK,GAAG,CAACod,yBAAyB,CAACpd,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,EAAElL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,EAAElL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,EAAElL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,CAAC;MACjHlL,GAAG,CAACif,YAAY,CAAC,CAAC,CAAC;IACpB,CAAC;IAEDjf,GAAG,CAACye,IAAI,GAAG,UAASsJ,QAAQ,EAAEC,OAAO,EAAE;MACtC,IAAID,QAAQ,EAAE;QACb,IAAIC,OAAO,EAAE;UACZhoB,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,GAAGlL,GAAG,CAAC4K,OAAO,CAACiC,MAAM,GAAG,CAAC;QAC7C,CAAC,MAAM;UACN7M,GAAG,CAAC4oB,KAAK,CAACX,OAAO,CAAC,CAAC,EAAE,CAAC,CAAC;QACxB;MACD,CAAC,MAAM;QACN,IAAID,OAAO,EAAE;UACZhoB,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,GAAGlL,GAAG,CAAC4K,OAAO,CAACiC,MAAM,GAAG,CAAC;QAC7C,CAAC,MAAM;UACN7M,GAAG,CAAC4oB,KAAK,CAACX,OAAO,CAAC,CAAC,EAAE,CAAC,CAAC;QACxB;QACAjoB,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,GAAGlL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC;QACzClL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,GAAGlL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC;MAC1C;;MAEA;MACA,IAAIlL,GAAG,CAACH,OAAO,CAACqE,WAAW,IAAI,IAAI,KAAKlE,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,IAAIlL,GAAG,CAAC4K,OAAO,CAACiC,MAAM,GAAG,CAAC,IAAI7M,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,IAAIlL,GAAG,CAAC4K,OAAO,CAACiC,MAAM,GAAG,CAAC,CAAC,EAAE;QACxI7M,GAAG,CAAC2iB,QAAQ,CAAC,CAAC,CAAC,CAAC;MACjB,CAAC,MAAM,IAAI3iB,GAAG,CAACH,OAAO,CAACkE,UAAU,GAAG,CAAC,EAAE;QACtC,IAAIyG,UAAU,GAAGxK,GAAG,CAACsoB,SAAS,CAACtoB,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,CAAC;QACnD,IAAIV,UAAU,IAAIxK,GAAG,CAACwK,UAAU,EAAE;UACjCxK,GAAG,CAAC4O,IAAI,CAACpE,UAAU,CAAC;QACrB;MACD;MAEAxK,GAAG,CAACod,yBAAyB,CAACpd,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,EAAElL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,EAAElL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,EAAElL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,CAAC;MACjHlL,GAAG,CAACif,YAAY,CAAC,CAAC,CAAC;IACpB,CAAC;IAEDjf,GAAG,CAAC8oB,SAAS,GAAG,YAAW;MAC1B,IAAI,CAAE9oB,GAAG,CAACkL,YAAY,EAAE;QACvBlL,GAAG,CAACkL,YAAY,GAAG,EAAE;MACtB;MAEAlL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,GAAG,CAAC;MACvBlL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,GAAG,CAAC;MACvBlL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,GAAGlL,GAAG,CAAC2K,OAAO,CAACkC,MAAM,GAAG,CAAC;MAC5C7M,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,GAAGlL,GAAG,CAAC4K,OAAO,CAACiC,MAAM,GAAG,CAAC;MAE5C7M,GAAG,CAACod,yBAAyB,CAACpd,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,EAAElL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,EAAElL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,EAAElL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,CAAC;IAClH,CAAC;;IAED;AACF;AACA;IACElL,GAAG,CAAC2iB,QAAQ,GAAG,UAASnY,UAAU,EAAE;MACnC;MACA,IAAI,CAACxK,GAAG,CAACH,OAAO,CAACiE,MAAM,IAAI,IAAI,IAAI9D,GAAG,CAACH,OAAO,CAACoF,OAAO,IAAI,IAAI,KAAKjF,GAAG,CAACsK,OAAO,EAAE;QAC/E,IAAIA,OAAO,GAAGtK,GAAG,CAACsK,OAAO;MAC1B,CAAC,MAAM;QACN,IAAIA,OAAO,GAAGtK,GAAG,CAACqB,IAAI;MACvB;;MAEA;MACA,IAAImQ,eAAe,GAAG,GAAG;;MAEzB;MACA,IAAIhH,UAAU,IAAI,IAAI,IAAIA,UAAU,IAAI,CAAC,CAAC,EAAE;QAC3C;QACAA,UAAU,GAAGgQ,IAAI,CAACuO,IAAI,CAACze,OAAO,CAACuC,MAAM,GAAG2E,eAAe,CAAC,GAAG,CAAC;MAC7D;MAEA,IAAIwX,QAAQ,GAAIxe,UAAU,GAAGgH,eAAgB;MAC7C,IAAIyX,QAAQ,GAAIze,UAAU,GAAGgH,eAAe,GAAIA,eAAe;MAC/D,IAAIyX,QAAQ,GAAG3e,OAAO,CAACuC,MAAM,EAAE;QAC9Boc,QAAQ,GAAG3e,OAAO,CAACuC,MAAM;MAC1B;MACAmc,QAAQ,GAAGC,QAAQ,GAAG,GAAG;MACzB,IAAID,QAAQ,GAAG,CAAC,EAAE;QACjBA,QAAQ,GAAG,CAAC;MACb;;MAEA;MACA,KAAK,IAAI/Z,CAAC,GAAG+Z,QAAQ,EAAE/Z,CAAC,GAAGga,QAAQ,EAAEha,CAAC,EAAE,EAAE;QACzC,IAAI,CAACjP,GAAG,CAACH,OAAO,CAACiE,MAAM,IAAI,IAAI,IAAI9D,GAAG,CAACH,OAAO,CAACoF,OAAO,IAAI,IAAI,KAAKjF,GAAG,CAACsK,OAAO,EAAE;UAC/EtK,GAAG,CAACqK,KAAK,CAACkE,WAAW,CAACvO,GAAG,CAACqB,IAAI,CAACiJ,OAAO,CAAC2E,CAAC,CAAC,CAAC,CAAC;QAC5C,CAAC,MAAM;UACNjP,GAAG,CAACqK,KAAK,CAACkE,WAAW,CAACvO,GAAG,CAACqB,IAAI,CAAC4N,CAAC,CAAC,CAAC;QACnC;QAEA,IAAIjP,GAAG,CAACqK,KAAK,CAACwL,QAAQ,CAAChJ,MAAM,GAAG2E,eAAe,EAAE;UAChDxR,GAAG,CAACqK,KAAK,CAAC2R,WAAW,CAAChc,GAAG,CAACqK,KAAK,CAAC+d,UAAU,CAAC;QAC5C;MACD;IACD,CAAC;IAEDpoB,GAAG,CAACqoB,MAAM,GAAG,YAAW;MACvB;MACA,IAAI,CAACroB,GAAG,CAACH,OAAO,CAACiE,MAAM,IAAI,IAAI,IAAI9D,GAAG,CAACH,OAAO,CAACoF,OAAO,IAAI,IAAI,KAAKjF,GAAG,CAACsK,OAAO,EAAE;QAC/E,IAAIA,OAAO,GAAGtK,GAAG,CAACsK,OAAO;MAC1B,CAAC,MAAM;QACN,IAAIA,OAAO,GAAGtK,GAAG,CAACqB,IAAI;MACvB;MACA,IAAI4V,IAAI,GAAG,CAAC;MACZ,IAAI3M,OAAO,CAACuC,MAAM,GAAG,GAAG,EAAE;QACzB;QACA,IAAIsb,IAAI,GAAGxZ,QAAQ,CAAC3O,GAAG,CAACqK,KAAK,CAAC+d,UAAU,CAAC7R,YAAY,CAAC,QAAQ,CAAC,CAAC;QAChE,IAAI,CAACvW,GAAG,CAACH,OAAO,CAACiE,MAAM,IAAI,IAAI,IAAI9D,GAAG,CAACH,OAAO,CAACoF,OAAO,IAAI,IAAI,KAAKjF,GAAG,CAACsK,OAAO,EAAE;UAC/E6d,IAAI,GAAG7d,OAAO,CAACyY,OAAO,CAACoF,IAAI,CAAC;QAC7B;QACA,IAAIA,IAAI,GAAG,CAAC,EAAE;UACb,KAAK,IAAIlZ,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,EAAE,EAAEA,CAAC,EAAE,EAAE;YAC5BkZ,IAAI,GAAGA,IAAI,GAAG,CAAC;YACf,IAAIA,IAAI,GAAG,CAAC,CAAC,EAAE;cACd,IAAI,CAACnoB,GAAG,CAACH,OAAO,CAACiE,MAAM,IAAI,IAAI,IAAI9D,GAAG,CAACH,OAAO,CAACoF,OAAO,IAAI,IAAI,KAAKjF,GAAG,CAACsK,OAAO,EAAE;gBAC/EtK,GAAG,CAACqK,KAAK,CAAC1J,YAAY,CAACX,GAAG,CAACqB,IAAI,CAACiJ,OAAO,CAAC6d,IAAI,CAAC,CAAC,EAAEnoB,GAAG,CAACqK,KAAK,CAAC+d,UAAU,CAAC;cACtE,CAAC,MAAM;gBACNpoB,GAAG,CAACqK,KAAK,CAAC1J,YAAY,CAACX,GAAG,CAACqB,IAAI,CAAC8mB,IAAI,CAAC,EAAEnoB,GAAG,CAACqK,KAAK,CAAC+d,UAAU,CAAC;cAC7D;cACA,IAAIpoB,GAAG,CAACqK,KAAK,CAACwL,QAAQ,CAAChJ,MAAM,GAAG,GAAG,EAAE;gBACpC7M,GAAG,CAACqK,KAAK,CAAC2R,WAAW,CAAChc,GAAG,CAACqK,KAAK,CAACqe,SAAS,CAAC;gBAC1CzR,IAAI,GAAG,CAAC;cACT;YACD;UACD;QACD;MACD;MACA,OAAOA,IAAI;IACZ,CAAC;IAEDjX,GAAG,CAAC2oB,QAAQ,GAAG,YAAW;MACzB;MACA,IAAI,CAAC3oB,GAAG,CAACH,OAAO,CAACiE,MAAM,IAAI,IAAI,IAAI9D,GAAG,CAACH,OAAO,CAACoF,OAAO,IAAI,IAAI,KAAKjF,GAAG,CAACsK,OAAO,EAAE;QAC/E,IAAIA,OAAO,GAAGtK,GAAG,CAACsK,OAAO;MAC1B,CAAC,MAAM;QACN,IAAIA,OAAO,GAAGtK,GAAG,CAACqB,IAAI;MACvB;MACA,IAAI4V,IAAI,GAAG,CAAC;MACZ,IAAI3M,OAAO,CAACuC,MAAM,GAAG,GAAG,EAAE;QACzB;QACA,IAAIsb,IAAI,GAAGxZ,QAAQ,CAAC3O,GAAG,CAACqK,KAAK,CAACqe,SAAS,CAACnS,YAAY,CAAC,QAAQ,CAAC,CAAC;QAC/D,IAAI,CAACvW,GAAG,CAACH,OAAO,CAACiE,MAAM,IAAI,IAAI,IAAI9D,GAAG,CAACH,OAAO,CAACoF,OAAO,IAAI,IAAI,KAAKjF,GAAG,CAACsK,OAAO,EAAE;UAC/E6d,IAAI,GAAG7d,OAAO,CAACyY,OAAO,CAACoF,IAAI,CAAC;QAC7B;QACA,IAAIA,IAAI,GAAGnoB,GAAG,CAACqB,IAAI,CAACwL,MAAM,GAAG,CAAC,EAAE;UAC/B,KAAK,IAAIoC,CAAC,GAAG,CAAC,EAAEA,CAAC,IAAI,EAAE,EAAEA,CAAC,EAAE,EAAE;YAC7B,IAAIkZ,IAAI,GAAG7d,OAAO,CAACuC,MAAM,EAAE;cAC1B,IAAI,CAAC7M,GAAG,CAACH,OAAO,CAACiE,MAAM,IAAI,IAAI,IAAI9D,GAAG,CAACH,OAAO,CAACoF,OAAO,IAAI,IAAI,KAAKjF,GAAG,CAACsK,OAAO,EAAE;gBAC/EtK,GAAG,CAACqK,KAAK,CAACkE,WAAW,CAACvO,GAAG,CAACqB,IAAI,CAACiJ,OAAO,CAAC6d,IAAI,CAAC,CAAC,CAAC;cAC/C,CAAC,MAAM;gBACNnoB,GAAG,CAACqK,KAAK,CAACkE,WAAW,CAACvO,GAAG,CAACqB,IAAI,CAAC8mB,IAAI,CAAC,CAAC;cACtC;cACA,IAAInoB,GAAG,CAACqK,KAAK,CAACwL,QAAQ,CAAChJ,MAAM,GAAG,GAAG,EAAE;gBACpC7M,GAAG,CAACqK,KAAK,CAAC2R,WAAW,CAAChc,GAAG,CAACqK,KAAK,CAAC+d,UAAU,CAAC;gBAC3CnR,IAAI,GAAG,CAAC;cACT;YACD;YACAkR,IAAI,GAAGA,IAAI,GAAG,CAAC;UAChB;QACD;MACD;MAEA,OAAOlR,IAAI;IACZ,CAAC;IAEDjX,GAAG,CAACkoB,cAAc,GAAG,YAAW;MAC/B,IAAIloB,GAAG,CAACkL,YAAY,EAAE;QACrB,IAAIge,WAAW,GAAGva,QAAQ,CAAC3O,GAAG,CAACqK,KAAK,CAAC+d,UAAU,CAAC7R,YAAY,CAAC,QAAQ,CAAC,CAAC,GAAG,GAAG;QAC7E,IAAI4S,YAAY,GAAGxa,QAAQ,CAAC3O,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,GAAG,GAAG,CAAC;QACtD,IAAIke,UAAU,GAAGza,QAAQ,CAAC3O,GAAG,CAACqB,IAAI,CAACwL,MAAM,GAAG,GAAG,CAAC;QAEhD,IAAIqc,WAAW,IAAIC,YAAY,IAAIA,YAAY,IAAIC,UAAU,EAAE;UAC9D,IAAI,CAAE/c,KAAK,CAACC,SAAS,CAACyW,OAAO,CAACvW,IAAI,CAACxM,GAAG,CAACqK,KAAK,CAACwL,QAAQ,EAAE7V,GAAG,CAACqB,IAAI,CAACrB,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;YACtFlL,GAAG,CAAC2iB,QAAQ,CAACwG,YAAY,CAAC;YAC1B,OAAO,IAAI;UACZ;QACD;MACD;MAEA,OAAO,KAAK;IACb,CAAC;;IAED;AACF;AACA;IACEnpB,GAAG,CAAC8iB,WAAW,GAAG,YAAW;MAC5B9iB,GAAG,CAACuK,WAAW,CAAClL,KAAK,GAAG,EAAE;MAC1BW,GAAG,CAAC8D,MAAM,CAAC,EAAE,CAAC;MACd9D,GAAG,CAACsK,OAAO,GAAG,IAAI;IACnB,CAAC;;IAED;AACF;AACA;IACEtK,GAAG,CAAC8D,MAAM,GAAG,UAASyV,KAAK,EAAE;MAC5B;MACA,IAAIvZ,GAAG,CAACH,OAAO,CAACoF,OAAO,EAAE;QACxBjF,GAAG,CAACgZ,YAAY,CAAC,CAAC;MACnB;;MAEA;MACAhZ,GAAG,CAACwO,cAAc,CAAC,CAAC;;MAEpB;MACAxO,GAAG,CAACwK,UAAU,GAAG,CAAC;MAClBxK,GAAG,CAACsK,OAAO,GAAG,EAAE;MAEhB,IAAIiP,KAAK,EAAE;QACV;QACA,IAAIzV,MAAM,GAAG,SAAAA,CAASqkB,IAAI,EAAE5O,KAAK,EAAE9L,KAAK,EAAE;UACzC,KAAK,IAAIR,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGkb,IAAI,CAACtb,MAAM,EAAEI,CAAC,EAAE,EAAE;YACrC,IAAI,CAAC,EAAE,GAACkb,IAAI,CAAClb,CAAC,CAAC,EAAE4U,WAAW,CAAC,CAAC,CAAC/d,MAAM,CAACyV,KAAK,CAAC,IAAI,CAAC,IAChD,CAAC,EAAE,GAACvZ,GAAG,CAAC4K,OAAO,CAAC6C,KAAK,CAAC,CAACR,CAAC,CAAC,CAAC6B,SAAS,EAAE+S,WAAW,CAAC,CAAC,CAAC/d,MAAM,CAACyV,KAAK,CAAC,IAAI,CAAC,EAAE;cACvE,OAAO,IAAI;YACZ;UACD;UACA,OAAO,KAAK;QACb,CAAC;;QAED;QACA,IAAI8P,WAAW,GAAG,SAAAA,CAASjZ,CAAC,EAAE;UAC7B,IAAIpQ,GAAG,CAACsK,OAAO,CAACyY,OAAO,CAAC3S,CAAC,CAAC,IAAI,CAAC,CAAC,EAAE;YACjCpQ,GAAG,CAACsK,OAAO,CAACkD,IAAI,CAAC4C,CAAC,CAAC;UACpB;QACD,CAAC;QAED,IAAIkZ,WAAW,GAAG/P,KAAK,CAACiO,OAAO,CAAC,0BAA0B,EAAE,MAAM,CAAC;QACnE8B,WAAW,GAAG,IAAItV,MAAM,CAACsV,WAAW,EAAE,GAAG,CAAC;;QAE1C;QACAtpB,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACsoB,OAAO,CAAC,UAASjqB,CAAC,EAAE8Q,CAAC,EAAE;UACvC,IAAItM,MAAM,CAACxE,CAAC,EAAEgqB,WAAW,EAAElZ,CAAC,CAAC,EAAE;YAC9B;YACA,IAAI/O,IAAI,GAAGrB,GAAG,CAACoY,WAAW,CAAChI,CAAC,CAAC;YAC7B,IAAI/O,IAAI,CAACwL,MAAM,EAAE;cAChB,KAAK,IAAII,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG5L,IAAI,CAACwL,MAAM,EAAEI,CAAC,EAAE,EAAE;gBACrC,IAAI6D,GAAG,GAAGrS,MAAM,CAAC6R,mBAAmB,CAACjP,IAAI,CAAC4L,CAAC,CAAC,EAAE,IAAI,CAAC;gBACnD,KAAK,IAAIgC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjP,GAAG,CAACH,OAAO,CAAC+D,UAAU,CAACvC,IAAI,CAAC4L,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAEgC,CAAC,EAAE,EAAE;kBAC5Doa,WAAW,CAACvY,GAAG,CAAC,CAAC,CAAC,GAAC7B,CAAC,CAAC;gBACtB;cACD;YACD,CAAC,MAAM;cACN;cACAoa,WAAW,CAACjZ,CAAC,CAAC;YACf;UACD;QACD,CAAC,CAAC;MACH,CAAC,MAAM;QACNpQ,GAAG,CAACsK,OAAO,GAAG,IAAI;MACnB;MAEA,OAAOtK,GAAG,CAACsZ,YAAY,CAAC,CAAC;IAC1B,CAAC;IAEDtZ,GAAG,CAACsZ,YAAY,GAAG,YAAW;MAC7B,IAAIkQ,KAAK,GAAG,CAAC;MACb,IAAI/b,KAAK,GAAG,CAAC;;MAEb;MACA,IAAIzN,GAAG,CAACH,OAAO,CAACqE,WAAW,IAAI,IAAI,EAAE;QACpCslB,KAAK,GAAG,GAAG;MACZ,CAAC,MAAM,IAAIxpB,GAAG,CAACH,OAAO,CAACkE,UAAU,GAAG,CAAC,EAAE;QACtCylB,KAAK,GAAGxpB,GAAG,CAACH,OAAO,CAACkE,UAAU;MAC/B,CAAC,MAAM;QACN,IAAI/D,GAAG,CAACsK,OAAO,EAAE;UAChBkf,KAAK,GAAGxpB,GAAG,CAACsK,OAAO,CAACuC,MAAM;QAC3B,CAAC,MAAM;UACN2c,KAAK,GAAGxpB,GAAG,CAACqB,IAAI,CAACwL,MAAM;QACxB;MACD;;MAEA;MACA,OAAO7M,GAAG,CAACqK,KAAK,CAAC+d,UAAU,EAAE;QAC5BpoB,GAAG,CAACqK,KAAK,CAAC2R,WAAW,CAAChc,GAAG,CAACqK,KAAK,CAAC+d,UAAU,CAAC;MAC5C;;MAEA;MACA,KAAK,IAAInZ,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjP,GAAG,CAACqB,IAAI,CAACwL,MAAM,EAAEoC,CAAC,EAAE,EAAE;QACzC,IAAI,CAAEjP,GAAG,CAACsK,OAAO,IAAItK,GAAG,CAACsK,OAAO,CAACyY,OAAO,CAAC9T,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE;UACjD,IAAIxB,KAAK,GAAG+b,KAAK,EAAE;YAClBxpB,GAAG,CAACqK,KAAK,CAACkE,WAAW,CAACvO,GAAG,CAACqB,IAAI,CAAC4N,CAAC,CAAC,CAAC;YAClCxB,KAAK,EAAE;UACR;UACAzN,GAAG,CAACqB,IAAI,CAAC4N,CAAC,CAAC,CAACxK,KAAK,CAAC6K,OAAO,GAAG,EAAE;QAC/B,CAAC,MAAM;UACNtP,GAAG,CAACqB,IAAI,CAAC4N,CAAC,CAAC,CAACxK,KAAK,CAAC6K,OAAO,GAAG,MAAM;QACnC;MACD;;MAEA;MACA,IAAItP,GAAG,CAACH,OAAO,CAACkE,UAAU,GAAG,CAAC,EAAE;QAC/B/D,GAAG,CAAC2R,gBAAgB,CAAC,CAAC;MACvB;MAEA3R,GAAG,CAAC0a,oBAAoB,CAAC,CAAC;MAE1B,OAAO8O,KAAK;IACb,CAAC;;IAED;AACF;AACA;IACExpB,GAAG,CAACsoB,SAAS,GAAG,UAASjY,IAAI,EAAE;MAC9B;MACA,IAAI,CAACrQ,GAAG,CAACH,OAAO,CAACiE,MAAM,IAAI,IAAI,IAAI9D,GAAG,CAACH,OAAO,CAACoF,OAAO,IAAI,IAAI,KAAKjF,GAAG,CAACsK,OAAO,EAAE;QAC/E+F,IAAI,GAAGrQ,GAAG,CAACsK,OAAO,CAACyY,OAAO,CAAC1S,IAAI,CAAC;MACjC;MAEA,OAAQmK,IAAI,CAACuO,IAAI,CAAC,CAACpa,QAAQ,CAAC0B,IAAI,CAAC,GAAG,CAAC,IAAI1B,QAAQ,CAAC3O,GAAG,CAACH,OAAO,CAACkE,UAAU,CAAC,CAAC,GAAI,CAAC;IAChF,CAAC;;IAED;AACF;AACA;IACE/D,GAAG,CAAC4O,IAAI,GAAG,UAASpE,UAAU,EAAE;MAC/B,IAAIif,OAAO,GAAGzpB,GAAG,CAACwK,UAAU;;MAE5B;MACA,IAAI,CAACxK,GAAG,CAACH,OAAO,CAACiE,MAAM,IAAI,IAAI,IAAI9D,GAAG,CAACH,OAAO,CAACoF,OAAO,IAAI,IAAI,KAAKjF,GAAG,CAACsK,OAAO,EAAE;QAC/E,IAAIA,OAAO,GAAGtK,GAAG,CAACsK,OAAO;MAC1B,CAAC,MAAM;QACN,IAAIA,OAAO,GAAGtK,GAAG,CAACqB,IAAI;MACvB;;MAEA;MACA,IAAImQ,eAAe,GAAG7C,QAAQ,CAAC3O,GAAG,CAACH,OAAO,CAACkE,UAAU,CAAC;;MAEtD;MACA,IAAIyG,UAAU,IAAI,IAAI,IAAIA,UAAU,IAAI,CAAC,CAAC,EAAE;QAC3C;QACAA,UAAU,GAAGgQ,IAAI,CAACuO,IAAI,CAACze,OAAO,CAACuC,MAAM,GAAG2E,eAAe,CAAC,GAAG,CAAC;MAC7D;;MAEA;MACAxR,GAAG,CAACwK,UAAU,GAAGA,UAAU;MAE3B,IAAIwe,QAAQ,GAAIxe,UAAU,GAAGgH,eAAgB;MAC7C,IAAIyX,QAAQ,GAAIze,UAAU,GAAGgH,eAAe,GAAIA,eAAe;MAC/D,IAAIyX,QAAQ,GAAG3e,OAAO,CAACuC,MAAM,EAAE;QAC9Boc,QAAQ,GAAG3e,OAAO,CAACuC,MAAM;MAC1B;MACA,IAAImc,QAAQ,GAAG,CAAC,EAAE;QACjBA,QAAQ,GAAG,CAAC;MACb;;MAEA;MACA,OAAOhpB,GAAG,CAACqK,KAAK,CAAC+d,UAAU,EAAE;QAC5BpoB,GAAG,CAACqK,KAAK,CAAC2R,WAAW,CAAChc,GAAG,CAACqK,KAAK,CAAC+d,UAAU,CAAC;MAC5C;;MAEA;MACA,KAAK,IAAInZ,CAAC,GAAG+Z,QAAQ,EAAE/Z,CAAC,GAAGga,QAAQ,EAAEha,CAAC,EAAE,EAAE;QACzC,IAAI,CAACjP,GAAG,CAACH,OAAO,CAACiE,MAAM,IAAI,IAAI,IAAI9D,GAAG,CAACH,OAAO,CAACoF,OAAO,IAAI,IAAI,KAAKjF,GAAG,CAACsK,OAAO,EAAE;UAC/EtK,GAAG,CAACqK,KAAK,CAACkE,WAAW,CAACvO,GAAG,CAACqB,IAAI,CAACiJ,OAAO,CAAC2E,CAAC,CAAC,CAAC,CAAC;QAC5C,CAAC,MAAM;UACNjP,GAAG,CAACqK,KAAK,CAACkE,WAAW,CAACvO,GAAG,CAACqB,IAAI,CAAC4N,CAAC,CAAC,CAAC;QACnC;MACD;MAEA,IAAIjP,GAAG,CAACH,OAAO,CAACkE,UAAU,GAAG,CAAC,EAAE;QAC/B/D,GAAG,CAAC2R,gBAAgB,CAAC,CAAC;MACvB;;MAEA;MACA3R,GAAG,CAAC0a,oBAAoB,CAAC,CAAC;;MAE1B;MACA1a,GAAG,CAACgM,QAAQ,CAAC,cAAc,EAAEjM,EAAE,EAAEyK,UAAU,EAAEif,OAAO,CAAC;IACtD,CAAC;;IAED;AACF;AACA;IACEzpB,GAAG,CAAC2R,gBAAgB,GAAG,YAAW;MACjC;MACA3R,GAAG,CAAC+D,UAAU,CAAC8R,QAAQ,CAAC,CAAC,CAAC,CAAC/G,SAAS,GAAG,EAAE;MACzC9O,GAAG,CAAC+D,UAAU,CAAC8R,QAAQ,CAAC,CAAC,CAAC,CAAC/G,SAAS,GAAG,EAAE;;MAEzC;MACA,IAAI9O,GAAG,CAACH,OAAO,CAACkE,UAAU,EAAE;QAC3B;QACA,IAAI,CAAC/D,GAAG,CAACH,OAAO,CAACiE,MAAM,IAAI,IAAI,IAAI9D,GAAG,CAACH,OAAO,CAACoF,OAAO,IAAI,IAAI,KAAKjF,GAAG,CAACsK,OAAO,EAAE;UAC/E,IAAIA,OAAO,GAAGtK,GAAG,CAACsK,OAAO,CAACuC,MAAM;QACjC,CAAC,MAAM;UACN,IAAIvC,OAAO,GAAGtK,GAAG,CAACqB,IAAI,CAACwL,MAAM;QAC9B;QAEA,IAAI,CAAEvC,OAAO,EAAE;UACd;UACAtK,GAAG,CAAC+D,UAAU,CAAC8R,QAAQ,CAAC,CAAC,CAAC,CAAC/G,SAAS,GAAG9O,GAAG,CAACH,OAAO,CAAC+H,IAAI,CAACC,cAAc;QACvE,CAAC,MAAM;UACN;UACA,IAAI6hB,aAAa,GAAGlP,IAAI,CAACuO,IAAI,CAACze,OAAO,GAAGtK,GAAG,CAACH,OAAO,CAACkE,UAAU,CAAC;UAE/D,IAAI/D,GAAG,CAACwK,UAAU,GAAG,CAAC,EAAE;YACvB,IAAI8G,WAAW,GAAG,CAAC;YACnB,IAAIC,WAAW,GAAGmY,aAAa,GAAG,EAAE,GAAGA,aAAa,GAAG,EAAE;UAC1D,CAAC,MAAM,IAAIA,aAAa,GAAG1pB,GAAG,CAACwK,UAAU,GAAG,CAAC,EAAE;YAC9C,IAAI8G,WAAW,GAAGoY,aAAa,GAAG,CAAC;YACnC,IAAInY,WAAW,GAAGmY,aAAa;YAC/B,IAAIpY,WAAW,GAAG,CAAC,EAAE;cACpBA,WAAW,GAAG,CAAC;YAChB;UACD,CAAC,MAAM;YACN,IAAIA,WAAW,GAAGtR,GAAG,CAACwK,UAAU,GAAG,CAAC;YACpC,IAAI+G,WAAW,GAAGvR,GAAG,CAACwK,UAAU,GAAG,CAAC;UACrC;;UAEA;UACA,IAAI8G,WAAW,GAAG,CAAC,EAAE;YACpB,IAAIqY,cAAc,GAAGnpB,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;YAClDkpB,cAAc,CAACta,SAAS,GAAG,aAAa;YACxCsa,cAAc,CAAC7a,SAAS,GAAG,GAAG;YAC9B6a,cAAc,CAAC9qB,KAAK,GAAG,CAAC;YACxBmB,GAAG,CAAC+D,UAAU,CAAC8R,QAAQ,CAAC,CAAC,CAAC,CAACtH,WAAW,CAACob,cAAc,CAAC;UACvD;;UAEA;UACA,KAAK,IAAI1c,CAAC,GAAGqE,WAAW,EAAErE,CAAC,IAAIsE,WAAW,EAAEtE,CAAC,EAAE,EAAE;YAChD,IAAI0c,cAAc,GAAGnpB,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;YAClDkpB,cAAc,CAACta,SAAS,GAAG,aAAa;YACxCsa,cAAc,CAAC7a,SAAS,GAAG7B,CAAC;YAC5BjN,GAAG,CAAC+D,UAAU,CAAC8R,QAAQ,CAAC,CAAC,CAAC,CAACtH,WAAW,CAACob,cAAc,CAAC;YAEtD,IAAI3pB,GAAG,CAACwK,UAAU,IAAKyC,CAAC,GAAC,CAAE,EAAE;cAC5B0c,cAAc,CAAC7d,SAAS,CAACC,GAAG,CAAC,sBAAsB,CAAC;YACrD;UACD;;UAEA;UACA,IAAIwF,WAAW,GAAGmY,aAAa,EAAE;YAChC,IAAIC,cAAc,GAAGnpB,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;YAClDkpB,cAAc,CAACta,SAAS,GAAG,aAAa;YACxCsa,cAAc,CAAC7a,SAAS,GAAG,GAAG;YAC9B6a,cAAc,CAAC9qB,KAAK,GAAG6qB,aAAa;YACpC1pB,GAAG,CAAC+D,UAAU,CAAC8R,QAAQ,CAAC,CAAC,CAAC,CAACtH,WAAW,CAACob,cAAc,CAAC;UACvD;;UAEA;UACA,IAAIlqB,MAAM,GAAG,SAAAA,CAASA,MAAM,EAAE;YAC7B,IAAImqB,IAAI,GAAGvd,KAAK,CAACC,SAAS,CAACC,KAAK,CAACC,IAAI,CAACJ,SAAS,EAAE,CAAC,CAAC;YACnD,OAAO3M,MAAM,CAAC+nB,OAAO,CAAC,UAAU,EAAE,UAASzT,KAAK,EAAE8P,MAAM,EAAE;cACxD,OAAO,OAAO+F,IAAI,CAAC/F,MAAM,CAAC,IAAI,WAAW,GACxC+F,IAAI,CAAC/F,MAAM,CAAC,GACZ9P,KAAK;YAER,CAAC,CAAC;UACH,CAAC;UAED/T,GAAG,CAAC+D,UAAU,CAAC8R,QAAQ,CAAC,CAAC,CAAC,CAAC/G,SAAS,GAAGrP,MAAM,CAACO,GAAG,CAACH,OAAO,CAAC+H,IAAI,CAACE,WAAW,EAAE9H,GAAG,CAACwK,UAAU,GAAG,CAAC,EAAEkf,aAAa,CAAC;QAC/G;MACD;IACD,CAAC;;IAED;AACF;AACA;AACA;AACA;IACE1pB,GAAG,CAAC6pB,QAAQ,GAAG,UAASC,cAAc,EAAE;MACvC,IAAI9pB,GAAG,CAACH,OAAO,CAACoC,WAAW,IAAI,KAAK,EAAE;QACrC9B,OAAO,CAACC,KAAK,CAAC,oBAAoB,CAAC;MACpC,CAAC,MAAM;QACN;QACA,IAAIa,IAAI,GAAG,EAAE;;QAEb;QACAA,IAAI,IAAIjB,GAAG,CAAC+I,IAAI,CAAC,KAAK,EAAE/I,GAAG,CAACH,OAAO,CAAC2D,YAAY,EAAE,IAAI,EAAEsmB,cAAc,EAAE,IAAI,CAAC;;QAE7E;QACA,IAAIC,IAAI,GAAG,IAAIC,IAAI,CAAC,CAAC,QAAQ,GAAC/oB,IAAI,CAAC,EAAE;UAAClC,IAAI,EAAE;QAAyB,CAAC,CAAC;;QAEvE;QACA,IAAIL,MAAM,CAACurB,SAAS,IAAIvrB,MAAM,CAACurB,SAAS,CAACC,gBAAgB,EAAE;UAC1DxrB,MAAM,CAACurB,SAAS,CAACC,gBAAgB,CAACH,IAAI,EAAE/pB,GAAG,CAACH,OAAO,CAACyD,WAAW,GAAG,MAAM,CAAC;QAC1E,CAAC,MAAM;UACN;UACA,IAAI6mB,GAAG,GAAG3pB,QAAQ,CAACC,aAAa,CAAC,GAAG,CAAC;UACrC,IAAIK,GAAG,GAAGspB,GAAG,CAACC,eAAe,CAACN,IAAI,CAAC;UACnCI,GAAG,CAACG,IAAI,GAAGxpB,GAAG;UACdqpB,GAAG,CAACnb,YAAY,CAAC,UAAU,EAAEhP,GAAG,CAACH,OAAO,CAACyD,WAAW,GAAG,MAAM,CAAC;UAC9D9C,QAAQ,CAAC+pB,IAAI,CAAChc,WAAW,CAAC4b,GAAG,CAAC;UAC9BA,GAAG,CAACK,KAAK,CAAC,CAAC;UACXL,GAAG,CAACzpB,UAAU,CAACsb,WAAW,CAACmO,GAAG,CAAC;QAChC;MACD;IACD,CAAC;;IAED;AACF;AACA;AACA;AACA;IACEnqB,GAAG,CAAC0X,UAAU,GAAG,UAAS+S,OAAO,EAAE;MAClC,IAAIzqB,GAAG,CAACwL,aAAa,IAAI,IAAI,EAAE;QAC9B;QACA,IAAIiC,KAAK,GAAG,EAAEzN,GAAG,CAACsL,YAAY;;QAE9B;QACAtL,GAAG,CAAC6K,OAAO,GAAI7K,GAAG,CAAC6K,OAAO,GAAG7K,GAAG,CAAC6K,OAAO,CAAC0B,KAAK,CAAC,CAAC,EAAEkB,KAAK,GAAG,CAAC,CAAE;;QAE7D;QACAzN,GAAG,CAAC6K,OAAO,CAAC4C,KAAK,CAAC,GAAGgd,OAAO;MAC7B;IACD,CAAC;;IAED;AACF;AACA;AACA;AACA;AACA;AACA;IACEzqB,GAAG,CAAC+I,IAAI,GAAG,UAASkC,WAAW,EAAEyf,SAAS,EAAEC,UAAU,EAAEb,cAAc,EAAED,QAAQ,EAAE;MACjF,IAAI,CAAEa,SAAS,EAAE;QAChBA,SAAS,GAAG,IAAI;MACjB;MAEA,IAAInqB,GAAG,GAAG,IAAIyT,MAAM,CAAC0W,SAAS,EAAE,IAAI,CAAC;;MAErC;MACA,IAAIE,MAAM,GAAG,EAAE;MACf,IAAI1O,GAAG,GAAG,EAAE;MACZ,IAAI2O,QAAQ,GAAG,EAAE;MACjB,IAAI/Z,GAAG,GAAG,EAAE;MACZ,IAAIga,QAAQ,GAAG,EAAE;MACjB,IAAI3Y,CAAC,GAAGnS,GAAG,CAACH,OAAO,CAACoB,IAAI,CAAC,CAAC,CAAC,CAAC4L,MAAM;MAClC,IAAIuF,CAAC,GAAGpS,GAAG,CAACH,OAAO,CAACoB,IAAI,CAAC4L,MAAM;MAC/B,IAAI8H,GAAG,GAAG,EAAE;MACZ,IAAIoW,UAAU,GAAG,KAAK;MACtB,IAAIpgB,OAAO,GAAG,EAAE;MAChB,IAAIjJ,aAAa,GAAG,EAAE;MACtB,IAAIspB,SAAS,GAAG,CAAC;MACjB,IAAI5H,SAAS,GAAG,CAAC;;MAEjB;MACA,IAAI6H,KAAK,GAAG,CAAC;MACb,IAAIC,KAAK,GAAG,CAAC;MACb,IAAIC,aAAa,GAAG,IAAI;MACxB;MACA,KAAK,IAAIlc,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGmD,CAAC,EAAEnD,CAAC,EAAE,EAAE;QAC3B,KAAK,IAAIhC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGkF,CAAC,EAAElF,CAAC,EAAE,EAAE;UAC3B;UACA,IAAI,CAAEhC,WAAW,IAAIjL,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAAChC,CAAC,CAAC,CAACnB,SAAS,CAACuG,QAAQ,CAAC,WAAW,CAAC,EAAE;YACvE,IAAI4Y,KAAK,IAAIhe,CAAC,EAAE;cACfge,KAAK,GAAGhe,CAAC;YACV;YACA,IAAIie,KAAK,IAAIjc,CAAC,EAAE;cACfic,KAAK,GAAGjc,CAAC;YACV;UACD;QACD;MACD;MACA,IAAIkD,CAAC,KAAK8Y,KAAK,GAAC,CAAC,IAAI7Y,CAAC,KAAK8Y,KAAK,GAAC,CAAC,EAAE;QACnCC,aAAa,GAAG,KAAK;MACtB;MAEA,IAAKtB,QAAQ,IAAI7pB,GAAG,CAACH,OAAO,CAACqC,wBAAwB,IAAI,IAAI,IAC3D,CAAE2nB,QAAQ,IAAI7pB,GAAG,CAACH,OAAO,CAACsC,oBAAoB,IAAI,IAAI,IAAI,CAAEgpB,aAAc,IAAKrB,cAAe,EAAE;QACjG;QACA,IAAI9pB,GAAG,CAACH,OAAO,CAAC6B,aAAa,IAAI1B,GAAG,CAACH,OAAO,CAAC6B,aAAa,CAACmL,MAAM,GAAG,CAAC,EAAE;UACtE;UACA,IAAI,EAAG7M,GAAG,CAACH,OAAO,CAAC6B,aAAa,CAAC,CAAC,CAAC,IAAI1B,GAAG,CAACH,OAAO,CAAC6B,aAAa,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;YACxEiT,GAAG,GAAG,CAAC3U,GAAG,CAACH,OAAO,CAAC6B,aAAa,CAAC;UAClC,CAAC,MAAM;YACNiT,GAAG,GAAG3U,GAAG,CAACH,OAAO,CAAC6B,aAAa;UAChC;UAEA,KAAK,IAAIuN,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG0F,GAAG,CAAC9H,MAAM,EAAEoC,CAAC,EAAE,EAAE;YACpC,IAAImc,MAAM,GAAG,EAAE;YACf,KAAK,IAAIne,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG0H,GAAG,CAAC1F,CAAC,CAAC,CAACpC,MAAM,EAAEI,CAAC,EAAE,EAAE;cACvC,IAAI+I,OAAO,GAAGrH,QAAQ,CAACgG,GAAG,CAAC1F,CAAC,CAAC,CAAChC,CAAC,CAAC,CAAC+I,OAAO,CAAC;cACzCoV,MAAM,CAAC5d,IAAI,CAACmH,GAAG,CAAC1F,CAAC,CAAC,CAAChC,CAAC,CAAC,CAACpO,KAAK,CAAC;cAC5B,KAAK,IAAIid,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG9F,OAAO,GAAG,CAAC,EAAE8F,CAAC,EAAE,EAAE;gBACrCsP,MAAM,CAAC5d,IAAI,CAAC,EAAE,CAAC;cAChB;YACD;YACA9L,aAAa,IAAI0pB,MAAM,CAACjsB,IAAI,CAACurB,SAAS,CAAC,GAAG,MAAM;UACjD;QACD;QAEAK,UAAU,GAAG,IAAI;MAClB;;MAEA;MACA/qB,GAAG,CAACyE,KAAK,GAAG,EAAE;;MAEd;MACA,KAAK,IAAIwK,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGmD,CAAC,EAAEnD,CAAC,EAAE,EAAE;QAC3BiN,GAAG,GAAG,EAAE;QACR2O,QAAQ,GAAG,EAAE;QAEb,KAAK,IAAI5d,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGkF,CAAC,EAAElF,CAAC,EAAE,EAAE;UAC3B;UACA,IAAI,CAAEhC,WAAW,IAAIjL,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAAChC,CAAC,CAAC,CAACnB,SAAS,CAACuG,QAAQ,CAAC,WAAW,CAAC,EAAE;YACvE,IAAI0Y,UAAU,IAAI,IAAI,EAAE;cACvBH,MAAM,CAACpd,IAAI,CAACxN,GAAG,CAAC2K,OAAO,CAACsC,CAAC,CAAC,CAACqH,WAAW,CAAC;YACxC;YACA;YACA,IAAIjV,KAAK,GAAGW,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACgO,CAAC,CAAC,CAAChC,CAAC,CAAC;YAClC;YACA;AACN;AACA;AACA;AACA;AACA;YACM,IAAK5N,KAAK,CAAC0U,KAAK,KAAM1U,KAAK,CAAC0U,KAAK,CAAExT,GAAI,CAAC,IAAIlB,KAAK,CAACgsB,QAAQ,CAAEX,SAAU,CAAC,IAAIrrB,KAAK,CAACgsB,QAAQ,CAAE,IAAK,CAAC,CAAE,EAAG;cACrG,IAAKhsB,KAAK,CAACgsB,QAAQ,CAAE,GAAI,CAAC,EAAG;gBAC5BhsB,KAAK,GAAGA,KAAK,CAACmoB,OAAO,CAAC,IAAIxT,MAAM,CAAC,GAAG,EAAE,GAAG,CAAC,EAAE,IAAI,CAAC;cAClD;cACA3U,KAAK,GAAG,GAAG,GAAGA,KAAK,GAAG,GAAG;YAC1B;YACA6c,GAAG,CAAC1O,IAAI,CAACnO,KAAK,CAAC;;YAEf;YACA,IAAIW,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAAClO,IAAI,IAAI,UAAU,IAAIiB,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAAClO,IAAI,IAAI,OAAO,EAAE;cACxF,IAAIya,KAAK,GAAGna,KAAK;YAClB,CAAC,MAAM;cACN,IAAIW,GAAG,CAACH,OAAO,CAACmF,eAAe,IAAI,IAAI,EAAE;gBACxC,IAAIwU,KAAK,GAAGxZ,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAAChC,CAAC,CAAC,CAACqH,WAAW;cAC1C,CAAC,MAAM;gBACN,IAAIkF,KAAK,GAAGxZ,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAAChC,CAAC,CAAC,CAAC6B,SAAS;cACxC;cACA,IAAI0K,KAAK,CAACzF,KAAK,KAAKyF,KAAK,CAACzF,KAAK,CAACxT,GAAG,CAAC,IAAIiZ,KAAK,CAACzF,KAAK,CAAC,IAAI,CAAC,IAAIyF,KAAK,CAACzF,KAAK,CAAC,IAAI,CAAC,IAAIyF,KAAK,CAACzF,KAAK,CAAC,IAAI,CAAC,CAAC,EAAE;gBACrG;gBACAyF,KAAK,GAAGA,KAAK,CAACgO,OAAO,CAAC,IAAIxT,MAAM,CAAC,GAAG,EAAE,GAAG,CAAC,EAAE,IAAI,CAAC;gBACjDwF,KAAK,GAAG,GAAG,GAAGA,KAAK,GAAG,GAAG;cAC1B;YACD;YACAqR,QAAQ,CAACrd,IAAI,CAACgM,KAAK,CAAC;;YAEpB;YACA7E,GAAG,GAAG3U,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAAChC,CAAC,CAAC,CAACsJ,YAAY,CAAC,OAAO,CAAC;YAC7C5B,GAAG,GAAGA,GAAG,CAAC6S,OAAO,CAAC,gBAAgB,EAAE,EAAE,CAAC;YACvCxnB,GAAG,CAACyE,KAAK,CAAC+I,IAAI,CAACmH,GAAG,GAAGA,GAAG,GAAG,EAAE,CAAC;UAC/B;QACD;QAEA,IAAIuH,GAAG,CAACrP,MAAM,EAAE;UACf,IAAIke,UAAU,EAAE;YACfC,SAAS,GAAG9O,GAAG,CAACrP,MAAM;YACtBiE,GAAG,CAACtD,IAAI,CAACod,MAAM,CAACzrB,IAAI,CAACurB,SAAS,CAAC,CAAC;UACjC;UACA5Z,GAAG,CAACtD,IAAI,CAAC0O,GAAG,CAAC/c,IAAI,CAACurB,SAAS,CAAC,CAAC;QAC9B;QACA,IAAIG,QAAQ,CAAChe,MAAM,EAAE;UACpBuW,SAAS,EAAE;UACX,IAAI2H,UAAU,EAAE;YACfD,QAAQ,CAACtd,IAAI,CAACod,MAAM,CAACzrB,IAAI,CAACurB,SAAS,CAAC,CAAC;YACrCK,UAAU,GAAG,KAAK;UACnB;UACAD,QAAQ,CAACtd,IAAI,CAACqd,QAAQ,CAAC1rB,IAAI,CAACurB,SAAS,CAAC,CAAC;QACxC;MACD;MAEA,IAAIvY,CAAC,IAAI6Y,SAAS,IAAK5Y,CAAC,IAAIgR,SAAS,EAAE;QACtCzY,OAAO,GAAGjJ,aAAa;MACxB;;MAEA;MACA,IAAI4pB,GAAG,GAAG3gB,OAAO,GAAGmG,GAAG,CAAC3R,IAAI,CAAC,MAAM,CAAC;MACpC,IAAIosB,QAAQ,GAAG5gB,OAAO,GAAGmgB,QAAQ,CAAC3rB,IAAI,CAAC,MAAM,CAAC;;MAE9C;MACA,IAAI,CAAEwrB,UAAU,EAAE;QACjB,IAAI3qB,GAAG,CAACH,OAAO,CAACsB,iBAAiB,IAAI,IAAI,EAAE;UAC1CnB,GAAG,CAACgK,QAAQ,CAAC3K,KAAK,GAAGksB,QAAQ;QAC9B,CAAC,MAAM;UACNvrB,GAAG,CAACgK,QAAQ,CAAC3K,KAAK,GAAGisB,GAAG;QACzB;QACAtrB,GAAG,CAACgK,QAAQ,CAACwhB,MAAM,CAAC,CAAC;QACrBhrB,QAAQ,CAACirB,WAAW,CAAC,MAAM,CAAC;MAC7B;;MAEA;MACA,IAAIzrB,GAAG,CAACH,OAAO,CAACsB,iBAAiB,IAAI,IAAI,EAAE;QAC1CnB,GAAG,CAACiB,IAAI,GAAGsqB,QAAQ;MACpB,CAAC,MAAM;QACNvrB,GAAG,CAACiB,IAAI,GAAGqqB,GAAG;MACf;MACA;MACAtrB,GAAG,CAAC0L,UAAU,GAAG1L,GAAG,CAAC0rB,IAAI,CAAC1rB,GAAG,CAACiB,IAAI,CAAC;;MAEnC;MACA,IAAI,CAAE0pB,UAAU,EAAE;QACjB3qB,GAAG,CAACoe,sBAAsB,CAAC,CAAC;;QAE5B;QACA,IAAIpe,GAAG,CAACiL,WAAW,EAAE;UACpB,KAAK,IAAIgC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjN,GAAG,CAACiL,WAAW,CAAC4B,MAAM,EAAEI,CAAC,EAAE,EAAE;YAChDjN,GAAG,CAACiL,WAAW,CAACgC,CAAC,CAAC,CAACnB,SAAS,CAACC,GAAG,CAAC,SAAS,CAAC;YAC3C,IAAI/L,GAAG,CAACiL,WAAW,CAACgC,CAAC,CAAC,CAACnB,SAAS,CAACuG,QAAQ,CAAC,gBAAgB,CAAC,EAAE;cAC5DrS,GAAG,CAACiL,WAAW,CAACgC,CAAC,CAAC,CAACnB,SAAS,CAACC,GAAG,CAAC,cAAc,CAAC;YACjD;YACA,IAAI/L,GAAG,CAACiL,WAAW,CAACgC,CAAC,CAAC,CAACnB,SAAS,CAACuG,QAAQ,CAAC,iBAAiB,CAAC,EAAE;cAC7DrS,GAAG,CAACiL,WAAW,CAACgC,CAAC,CAAC,CAACnB,SAAS,CAACC,GAAG,CAAC,eAAe,CAAC;YAClD;YACA,IAAI/L,GAAG,CAACiL,WAAW,CAACgC,CAAC,CAAC,CAACnB,SAAS,CAACuG,QAAQ,CAAC,eAAe,CAAC,EAAE;cAC3DrS,GAAG,CAACiL,WAAW,CAACgC,CAAC,CAAC,CAACnB,SAAS,CAACC,GAAG,CAAC,aAAa,CAAC;YAChD;YACA,IAAI/L,GAAG,CAACiL,WAAW,CAACgC,CAAC,CAAC,CAACnB,SAAS,CAACuG,QAAQ,CAAC,kBAAkB,CAAC,EAAE;cAC9DrS,GAAG,CAACiL,WAAW,CAACgC,CAAC,CAAC,CAACnB,SAAS,CAACC,GAAG,CAAC,gBAAgB,CAAC;YACnD;UACD;QACD;;QAEA;QACA/L,GAAG,CAACgM,QAAQ,CAAC,QAAQ,EAAEjM,EAAE,EAAEC,GAAG,CAACH,OAAO,CAACsB,iBAAiB,IAAI,IAAI,GAAG2pB,QAAQ,GAAGha,GAAG,EAAE9Q,GAAG,CAAC0L,UAAU,CAAC;MACnG;MAEA,OAAO1L,GAAG,CAACiB,IAAI;IAChB,CAAC;;IAED;AACF;AACA;AACA;AACA;AACA;IACEjB,GAAG,CAACgJ,KAAK,GAAG,UAASmJ,CAAC,EAAEC,CAAC,EAAEnR,IAAI,EAAE;MAChC,IAAI0qB,GAAG,GAAGhd,QAAQ,CAACwD,CAAC,CAAC;QACrByZ,GAAG,GAAGjd,QAAQ,CAACyD,CAAC,CAAC;QACjByZ,GAAG,GAAGld,QAAQ,CAAC3O,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,CAAC;QACnC4gB,GAAG,GAAGnd,QAAQ,CAAC3O,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,CAAC;QACnCyU,CAAC,GAAGkM,GAAG,GAAGF,GAAG,GAAG,CAAC;QACjBrP,CAAC,GAAGwP,GAAG,GAAGF,GAAG,GAAG,CAAC;;MAEjB;MACA,IAAIC,GAAG,GAAGF,GAAG,EAAC;QACbxZ,CAAC,GAAG0Z,GAAG,CAACE,QAAQ,CAAC,CAAC;QAClBpM,CAAC,GAAGgM,GAAG,GAAGE,GAAG,GAAG,CAAC;MAClB;MACA;MACA,IAAIC,GAAG,GAAGF,GAAG,EAAC;QACbxZ,CAAC,GAAG0Z,GAAG,CAACC,QAAQ,CAAC,CAAC;QAClBzP,CAAC,GAAGsP,GAAG,GAAGE,GAAG,GAAG,CAAC;MAClB;MACA;MACA,IAAI5f,GAAG,GAAGlM,GAAG,CAACgM,QAAQ,CAAC,eAAe,EAAEjM,EAAE,EAAEkB,IAAI,EAAEkR,CAAC,EAAEC,CAAC,CAAC;MAEvD,IAAIlG,GAAG,KAAK,KAAK,EAAE;QAClB,OAAO,KAAK;MACb,CAAC,MAAM,IAAIA,GAAG,EAAE;QACf,IAAIjL,IAAI,GAAGiL,GAAG;MACf;;MAEA;MACA,IAAIwf,IAAI,GAAG1rB,GAAG,CAAC0rB,IAAI,CAACzqB,IAAI,CAAC;MACzB,IAAIwD,KAAK,GAAIinB,IAAI,IAAI1rB,GAAG,CAAC0L,UAAU,GAAI1L,GAAG,CAACyE,KAAK,GAAG,IAAI;;MAEvD;MACA,IAAIzE,GAAG,CAACH,OAAO,CAACsB,iBAAiB,IAAI,IAAI,IAAIuqB,IAAI,IAAI1rB,GAAG,CAAC0L,UAAU,EAAE;QACpE,IAAIzK,IAAI,GAAGjB,GAAG,CAACiB,IAAI;MACpB;;MAEA;MACA,IAAIA,IAAI,GAAGjB,GAAG,CAACgsB,QAAQ,CAAC/qB,IAAI,EAAE,IAAI,CAAC;MACnC;MACA,IAAK0e,CAAC,GAAG,CAAC,GAAIlM,MAAM,CAACoU,SAAS,CAAClI,CAAC,GAAG1e,IAAI,CAAC,CAAC,CAAC,CAAC4L,MAAM,CAAC,EAAE;QACnDpI,KAAK,GAAG,IAAI;QACZwnB,OAAO,GAAGtM,CAAC,GAAG1e,IAAI,CAAC,CAAC,CAAC,CAAC4L,MAAM;QAE5B,IAAIqf,MAAM,GAAGjrB,IAAI,CAACkrB,GAAG,CAAC,UAAUrb,GAAG,EAAE7D,CAAC,EAAE;UACxC,IAAImf,MAAM,GAAG/f,KAAK,CAACF,KAAK,CAAC,IAAI,EAAE;YAAEU,MAAM,EAAEof,OAAO,GAAGnb,GAAG,CAACjE;UAAO,CAAC,CAAC,CAACsf,GAAG,CACnE,UAAUne,CAAC,EAAEf,CAAC,EAAE;YAAE,OAAO6D,GAAG,CAAC7D,CAAC,GAAG6D,GAAG,CAACjE,MAAM,CAAC;UAAE,CAC/C,CAAC;UACD,OAAOuf,MAAM;QACb,CAAC,CAAC;QACFnrB,IAAI,GAAGirB,MAAM;MACd;MACA,IAAK5P,CAAC,GAAG,CAAC,GAAI7I,MAAM,CAACoU,SAAS,CAACvL,CAAC,GAAGrb,IAAI,CAAC4L,MAAM,CAAC,EAAE;QAChDpI,KAAK,GAAG,IAAI;QACZ,IAAIwnB,OAAO,GAAG3P,CAAC,GAAGrb,IAAI,CAAC4L,MAAM;QAC7B,IAAIqf,MAAM,GAAG7f,KAAK,CAACF,KAAK,CAAC,IAAI,EAAE;UAAEU,MAAM,EAAEof,OAAO,GAAGhrB,IAAI,CAAC4L;QAAO,CAAC,CAAC,CAACsf,GAAG,CACrE,UAAUne,CAAC,EAAEf,CAAC,EAAE;UAAE,OAAOhM,IAAI,CAACgM,CAAC,GAAGhM,IAAI,CAAC4L,MAAM,CAAC;QAAE,CAChD,CAAC;QACD5L,IAAI,GAAGirB,MAAM;MACd;MAEA,IAAI/Z,CAAC,IAAI,IAAI,IAAIC,CAAC,IAAI,IAAI,IAAInR,IAAI,EAAE;QACnC;QACA,IAAIgM,CAAC,GAAG,CAAC;QACT,IAAIgC,CAAC,GAAG,CAAC;QACT,IAAIrE,OAAO,GAAG,EAAE;QAChB,IAAIyhB,QAAQ,GAAG,CAAC,CAAC;QACjB,IAAIC,QAAQ,GAAG,CAAC,CAAC;QACjB,IAAIC,UAAU,GAAG,CAAC;;QAElB;QACA,IAAIC,QAAQ,GAAG7d,QAAQ,CAACwD,CAAC,CAAC;QAC1B,IAAImR,QAAQ,GAAG3U,QAAQ,CAACyD,CAAC,CAAC;QAC1B,IAAItB,GAAG,GAAG,IAAI;;QAEd;QACA,OAAOA,GAAG,GAAG7P,IAAI,CAACgO,CAAC,CAAC,EAAE;UACrBhC,CAAC,GAAG,CAAC;UACLuf,QAAQ,GAAG7d,QAAQ,CAACwD,CAAC,CAAC;UAEtB,OAAOrB,GAAG,CAAC7D,CAAC,CAAC,IAAI,IAAI,EAAE;YACtB;YACA,IAAIgP,MAAM,GAAGjc,GAAG,CAACwX,UAAU,CAACgV,QAAQ,EAAElJ,QAAQ,EAAExS,GAAG,CAAC7D,CAAC,CAAC,CAAC;YACvD;YACArC,OAAO,CAAC4C,IAAI,CAACyO,MAAM,CAAC;YACpB;YACAjc,GAAG,CAAC0b,kBAAkB,CAAC8Q,QAAQ,EAAElJ,QAAQ,EAAE1Y,OAAO,CAAC;YACnD;YACA,IAAInG,KAAK,IAAIA,KAAK,CAAC8nB,UAAU,CAAC,EAAE;cAC/B,IAAItkB,UAAU,GAAGxJ,MAAM,CAACqU,mBAAmB,CAAC,CAAC0Z,QAAQ,EAAElJ,QAAQ,CAAC,CAAC;cACjE+I,QAAQ,CAACpkB,UAAU,CAAC,GAAGxD,KAAK,CAAC8nB,UAAU,CAAC;cACxCD,QAAQ,CAACrkB,UAAU,CAAC,GAAGjI,GAAG,CAAC8gB,QAAQ,CAAC7Y,UAAU,CAAC;cAC/CjI,GAAG,CAAC4K,OAAO,CAAC0Y,QAAQ,CAAC,CAACkJ,QAAQ,CAAC,CAACxd,YAAY,CAAC,OAAO,EAAEvK,KAAK,CAAC8nB,UAAU,CAAC,CAAC;cACxEA,UAAU,EAAE;YACb;YACAtf,CAAC,EAAE;YACH,IAAI6D,GAAG,CAAC7D,CAAC,CAAC,IAAI,IAAI,EAAE;cACnB,IAAIuf,QAAQ,IAAIxsB,GAAG,CAAC2K,OAAO,CAACkC,MAAM,GAAG,CAAC,EAAE;gBACvC;gBACA,IAAI7M,GAAG,CAACH,OAAO,CAAC+C,iBAAiB,IAAI,IAAI,EAAE;kBAC1C5C,GAAG,CAACikB,YAAY,CAAC,CAAC;kBAClB;gBACD,CAAC,MAAM;kBACN;gBACD;cACD;cACAuI,QAAQ,GAAGxsB,GAAG,CAAC4oB,KAAK,CAACJ,GAAG,CAACgE,QAAQ,EAAElJ,QAAQ,CAAC;YAC7C;UACD;UAEArU,CAAC,EAAE;UACH,IAAIhO,IAAI,CAACgO,CAAC,CAAC,EAAE;YACZ,IAAIqU,QAAQ,IAAItjB,GAAG,CAACqB,IAAI,CAACwL,MAAM,GAAC,CAAC,EAAE;cAClC;cACA,IAAI7M,GAAG,CAACH,OAAO,CAAC6C,cAAc,IAAI,IAAI,EAAE;gBACvC1C,GAAG,CAACkjB,SAAS,CAAC,CAAC;gBACf;cACD,CAAC,MAAM;gBACN;cACD;YACD;YACAI,QAAQ,GAAGtjB,GAAG,CAACyoB,IAAI,CAACD,GAAG,CAACrW,CAAC,EAAEmR,QAAQ,CAAC;UACrC;QACD;;QAEA;QACAtjB,GAAG,CAACod,yBAAyB,CAACjL,CAAC,EAAEC,CAAC,EAAEoa,QAAQ,EAAElJ,QAAQ,CAAC;;QAEvD;QACAtjB,GAAG,CAAC0X,UAAU,CAAC;UACdC,MAAM,EAAC,UAAU;UACjB/M,OAAO,EAACA,OAAO;UACfI,SAAS,EAAChL,GAAG,CAACkL,YAAY;UAC1BmhB,QAAQ,EAACA,QAAQ;UACjBC,QAAQ,EAACA;QACV,CAAC,CAAC;;QAEF;QACAtsB,GAAG,CAACyH,WAAW,CAAC,CAAC;;QAEjB;QACAzH,GAAG,CAACgM,QAAQ,CAAC,SAAS,EAAEjM,EAAE,EAAEkB,IAAI,CAAC;;QAEjC;QACAjB,GAAG,CAACyF,cAAc,CAAC1F,EAAE,EAAE6K,OAAO,CAAC;MAChC;MAEA5K,GAAG,CAACoe,sBAAsB,CAAC,CAAC;IAC7B,CAAC;;IAED;AACF;AACA;IACEpe,GAAG,CAACoe,sBAAsB,GAAG,YAAW;MACvC,IAAIqO,OAAO,GAAGjsB,QAAQ,CAACksB,gBAAgB,CAAC,kBAAkB,CAAC;MAC3D,KAAK,IAAIzf,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGwf,OAAO,CAAC5f,MAAM,EAAEI,CAAC,EAAE,EAAE;QACxCwf,OAAO,CAACxf,CAAC,CAAC,CAACnB,SAAS,CAAClL,MAAM,CAAC,SAAS,CAAC;QACtC6rB,OAAO,CAACxf,CAAC,CAAC,CAACnB,SAAS,CAAClL,MAAM,CAAC,cAAc,CAAC;QAC3C6rB,OAAO,CAACxf,CAAC,CAAC,CAACnB,SAAS,CAAClL,MAAM,CAAC,eAAe,CAAC;QAC5C6rB,OAAO,CAACxf,CAAC,CAAC,CAACnB,SAAS,CAAClL,MAAM,CAAC,aAAa,CAAC;QAC1C6rB,OAAO,CAACxf,CAAC,CAAC,CAACnB,SAAS,CAAClL,MAAM,CAAC,gBAAgB,CAAC;MAC9C;IACD,CAAC;;IAED;AACF;AACA;IACEZ,GAAG,CAAC2sB,iBAAiB,GAAG,UAAS5tB,IAAI,EAAE6tB,aAAa,EAAE;MACrD,IAAItJ,QAAQ,GAAI,CAAEsJ,aAAa,CAACjsB,YAAY,GAAIisB,aAAa,CAACra,SAAS,GAAG,CAAC,GAAG,CAACqa,aAAa,CAACra,SAAS;MAEtG,IAAIvS,GAAG,CAACH,OAAO,CAACiE,MAAM,IAAI,IAAI,EAAE;QAC/B,IAAI9D,GAAG,CAACsK,OAAO,IAAItK,GAAG,CAACsK,OAAO,CAACuC,MAAM,IAAI7M,GAAG,CAACqB,IAAI,CAACwL,MAAM,EAAE;UACzD7M,GAAG,CAAC8iB,WAAW,CAAC,CAAC;QAClB;MACD;;MAEA;MACA,IAAI/jB,IAAI,IAAI,CAAC,EAAE;QACd,IAAIqkB,SAAS,GAAGwJ,aAAa,CAACxJ,SAAS;QACvC;QACA,KAAK,IAAInU,CAAC,GAAGqU,QAAQ,EAAErU,CAAC,GAAImU,SAAS,GAAGE,QAAS,EAAErU,CAAC,EAAE,EAAE;UACvDjP,GAAG,CAACqB,IAAI,CAAC4N,CAAC,CAAC,CAACvO,UAAU,CAACsb,WAAW,CAAChc,GAAG,CAACqB,IAAI,CAAC4N,CAAC,CAAC,CAAC;QAChD;QACA;QACAjP,GAAG,CAAC4K,OAAO,CAACqY,MAAM,CAACK,QAAQ,EAAEF,SAAS,CAAC;QACvCpjB,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACgiB,MAAM,CAACK,QAAQ,EAAEF,SAAS,CAAC;QAC5CpjB,GAAG,CAACqB,IAAI,CAAC4hB,MAAM,CAACK,QAAQ,EAAEF,SAAS,CAAC;QAEpCpjB,GAAG,CAACqd,0BAA0B,CAAC,CAAC,EAAEiG,QAAQ,EAAGF,SAAS,GAAGE,QAAQ,GAAI,CAAC,CAAC;MACxE,CAAC,MAAM;QACN;QACAtjB,GAAG,CAAC4K,OAAO,GAAGnM,MAAM,CAAC6lB,WAAW,CAACtkB,GAAG,CAAC4K,OAAO,EAAE0Y,QAAQ,EAAEsJ,aAAa,CAAClJ,UAAU,CAAC;QACjF1jB,GAAG,CAACH,OAAO,CAACoB,IAAI,GAAGxC,MAAM,CAAC6lB,WAAW,CAACtkB,GAAG,CAACH,OAAO,CAACoB,IAAI,EAAEqiB,QAAQ,EAAEsJ,aAAa,CAACpa,OAAO,CAAC;QACxFxS,GAAG,CAACqB,IAAI,GAAG5C,MAAM,CAAC6lB,WAAW,CAACtkB,GAAG,CAACqB,IAAI,EAAEiiB,QAAQ,EAAEsJ,aAAa,CAACjJ,OAAO,CAAC;QACxE;QACA,IAAIlW,KAAK,GAAG,CAAC;QACb,KAAK,IAAIwB,CAAC,GAAGqU,QAAQ,EAAErU,CAAC,GAAI2d,aAAa,CAACxJ,SAAS,GAAGE,QAAS,EAAErU,CAAC,EAAE,EAAE;UACrEjP,GAAG,CAACqK,KAAK,CAAC1J,YAAY,CAACisB,aAAa,CAACjJ,OAAO,CAAClW,KAAK,CAAC,EAAEzN,GAAG,CAACqK,KAAK,CAACwL,QAAQ,CAAC5G,CAAC,CAAC,CAAC;UAC3ExB,KAAK,EAAE;QACR;MACD;;MAEA;MACA,IAAIzN,GAAG,CAACH,OAAO,CAACkE,UAAU,GAAG,CAAC,EAAE;QAC/B/D,GAAG,CAAC4O,IAAI,CAAC5O,GAAG,CAACwK,UAAU,CAAC;MACzB;MAEAxK,GAAG,CAAC0iB,qBAAqB,CAAC,CAAC;IAC5B,CAAC;;IAED;AACF;AACA;IACE1iB,GAAG,CAAC6sB,oBAAoB,GAAG,UAAS9tB,IAAI,EAAE6tB,aAAa,EAAE;MACxD,IAAIvI,WAAW,GAAI,CAAEuI,aAAa,CAACjsB,YAAY,GAAIisB,aAAa,CAAC3Z,YAAY,GAAG,CAAC,GAAG2Z,aAAa,CAAC3Z,YAAY;;MAE9G;MACA,IAAIlU,IAAI,IAAI,CAAC,EAAE;QACd,IAAIolB,YAAY,GAAGyI,aAAa,CAACzI,YAAY;QAE7CnkB,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2hB,MAAM,CAACoB,WAAW,EAAEF,YAAY,CAAC;QACrD,KAAK,IAAIlX,CAAC,GAAGoX,WAAW,EAAEpX,CAAC,GAAIkX,YAAY,GAAGE,WAAY,EAAEpX,CAAC,EAAE,EAAE;UAChEjN,GAAG,CAAC2K,OAAO,CAACsC,CAAC,CAAC,CAACvM,UAAU,CAACsb,WAAW,CAAChc,GAAG,CAAC2K,OAAO,CAACsC,CAAC,CAAC,CAAC;UACrDjN,GAAG,CAAC+K,QAAQ,CAACkC,CAAC,CAAC,CAACvM,UAAU,CAACsb,WAAW,CAAChc,GAAG,CAAC+K,QAAQ,CAACkC,CAAC,CAAC,CAAC;QACxD;QACAjN,GAAG,CAAC2K,OAAO,CAACsY,MAAM,CAACoB,WAAW,EAAEF,YAAY,CAAC;QAC7CnkB,GAAG,CAAC+K,QAAQ,CAACkY,MAAM,CAACoB,WAAW,EAAEF,YAAY,CAAC;QAC9C,KAAK,IAAIlV,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG2d,aAAa,CAAC3rB,IAAI,CAAC4L,MAAM,EAAEoC,CAAC,EAAE,EAAE;UACnD,KAAK,IAAIhC,CAAC,GAAGoX,WAAW,EAAEpX,CAAC,GAAIkX,YAAY,GAAGE,WAAY,EAAEpX,CAAC,EAAE,EAAE;YAChEjN,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAAChC,CAAC,CAAC,CAACvM,UAAU,CAACsb,WAAW,CAAChc,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAAChC,CAAC,CAAC,CAAC;UAC5D;UACAjN,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAACgU,MAAM,CAACoB,WAAW,EAAEF,YAAY,CAAC;UAChDnkB,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACgO,CAAC,CAAC,CAACgU,MAAM,CAACoB,WAAW,EAAEF,YAAY,CAAC;QACtD;QACA;QACA,IAAInkB,GAAG,CAACH,OAAO,CAACqF,OAAO,EAAE;UACxB,KAAK,IAAI+J,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjP,GAAG,CAACH,OAAO,CAACqF,OAAO,CAAC2H,MAAM,EAAEoC,CAAC,EAAE,EAAE;YACpDjP,GAAG,CAACH,OAAO,CAACqF,OAAO,CAAC+J,CAAC,CAAC,CAACgU,MAAM,CAACoB,WAAW,EAAEF,YAAY,CAAC;UACzD;QACD;MACD,CAAC,MAAM;QACN;QACAnkB,GAAG,CAACH,OAAO,CAACyB,OAAO,GAAG7C,MAAM,CAAC6lB,WAAW,CAACtkB,GAAG,CAACH,OAAO,CAACyB,OAAO,EAAE+iB,WAAW,EAAEuI,aAAa,CAACtrB,OAAO,CAAC;QACjGtB,GAAG,CAAC2K,OAAO,GAAGlM,MAAM,CAAC6lB,WAAW,CAACtkB,GAAG,CAAC2K,OAAO,EAAE0Z,WAAW,EAAEuI,aAAa,CAACjiB,OAAO,CAAC;QACjF3K,GAAG,CAAC+K,QAAQ,GAAGtM,MAAM,CAAC6lB,WAAW,CAACtkB,GAAG,CAAC+K,QAAQ,EAAEsZ,WAAW,EAAEuI,aAAa,CAAC7hB,QAAQ,CAAC;QAEpF,IAAI0C,KAAK,GAAG,CAAC;QACb,KAAK,IAAIR,CAAC,GAAGoX,WAAW,EAAEpX,CAAC,GAAI2f,aAAa,CAACzI,YAAY,GAAGE,WAAY,EAAEpX,CAAC,EAAE,EAAE;UAC9EjN,GAAG,CAACyK,eAAe,CAAC9J,YAAY,CAACisB,aAAa,CAACjiB,OAAO,CAAC8C,KAAK,CAAC,EAAEzN,GAAG,CAACyK,eAAe,CAACoL,QAAQ,CAAC5I,CAAC,GAAC,CAAC,CAAC,CAAC;UACjGjN,GAAG,CAAC0K,iBAAiB,CAAC/J,YAAY,CAACisB,aAAa,CAAC7hB,QAAQ,CAAC0C,KAAK,CAAC,EAAEzN,GAAG,CAAC0K,iBAAiB,CAACmL,QAAQ,CAAC5I,CAAC,GAAC,CAAC,CAAC,CAAC;UACtGQ,KAAK,EAAE;QACR;QAEA,KAAK,IAAIwB,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG2d,aAAa,CAAC3rB,IAAI,CAAC4L,MAAM,EAAEoC,CAAC,EAAE,EAAE;UACnDjP,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACgO,CAAC,CAAC,GAAGxQ,MAAM,CAAC6lB,WAAW,CAACtkB,GAAG,CAACH,OAAO,CAACoB,IAAI,CAACgO,CAAC,CAAC,EAAEoV,WAAW,EAAEuI,aAAa,CAAC3rB,IAAI,CAACgO,CAAC,CAAC,CAAC;UACjGjP,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,GAAGxQ,MAAM,CAAC6lB,WAAW,CAACtkB,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,EAAEoV,WAAW,EAAEuI,aAAa,CAAChiB,OAAO,CAACqE,CAAC,CAAC,CAAC;UAC1F,IAAIxB,KAAK,GAAG,CAAC;UACb,KAAK,IAAIR,CAAC,GAAGoX,WAAW,EAAEpX,CAAC,GAAI2f,aAAa,CAACzI,YAAY,GAAGE,WAAY,EAAEpX,CAAC,EAAE,EAAE;YAC9EjN,GAAG,CAACqB,IAAI,CAAC4N,CAAC,CAAC,CAACtO,YAAY,CAACisB,aAAa,CAAChiB,OAAO,CAACqE,CAAC,CAAC,CAACxB,KAAK,CAAC,EAAEzN,GAAG,CAACqB,IAAI,CAAC4N,CAAC,CAAC,CAAC4G,QAAQ,CAAC5I,CAAC,GAAC,CAAC,CAAC,CAAC;YACpFQ,KAAK,EAAE;UACR;QACD;QACA;QACA,IAAIzN,GAAG,CAACH,OAAO,CAACqF,OAAO,EAAE;UACxB,KAAK,IAAI+J,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjP,GAAG,CAACH,OAAO,CAACqF,OAAO,CAAC2H,MAAM,EAAEoC,CAAC,EAAE,EAAE;YACpDjP,GAAG,CAACH,OAAO,CAACqF,OAAO,CAAC+J,CAAC,CAAC,GAAGxQ,MAAM,CAAC6lB,WAAW,CAACtkB,GAAG,CAACH,OAAO,CAACqF,OAAO,CAAC+J,CAAC,CAAC,EAAEoV,WAAW,EAAEuI,aAAa,CAAC1nB,OAAO,CAAC+J,CAAC,CAAC,CAAC;UAC3G;QACD;MACD;;MAEA;MACA,IAAIjP,GAAG,CAACH,OAAO,CAAC6B,aAAa,IAAI1B,GAAG,CAACH,OAAO,CAAC6B,aAAa,CAACmL,MAAM,GAAG,CAAC,EAAE;QACtE;QACA,IAAI7M,GAAG,CAACH,OAAO,CAAC6B,aAAa,CAAC,CAAC,CAAC,IAAI1B,GAAG,CAACH,OAAO,CAAC6B,aAAa,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;UACpE,KAAK,IAAIuN,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjP,GAAG,CAACH,OAAO,CAAC6B,aAAa,CAACmL,MAAM,EAAEoC,CAAC,EAAE,EAAE;YAC1D,IAAIlQ,IAAI,IAAI,CAAC,EAAE;cACd,IAAIiX,OAAO,GAAGrH,QAAQ,CAAC3O,GAAG,CAACH,OAAO,CAAC6B,aAAa,CAACuN,CAAC,CAAC,CAACjP,GAAG,CAACH,OAAO,CAAC6B,aAAa,CAACuN,CAAC,CAAC,CAACpC,MAAM,GAAC,CAAC,CAAC,CAACmJ,OAAO,CAAC,GAAG4W,aAAa,CAACzI,YAAY;YACjI,CAAC,MAAM;cACN,IAAInO,OAAO,GAAGrH,QAAQ,CAAC3O,GAAG,CAACH,OAAO,CAAC6B,aAAa,CAACuN,CAAC,CAAC,CAACjP,GAAG,CAACH,OAAO,CAAC6B,aAAa,CAACuN,CAAC,CAAC,CAACpC,MAAM,GAAC,CAAC,CAAC,CAACmJ,OAAO,CAAC,GAAG4W,aAAa,CAACzI,YAAY;YACjI;YACAnkB,GAAG,CAACH,OAAO,CAAC6B,aAAa,CAACuN,CAAC,CAAC,CAACjP,GAAG,CAACH,OAAO,CAAC6B,aAAa,CAACuN,CAAC,CAAC,CAACpC,MAAM,GAAC,CAAC,CAAC,CAACmJ,OAAO,GAAGA,OAAO;YACrFhW,GAAG,CAACoK,KAAK,CAACyL,QAAQ,CAAC5G,CAAC,CAAC,CAAC4G,QAAQ,CAAC7V,GAAG,CAACoK,KAAK,CAACyL,QAAQ,CAAC5G,CAAC,CAAC,CAAC4G,QAAQ,CAAChJ,MAAM,GAAC,CAAC,CAAC,CAACmC,YAAY,CAAC,SAAS,EAAEgH,OAAO,CAAC;UACzG;QACD,CAAC,MAAM;UACN,IAAIjX,IAAI,IAAI,CAAC,EAAE;YACd,IAAIiX,OAAO,GAAGrH,QAAQ,CAAC3O,GAAG,CAACH,OAAO,CAAC6B,aAAa,CAAC,CAAC,CAAC,CAACsU,OAAO,CAAC,GAAG4W,aAAa,CAACzI,YAAY;UAC1F,CAAC,MAAM;YACN,IAAInO,OAAO,GAAGrH,QAAQ,CAAC3O,GAAG,CAACH,OAAO,CAAC6B,aAAa,CAAC,CAAC,CAAC,CAACsU,OAAO,CAAC,GAAG4W,aAAa,CAACzI,YAAY;UAC1F;UACAnkB,GAAG,CAACH,OAAO,CAAC6B,aAAa,CAAC,CAAC,CAAC,CAACsU,OAAO,GAAGA,OAAO;UAC9ChW,GAAG,CAACoK,KAAK,CAACyL,QAAQ,CAAC,CAAC,CAAC,CAACA,QAAQ,CAAC7V,GAAG,CAACoK,KAAK,CAACyL,QAAQ,CAAC,CAAC,CAAC,CAACA,QAAQ,CAAChJ,MAAM,GAAC,CAAC,CAAC,CAACmC,YAAY,CAAC,SAAS,EAAEgH,OAAO,CAAC;QACzG;MACD;MAEAhW,GAAG,CAAC0iB,qBAAqB,CAAC,CAAC;IAC5B,CAAC;;IAED;AACF;AACA;IACE1iB,GAAG,CAAC8sB,IAAI,GAAG,YAAW;MACrB;MACA,IAAIvhB,YAAY,GAAGvL,GAAG,CAACuL,YAAY,GAAG,IAAI,GAAG,KAAK;MAClD,IAAIC,aAAa,GAAGxL,GAAG,CAACwL,aAAa,GAAG,IAAI,GAAG,KAAK;MAEpDxL,GAAG,CAACuL,YAAY,GAAG,IAAI;MACvBvL,GAAG,CAACwL,aAAa,GAAG,IAAI;;MAExB;MACA,IAAIZ,OAAO,GAAG,EAAE;;MAEhB;MACA,IAAI5K,GAAG,CAACsL,YAAY,IAAI,CAAC,EAAE;QAC1B;QACA,IAAIshB,aAAa,GAAG5sB,GAAG,CAAC6K,OAAO,CAAC7K,GAAG,CAACsL,YAAY,EAAE,CAAC;QAEnD,IAAIshB,aAAa,CAACjV,MAAM,IAAI,WAAW,EAAE;UACxC3X,GAAG,CAAC2sB,iBAAiB,CAAC,CAAC,EAAEC,aAAa,CAAC;QACxC,CAAC,MAAM,IAAIA,aAAa,CAACjV,MAAM,IAAI,WAAW,EAAE;UAC/C3X,GAAG,CAAC2sB,iBAAiB,CAAC,CAAC,EAAEC,aAAa,CAAC;QACxC,CAAC,MAAM,IAAIA,aAAa,CAACjV,MAAM,IAAI,cAAc,EAAE;UAClD3X,GAAG,CAAC6sB,oBAAoB,CAAC,CAAC,EAAED,aAAa,CAAC;QAC3C,CAAC,MAAM,IAAIA,aAAa,CAACjV,MAAM,IAAI,cAAc,EAAE;UAClD3X,GAAG,CAAC6sB,oBAAoB,CAAC,CAAC,EAAED,aAAa,CAAC;QAC3C,CAAC,MAAM,IAAIA,aAAa,CAACjV,MAAM,IAAI,SAAS,EAAE;UAC7C3X,GAAG,CAAC4iB,OAAO,CAACgK,aAAa,CAACla,QAAQ,EAAEka,aAAa,CAACzQ,QAAQ,CAAC;QAC5D,CAAC,MAAM,IAAIyQ,aAAa,CAACjV,MAAM,IAAI,YAAY,EAAE;UAChD3X,GAAG,CAACgkB,UAAU,CAAC4I,aAAa,CAACla,QAAQ,EAAEka,aAAa,CAACzQ,QAAQ,CAAC;QAC/D,CAAC,MAAM,IAAIyQ,aAAa,CAACjV,MAAM,IAAI,UAAU,EAAE;UAC9C3X,GAAG,CAAC8X,WAAW,CAAC8U,aAAa,CAAC1W,MAAM,EAAE0W,aAAa,CAAC3rB,IAAI,CAAC;QAC1D,CAAC,MAAM,IAAI2rB,aAAa,CAACjV,MAAM,IAAI,UAAU,EAAE;UAC9C3X,GAAG,CAACmQ,QAAQ,CAACyc,aAAa,CAACzQ,QAAQ,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC,CAAC;QACpD,CAAC,MAAM,IAAIyQ,aAAa,CAACjV,MAAM,IAAI,UAAU,EAAE;UAC9C3X,GAAG,CAACyf,QAAQ,CAACmN,aAAa,CAAC1W,MAAM,EAAE0W,aAAa,CAACzQ,QAAQ,CAAC;QAC3D,CAAC,MAAM,IAAIyQ,aAAa,CAACjV,MAAM,IAAI,WAAW,EAAE;UAC/C3X,GAAG,CAAC4f,SAAS,CAACgN,aAAa,CAAC9b,GAAG,EAAE8b,aAAa,CAACzQ,QAAQ,CAAC;QACzD,CAAC,MAAM,IAAIyQ,aAAa,CAACjV,MAAM,IAAI,WAAW,EAAE;UAC/C3X,GAAG,CAACmgB,SAAS,CAACyM,aAAa,CAAC1W,MAAM,EAAE0W,aAAa,CAACzQ,QAAQ,CAAC;QAC5D,CAAC,MAAM,IAAIyQ,aAAa,CAACjV,MAAM,IAAI,aAAa,EAAE;UACjD3X,GAAG,CAACuhB,WAAW,CAACqL,aAAa,CAAC1W,MAAM,EAAE0W,aAAa,CAACzQ,QAAQ,CAAC,CAAC,CAAC,EAAEyQ,aAAa,CAACzQ,QAAQ,CAAC,CAAC,CAAC,CAAC;QAC5F,CAAC,MAAM,IAAIyQ,aAAa,CAACjV,MAAM,IAAI,SAAS,EAAE;UAC7C,IAAItW,IAAI,GAAG,EAAE;UACb,KAAK,IAAI4N,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG2d,aAAa,CAACvrB,IAAI,CAACwL,MAAM,EAAEoC,CAAC,EAAE,EAAE;YACnD5N,IAAI,CAACurB,aAAa,CAACvrB,IAAI,CAAC4N,CAAC,CAAC,CAAC,GAAGA,CAAC;UAChC;UACAjP,GAAG,CAACwiB,gBAAgB,CAACoK,aAAa,CAAC1W,MAAM,EAAE0W,aAAa,CAACjL,KAAK,GAAG,CAAC,GAAG,CAAC,CAAC;UACvE3hB,GAAG,CAACyiB,WAAW,CAACphB,IAAI,CAAC;QACtB,CAAC,MAAM,IAAIurB,aAAa,CAACjV,MAAM,IAAI,UAAU,EAAE;UAC9C;UACA,KAAK,IAAI1K,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG2f,aAAa,CAAChiB,OAAO,CAACiC,MAAM,EAAEI,CAAC,EAAE,EAAE;YACtDrC,OAAO,CAAC4C,IAAI,CAAC;cACZ2E,CAAC,EAAEya,aAAa,CAAChiB,OAAO,CAACqC,CAAC,CAAC,CAACkF,CAAC;cAC7BC,CAAC,EAAEwa,aAAa,CAAChiB,OAAO,CAACqC,CAAC,CAAC,CAACmF,CAAC;cAC7BM,QAAQ,EAAEka,aAAa,CAAChiB,OAAO,CAACqC,CAAC,CAAC,CAACkP;YACpC,CAAC,CAAC;YAEF,IAAIyQ,aAAa,CAACN,QAAQ,EAAE;cAC3BtsB,GAAG,CAAC+gB,UAAU,CAAC6L,aAAa,CAACN,QAAQ,CAAC;YACvC;UACD;UACA;UACAtsB,GAAG,CAAC+S,QAAQ,CAACnI,OAAO,CAAC;;UAErB;UACA,IAAIgiB,aAAa,CAAC5hB,SAAS,EAAE;YAC5BhL,GAAG,CAACod,yBAAyB,CAACwP,aAAa,CAAC5hB,SAAS,CAAC,CAAC,CAAC,EAAE4hB,aAAa,CAAC5hB,SAAS,CAAC,CAAC,CAAC,EAAE4hB,aAAa,CAAC5hB,SAAS,CAAC,CAAC,CAAC,EAAE4hB,aAAa,CAAC5hB,SAAS,CAAC,CAAC,CAAC,CAAC;UAC9I;QACD;MACD;MACAhL,GAAG,CAACuL,YAAY,GAAGA,YAAY;MAC/BvL,GAAG,CAACwL,aAAa,GAAGA,aAAa;;MAEjC;MACAxL,GAAG,CAACgM,QAAQ,CAAC,QAAQ,EAAEjM,EAAE,EAAE6sB,aAAa,CAAC;IAC1C,CAAC;;IAED;AACF;AACA;IACE5sB,GAAG,CAAC+sB,IAAI,GAAG,YAAW;MACrB;MACA,IAAIxhB,YAAY,GAAGvL,GAAG,CAACuL,YAAY,GAAG,IAAI,GAAG,KAAK;MAClD,IAAIC,aAAa,GAAGxL,GAAG,CAACwL,aAAa,GAAG,IAAI,GAAG,KAAK;MAEpDxL,GAAG,CAACuL,YAAY,GAAG,IAAI;MACvBvL,GAAG,CAACwL,aAAa,GAAG,IAAI;;MAExB;MACA,IAAIZ,OAAO,GAAG,EAAE;;MAEhB;MACA,IAAI5K,GAAG,CAACsL,YAAY,GAAGtL,GAAG,CAAC6K,OAAO,CAACgC,MAAM,GAAG,CAAC,EAAE;QAC9C;QACA,IAAI+f,aAAa,GAAG5sB,GAAG,CAAC6K,OAAO,CAAC,EAAE7K,GAAG,CAACsL,YAAY,CAAC;QAEnD,IAAIshB,aAAa,CAACjV,MAAM,IAAI,WAAW,EAAE;UACxC3X,GAAG,CAAC2sB,iBAAiB,CAAC,CAAC,EAAEC,aAAa,CAAC;QACxC,CAAC,MAAM,IAAIA,aAAa,CAACjV,MAAM,IAAI,WAAW,EAAE;UAC/C3X,GAAG,CAAC2sB,iBAAiB,CAAC,CAAC,EAAEC,aAAa,CAAC;QACxC,CAAC,MAAM,IAAIA,aAAa,CAACjV,MAAM,IAAI,cAAc,EAAE;UAClD3X,GAAG,CAAC6sB,oBAAoB,CAAC,CAAC,EAAED,aAAa,CAAC;QAC3C,CAAC,MAAM,IAAIA,aAAa,CAACjV,MAAM,IAAI,cAAc,EAAE;UAClD3X,GAAG,CAAC6sB,oBAAoB,CAAC,CAAC,EAAED,aAAa,CAAC;QAC3C,CAAC,MAAM,IAAIA,aAAa,CAACjV,MAAM,IAAI,SAAS,EAAE;UAC7C3X,GAAG,CAAC4iB,OAAO,CAACgK,aAAa,CAACzQ,QAAQ,EAAEyQ,aAAa,CAACla,QAAQ,CAAC;QAC5D,CAAC,MAAM,IAAIka,aAAa,CAACjV,MAAM,IAAI,YAAY,EAAE;UAChD3X,GAAG,CAACgkB,UAAU,CAAC4I,aAAa,CAACzQ,QAAQ,EAAEyQ,aAAa,CAACla,QAAQ,CAAC;QAC/D,CAAC,MAAM,IAAIka,aAAa,CAACjV,MAAM,IAAI,UAAU,EAAE;UAC9C3X,GAAG,CAAC6R,QAAQ,CAAC+a,aAAa,CAAC1W,MAAM,EAAE0W,aAAa,CAAC5W,OAAO,EAAE4W,aAAa,CAAC7V,OAAO,EAAE,CAAC,CAAC;QACpF,CAAC,MAAM,IAAI6V,aAAa,CAACjV,MAAM,IAAI,UAAU,EAAE;UAC9C3X,GAAG,CAACmQ,QAAQ,CAACyc,aAAa,CAACla,QAAQ,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC,CAAC;QACpD,CAAC,MAAM,IAAIka,aAAa,CAACjV,MAAM,IAAI,UAAU,EAAE;UAC9C3X,GAAG,CAACyf,QAAQ,CAACmN,aAAa,CAAC1W,MAAM,EAAE0W,aAAa,CAACla,QAAQ,CAAC;QAC3D,CAAC,MAAM,IAAIka,aAAa,CAACjV,MAAM,IAAI,WAAW,EAAE;UAC/C3X,GAAG,CAAC4f,SAAS,CAACgN,aAAa,CAAC9b,GAAG,EAAE8b,aAAa,CAACla,QAAQ,CAAC;QACzD,CAAC,MAAM,IAAIka,aAAa,CAACjV,MAAM,IAAI,WAAW,EAAE;UAC/C3X,GAAG,CAACmgB,SAAS,CAACyM,aAAa,CAAC1W,MAAM,EAAE0W,aAAa,CAACla,QAAQ,CAAC;QAC5D,CAAC,MAAM,IAAIka,aAAa,CAACjV,MAAM,IAAI,aAAa,EAAE;UACjD3X,GAAG,CAACuhB,WAAW,CAACqL,aAAa,CAAC1W,MAAM,EAAE0W,aAAa,CAACla,QAAQ,CAAC,CAAC,CAAC,EAAEka,aAAa,CAACla,QAAQ,CAAC,CAAC,CAAC,CAAC;QAC5F,CAAC,MAAM,IAAIka,aAAa,CAACjV,MAAM,IAAI,SAAS,EAAE;UAC7C3X,GAAG,CAACwiB,gBAAgB,CAACoK,aAAa,CAAC1W,MAAM,EAAE0W,aAAa,CAACjL,KAAK,CAAC;UAC/D3hB,GAAG,CAACyiB,WAAW,CAACmK,aAAa,CAACvrB,IAAI,CAAC;QACpC,CAAC,MAAM,IAAIurB,aAAa,CAACjV,MAAM,IAAI,UAAU,EAAE;UAC9C3X,GAAG,CAAC+S,QAAQ,CAAC6Z,aAAa,CAAChiB,OAAO,CAAC;UACnC;UACA,KAAK,IAAIqC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG2f,aAAa,CAAChiB,OAAO,CAACiC,MAAM,EAAEI,CAAC,EAAE,EAAE;YACtD,IAAI2f,aAAa,CAACN,QAAQ,EAAE;cAC3BtsB,GAAG,CAAC+gB,UAAU,CAAC6L,aAAa,CAACP,QAAQ,CAAC;YACvC;UACD;UACA;UACA,IAAIO,aAAa,CAAC5hB,SAAS,EAAE;YAC5BhL,GAAG,CAACod,yBAAyB,CAACwP,aAAa,CAAC5hB,SAAS,CAAC,CAAC,CAAC,EAAE4hB,aAAa,CAAC5hB,SAAS,CAAC,CAAC,CAAC,EAAE4hB,aAAa,CAAC5hB,SAAS,CAAC,CAAC,CAAC,EAAE4hB,aAAa,CAAC5hB,SAAS,CAAC,CAAC,CAAC,CAAC;UAC9I;QACD;MACD;MACAhL,GAAG,CAACuL,YAAY,GAAGA,YAAY;MAC/BvL,GAAG,CAACwL,aAAa,GAAGA,aAAa;;MAEjC;MACAxL,GAAG,CAACgM,QAAQ,CAAC,QAAQ,EAAEjM,EAAE,EAAE6sB,aAAa,CAAC;IAC1C,CAAC;;IAED;AACF;AACA;IACE5sB,GAAG,CAAC+U,gBAAgB,GAAG,UAASmB,MAAM,EAAEsK,GAAG,EAAE;MAC5C,IAAInhB,KAAK,GAAG,EAAE;MAEd,IAAIW,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC4U,MAAM,CAAC,IAAIlW,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC4U,MAAM,CAAC,CAAC/I,MAAM,EAAE;QACtE;QACA,IAAI6f,KAAK,GAAG,EAAE;QACd,IAAI7f,MAAM,GAAGnN,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC4U,MAAM,CAAC,CAAC/I,MAAM;QAE/C,KAAK,IAAIF,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGE,MAAM,CAACN,MAAM,EAAEI,CAAC,EAAE,EAAE;UACvC,IAAI,OAAOE,MAAM,CAACF,CAAC,CAAE,IAAI,QAAQ,EAAE;YAClC+f,KAAK,CAAC7f,MAAM,CAACF,CAAC,CAAC,CAACsC,EAAE,CAAC,GAAGpC,MAAM,CAACF,CAAC,CAAC,CAACC,IAAI;UACrC,CAAC,MAAM;YACN8f,KAAK,CAAC7f,MAAM,CAACF,CAAC,CAAC,CAAC,GAAGE,MAAM,CAACF,CAAC,CAAC;UAC7B;QACD;;QAEA;QACA,IAAIH,IAAI,GAAGT,KAAK,CAACwE,OAAO,CAAC2P,GAAG,CAAC,GAAGA,GAAG,GAAG,CAAC,EAAE,GAAGA,GAAG,EAAE3M,KAAK,CAAC,GAAG,CAAC;QAE3D,KAAK,IAAI5G,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGH,IAAI,CAACD,MAAM,EAAEI,CAAC,EAAE,EAAE;UACrC,IAAI,OAAOH,IAAI,CAACG,CAAC,CAAE,KAAK,QAAQ,EAAE;YACjC5N,KAAK,CAACmO,IAAI,CAACwf,KAAK,CAAClgB,IAAI,CAACG,CAAC,CAAC,CAACsC,EAAE,CAAC,CAAC;UAC9B,CAAC,MAAM;YACN,IAAIyd,KAAK,CAAClgB,IAAI,CAACG,CAAC,CAAC,CAAC,EAAE;cACnB5N,KAAK,CAACmO,IAAI,CAACwf,KAAK,CAAClgB,IAAI,CAACG,CAAC,CAAC,CAAC,CAAC;YAC3B;UACD;QACD;MACD,CAAC,MAAM;QACN9M,OAAO,CAACC,KAAK,CAAC,gBAAgB,CAAC;MAChC;MAEA,OAAQf,KAAK,CAACwN,MAAM,GAAG,CAAC,GAAIxN,KAAK,CAACF,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE;IAClD,CAAC;;IAED;AACF;AACA;IACE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;IAQE;IACA;IACAa,GAAG,CAACgsB,QAAQ,GAAG,UAASV,GAAG,EAAEZ,SAAS,EAAE;MACvC;MACAY,GAAG,GAAGA,GAAG,CAAC9D,OAAO,CAAE,iBAAiB,EAAE,EAAG,CAAC;MAC1C8D,GAAG,IAAI,IAAI;;MAEX;MACAZ,SAAS,GAAGA,SAAS,IAAI,GAAG;MAE5B,MAAMuC,YAAY,GAAG,IAAIjZ,MAAM,CAAE,GAAG,GAAG,WAAW,CAACwT,OAAO,CAAEkD,SAAS,EAAE,EAAG,CAAC,GAAG,GAAI,CAAC;MAEnF,IAAIrpB,IAAI,GAAG,EAAE,CAAC,CAAC;MACf,IAAIyP,GAAG,GAAG,EAAE,CAAC,CAAC;MACd,IAAIoF,MAAM,GAAG,CAAC,CAAC,CAAC;MAChB,IAAIgX,YAAY,GAAG,EAAE,CAAC,CAAC;MACvB,IAAIC,QAAQ,GAAG,KAAK;MACpB,IAAIC,YAAY,GAAG,KAAK,CAAC,CAAC;;MAE1B;MACA,MAAMC,WAAW,GAAG/B,GAAG,CAACze,MAAM;MAC9B,KAAM,IAAII,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGogB,WAAW,EAAEpgB,CAAC,EAAE,EAAG;QACvC,IAAIqgB,SAAS,GAAGhC,GAAG,CAAEre,CAAC,CAAE;QACxB,IAAIsgB,SAAS,GAAKtgB,CAAC,GAAG,CAAC,GAAGogB,WAAW,GAAK/B,GAAG,CAAEre,CAAC,GAAG,CAAC,CAAE,GAAG,EAAE;QAE3D,IAAKqgB,SAAS,KAAK,GAAG,EAAG;UACxB;UACA,IAAK,CAAEH,QAAQ,EAAG;YACjB,IAAK,EAAE,KAAKD,YAAY,CAAC1F,OAAO,CAAEyF,YAAY,EAAE,EAAG,CAAC,EAAG;cACtDE,QAAQ,GAAG,IAAI;cACfC,YAAY,GAAG,IAAI;YACpB,CAAC,MAAM;cACN;cACAF,YAAY,IAAII,SAAS;YAC1B;UACD,CAAC,MAAM,IAAKC,SAAS,KAAK,GAAG,EAAG;YAC/B;YACAL,YAAY,IAAII,SAAS;YACzB,EAAErgB,CAAC,CAAC,CAAC;UACN,CAAC,MAAM,IAAKsgB,SAAS,KAAK7C,SAAS,IAAI,IAAI,KAAK6C,SAAS,IAAI,IAAI,KAAKA,SAAS,EAAG;YACjF;YACA,IAAIpb,CAAC,GAAGlF,CAAC,GAAG,CAAC;YACb,OAAQoE,SAAS,KAAKia,GAAG,CAAEnZ,CAAC,CAAE,IAAI,EAAE,KAAKmZ,GAAG,CAAEnZ,CAAC,CAAE,CAACqV,OAAO,CAAEyF,YAAY,EAAE,EAAG,CAAC,EAAE9a,CAAC,EAAE,EAAG;cACpF;YAAA;YAED,IAAKmZ,GAAG,CAAEnZ,CAAC,CAAE,KAAKuY,SAAS,EAAG;cAC7ByC,QAAQ,GAAG,KAAK;cAChBlgB,CAAC,GAAGkF,CAAC;YACN,CAAC,MAAM;cACN;cACA+a,YAAY,IAAII,SAAS;cACzBH,QAAQ,GAAG,KAAK;YACjB;UACD,CAAC,MAAM;YACN;YACAA,QAAQ,GAAG,KAAK;UACjB;QACD,CAAC,MAAM,IAAK,CAAEG,SAAS,KAAK5C,SAAS,IAAI,IAAI,KAAK4C,SAAS,IAAI,IAAI,KAAKA,SAAS,KAAM,CAAEH,QAAQ,EAAG;UACnG;UACArc,GAAG,CAAEoF,MAAM,CAAE,GAAGkX,YAAY,GAAGF,YAAY,GAAGA,YAAY,CAAC9L,IAAI,CAAC,CAAC;UACjE8L,YAAY,GAAG,EAAE;UACjBE,YAAY,GAAG,KAAK;UACpB,EAAElX,MAAM;;UAER;UACA,IAAK,IAAI,KAAKoX,SAAS,IAAI,IAAI,KAAKA,SAAS,EAAG;YAC/C;YACAjsB,IAAI,CAACmM,IAAI,CAAEsD,GAAI,CAAC;YAChBA,GAAG,GAAG,EAAE;YACRoF,MAAM,GAAG,CAAC;YACV,IAAK,IAAI,KAAKoX,SAAS,IAAI,IAAI,KAAKC,SAAS,EAAG;cAC/C;cACA,EAAEtgB,CAAC;YACJ;UACD;QACD,CAAC,MAAM;UACN;UACAigB,YAAY,IAAII,SAAS;QAC1B;MACD;MAEA,OAAOjsB,IAAI;IACZ,CAAC;IAEDrB,GAAG,CAAC0rB,IAAI,GAAG,UAASJ,GAAG,EAAE;MACxB,IAAII,IAAI,GAAG,CAAC;QAAEze,CAAC;QAAEugB,GAAG;MAEpB,IAAIlC,GAAG,CAACze,MAAM,KAAK,CAAC,EAAE;QACrB,OAAO6e,IAAI;MACZ,CAAC,MAAM;QACN,KAAKze,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGqe,GAAG,CAACze,MAAM,EAAEI,CAAC,EAAE,EAAE;UAC/BugB,GAAG,GAAGlC,GAAG,CAACmC,UAAU,CAACxgB,CAAC,CAAC;UACvBye,IAAI,GAAI,CAACA,IAAI,IAAI,CAAC,IAAIA,IAAI,GAAI8B,GAAG;UACjC9B,IAAI,IAAI,CAAC;QACX;MACD;MACA,OAAOA,IAAI;IACZ,CAAC;IAED1rB,GAAG,CAACyF,cAAc,GAAG,UAAS1F,EAAE,EAAE6K,OAAO,EAAE;MAC1C;MACA5K,GAAG,CAACgM,QAAQ,CAAC,gBAAgB,EAAEjM,EAAE,EAAE6K,OAAO,CAAC;IAC5C,CAAC;IAED5K,GAAG,CAAC0tB,OAAO,GAAG,YAAW;MACxBjvB,MAAM,CAACivB,OAAO,CAAC3tB,EAAE,CAAC;IACnB,CAAC;;IAED;AACF;AACA;IACEC,GAAG,CAAC2tB,IAAI,GAAG,YAAW;MACrBlvB,MAAM,CAACmvB,OAAO,GAAG5tB,GAAG;;MAEpB;MACA,IAAI,OAAOvB,MAAM,CAACovB,KAAM,IAAI,UAAU,EAAE;QACvC,IAAI7tB,GAAG,CAACH,OAAO,CAACuB,IAAI,EAAE;UACrB3C,MAAM,CAACovB,KAAK,CAAC7tB,GAAG,CAACH,OAAO,CAACuB,IAAI,CAAC;QAC/B,CAAC,MAAM;UACN3C,MAAM,CAACovB,KAAK,CAACrtB,QAAQ,CAAC;UACtB/B,MAAM,CAACovB,KAAK,GAAG,IAAI;QACpB;MACD;;MAEA;MACA9tB,EAAE,CAACiP,YAAY,CAAC,UAAU,EAAE,CAAC,CAAC;MAC9BjP,EAAE,CAAC+tB,gBAAgB,CAAC,OAAO,EAAE,UAAS9f,CAAC,EAAE;QACxC,IAAIvP,MAAM,CAACmvB,OAAO,IAAI,CAAE5tB,GAAG,CAACkL,YAAY,EAAE;UACzClL,GAAG,CAACod,yBAAyB,CAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,CAAC;UACtCpd,GAAG,CAAC0d,IAAI,CAAC,CAAC;QACX;MACD,CAAC,CAAC;;MAEF;MACA,IAAI1d,GAAG,CAACH,OAAO,CAACwD,GAAG,EAAE;QACpB;QACA,IAAIrD,GAAG,CAACH,OAAO,CAACsE,WAAW,IAAI,IAAI,EAAE;UACpC0J,OAAO,CAAC2C,OAAO,CAACzI,IAAI,CAAC,CAAC;QACvB;;QAEA;QACA8F,OAAO,CAACC,IAAI,CAAC;UACZhN,GAAG,EAAEd,GAAG,CAACH,OAAO,CAACwD,GAAG;UACpBtC,MAAM,EAAEf,GAAG,CAACH,OAAO,CAACkB,MAAM;UAC1BE,IAAI,EAAEjB,GAAG,CAACH,OAAO,CAACmB,gBAAgB;UAClC0M,QAAQ,EAAE,MAAM;UAChBC,OAAO,EAAE,SAAAA,CAAS8C,MAAM,EAAE;YACzB;YACA,IAAIsd,OAAO,GAAG/tB,GAAG,CAACgsB,QAAQ,CAACvb,MAAM,EAAEzQ,GAAG,CAACH,OAAO,CAAC2D,YAAY,CAAC;;YAE5D;YACA,IAAIxD,GAAG,CAACH,OAAO,CAAC0D,UAAU,IAAI,IAAI,IAAIwqB,OAAO,CAAClhB,MAAM,GAAG,CAAC,EAAE;cACzD,IAAIlC,OAAO,GAAGojB,OAAO,CAACC,KAAK,CAAC,CAAC;cAC7B,KAAI,IAAI/gB,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGtC,OAAO,CAACkC,MAAM,EAAEI,CAAC,EAAE,EAAE;gBACvC,IAAI,CAAEjN,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,EAAE;kBAC7BjN,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,GAAG;oBAAElO,IAAI,EAAC,MAAM;oBAAEwO,KAAK,EAACvN,GAAG,CAACH,OAAO,CAAC+B,eAAe;oBAAE0L,KAAK,EAACtN,GAAG,CAACH,OAAO,CAAC8B;kBAAgB,CAAC;gBAC/G;gBACA;gBACA,IAAI,OAAO3B,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAACpO,KAAK,KAAK,WAAW,EAAE;kBACvDmB,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAACpO,KAAK,GAAG8L,OAAO,CAACsC,CAAC,CAAC;gBAC3C;cACD;YACD;YACA;YACAjN,GAAG,CAACH,OAAO,CAACoB,IAAI,GAAG8sB,OAAO;YAC1B;YACA/tB,GAAG,CAAC2M,YAAY,CAAC,CAAC;YAClB;YACA,IAAI3M,GAAG,CAACH,OAAO,CAACsE,WAAW,IAAI,IAAI,EAAE;cACpC0J,OAAO,CAAC2C,OAAO,CAACE,IAAI,CAAC,CAAC;YACvB;UACD;QACD,CAAC,CAAC;MACH,CAAC,MAAM,IAAI1Q,GAAG,CAACH,OAAO,CAACiB,GAAG,EAAE;QAC3B;QACA,IAAId,GAAG,CAACH,OAAO,CAACsE,WAAW,IAAI,IAAI,EAAE;UACpC0J,OAAO,CAAC2C,OAAO,CAACzI,IAAI,CAAC,CAAC;QACvB;QAEA8F,OAAO,CAACC,IAAI,CAAC;UACZhN,GAAG,EAAEd,GAAG,CAACH,OAAO,CAACiB,GAAG;UACpBC,MAAM,EAAEf,GAAG,CAACH,OAAO,CAACkB,MAAM;UAC1BE,IAAI,EAAEjB,GAAG,CAACH,OAAO,CAACmB,gBAAgB;UAClC0M,QAAQ,EAAE,MAAM;UAChBC,OAAO,EAAE,SAAAA,CAAS8C,MAAM,EAAE;YACzB;YACAzQ,GAAG,CAACH,OAAO,CAACoB,IAAI,GAAIwP,MAAM,CAACxP,IAAI,GAAIwP,MAAM,CAACxP,IAAI,GAAGwP,MAAM;YACvD;YACAzQ,GAAG,CAAC2M,YAAY,CAAC,CAAC;YAClB;YACA,IAAI3M,GAAG,CAACH,OAAO,CAACsE,WAAW,IAAI,IAAI,EAAE;cACpC0J,OAAO,CAAC2C,OAAO,CAACE,IAAI,CAAC,CAAC;YACvB;UACD;QACD,CAAC,CAAC;MACH,CAAC,MAAM;QACN;QACA1Q,GAAG,CAAC2M,YAAY,CAAC,CAAC;MACnB;IACD,CAAC;;IAED;IACA,IAAI9M,OAAO,IAAIA,OAAO,CAACkK,WAAW,IAAI,IAAI,EAAE;MAC3C/J,GAAG,CAACH,OAAO,CAACkK,WAAW,GAAGlK,OAAO,CAACkK,WAAW;IAC9C,CAAC,MAAM;MACN/J,GAAG,CAACH,OAAO,CAACkK,WAAW,GAAG,UAAShK,EAAE,EAAEoS,CAAC,EAAEC,CAAC,EAAEpE,CAAC,EAAE;QAC/C,IAAIigB,KAAK,GAAG,EAAE;QAEd,IAAI7b,CAAC,IAAI,IAAI,EAAE;UACd;UACA,IAAIpS,GAAG,CAACH,OAAO,CAAC+C,iBAAiB,IAAI,IAAI,EAAE;YAC1CqrB,KAAK,CAACzgB,IAAI,CAAC;cACV3O,KAAK,EAACmB,GAAG,CAACH,OAAO,CAAC+H,IAAI,CAACM,sBAAsB;cAC7CwH,OAAO,EAAC,SAAAA,CAAA,EAAW;gBAClB1P,GAAG,CAACikB,YAAY,CAAC,CAAC,EAAEtV,QAAQ,CAACwD,CAAC,CAAC,EAAE,CAAC,CAAC;cACpC;YACD,CAAC,CAAC;UACH;UAEA,IAAInS,GAAG,CAACH,OAAO,CAAC+C,iBAAiB,IAAI,IAAI,EAAE;YAC1CqrB,KAAK,CAACzgB,IAAI,CAAC;cACV3O,KAAK,EAACmB,GAAG,CAACH,OAAO,CAAC+H,IAAI,CAACO,qBAAqB;cAC5CuH,OAAO,EAAC,SAAAA,CAAA,EAAW;gBAClB1P,GAAG,CAACikB,YAAY,CAAC,CAAC,EAAEtV,QAAQ,CAACwD,CAAC,CAAC,EAAE,CAAC,CAAC;cACpC;YACD,CAAC,CAAC;UACH;;UAEA;UACA,IAAInS,GAAG,CAACH,OAAO,CAACmD,iBAAiB,IAAI,IAAI,EAAE;YAC1CirB,KAAK,CAACzgB,IAAI,CAAC;cACV3O,KAAK,EAACmB,GAAG,CAACH,OAAO,CAAC+H,IAAI,CAACQ,qBAAqB;cAC5CsH,OAAO,EAAC,SAAAA,CAAA,EAAW;gBAClB1P,GAAG,CAAC+kB,YAAY,CAAC/kB,GAAG,CAACglB,kBAAkB,CAAC,CAAC,CAACnY,MAAM,GAAGwE,SAAS,GAAG1C,QAAQ,CAACwD,CAAC,CAAC,CAAC;cAC5E;YACD,CAAC,CAAC;UACH;;UAEA;UACA,IAAInS,GAAG,CAACH,OAAO,CAACoD,iBAAiB,IAAI,IAAI,EAAE;YAC1CgrB,KAAK,CAACzgB,IAAI,CAAC;cACV3O,KAAK,EAACmB,GAAG,CAACH,OAAO,CAAC+H,IAAI,CAACS,gBAAgB;cACvCqH,OAAO,EAAC,SAAAA,CAAA,EAAW;gBAClB1P,GAAG,CAACmgB,SAAS,CAAChO,CAAC,CAAC;cACjB;YACD,CAAC,CAAC;UACH;;UAEA;UACA,IAAInS,GAAG,CAACH,OAAO,CAACuC,aAAa,IAAI,IAAI,EAAE;YACtC;YACA6rB,KAAK,CAACzgB,IAAI,CAAC;cAAEzO,IAAI,EAAC;YAAO,CAAC,CAAC;YAE3BkvB,KAAK,CAACzgB,IAAI,CAAC;cACV3O,KAAK,EAACmB,GAAG,CAACH,OAAO,CAAC+H,IAAI,CAACU,cAAc;cACrCoH,OAAO,EAAC,SAAAA,CAAA,EAAW;gBAClB1P,GAAG,CAAC0hB,OAAO,CAACvP,CAAC,EAAE,CAAC,CAAC;cAClB;YACD,CAAC,CAAC;YACF8b,KAAK,CAACzgB,IAAI,CAAC;cACV3O,KAAK,EAACmB,GAAG,CAACH,OAAO,CAAC+H,IAAI,CAACW,eAAe;cACtCmH,OAAO,EAAC,SAAAA,CAAA,EAAW;gBAClB1P,GAAG,CAAC0hB,OAAO,CAACvP,CAAC,EAAE,CAAC,CAAC;cAClB;YACD,CAAC,CAAC;UACH;QACD,CAAC,MAAM;UACN;UACA,IAAInS,GAAG,CAACH,OAAO,CAAC6C,cAAc,IAAI,IAAI,EAAE;YACvCurB,KAAK,CAACzgB,IAAI,CAAC;cACV3O,KAAK,EAACmB,GAAG,CAACH,OAAO,CAAC+H,IAAI,CAACY,mBAAmB;cAC1CkH,OAAO,EAAC,SAAAA,CAAA,EAAW;gBAClB1P,GAAG,CAACkjB,SAAS,CAAC,CAAC,EAAEvU,QAAQ,CAACyD,CAAC,CAAC,EAAE,CAAC,CAAC;cACjC;YACD,CAAC,CAAC;YAEF6b,KAAK,CAACzgB,IAAI,CAAC;cACV3O,KAAK,EAACmB,GAAG,CAACH,OAAO,CAAC+H,IAAI,CAACa,kBAAkB;cACzCiH,OAAO,EAAC,SAAAA,CAAA,EAAW;gBAClB1P,GAAG,CAACkjB,SAAS,CAAC,CAAC,EAAEvU,QAAQ,CAACyD,CAAC,CAAC,CAAC;cAC9B;YACD,CAAC,CAAC;UACH;UAEA,IAAIpS,GAAG,CAACH,OAAO,CAACiD,cAAc,IAAI,IAAI,EAAE;YACvCmrB,KAAK,CAACzgB,IAAI,CAAC;cACV3O,KAAK,EAACmB,GAAG,CAACH,OAAO,CAAC+H,IAAI,CAACc,kBAAkB;cACzCgH,OAAO,EAAC,SAAAA,CAAA,EAAW;gBAClB1P,GAAG,CAAC4jB,SAAS,CAAC5jB,GAAG,CAAC8jB,eAAe,CAAC,CAAC,CAACjX,MAAM,GAAGwE,SAAS,GAAG1C,QAAQ,CAACyD,CAAC,CAAC,CAAC;cACtE;YACD,CAAC,CAAC;UACH;UAEA,IAAID,CAAC,EAAE;YACN,IAAInS,GAAG,CAACH,OAAO,CAACqD,aAAa,IAAI,IAAI,EAAE;cACtC+qB,KAAK,CAACzgB,IAAI,CAAC;gBAAEzO,IAAI,EAAC;cAAO,CAAC,CAAC;cAE3B,IAAIF,KAAK,GAAGmB,GAAG,CAAC4K,OAAO,CAACwH,CAAC,CAAC,CAACD,CAAC,CAAC,CAACoE,YAAY,CAAC,OAAO,CAAC,IAAI,EAAE;cAEzD0X,KAAK,CAACzgB,IAAI,CAAC;gBACV3O,KAAK,EAAEA,KAAK,GAAGmB,GAAG,CAACH,OAAO,CAAC+H,IAAI,CAACe,YAAY,GAAG3I,GAAG,CAACH,OAAO,CAAC+H,IAAI,CAACgB,WAAW;gBAC3E8G,OAAO,EAAC,SAAAA,CAAA,EAAW;kBAClB,IAAIwe,OAAO,GAAG9N,MAAM,CAACpgB,GAAG,CAACH,OAAO,CAAC+H,IAAI,CAACiB,QAAQ,EAAEhK,KAAK,CAAC;kBACtD,IAAIqvB,OAAO,EAAE;oBACZluB,GAAG,CAACuhB,WAAW,CAAC,CAAEpP,CAAC,EAAEC,CAAC,CAAE,EAAE8b,OAAO,CAAC;kBACnC;gBACD;cACD,CAAC,CAAC;cAEF,IAAIrvB,KAAK,EAAE;gBACVovB,KAAK,CAACzgB,IAAI,CAAC;kBACV3O,KAAK,EAACmB,GAAG,CAACH,OAAO,CAAC+H,IAAI,CAACkB,aAAa;kBACpC4G,OAAO,EAAC,SAAAA,CAAA,EAAW;oBAClB1P,GAAG,CAACuhB,WAAW,CAAC,CAAEpP,CAAC,EAAEC,CAAC,CAAE,EAAE,EAAE,CAAC;kBAC9B;gBACD,CAAC,CAAC;cACH;YACD;UACD;QACD;;QAEA;QACA6b,KAAK,CAACzgB,IAAI,CAAC;UAAEzO,IAAI,EAAC;QAAO,CAAC,CAAC;;QAE3B;QACAkvB,KAAK,CAACzgB,IAAI,CAAC;UACV3O,KAAK,EAACmB,GAAG,CAACH,OAAO,CAAC+H,IAAI,CAACmB,IAAI;UAC3BolB,QAAQ,EAAC,UAAU;UACnBze,OAAO,EAAC,SAAAA,CAAA,EAAW;YAClB1P,GAAG,CAAC+I,IAAI,CAAC,IAAI,CAAC;UACf;QACD,CAAC,CAAC;;QAEF;QACA,IAAIkhB,SAAS,IAAIA,SAAS,CAACmE,SAAS,EAAE;UACrCH,KAAK,CAACzgB,IAAI,CAAC;YACV3O,KAAK,EAACmB,GAAG,CAACH,OAAO,CAAC+H,IAAI,CAACoB,KAAK;YAC5BmlB,QAAQ,EAAC,UAAU;YACnBze,OAAO,EAAC,SAAAA,CAAA,EAAW;cAClB,IAAI1P,GAAG,CAACkL,YAAY,EAAE;gBACrB+e,SAAS,CAACmE,SAAS,CAACC,QAAQ,CAAC,CAAC,CAACC,IAAI,CAAC,UAAS1mB,IAAI,EAAE;kBAClD,IAAIA,IAAI,EAAE;oBACTnJ,MAAM,CAACmvB,OAAO,CAAC5kB,KAAK,CAAChJ,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,EAAElL,GAAG,CAACkL,YAAY,CAAC,CAAC,CAAC,EAAEtD,IAAI,CAAC;kBACrE;gBACD,CAAC,CAAC;cACH;YACD;UACD,CAAC,CAAC;QACH;;QAEA;QACA,IAAI5H,GAAG,CAACH,OAAO,CAACoC,WAAW,EAAE;UAC5BgsB,KAAK,CAACzgB,IAAI,CAAC;YACV3O,KAAK,EAAEmB,GAAG,CAACH,OAAO,CAAC+H,IAAI,CAACqB,MAAM;YAC9BklB,QAAQ,EAAE,UAAU;YACpBze,OAAO,EAAE,SAAAA,CAAA,EAAY;cACpB1P,GAAG,CAAC6pB,QAAQ,CAAC,CAAC;YACf;UACD,CAAC,CAAC;QACH;;QAEA;QACA,IAAI7pB,GAAG,CAACH,OAAO,CAACqJ,KAAK,EAAE;UACtB+kB,KAAK,CAACzgB,IAAI,CAAC;YACV3O,KAAK,EAACmB,GAAG,CAACH,OAAO,CAAC+H,IAAI,CAACsB,KAAK;YAC5BwG,OAAO,EAAC,SAAAA,CAAA,EAAW;cAClB,IAAI1P,GAAG,CAACH,OAAO,CAACqJ,KAAK,KAAK,IAAI,EAAE;gBAC/BgO,KAAK,CAACvY,OAAO,CAAC,CAAC,CAACO,KAAK,CAAC,CAAC,CAAC;cACzB,CAAC,MAAM;gBACNgY,KAAK,CAAClX,GAAG,CAACH,OAAO,CAACqJ,KAAK,CAAC;cACzB;YACD;UACD,CAAC,CAAC;QACH;QAEA,OAAO+kB,KAAK;MACb,CAAC;IACF;IAEAjuB,GAAG,CAACiO,cAAc,GAAG,UAASD,CAAC,EAAE;MAChChO,GAAG,CAACmO,aAAa,CAAC,CAAC;MAEnB,IAAInO,GAAG,CAACH,OAAO,CAAC8H,aAAa,GAAG,CAAC,IAAI3H,GAAG,CAACkK,OAAO,CAAC4Q,UAAU,IAAIA,UAAU,EAAE;QAC1E9a,GAAG,CAACuuB,oBAAoB,CAAC,CAAC;MAC3B;;MAEA;MACA,IAAIvuB,GAAG,CAACH,OAAO,CAACqE,WAAW,IAAI,IAAI,IAAIlE,GAAG,CAACH,OAAO,CAACuE,aAAa,IAAI,IAAI,EAAE;QACzE,IAAIpE,GAAG,CAACyL,OAAO,IAAIuC,CAAC,CAACwgB,MAAM,CAACnf,SAAS,CAACkE,MAAM,CAAC,CAAC,EAAC,CAAC,CAAC,IAAI,WAAW,EAAE;UACjEvT,GAAG,CAAC8Z,WAAW,CAAC9Z,GAAG,CAACyL,OAAO,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC;QACtC;MACD;IACD,CAAC;IAEDzL,GAAG,CAACmO,aAAa,GAAG,UAASH,CAAC,EAAE;MAC/B,IAAIhO,GAAG,CAACH,OAAO,CAACqE,WAAW,IAAI,IAAI,EAAE;QACpC,IAAIzF,MAAM,CAACgwB,kBAAkB,IAAI,IAAI,EAAE;UACtChwB,MAAM,CAACgwB,kBAAkB,GAAG7I,UAAU,CAAC,YAAW;YACjD,IAAI5lB,GAAG,CAACkK,OAAO,CAAC6U,SAAS,GAAG/e,GAAG,CAACkK,OAAO,CAACwkB,YAAY,IAAI1uB,GAAG,CAACkK,OAAO,CAACykB,YAAY,GAAG,EAAE,EAAE;cACtF,IAAI3uB,GAAG,CAAC2oB,QAAQ,CAAC,CAAC,EAAE;gBACnB,IAAI3oB,GAAG,CAACkK,OAAO,CAAC6U,SAAS,GAAG/e,GAAG,CAACkK,OAAO,CAACwkB,YAAY,GAAG1uB,GAAG,CAACkK,OAAO,CAACykB,YAAY,GAAG,EAAE,EAAE;kBACrF3uB,GAAG,CAACkK,OAAO,CAAC6U,SAAS,GAAG/e,GAAG,CAACkK,OAAO,CAAC6U,SAAS,GAAG/e,GAAG,CAACkK,OAAO,CAACwkB,YAAY;gBACzE;gBACA1uB,GAAG,CAAC0a,oBAAoB,CAAC,CAAC;cAC3B;YACD,CAAC,MAAM,IAAI1a,GAAG,CAACkK,OAAO,CAAC6U,SAAS,IAAI/e,GAAG,CAACkK,OAAO,CAACwkB,YAAY,EAAE;cAC7D,IAAI1uB,GAAG,CAACqoB,MAAM,CAAC,CAAC,EAAE;gBACjB,IAAIroB,GAAG,CAACkK,OAAO,CAAC6U,SAAS,GAAG,EAAE,EAAE;kBAC/B/e,GAAG,CAACkK,OAAO,CAAC6U,SAAS,GAAG/e,GAAG,CAACkK,OAAO,CAAC6U,SAAS,GAAG/e,GAAG,CAACkK,OAAO,CAACwkB,YAAY;gBACzE;gBACA1uB,GAAG,CAAC0a,oBAAoB,CAAC,CAAC;cAC3B;YACD;YAEAjc,MAAM,CAACgwB,kBAAkB,GAAG,IAAI;UACjC,CAAC,EAAE,GAAG,CAAC;QACR;MACD;IACD,CAAC;;IAED;IACAzuB,GAAG,CAACgf,cAAc,GAAG,YAAW;MAC/B,IAAI1R,KAAK,GAAG,CAAC;MACb,IAAItN,GAAG,CAACH,OAAO,CAAC8H,aAAa,GAAG,CAAC,EAAE;QAClC,KAAK,IAAIsF,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjN,GAAG,CAACH,OAAO,CAAC8H,aAAa,EAAEsF,CAAC,EAAE,EAAE;UACnDK,KAAK,IAAIqB,QAAQ,CAAC3O,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAACK,KAAK,CAAC;QAChD;MACD;MACA,OAAOA,KAAK;IACb,CAAC;IAED,IAAIwN,UAAU,GAAG,CAAC;IAElB9a,GAAG,CAACuuB,oBAAoB,GAAG,YAAW;MACrCzT,UAAU,GAAG9a,GAAG,CAACkK,OAAO,CAAC4Q,UAAU;MACnC,IAAIxN,KAAK,GAAG,CAAC;MACb,IAAIwN,UAAU,GAAG,EAAE,EAAE;QACpB,KAAK,IAAI7N,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjN,GAAG,CAACH,OAAO,CAAC8H,aAAa,EAAEsF,CAAC,EAAE,EAAE;UACnD,IAAIA,CAAC,GAAG,CAAC,EAAE;YACV;YACA,IAAIjN,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,GAAC,CAAC,CAAC,CAAClO,IAAI,KAAK,QAAQ,EAAE;cAC/CuO,KAAK,IAAIqB,QAAQ,CAAC3O,GAAG,CAACH,OAAO,CAACyB,OAAO,CAAC2L,CAAC,GAAC,CAAC,CAAC,CAACK,KAAK,CAAC;YAClD;UACD;UACAtN,GAAG,CAAC2K,OAAO,CAACsC,CAAC,CAAC,CAACnB,SAAS,CAACC,GAAG,CAAC,gBAAgB,CAAC;UAC9C/L,GAAG,CAAC2K,OAAO,CAACsC,CAAC,CAAC,CAACxI,KAAK,CAACiZ,IAAI,GAAGpQ,KAAK,GAAG,IAAI;UACxC,KAAK,IAAI2B,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjP,GAAG,CAACqB,IAAI,CAACwL,MAAM,EAAEoC,CAAC,EAAE,EAAE;YACzC,IAAIjP,GAAG,CAACqB,IAAI,CAAC4N,CAAC,CAAC,IAAIjP,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAAChC,CAAC,CAAC,EAAE;cACrC,IAAI2hB,OAAO,GAAI9T,UAAU,IAAI7N,CAAC,GAAG,CAAC,GAAGjN,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAAChC,CAAC,GAAC,CAAC,CAAC,CAACxI,KAAK,CAAC6I,KAAK,GAAG,CAAC,CAAC,GAAI,EAAE,GAAG,IAAI;cACtFtN,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAAChC,CAAC,CAAC,CAACnB,SAAS,CAACC,GAAG,CAAC,gBAAgB,CAAC;cACjD/L,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAAChC,CAAC,CAAC,CAACxI,KAAK,CAACiZ,IAAI,GAAGkR,OAAO;YACvC;UACD;QACD;MACD,CAAC,MAAM;QACN,KAAK,IAAI3hB,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjN,GAAG,CAACH,OAAO,CAAC8H,aAAa,EAAEsF,CAAC,EAAE,EAAE;UACnDjN,GAAG,CAAC2K,OAAO,CAACsC,CAAC,CAAC,CAACnB,SAAS,CAAClL,MAAM,CAAC,gBAAgB,CAAC;UACjDZ,GAAG,CAAC2K,OAAO,CAACsC,CAAC,CAAC,CAACxI,KAAK,CAACiZ,IAAI,GAAG,EAAE;UAC9B,KAAK,IAAIzO,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjP,GAAG,CAACqB,IAAI,CAACwL,MAAM,EAAEoC,CAAC,EAAE,EAAE;YACzC,IAAIjP,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAAChC,CAAC,CAAC,EAAE;cACtBjN,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAAChC,CAAC,CAAC,CAACnB,SAAS,CAAClL,MAAM,CAAC,gBAAgB,CAAC;cACpDZ,GAAG,CAAC4K,OAAO,CAACqE,CAAC,CAAC,CAAChC,CAAC,CAAC,CAACxI,KAAK,CAACiZ,IAAI,GAAG,EAAE;YAClC;UACD;QACD;MACD;;MAEA;MACA1d,GAAG,CAAC0a,oBAAoB,CAAC,CAAC;IAC3B,CAAC;IAED3a,EAAE,CAAC+tB,gBAAgB,CAAC,gBAAgB,EAAE9tB,GAAG,CAACmO,aAAa,CAAC;IACxDpO,EAAE,CAAC+tB,gBAAgB,CAAC,YAAY,EAAE9tB,GAAG,CAACmO,aAAa,CAAC;IAEpDpO,EAAE,CAACtB,MAAM,GAAGuB,GAAG;IACfD,EAAE,CAACvB,YAAY,GAAGwB,GAAG;IAErBA,GAAG,CAAC2tB,IAAI,CAAC,CAAC;IAEV,OAAO3tB,GAAG;EACX,CAAE;;EAEF;EACAvB,MAAM,CAACowB,aAAa,GAAG,UAASrvB,CAAC,EAAE;IAClCqO,OAAO,CAACghB,aAAa,CAACrvB,CAAC,CAAC;EACzB,CAAC;;EAED;EACAf,MAAM,CAACqwB,aAAa,GAAG,UAAStvB,CAAC,EAAE;IAClC,IAAI4Q,CAAC,GAAGrD,MAAM,CAACD,IAAI,CAACtN,CAAC,CAAC;IACtB,KAAK,IAAIyN,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGmD,CAAC,CAACvD,MAAM,EAAEI,CAAC,EAAE,EAAE;MAClC,IAAI,OAAOzN,CAAC,CAAC4Q,CAAC,CAACnD,CAAC,CAAC,CAAE,KAAK,UAAU,EAAE;QACnCxO,MAAM,CAAC2R,CAAC,CAACnD,CAAC,CAAC,CAAC,GAAGzN,CAAC,CAAC4Q,CAAC,CAACnD,CAAC,CAAC,CAAC;QACtB,IAAIxO,MAAM,CAACQ,OAAO,IAAI,OAAOO,CAAC,CAAC4Q,CAAC,CAACnD,CAAC,CAAC,CAAC,CAAChO,OAAQ,IAAI,UAAU,EAAE;UAC5DO,CAAC,CAAC4Q,CAAC,CAACnD,CAAC,CAAC,CAAC,CAAChO,OAAO,CAACR,MAAM,CAACQ,OAAO,CAAC;QAChC;MACD;IACD;EACD,CAAC;;EAED;AACD;AACA;EACC,IAAI,OAAO6L,OAAQ,KAAK,WAAW,EAAE;IACpCrM,MAAM,CAACqM,OAAO,GAAGA,OAAO;EACzB;EACArM,MAAM,CAACK,OAAO,GAAGH,OAAO;EAExBF,MAAM,CAACmvB,OAAO,GAAG,IAAI;EACrBnvB,MAAM,CAACswB,WAAW,GAAG,IAAI;EACzBtwB,MAAM,CAACgwB,kBAAkB,GAAG,IAAI;EAEhC,MAAMO,aAAa,GAAG,SAAAA,CAAS5tB,IAAI,EAAE;IACpCA,IAAI,CAAC6tB,mBAAmB,CAAC,SAAS,EAAExwB,MAAM,CAACywB,eAAe,CAAC;IAC3D9tB,IAAI,CAAC6tB,mBAAmB,CAAC,WAAW,EAAExwB,MAAM,CAAC0wB,iBAAiB,CAAC;IAC/D/tB,IAAI,CAAC6tB,mBAAmB,CAAC,WAAW,EAAExwB,MAAM,CAAC2wB,iBAAiB,CAAC;IAC/DhuB,IAAI,CAAC6tB,mBAAmB,CAAC,WAAW,EAAExwB,MAAM,CAAC4wB,iBAAiB,CAAC;IAC/DjuB,IAAI,CAAC6tB,mBAAmB,CAAC,UAAU,EAAExwB,MAAM,CAAC6wB,mBAAmB,CAAC;IAChEluB,IAAI,CAAC6tB,mBAAmB,CAAC,OAAO,EAAExwB,MAAM,CAAC8wB,aAAa,CAAC;IACvDnuB,IAAI,CAAC6tB,mBAAmB,CAAC,aAAa,EAAExwB,MAAM,CAAC+wB,mBAAmB,CAAC;IACnEpuB,IAAI,CAAC6tB,mBAAmB,CAAC,YAAY,EAAExwB,MAAM,CAACgxB,kBAAkB,CAAC;IACjEruB,IAAI,CAAC6tB,mBAAmB,CAAC,UAAU,EAAExwB,MAAM,CAACixB,gBAAgB,CAAC;IAC7DtuB,IAAI,CAAC6tB,mBAAmB,CAAC,aAAa,EAAExwB,MAAM,CAACixB,gBAAgB,CAAC;IAChElvB,QAAQ,CAACyuB,mBAAmB,CAAC,SAAS,EAAExwB,MAAM,CAACkxB,eAAe,CAAC;EAChE,CAAC;EAEDlxB,MAAM,CAACivB,OAAO,GAAG,UAASnZ,OAAO,EAAEqb,oBAAoB,EAAE;IACxD,IAAIrb,OAAO,CAAC9V,MAAM,EAAE;MACnB,IAAI2C,IAAI,GAAGmT,OAAO,CAAC9V,MAAM,CAACoB,OAAO,CAACuB,IAAI,GAAGmT,OAAO,CAAC9V,MAAM,CAACoB,OAAO,CAACuB,IAAI,GAAGZ,QAAQ;MAC/E+T,OAAO,CAAC0a,mBAAmB,CAAC,gBAAgB,EAAE1a,OAAO,CAAC9V,MAAM,CAACwP,cAAc,CAAC;MAC5EsG,OAAO,CAAC0a,mBAAmB,CAAC,YAAY,EAAE1a,OAAO,CAAC9V,MAAM,CAACwP,cAAc,CAAC;MACxEsG,OAAO,CAAC9V,MAAM,GAAG,IAAI;MACrB8V,OAAO,CAACzF,SAAS,GAAG,EAAE;MAEtB,IAAI8gB,oBAAoB,EAAE;QACzBZ,aAAa,CAAC5tB,IAAI,CAAC;QACnB3C,MAAM,GAAG,IAAI;MACd;IACD;EACD,CAAC;EAEDA,MAAM,CAACovB,KAAK,GAAG,UAASzsB,IAAI,EAAE;IAC7B4tB,aAAa,CAAC5tB,IAAI,CAAC;IACnBA,IAAI,CAAC0sB,gBAAgB,CAAC,SAAS,EAAErvB,MAAM,CAACywB,eAAe,CAAC;IACxD9tB,IAAI,CAAC0sB,gBAAgB,CAAC,WAAW,EAAErvB,MAAM,CAAC0wB,iBAAiB,CAAC;IAC5D/tB,IAAI,CAAC0sB,gBAAgB,CAAC,WAAW,EAAErvB,MAAM,CAAC2wB,iBAAiB,CAAC;IAC5DhuB,IAAI,CAAC0sB,gBAAgB,CAAC,WAAW,EAAErvB,MAAM,CAAC4wB,iBAAiB,CAAC;IAC5DjuB,IAAI,CAAC0sB,gBAAgB,CAAC,UAAU,EAAErvB,MAAM,CAAC6wB,mBAAmB,CAAC;IAC7DluB,IAAI,CAAC0sB,gBAAgB,CAAC,OAAO,EAAErvB,MAAM,CAAC8wB,aAAa,CAAC;IACpDnuB,IAAI,CAAC0sB,gBAAgB,CAAC,aAAa,EAAErvB,MAAM,CAAC+wB,mBAAmB,CAAC;IAChEpuB,IAAI,CAAC0sB,gBAAgB,CAAC,YAAY,EAAErvB,MAAM,CAACgxB,kBAAkB,CAAC;IAC9DruB,IAAI,CAAC0sB,gBAAgB,CAAC,UAAU,EAAErvB,MAAM,CAACixB,gBAAgB,CAAC;IAC1DtuB,IAAI,CAAC0sB,gBAAgB,CAAC,aAAa,EAAErvB,MAAM,CAACixB,gBAAgB,CAAC;IAC7DtuB,IAAI,CAAC0sB,gBAAgB,CAAC,WAAW,EAAErvB,MAAM,CAACixB,gBAAgB,CAAC;IAC3DlvB,QAAQ,CAACstB,gBAAgB,CAAC,SAAS,EAAErvB,MAAM,CAACkxB,eAAe,CAAC;EAC7D,CAAC;;EAED;AACD;AACA;EACClxB,MAAM,CAACkxB,eAAe,GAAG,UAAS3hB,CAAC,EAAE;IACpC,IAAIvP,MAAM,CAACmvB,OAAO,EAAE;MACnB,IAAInvB,MAAM,CAACmvB,OAAO,CAACniB,OAAO,EAAE;QAC3B,IAAIuC,CAAC,CAAC6hB,KAAK,IAAI,EAAE,EAAE;UAClB;UACA,IAAIpxB,MAAM,CAACmvB,OAAO,CAACniB,OAAO,EAAE;YAC3B;YACAhN,MAAM,CAACmvB,OAAO,CAAC9T,WAAW,CAACrb,MAAM,CAACmvB,OAAO,CAACniB,OAAO,CAAC,CAAC,CAAC,EAAE,KAAK,CAAC;UAC7D;UACAuC,CAAC,CAAC8hB,cAAc,CAAC,CAAC;QACnB,CAAC,MAAM,IAAI9hB,CAAC,CAAC6hB,KAAK,IAAI,EAAE,EAAE;UACzB;UACA,IAAIpxB,MAAM,CAACmvB,OAAO,CAAC/tB,OAAO,CAACyB,OAAO,CAAC7C,MAAM,CAACmvB,OAAO,CAACniB,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC1M,IAAI,IAAI,UAAU,EAAE;YACjFN,MAAM,CAACmvB,OAAO,CAAC9T,WAAW,CAACrb,MAAM,CAACmvB,OAAO,CAACniB,OAAO,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC;UAC5D,CAAC,MAAM,IAAIhN,MAAM,CAACmvB,OAAO,CAAC/tB,OAAO,CAACyB,OAAO,CAAC7C,MAAM,CAACmvB,OAAO,CAACniB,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC1M,IAAI,IAAI,UAAU,IAClFN,MAAM,CAACmvB,OAAO,CAAC/tB,OAAO,CAACyB,OAAO,CAAC7C,MAAM,CAACmvB,OAAO,CAACniB,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC1M,IAAI,IAAI,cAAc,EAAE;YACtF;UAAA,CACA,MAAM;YACN;YACA,IAAI,CAACN,MAAM,CAACmvB,OAAO,CAAC/tB,OAAO,CAACsD,QAAQ,IAAI,IAAI,IAC1C1E,MAAM,CAACmvB,OAAO,CAAC/tB,OAAO,CAACyB,OAAO,CAAC7C,MAAM,CAACmvB,OAAO,CAACniB,OAAO,CAAC,CAAC,CAAC,CAAC,CAACtI,QAAQ,IAAI,IAAI,IAC1E1E,MAAM,CAACmvB,OAAO,CAAC/tB,OAAO,CAACoB,IAAI,CAACxC,MAAM,CAACmvB,OAAO,CAACniB,OAAO,CAAC,CAAC,CAAC,CAAC,CAAChN,MAAM,CAACmvB,OAAO,CAACniB,OAAO,CAAC,CAAC,CAAC,CAAC,CAACoB,MAAM,GAAG,GAAG,KAAKmB,CAAC,CAAC+hB,MAAM,EAAE;cAC9G;cACA,IAAIC,cAAc,GAAGvxB,MAAM,CAACmvB,OAAO,CAACniB,OAAO,CAAC,CAAC,CAAC,CAACoK,QAAQ,CAAC,CAAC,CAAC;cAC1D,IAAIoa,WAAW,GAAGxxB,MAAM,CAACmvB,OAAO,CAACniB,OAAO,CAAC,CAAC,CAAC,CAACoK,QAAQ,CAAC,CAAC,CAAC,CAACxW,KAAK;cAC7D,IAAI6wB,aAAa,GAAGF,cAAc,CAACG,cAAc;cACjDF,WAAW,GAAGA,WAAW,CAAC1jB,KAAK,CAAC,CAAC,EAAE2jB,aAAa,CAAC,GAAG,IAAI,GAAGD,WAAW,CAAC1jB,KAAK,CAAC2jB,aAAa,CAAC;cAC3FF,cAAc,CAAC3wB,KAAK,GAAG4wB,WAAW;cAClCD,cAAc,CAACjW,KAAK,CAAC,CAAC;cACtBiW,cAAc,CAACG,cAAc,GAAGD,aAAa,GAAG,CAAC;cACjDF,cAAc,CAACI,YAAY,GAAGF,aAAa,GAAG,CAAC;YAChD,CAAC,MAAM;cACN;cACA;YAAA;UAEF;QACD,CAAC,MAAM,IAAIliB,CAAC,CAAC6hB,KAAK,IAAI,CAAC,EAAE;UACxB;UACA,IAAI,CAAC,UAAU,EAAE,MAAM,CAAC,CAACxE,QAAQ,CACjC5sB,MAAM,CAACmvB,OAAO,CAAC/tB,OAAO,CAACyB,OAAO,CAAC7C,MAAM,CAACmvB,OAAO,CAACniB,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC1M,IAAI,CAAC,EAAE;YAChEN,MAAM,CAACmvB,OAAO,CAAC9T,WAAW,CAACrb,MAAM,CAACmvB,OAAO,CAACniB,OAAO,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC;UAC5D,CAAC,MAAM;YACNhN,MAAM,CAACmvB,OAAO,CAACniB,OAAO,CAAC,CAAC,CAAC,CAACoK,QAAQ,CAAC,CAAC,CAAC,CAACyH,IAAI,CAAC,CAAC;UAC7C;QACD;MACD;MAEA,IAAI,CAAE7e,MAAM,CAACmvB,OAAO,CAACniB,OAAO,IAAIhN,MAAM,CAACmvB,OAAO,CAAC1iB,YAAY,EAAE;QAC5D;QACA,IAAI8C,CAAC,CAAC6hB,KAAK,IAAI,EAAE,EAAE;UAClBpxB,MAAM,CAACmvB,OAAO,CAAClQ,IAAI,CAAC1P,CAAC,CAAC+Z,QAAQ,EAAE/Z,CAAC,CAACga,OAAO,CAAC;UAC1Cha,CAAC,CAAC8hB,cAAc,CAAC,CAAC;QACnB,CAAC,MAAM,IAAI9hB,CAAC,CAAC6hB,KAAK,IAAI,EAAE,EAAE;UACzBpxB,MAAM,CAACmvB,OAAO,CAAChF,KAAK,CAAC5a,CAAC,CAAC+Z,QAAQ,EAAE/Z,CAAC,CAACga,OAAO,CAAC;UAC3Cha,CAAC,CAAC8hB,cAAc,CAAC,CAAC;QACnB,CAAC,MAAM,IAAI9hB,CAAC,CAAC6hB,KAAK,IAAI,EAAE,EAAE;UACzBpxB,MAAM,CAACmvB,OAAO,CAAC9F,EAAE,CAAC9Z,CAAC,CAAC+Z,QAAQ,EAAE/Z,CAAC,CAACga,OAAO,CAAC;UACxCha,CAAC,CAAC8hB,cAAc,CAAC,CAAC;QACnB,CAAC,MAAM,IAAI9hB,CAAC,CAAC6hB,KAAK,IAAI,EAAE,EAAE;UACzBpxB,MAAM,CAACmvB,OAAO,CAACnF,IAAI,CAACza,CAAC,CAAC+Z,QAAQ,EAAE/Z,CAAC,CAACga,OAAO,CAAC;UAC1Cha,CAAC,CAAC8hB,cAAc,CAAC,CAAC;QACnB,CAAC,MAAM,IAAI9hB,CAAC,CAAC6hB,KAAK,IAAI,EAAE,EAAE;UACzBpxB,MAAM,CAACmvB,OAAO,CAAC/E,KAAK,CAAC7a,CAAC,CAAC+Z,QAAQ,EAAE/Z,CAAC,CAACga,OAAO,CAAC;UAC3Cha,CAAC,CAAC8hB,cAAc,CAAC,CAAC;QACnB,CAAC,MAAM,IAAI9hB,CAAC,CAAC6hB,KAAK,IAAI,EAAE,EAAE;UACzBpxB,MAAM,CAACmvB,OAAO,CAACnP,IAAI,CAACzQ,CAAC,CAAC+Z,QAAQ,EAAE/Z,CAAC,CAACga,OAAO,CAAC;UAC1Cha,CAAC,CAAC8hB,cAAc,CAAC,CAAC;QACnB,CAAC,MAAM,IAAI9hB,CAAC,CAAC6hB,KAAK,IAAI,EAAE,EAAE;UACzB;UACA,IAAIpxB,MAAM,CAACmvB,OAAO,CAAC/tB,OAAO,CAAC4C,QAAQ,IAAI,IAAI,EAAE;YAC5C,IAAIhE,MAAM,CAACmvB,OAAO,CAACyC,WAAW,EAAE;cAC/B,IAAI5xB,MAAM,CAACmvB,OAAO,CAAC/tB,OAAO,CAACiD,cAAc,IAAI,IAAI,EAAE;gBAClD,IAAI8e,OAAO,CAACnjB,MAAM,CAACmvB,OAAO,CAAC/tB,OAAO,CAAC+H,IAAI,CAACuB,iCAAiC,CAAC,EAAE;kBAC3E1K,MAAM,CAACmvB,OAAO,CAAChK,SAAS,CAAC,CAAC;gBAC3B;cACD;YACD,CAAC,MAAM,IAAInlB,MAAM,CAACmvB,OAAO,CAAC0C,cAAc,EAAE;cACzC,IAAI7xB,MAAM,CAACmvB,OAAO,CAAC/tB,OAAO,CAACmD,iBAAiB,IAAI,IAAI,EAAE;gBACrD,IAAI4e,OAAO,CAACnjB,MAAM,CAACmvB,OAAO,CAAC/tB,OAAO,CAAC+H,IAAI,CAACwB,oCAAoC,CAAC,EAAE;kBAC9E3K,MAAM,CAACmvB,OAAO,CAAC7I,YAAY,CAAC,CAAC;gBAC9B;cACD;YACD,CAAC,MAAM;cACN;cACAtmB,MAAM,CAACmvB,OAAO,CAAC7a,QAAQ,CAACtU,MAAM,CAACmvB,OAAO,CAAC3iB,WAAW,EAAE,EAAE,CAAC;YACxD;UACD;QACD,CAAC,MAAM,IAAI+C,CAAC,CAAC6hB,KAAK,IAAI,EAAE,EAAE;UACzB;UACA,IAAI7hB,CAAC,CAAC+Z,QAAQ,EAAE;YACftpB,MAAM,CAACmvB,OAAO,CAAC9F,EAAE,CAAC,CAAC;UACpB,CAAC,MAAM;YACN,IAAIrpB,MAAM,CAACmvB,OAAO,CAAC/tB,OAAO,CAAC6C,cAAc,IAAI,IAAI,EAAE;cAClD,IAAIjE,MAAM,CAACmvB,OAAO,CAAC/tB,OAAO,CAAC8C,oBAAoB,IAAI,IAAI,EAAE;gBACxD,IAAIlE,MAAM,CAACmvB,OAAO,CAAC1iB,YAAY,CAAC,CAAC,CAAC,IAAIzM,MAAM,CAACmvB,OAAO,CAAC/tB,OAAO,CAACoB,IAAI,CAAC4L,MAAM,GAAG,CAAC,EAAE;kBAC7E;kBACApO,MAAM,CAACmvB,OAAO,CAAC1K,SAAS,CAAC,CAAC;gBAC3B;cACD;YACD;YAEAzkB,MAAM,CAACmvB,OAAO,CAACnF,IAAI,CAAC,CAAC;UACtB;UACAza,CAAC,CAAC8hB,cAAc,CAAC,CAAC;QACnB,CAAC,MAAM,IAAI9hB,CAAC,CAAC6hB,KAAK,IAAI,CAAC,EAAE;UACxB;UACA,IAAI7hB,CAAC,CAAC+Z,QAAQ,EAAE;YACf;YACA;YACA,IAAKtpB,MAAM,CAACmvB,OAAO,CAAC1iB,YAAY,CAAC,CAAC,CAAC,IAAI,CAAC,EAAG;cAC1CzM,MAAM,CAACmvB,OAAO,CAAC9F,EAAE,CAAC,CAAC;cACnBrpB,MAAM,CAACmvB,OAAO,CAACnP,IAAI,CAAC,CAAC;YACtB,CAAC,MAAM;cACNhgB,MAAM,CAACmvB,OAAO,CAAClQ,IAAI,CAAC,CAAC;YACtB;UACD,CAAC,MAAM;YACN,IAAIjf,MAAM,CAACmvB,OAAO,CAAC/tB,OAAO,CAAC+C,iBAAiB,IAAI,IAAI,EAAE;cACrD,IAAInE,MAAM,CAACmvB,OAAO,CAAC/tB,OAAO,CAACgD,uBAAuB,IAAI,IAAI,EAAE;gBAC3D,IAAIpE,MAAM,CAACmvB,OAAO,CAAC1iB,YAAY,CAAC,CAAC,CAAC,IAAIzM,MAAM,CAACmvB,OAAO,CAAC/tB,OAAO,CAACoB,IAAI,CAAC,CAAC,CAAC,CAAC4L,MAAM,GAAG,CAAC,EAAE;kBAChF;kBACApO,MAAM,CAACmvB,OAAO,CAAC3J,YAAY,CAAC,CAAC;gBAC9B;cACD;YACD;;YAEA;YACA;YACA,IAAKxlB,MAAM,CAACmvB,OAAO,CAAC1iB,YAAY,CAAC,CAAC,CAAC,IAAIzM,MAAM,CAACmvB,OAAO,CAAC/tB,OAAO,CAACoB,IAAI,CAAC,CAAC,CAAC,CAAC4L,MAAM,GAAG,CAAC,EAAG;cAClFpO,MAAM,CAACmvB,OAAO,CAACnF,IAAI,CAAC,CAAC;cACrBhqB,MAAM,CAACmvB,OAAO,CAAC/E,KAAK,CAAC,CAAC;YACvB,CAAC,MAAM;cACNpqB,MAAM,CAACmvB,OAAO,CAAChF,KAAK,CAAC,CAAC;YACvB;UACD;UACA5a,CAAC,CAAC8hB,cAAc,CAAC,CAAC;QACnB,CAAC,MAAM;UACN,IAAI,CAAC9hB,CAAC,CAACga,OAAO,IAAIha,CAAC,CAACuiB,OAAO,KAAK,CAAEviB,CAAC,CAAC+Z,QAAQ,EAAE;YAC7C,IAAI/Z,CAAC,CAAC6hB,KAAK,IAAI,EAAE,EAAE;cAClB;cACApxB,MAAM,CAACmvB,OAAO,CAAC9E,SAAS,CAAC,CAAC;cAC1B9a,CAAC,CAAC8hB,cAAc,CAAC,CAAC;YACnB,CAAC,MAAM,IAAI9hB,CAAC,CAAC6hB,KAAK,IAAI,EAAE,EAAE;cACzB;cACApxB,MAAM,CAACmvB,OAAO,CAAC/D,QAAQ,CAAC,CAAC;cACzB7b,CAAC,CAAC8hB,cAAc,CAAC,CAAC;YACnB,CAAC,MAAM,IAAI9hB,CAAC,CAAC6hB,KAAK,IAAI,EAAE,EAAE;cACzB;cACApxB,MAAM,CAACmvB,OAAO,CAACb,IAAI,CAAC,CAAC;cACrB/e,CAAC,CAAC8hB,cAAc,CAAC,CAAC;YACnB,CAAC,MAAM,IAAI9hB,CAAC,CAAC6hB,KAAK,IAAI,EAAE,EAAE;cACzB;cACApxB,MAAM,CAACmvB,OAAO,CAACd,IAAI,CAAC,CAAC;cACrB9e,CAAC,CAAC8hB,cAAc,CAAC,CAAC;YACnB,CAAC,MAAM,IAAI9hB,CAAC,CAAC6hB,KAAK,IAAI,EAAE,EAAE;cACzB;cACApxB,MAAM,CAACmvB,OAAO,CAAC7kB,IAAI,CAAC,IAAI,CAAC;cACzBiF,CAAC,CAAC8hB,cAAc,CAAC,CAAC;YACnB,CAAC,MAAM,IAAI9hB,CAAC,CAAC6hB,KAAK,IAAI,EAAE,EAAE;cACzB;cACA,IAAIpxB,MAAM,CAACmvB,OAAO,CAAC/tB,OAAO,CAAC4C,QAAQ,IAAI,IAAI,EAAE;gBAC5ChE,MAAM,CAAC+xB,WAAW,CAAC,CAAC;cACrB,CAAC,MAAM;gBACN/xB,MAAM,CAACgyB,YAAY,CAAC,CAAC;cACtB;cACAziB,CAAC,CAAC8hB,cAAc,CAAC,CAAC;YACnB,CAAC,MAAM,IAAI9hB,CAAC,CAAC6hB,KAAK,IAAI,EAAE,EAAE;cACzB;cACApxB,MAAM,CAAC8wB,aAAa,CAAC,CAAC;YACvB;UACD,CAAC,MAAM;YACN,IAAI9wB,MAAM,CAACmvB,OAAO,CAAC1iB,YAAY,EAAE;cAChC,IAAIzM,MAAM,CAACmvB,OAAO,CAAC/tB,OAAO,CAAC4C,QAAQ,IAAI,IAAI,EAAE;gBAC5C,IAAIiuB,KAAK,GAAGjyB,MAAM,CAACmvB,OAAO,CAAC1iB,YAAY,CAAC,CAAC,CAAC;gBAC1C,IAAIoN,QAAQ,GAAG7Z,MAAM,CAACmvB,OAAO,CAAC1iB,YAAY,CAAC,CAAC,CAAC;;gBAE7C;gBACA,IAAIzM,MAAM,CAACmvB,OAAO,CAAC/tB,OAAO,CAACyB,OAAO,CAACgX,QAAQ,CAAC,CAACvZ,IAAI,IAAI,UAAU,EAAE;kBAChE;kBACA,IAAIiP,CAAC,CAAC2iB,OAAO,IAAI,EAAE,EAAE;oBACpB;oBACA3iB,CAAC,CAAC8hB,cAAc,CAAC,CAAC;oBAClB,IAAIrxB,MAAM,CAACmvB,OAAO,CAAC/tB,OAAO,CAACyB,OAAO,CAACgX,QAAQ,CAAC,CAACvZ,IAAI,IAAI,UAAU,IAC9DN,MAAM,CAACmvB,OAAO,CAAC/tB,OAAO,CAACyB,OAAO,CAACgX,QAAQ,CAAC,CAACvZ,IAAI,IAAI,OAAO,EAAE;sBAC1DN,MAAM,CAACmvB,OAAO,CAAChS,kBAAkB,CAAC,CAAC;oBACpC,CAAC,MAAM;sBACN;sBACAnd,MAAM,CAACmvB,OAAO,CAACnU,UAAU,CAAChb,MAAM,CAACmvB,OAAO,CAAChjB,OAAO,CAAC8lB,KAAK,CAAC,CAACpY,QAAQ,CAAC,EAAE,IAAI,CAAC;oBACzE;kBACD,CAAC,MAAM,IAAItK,CAAC,CAAC2iB,OAAO,IAAI,GAAG,EAAE;oBAC5B;oBACAlyB,MAAM,CAACmvB,OAAO,CAACnU,UAAU,CAAChb,MAAM,CAACmvB,OAAO,CAAChjB,OAAO,CAAC8lB,KAAK,CAAC,CAACpY,QAAQ,CAAC,EAAE,KAAK,CAAC;kBAC1E,CAAC,MAAM,IAAKtK,CAAC,CAAC2iB,OAAO,IAAI,CAAC,IACpB3iB,CAAC,CAAC2iB,OAAO,IAAI,EAAE,IAAI3iB,CAAC,CAAC2iB,OAAO,IAAI,EAAG,IACnC3iB,CAAC,CAAC2iB,OAAO,IAAI,EAAE,IAAI3iB,CAAC,CAAC2iB,OAAO,IAAI,GAAI,IACpC3iB,CAAC,CAAC2iB,OAAO,IAAI,GAAG,IAAI3iB,CAAC,CAAC2iB,OAAO,IAAI,GAAI,IACrC,CAACC,MAAM,CAACC,YAAY,CAAC7iB,CAAC,CAAC2iB,OAAO,CAAC,IAAI3iB,CAAC,CAACwS,GAAG,IAAIoQ,MAAM,CAACC,YAAY,CAAC7iB,CAAC,CAAC2iB,OAAO,CAAC,CAAC9O,WAAW,CAAC,CAAC,IAAI7T,CAAC,CAACwS,GAAG,CAACqB,WAAW,CAAC,CAAC,KAAKpjB,MAAM,CAACqyB,WAAW,CAACF,MAAM,CAACC,YAAY,CAAC7iB,CAAC,CAAC2iB,OAAO,CAAC,CAAE,EAAE;oBAC9K;oBACAlyB,MAAM,CAACmvB,OAAO,CAACnU,UAAU,CAAChb,MAAM,CAACmvB,OAAO,CAAChjB,OAAO,CAAC8lB,KAAK,CAAC,CAACpY,QAAQ,CAAC,EAAE,IAAI,CAAC;oBACxE;oBACA,IAAI7Z,MAAM,CAACmvB,OAAO,CAAC/tB,OAAO,CAACyB,OAAO,CAACgX,QAAQ,CAAC,CAACvZ,IAAI,IAAI,UAAU,EAAE;sBAChEiP,CAAC,CAAC8hB,cAAc,CAAC,CAAC;oBACnB;kBACD;gBACD;cACD;YACD;UACD;QACD;MACD,CAAC,MAAM;QACN,IAAI9hB,CAAC,CAACwgB,MAAM,CAAC1iB,SAAS,CAACuG,QAAQ,CAAC,eAAe,CAAC,EAAE;UACjD,IAAI5T,MAAM,CAACswB,WAAW,EAAE;YACvBgC,YAAY,CAACtyB,MAAM,CAACswB,WAAW,CAAC;UACjC;UAEAtwB,MAAM,CAACswB,WAAW,GAAGnJ,UAAU,CAAC,YAAW;YAC1CnnB,MAAM,CAACmvB,OAAO,CAAC9pB,MAAM,CAACkK,CAAC,CAACwgB,MAAM,CAACnvB,KAAK,CAAC;UACtC,CAAC,EAAE,GAAG,CAAC;QACR;MACD;IACD;EACD,CAAC;EAEDZ,MAAM,CAACuyB,aAAa,GAAG,KAAK;EAE5BvyB,MAAM,CAAC0wB,iBAAiB,GAAG,UAASnhB,CAAC,EAAE;IACtCA,CAAC,GAAGA,CAAC,IAAItP,MAAM,CAACuN,KAAK;IACrB,IAAI+B,CAAC,CAACijB,OAAO,EAAE;MACd,IAAIC,WAAW,GAAGljB,CAAC,CAACijB,OAAO;IAC5B,CAAC,MAAM,IAAIjjB,CAAC,CAACmjB,MAAM,EAAE;MACpB,IAAID,WAAW,GAAGljB,CAAC,CAACmjB,MAAM;IAC3B,CAAC,MAAM;MACN,IAAID,WAAW,GAAGljB,CAAC,CAAC6hB,KAAK;IAC1B;;IAEA;IACA,IAAIuB,WAAW,GAAG3yB,MAAM,CAAC4yB,UAAU,CAACrjB,CAAC,CAACwgB,MAAM,CAAC;IAE7C,IAAI4C,WAAW,CAAC,CAAC,CAAC,EAAE;MACnB,IAAI3yB,MAAM,CAACmvB,OAAO,IAAIwD,WAAW,CAAC,CAAC,CAAC,CAAC3yB,MAAM,EAAE;QAC5C,IAAIA,MAAM,CAACmvB,OAAO,EAAE;UACnB,IAAInvB,MAAM,CAACmvB,OAAO,CAACniB,OAAO,EAAE;YAC3BhN,MAAM,CAACmvB,OAAO,CAAC9T,WAAW,CAACrb,MAAM,CAACmvB,OAAO,CAACniB,OAAO,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC;UAC5D;UACAhN,MAAM,CAACmvB,OAAO,CAACpf,cAAc,CAAC,CAAC;QAChC;QACA/P,MAAM,CAACmvB,OAAO,GAAGwD,WAAW,CAAC,CAAC,CAAC,CAAC3yB,MAAM;MACvC;IACD,CAAC,MAAM;MACN,IAAIA,MAAM,CAACmvB,OAAO,EAAE;QACnB,IAAInvB,MAAM,CAACmvB,OAAO,CAACniB,OAAO,EAAE;UAC3BhN,MAAM,CAACmvB,OAAO,CAAC9T,WAAW,CAACrb,MAAM,CAACmvB,OAAO,CAACniB,OAAO,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC;QAC5D;QAEAhN,MAAM,CAACmvB,OAAO,CAACpf,cAAc,CAAC,IAAI,CAAC;QACnC/P,MAAM,CAACmvB,OAAO,GAAG,IAAI;MACtB;IACD;IAEA,IAAInvB,MAAM,CAACmvB,OAAO,IAAIsD,WAAW,IAAI,CAAC,EAAE;MACvC,IAAIljB,CAAC,CAACwgB,MAAM,CAAC1iB,SAAS,CAACuG,QAAQ,CAAC,kBAAkB,CAAC,EAAE;QACpD,IAAI5T,MAAM,CAACmvB,OAAO,EAAE;UACnBnvB,MAAM,CAACmvB,OAAO,CAAC9E,SAAS,CAAC,CAAC;QAC3B;MACD,CAAC,MAAM,IAAI9a,CAAC,CAACwgB,MAAM,CAAC1iB,SAAS,CAACuG,QAAQ,CAAC,eAAe,CAAC,EAAE;QACxD,IAAI5T,MAAM,CAACmvB,OAAO,CAAC/tB,OAAO,CAAC4C,QAAQ,IAAI,IAAI,EAAE;UAC5ChE,MAAM,CAACmvB,OAAO,CAAC0D,cAAc,GAAG,IAAI;QACrC;MACD,CAAC,MAAM;QACN;QACA,IAAIF,WAAW,CAAC,CAAC,CAAC,IAAI,CAAC,EAAE;UACxB,IAAI9Y,QAAQ,GAAGtK,CAAC,CAACwgB,MAAM,CAACjY,YAAY,CAAC,QAAQ,CAAC;UAC9C,IAAI+B,QAAQ,EAAE;YACb;YACA,IAAI1Z,IAAI,GAAGoP,CAAC,CAACwgB,MAAM,CAAC5U,qBAAqB,CAAC,CAAC;YAC3C,IAAInb,MAAM,CAACmvB,OAAO,CAAC/tB,OAAO,CAACyC,YAAY,IAAI,IAAI,IAAI1D,IAAI,CAAC0O,KAAK,GAAGU,CAAC,CAACujB,OAAO,GAAG,EAAE,EAAE;cAAE;cACjF;cACA9yB,MAAM,CAACmvB,OAAO,CAACjiB,QAAQ,GAAG;gBACzB6lB,aAAa,EAAExjB,CAAC,CAACyjB,KAAK;gBACtBvb,MAAM,EAAEoC,QAAQ;gBAChBhL,KAAK,EAAE1O,IAAI,CAAC0O;cACb,CAAC;;cAED;cACA7O,MAAM,CAACmvB,OAAO,CAACjjB,OAAO,CAAC2N,QAAQ,CAAC,CAACxM,SAAS,CAACC,GAAG,CAAC,UAAU,CAAC;cAC1D,KAAK,IAAIkD,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGxQ,MAAM,CAACmvB,OAAO,CAAChjB,OAAO,CAACiC,MAAM,EAAEoC,CAAC,EAAE,EAAE;gBACvD,IAAIxQ,MAAM,CAACmvB,OAAO,CAAChjB,OAAO,CAACqE,CAAC,CAAC,CAACqJ,QAAQ,CAAC,EAAE;kBACxC7Z,MAAM,CAACmvB,OAAO,CAAChjB,OAAO,CAACqE,CAAC,CAAC,CAACqJ,QAAQ,CAAC,CAACxM,SAAS,CAACC,GAAG,CAAC,UAAU,CAAC;gBAC9D;cACD;YACD,CAAC,MAAM,IAAItN,MAAM,CAACmvB,OAAO,CAAC/tB,OAAO,CAACwC,UAAU,IAAI,IAAI,IAAIzD,IAAI,CAACwU,MAAM,GAAGpF,CAAC,CAAC0jB,OAAO,GAAG,EAAE,EAAE;cAAE;cACvF,IAAIjzB,MAAM,CAACmvB,OAAO,CAAC1V,WAAW,CAACI,QAAQ,CAAC,CAACzL,MAAM,EAAE;gBAChD1M,OAAO,CAACC,KAAK,CAAC,qDAAqD,CAAC;cACrE,CAAC,MAAM;gBACN;gBACA3B,MAAM,CAACmvB,OAAO,CAACpf,cAAc,CAAC,CAAC;gBAC/B;gBACA/P,MAAM,CAACmvB,OAAO,CAAChiB,QAAQ,GAAG;kBACzB2I,OAAO,EAAEvG,CAAC,CAACwgB,MAAM;kBACjBtY,MAAM,EAAEoC,QAAQ;kBAChBqZ,WAAW,EAAErZ;gBACd,CAAC;gBACD;gBACA7Z,MAAM,CAACmvB,OAAO,CAACjjB,OAAO,CAAC2N,QAAQ,CAAC,CAACxM,SAAS,CAACC,GAAG,CAAC,UAAU,CAAC;gBAC1D,KAAK,IAAIkD,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGxQ,MAAM,CAACmvB,OAAO,CAAChjB,OAAO,CAACiC,MAAM,EAAEoC,CAAC,EAAE,EAAE;kBACvD,IAAIxQ,MAAM,CAACmvB,OAAO,CAAChjB,OAAO,CAACqE,CAAC,CAAC,CAACqJ,QAAQ,CAAC,EAAE;oBACxC7Z,MAAM,CAACmvB,OAAO,CAAChjB,OAAO,CAACqE,CAAC,CAAC,CAACqJ,QAAQ,CAAC,CAACxM,SAAS,CAACC,GAAG,CAAC,UAAU,CAAC;kBAC9D;gBACD;cACD;YACD,CAAC,MAAM;cACN,IAAItN,MAAM,CAACmvB,OAAO,CAAC0C,cAAc,KAAKtiB,CAAC,CAAC+Z,QAAQ,IAAI/Z,CAAC,CAACga,OAAO,CAAC,EAAE;gBAC/D,IAAIxoB,CAAC,GAAGf,MAAM,CAACmvB,OAAO,CAAC0C,cAAc;gBACrC,IAAIjU,CAAC,GAAG/D,QAAQ;cACjB,CAAC,MAAM;gBACN;gBACA,IAAI7Z,MAAM,CAACmvB,OAAO,CAAC0C,cAAc,IAAIhY,QAAQ,IAAI7Z,MAAM,CAACmvB,OAAO,CAAC/tB,OAAO,CAACoD,iBAAiB,IAAI,IAAI,EAAE;kBAClGxE,MAAM,CAACswB,WAAW,GAAGnJ,UAAU,CAAC,YAAW;oBAC1CnnB,MAAM,CAACmvB,OAAO,CAACzN,SAAS,CAAC7H,QAAQ,CAAC;kBACnC,CAAC,EAAE,GAAG,CAAC;gBACR;;gBAEA;gBACA7Z,MAAM,CAACmvB,OAAO,CAAC0C,cAAc,GAAGhY,QAAQ;;gBAExC;gBACA,IAAI9Y,CAAC,GAAG8Y,QAAQ;gBAChB,IAAI+D,CAAC,GAAG/D,QAAQ;cACjB;;cAEA;cACA7Z,MAAM,CAACmvB,OAAO,CAACxQ,yBAAyB,CAAC5d,CAAC,EAAE,CAAC,EAAE6c,CAAC,EAAE5d,MAAM,CAACmvB,OAAO,CAAC/tB,OAAO,CAACoB,IAAI,CAAC4L,MAAM,GAAG,CAAC,CAAC;YAC1F;UACD,CAAC,MAAM;YACN,IAAImB,CAAC,CAACwgB,MAAM,CAAC9tB,UAAU,CAACoL,SAAS,CAACuG,QAAQ,CAAC,eAAe,CAAC,EAAE;cAC5D,IAAIrE,CAAC,CAACwgB,MAAM,CAACjY,YAAY,CAAC,aAAa,CAAC,EAAE;gBACzC,IAAIL,MAAM,GAAGlI,CAAC,CAACwgB,MAAM,CAACjY,YAAY,CAAC,aAAa,CAAC,CAAC1C,KAAK,CAAC,GAAG,CAAC;gBAC5D,IAAI+d,EAAE,GAAGjjB,QAAQ,CAACuH,MAAM,CAAC,CAAC,CAAC,CAAC;gBAC5B,IAAI2b,EAAE,GAAGljB,QAAQ,CAACuH,MAAM,CAACA,MAAM,CAACrJ,MAAM,GAAC,CAAC,CAAC,CAAC;cAC3C,CAAC,MAAM;gBACN,IAAI+kB,EAAE,GAAG,CAAC;gBACV,IAAIC,EAAE,GAAGpzB,MAAM,CAACmvB,OAAO,CAAC/tB,OAAO,CAACyB,OAAO,CAACuL,MAAM,GAAG,CAAC;cACnD;cACApO,MAAM,CAACmvB,OAAO,CAACxQ,yBAAyB,CAACwU,EAAE,EAAE,CAAC,EAAEC,EAAE,EAAEpzB,MAAM,CAACmvB,OAAO,CAAC/tB,OAAO,CAACoB,IAAI,CAAC4L,MAAM,GAAG,CAAC,CAAC;YAC5F;UACD;QACD,CAAC,MAAM;UACNpO,MAAM,CAACmvB,OAAO,CAAC0C,cAAc,GAAG,KAAK;QACtC;;QAEA;QACA,IAAIc,WAAW,CAAC,CAAC,CAAC,IAAI,CAAC,EAAE;UACxB,IAAIV,KAAK,GAAG1iB,CAAC,CAACwgB,MAAM,CAACjY,YAAY,CAAC,QAAQ,CAAC;UAE3C,IAAIvI,CAAC,CAACwgB,MAAM,CAAC1iB,SAAS,CAACuG,QAAQ,CAAC,YAAY,CAAC,EAAE;YAC9C,IAAIzT,IAAI,GAAGoP,CAAC,CAACwgB,MAAM,CAAC5U,qBAAqB,CAAC,CAAC;YAC3C,IAAInb,MAAM,CAACmvB,OAAO,CAAC/tB,OAAO,CAAC0C,SAAS,IAAI,IAAI,IAAI3D,IAAI,CAACwU,MAAM,GAAGpF,CAAC,CAAC0jB,OAAO,GAAG,EAAE,EAAE;cAAE;cAC/E;cACAjzB,MAAM,CAACmvB,OAAO,CAACjiB,QAAQ,GAAG;gBACzB4I,OAAO,EAAEvG,CAAC,CAACwgB,MAAM,CAAC9tB,UAAU;gBAC5B8wB,aAAa,EAAExjB,CAAC,CAAC8jB,KAAK;gBACtBhhB,GAAG,EAAE4f,KAAK;gBACVtd,MAAM,EAAExU,IAAI,CAACwU;cACd,CAAC;cACD;cACApF,CAAC,CAACwgB,MAAM,CAAC9tB,UAAU,CAACoL,SAAS,CAACC,GAAG,CAAC,UAAU,CAAC;YAC9C,CAAC,MAAM,IAAItN,MAAM,CAACmvB,OAAO,CAAC/tB,OAAO,CAAC2C,OAAO,IAAI,IAAI,IAAI5D,IAAI,CAAC0O,KAAK,GAAGU,CAAC,CAACujB,OAAO,GAAG,EAAE,EAAE;cAAE;cACnF,IAAI9yB,MAAM,CAACmvB,OAAO,CAACxV,WAAW,CAACsY,KAAK,CAAC,CAAC7jB,MAAM,EAAE;gBAC7C1M,OAAO,CAACC,KAAK,CAAC,iDAAiD,CAAC;cACjE,CAAC,MAAM,IAAI3B,MAAM,CAACmvB,OAAO,CAAC/tB,OAAO,CAACiE,MAAM,IAAI,IAAI,IAAIrF,MAAM,CAACmvB,OAAO,CAACtjB,OAAO,EAAE;gBAC3EnK,OAAO,CAACC,KAAK,CAAC,mEAAmE,CAAC;cACnF,CAAC,MAAM;gBACN;gBACA3B,MAAM,CAACmvB,OAAO,CAACpf,cAAc,CAAC,CAAC;gBAC/B;gBACA/P,MAAM,CAACmvB,OAAO,CAAChiB,QAAQ,GAAG;kBACzB2I,OAAO,EAAEvG,CAAC,CAACwgB,MAAM,CAAC9tB,UAAU;kBAC5BoQ,GAAG,EAAC4f,KAAK;kBACTiB,WAAW,EAACjB;gBACb,CAAC;gBACD;gBACA1iB,CAAC,CAACwgB,MAAM,CAAC9tB,UAAU,CAACoL,SAAS,CAACC,GAAG,CAAC,UAAU,CAAC;cAC9C;YACD,CAAC,MAAM;cACN,IAAItN,MAAM,CAACmvB,OAAO,CAACyC,WAAW,KAAKriB,CAAC,CAAC+Z,QAAQ,IAAI/Z,CAAC,CAACga,OAAO,CAAC,EAAE;gBAC5D,IAAIxoB,CAAC,GAAGf,MAAM,CAACmvB,OAAO,CAACyC,WAAW;gBAClC,IAAIhU,CAAC,GAAGqU,KAAK;cACd,CAAC,MAAM;gBACN;gBACAjyB,MAAM,CAACmvB,OAAO,CAACyC,WAAW,GAAGK,KAAK;;gBAElC;gBACA,IAAIlxB,CAAC,GAAGkxB,KAAK;gBACb,IAAIrU,CAAC,GAAGqU,KAAK;cACd;;cAEA;cACAjyB,MAAM,CAACmvB,OAAO,CAACxQ,yBAAyB,CAAC,CAAC,EAAE5d,CAAC,EAAEf,MAAM,CAACmvB,OAAO,CAAC/tB,OAAO,CAACoB,IAAI,CAAC,CAAC,CAAC,CAAC4L,MAAM,GAAG,CAAC,EAAEwP,CAAC,CAAC;YAC7F;UACD,CAAC,MAAM;YACN;YACA,IAAIrO,CAAC,CAACwgB,MAAM,CAAC1iB,SAAS,CAACuG,QAAQ,CAAC,QAAQ,CAAC,IAAIrE,CAAC,CAACwgB,MAAM,CAACuD,WAAW,GAAG/jB,CAAC,CAACujB,OAAO,GAAG,EAAE,IAAIvjB,CAAC,CAAC0jB,OAAO,GAAG,EAAE,EAAE;cACrGjzB,MAAM,CAACmvB,OAAO,CAAC9T,WAAW,CAACrb,MAAM,CAACmvB,OAAO,CAACniB,OAAO,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC;YAC5D,CAAC,MAAM;cACN,IAAIumB,aAAa,GAAG,SAAAA,CAASzd,OAAO,EAAE;gBACrC,IAAIpC,CAAC,GAAGoC,OAAO,CAACgC,YAAY,CAAC,QAAQ,CAAC;gBACtC,IAAInE,CAAC,GAAGmC,OAAO,CAACgC,YAAY,CAAC,QAAQ,CAAC;gBACtC,IAAIpE,CAAC,IAAIC,CAAC,EAAE;kBACX,OAAO,CAACD,CAAC,EAAEC,CAAC,CAAC;gBACd,CAAC,MAAM;kBACN,IAAImC,OAAO,CAAC7T,UAAU,EAAE;oBACvB,OAAOsxB,aAAa,CAACzd,OAAO,CAAC7T,UAAU,CAAC;kBACzC;gBACD;cACD,CAAC;cAED,IAAIoY,QAAQ,GAAGkZ,aAAa,CAAChkB,CAAC,CAACwgB,MAAM,CAAC;cACtC,IAAI1V,QAAQ,EAAE;gBAEb,IAAIR,QAAQ,GAAGQ,QAAQ,CAAC,CAAC,CAAC;gBAC1B,IAAI4X,KAAK,GAAG5X,QAAQ,CAAC,CAAC,CAAC;gBACvB;gBACA,IAAIra,MAAM,CAACmvB,OAAO,CAACniB,OAAO,EAAE;kBAC3B,IAAIhN,MAAM,CAACmvB,OAAO,CAACniB,OAAO,CAAC,CAAC,CAAC,IAAI6M,QAAQ,IAAI7Z,MAAM,CAACmvB,OAAO,CAACniB,OAAO,CAAC,CAAC,CAAC,IAAIilB,KAAK,EAAE;oBAChFjyB,MAAM,CAACmvB,OAAO,CAAC9T,WAAW,CAACrb,MAAM,CAACmvB,OAAO,CAACniB,OAAO,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC;kBAC5D;gBACD;gBAEA,IAAI,CAAEhN,MAAM,CAACmvB,OAAO,CAACniB,OAAO,EAAE;kBAC7B;kBACA,IAAIuC,CAAC,CAAC+Z,QAAQ,EAAE;oBACftpB,MAAM,CAACmvB,OAAO,CAACxQ,yBAAyB,CAAC3e,MAAM,CAACmvB,OAAO,CAAC1iB,YAAY,CAAC,CAAC,CAAC,EAAEzM,MAAM,CAACmvB,OAAO,CAAC1iB,YAAY,CAAC,CAAC,CAAC,EAAEoN,QAAQ,EAAEoY,KAAK,CAAC;kBAC1H,CAAC,MAAM;oBACNjyB,MAAM,CAACmvB,OAAO,CAACxQ,yBAAyB,CAAC9E,QAAQ,EAAEoY,KAAK,CAAC;kBAC1D;gBACD;;gBAEA;gBACAjyB,MAAM,CAACmvB,OAAO,CAAC0C,cAAc,GAAG,IAAI;gBACpC7xB,MAAM,CAACmvB,OAAO,CAACyC,WAAW,GAAG,IAAI;cAClC;YACD;UACD;QACD,CAAC,MAAM;UACN5xB,MAAM,CAACmvB,OAAO,CAACyC,WAAW,GAAG,KAAK;QACnC;;QAEA;QACA,IAAIriB,CAAC,CAACwgB,MAAM,CAAC1iB,SAAS,CAACuG,QAAQ,CAAC,aAAa,CAAC,EAAE;UAC/C,IAAIrE,CAAC,CAACwgB,MAAM,CAACla,WAAW,IAAI,GAAG,EAAE;YAChC7V,MAAM,CAACmvB,OAAO,CAAChf,IAAI,CAAC,CAAC,CAAC;UACvB,CAAC,MAAM,IAAIZ,CAAC,CAACwgB,MAAM,CAACla,WAAW,IAAI,GAAG,EAAE;YACvC7V,MAAM,CAACmvB,OAAO,CAAChf,IAAI,CAACZ,CAAC,CAACwgB,MAAM,CAACjY,YAAY,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;UACxD,CAAC,MAAM;YACN9X,MAAM,CAACmvB,OAAO,CAAChf,IAAI,CAACZ,CAAC,CAACwgB,MAAM,CAACla,WAAW,GAAG,CAAC,CAAC;UAC9C;QACD;MACD;MAEA,IAAI7V,MAAM,CAACmvB,OAAO,CAACniB,OAAO,EAAE;QAC3BhN,MAAM,CAACuyB,aAAa,GAAG,KAAK;MAC7B,CAAC,MAAM;QACNvyB,MAAM,CAACuyB,aAAa,GAAG,IAAI;MAC5B;IACD,CAAC,MAAM;MACNvyB,MAAM,CAACuyB,aAAa,GAAG,KAAK;IAC7B;EACD,CAAC;EAEDvyB,MAAM,CAACywB,eAAe,GAAG,UAASlhB,CAAC,EAAE;IACpC,IAAIvP,MAAM,CAACmvB,OAAO,EAAE;MACnB;MACA,IAAInvB,MAAM,CAACmvB,OAAO,CAACjiB,QAAQ,EAAE;QAC5B;QACA,IAAIlN,MAAM,CAACmvB,OAAO,CAACjiB,QAAQ,CAACuK,MAAM,EAAE;UACnC;UACA,IAAI+b,QAAQ,GAAGxzB,MAAM,CAACmvB,OAAO,CAAC7iB,QAAQ,CAACtM,MAAM,CAACmvB,OAAO,CAACjiB,QAAQ,CAACuK,MAAM,CAAC,CAACK,YAAY,CAAC,OAAO,CAAC;UAC5F;UACA,IAAIjV,OAAO,GAAG7C,MAAM,CAACmvB,OAAO,CAAC5I,kBAAkB,CAAC,CAAC;UACjD,IAAI1jB,OAAO,CAACuL,MAAM,GAAG,CAAC,EAAE;YACvB,IAAIqlB,YAAY,GAAG,EAAE;YACrB,KAAK,IAAIjlB,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG3L,OAAO,CAACuL,MAAM,EAAEI,CAAC,EAAE,EAAE;cACxCilB,YAAY,CAAC1kB,IAAI,CAACmB,QAAQ,CAAClQ,MAAM,CAACmvB,OAAO,CAAC7iB,QAAQ,CAACzJ,OAAO,CAAC2L,CAAC,CAAC,CAAC,CAACsJ,YAAY,CAAC,OAAO,CAAC,CAAC,CAAC;YACvF;YACA;YACA,IAAI9I,KAAK,GAAGnM,OAAO,CAACyhB,OAAO,CAACpU,QAAQ,CAAClQ,MAAM,CAACmvB,OAAO,CAACjiB,QAAQ,CAACuK,MAAM,CAAC,CAAC;YACrEgc,YAAY,CAACzkB,KAAK,CAAC,GAAGhP,MAAM,CAACmvB,OAAO,CAACjiB,QAAQ,CAAC2B,KAAK;YACnD7O,MAAM,CAACmvB,OAAO,CAACnO,QAAQ,CAACne,OAAO,EAAE2wB,QAAQ,EAAEC,YAAY,CAAC;UACzD,CAAC,MAAM;YACNzzB,MAAM,CAACmvB,OAAO,CAACnO,QAAQ,CAAChhB,MAAM,CAACmvB,OAAO,CAACjiB,QAAQ,CAACuK,MAAM,EAAE+b,QAAQ,EAAExzB,MAAM,CAACmvB,OAAO,CAACjiB,QAAQ,CAAC2B,KAAK,CAAC;UACjG;UACA;UACA7O,MAAM,CAACmvB,OAAO,CAACjjB,OAAO,CAAClM,MAAM,CAACmvB,OAAO,CAACjiB,QAAQ,CAACuK,MAAM,CAAC,CAACpK,SAAS,CAAClL,MAAM,CAAC,UAAU,CAAC;UACnF,KAAK,IAAIqO,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGxQ,MAAM,CAACmvB,OAAO,CAAChjB,OAAO,CAACiC,MAAM,EAAEoC,CAAC,EAAE,EAAE;YACvD,IAAIxQ,MAAM,CAACmvB,OAAO,CAAChjB,OAAO,CAACqE,CAAC,CAAC,CAACxQ,MAAM,CAACmvB,OAAO,CAACjiB,QAAQ,CAACuK,MAAM,CAAC,EAAE;cAC9DzX,MAAM,CAACmvB,OAAO,CAAChjB,OAAO,CAACqE,CAAC,CAAC,CAACxQ,MAAM,CAACmvB,OAAO,CAACjiB,QAAQ,CAACuK,MAAM,CAAC,CAACpK,SAAS,CAAClL,MAAM,CAAC,UAAU,CAAC;YACvF;UACD;QACD,CAAC,MAAM;UACN;UACAnC,MAAM,CAACmvB,OAAO,CAACvsB,IAAI,CAAC5C,MAAM,CAACmvB,OAAO,CAACjiB,QAAQ,CAACmF,GAAG,CAAC,CAAC+E,QAAQ,CAAC,CAAC,CAAC,CAAC/J,SAAS,CAAClL,MAAM,CAAC,UAAU,CAAC;UACzF,IAAIuxB,SAAS,GAAG1zB,MAAM,CAACmvB,OAAO,CAACvsB,IAAI,CAAC5C,MAAM,CAACmvB,OAAO,CAACjiB,QAAQ,CAACmF,GAAG,CAAC,CAACyF,YAAY,CAAC,QAAQ,CAAC;UACvF9X,MAAM,CAACmvB,OAAO,CAAChO,SAAS,CAACnhB,MAAM,CAACmvB,OAAO,CAACjiB,QAAQ,CAACmF,GAAG,EAAEqhB,SAAS,EAAE1zB,MAAM,CAACmvB,OAAO,CAACjiB,QAAQ,CAACyH,MAAM,CAAC;UAChG;UACA3U,MAAM,CAACmvB,OAAO,CAACjiB,QAAQ,CAAC4I,OAAO,CAACzI,SAAS,CAAClL,MAAM,CAAC,UAAU,CAAC;QAC7D;QACA;QACAnC,MAAM,CAACmvB,OAAO,CAACjiB,QAAQ,GAAG,IAAI;MAC/B,CAAC,MAAM,IAAIlN,MAAM,CAACmvB,OAAO,CAAChiB,QAAQ,EAAE;QACnC;QACA,IAAInN,MAAM,CAACmvB,OAAO,CAAChiB,QAAQ,EAAE;UAC5B,IAAInN,MAAM,CAACmvB,OAAO,CAAChiB,QAAQ,CAACsK,MAAM,EAAE;YACnC;YACA,IAAIoC,QAAQ,GAAGtK,CAAC,CAACwgB,MAAM,CAACjY,YAAY,CAAC,QAAQ,CAAC;YAC9C;YACA9X,MAAM,CAACmvB,OAAO,CAACjjB,OAAO,CAAClM,MAAM,CAACmvB,OAAO,CAAChiB,QAAQ,CAACsK,MAAM,CAAC,CAACpK,SAAS,CAAClL,MAAM,CAAC,UAAU,CAAC;YACnF,KAAK,IAAIqO,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGxQ,MAAM,CAACmvB,OAAO,CAACvsB,IAAI,CAACwL,MAAM,EAAEoC,CAAC,EAAE,EAAE;cACpD,IAAIxQ,MAAM,CAACmvB,OAAO,CAAChjB,OAAO,CAACqE,CAAC,CAAC,CAACxQ,MAAM,CAACmvB,OAAO,CAAChiB,QAAQ,CAACsK,MAAM,CAAC,EAAE;gBAC9DzX,MAAM,CAACmvB,OAAO,CAAChjB,OAAO,CAACqE,CAAC,CAAC,CAACxQ,MAAM,CAACmvB,OAAO,CAAChiB,QAAQ,CAACsK,MAAM,CAAC,CAACpK,SAAS,CAAClL,MAAM,CAAC,UAAU,CAAC;cACvF;YACD;YACA,KAAK,IAAIqM,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGxO,MAAM,CAACmvB,OAAO,CAACjjB,OAAO,CAACkC,MAAM,EAAEI,CAAC,EAAE,EAAE;cACvDxO,MAAM,CAACmvB,OAAO,CAACjjB,OAAO,CAACsC,CAAC,CAAC,CAACnB,SAAS,CAAClL,MAAM,CAAC,eAAe,CAAC;cAC3DnC,MAAM,CAACmvB,OAAO,CAACjjB,OAAO,CAACsC,CAAC,CAAC,CAACnB,SAAS,CAAClL,MAAM,CAAC,gBAAgB,CAAC;YAC7D;YACA;YACA,IAAI0X,QAAQ,EAAE;cACb,IAAI7Z,MAAM,CAACmvB,OAAO,CAAChiB,QAAQ,CAACsK,MAAM,IAAIzX,MAAM,CAACmvB,OAAO,CAAChiB,QAAQ,CAAC+lB,WAAW,EAAE;gBAC1ElzB,MAAM,CAACmvB,OAAO,CAAC5J,UAAU,CAACvlB,MAAM,CAACmvB,OAAO,CAAChiB,QAAQ,CAACsK,MAAM,EAAEzX,MAAM,CAACmvB,OAAO,CAAChiB,QAAQ,CAAC+lB,WAAW,CAAC;cAC/F;YACD;UACD,CAAC,MAAM;YACN,IAAIlzB,MAAM,CAACmvB,OAAO,CAAChiB,QAAQ,CAAC2I,OAAO,CAACyO,WAAW,EAAE;cAChD,IAAIlK,QAAQ,GAAGnK,QAAQ,CAAClQ,MAAM,CAACmvB,OAAO,CAAChiB,QAAQ,CAAC2I,OAAO,CAACyO,WAAW,CAACzM,YAAY,CAAC,QAAQ,CAAC,CAAC;cAC3F,IAAI9X,MAAM,CAACmvB,OAAO,CAAChiB,QAAQ,CAACkF,GAAG,GAAGgI,QAAQ,EAAE;gBAC3CA,QAAQ,IAAI,CAAC;cACd;YACD,CAAC,MAAM;cACN,IAAIA,QAAQ,GAAGnK,QAAQ,CAAClQ,MAAM,CAACmvB,OAAO,CAAChiB,QAAQ,CAAC2I,OAAO,CAAC6d,eAAe,CAAC7b,YAAY,CAAC,QAAQ,CAAC,CAAC;YAChG;YACA,IAAI9X,MAAM,CAACmvB,OAAO,CAAChiB,QAAQ,CAACkF,GAAG,IAAIrS,MAAM,CAACmvB,OAAO,CAAChiB,QAAQ,CAAC+lB,WAAW,EAAE;cACvElzB,MAAM,CAACmvB,OAAO,CAAChL,OAAO,CAACnkB,MAAM,CAACmvB,OAAO,CAAChiB,QAAQ,CAACkF,GAAG,EAAEgI,QAAQ,EAAE,IAAI,CAAC;YACpE;YACAra,MAAM,CAACmvB,OAAO,CAAChiB,QAAQ,CAAC2I,OAAO,CAACzI,SAAS,CAAClL,MAAM,CAAC,UAAU,CAAC;UAC7D;UACAnC,MAAM,CAACmvB,OAAO,CAAChiB,QAAQ,GAAG,IAAI;QAC/B;MACD,CAAC,MAAM;QACN;QACA,IAAInN,MAAM,CAACmvB,OAAO,CAAC0D,cAAc,EAAE;UAClC7yB,MAAM,CAACmvB,OAAO,CAAC0D,cAAc,GAAG,KAAK;;UAErC;UACA,IAAI7yB,MAAM,CAACmvB,OAAO,CAAC5iB,SAAS,CAAC6B,MAAM,GAAG,CAAC,EAAE;YACxC;YACApO,MAAM,CAACmvB,OAAO,CAACxR,QAAQ,CAAC3d,MAAM,CAACmvB,OAAO,CAAC5iB,SAAS,CAAC,CAAC,CAAC,EAAEvM,MAAM,CAACmvB,OAAO,CAAC5iB,SAAS,CAACvM,MAAM,CAACmvB,OAAO,CAAC5iB,SAAS,CAAC6B,MAAM,GAAG,CAAC,CAAC,CAAC;;YAEnH;YACApO,MAAM,CAACmvB,OAAO,CAACvP,mBAAmB,CAAC,CAAC;UACrC;QACD;MACD;IACD;;IAEA;IACA,IAAI5f,MAAM,CAACswB,WAAW,EAAE;MACvBgC,YAAY,CAACtyB,MAAM,CAACswB,WAAW,CAAC;MAChCtwB,MAAM,CAACswB,WAAW,GAAG,IAAI;IAC1B;;IAEA;IACAtwB,MAAM,CAACuyB,aAAa,GAAG,KAAK;EAC7B,CAAC;;EAED;EACAvyB,MAAM,CAAC2wB,iBAAiB,GAAG,UAASphB,CAAC,EAAE;IACtCA,CAAC,GAAGA,CAAC,IAAItP,MAAM,CAACuN,KAAK;IACrB,IAAI+B,CAAC,CAACijB,OAAO,EAAE;MACd,IAAIC,WAAW,GAAGljB,CAAC,CAACijB,OAAO;IAC5B,CAAC,MAAM,IAAIjjB,CAAC,CAACmjB,MAAM,EAAE;MACpB,IAAID,WAAW,GAAGljB,CAAC,CAACmjB,MAAM;IAC3B,CAAC,MAAM;MACN,IAAID,WAAW,GAAGljB,CAAC,CAAC6hB,KAAK;IAC1B;IAEA,IAAI,CAAEqB,WAAW,EAAE;MAClBzyB,MAAM,CAACuyB,aAAa,GAAG,KAAK;IAC7B;IAEA,IAAIvyB,MAAM,CAACmvB,OAAO,EAAE;MACnB,IAAInvB,MAAM,CAACuyB,aAAa,IAAI,IAAI,EAAE;QACjC;QACA,IAAIvyB,MAAM,CAACmvB,OAAO,CAACjiB,QAAQ,EAAE;UAC5B,IAAIlN,MAAM,CAACmvB,OAAO,CAACjiB,QAAQ,CAACuK,MAAM,EAAE;YACnC,IAAI5I,KAAK,GAAGU,CAAC,CAACyjB,KAAK,GAAGhzB,MAAM,CAACmvB,OAAO,CAACjiB,QAAQ,CAAC6lB,aAAa;YAE3D,IAAI/yB,MAAM,CAACmvB,OAAO,CAACjiB,QAAQ,CAAC2B,KAAK,GAAGA,KAAK,GAAG,CAAC,EAAE;cAC9C,IAAI+kB,SAAS,GAAG5zB,MAAM,CAACmvB,OAAO,CAACjiB,QAAQ,CAAC2B,KAAK,GAAGA,KAAK;cACrD7O,MAAM,CAACmvB,OAAO,CAAC7iB,QAAQ,CAACtM,MAAM,CAACmvB,OAAO,CAACjiB,QAAQ,CAACuK,MAAM,CAAC,CAAClH,YAAY,CAAC,OAAO,EAAEqjB,SAAS,CAAC;cAExF5zB,MAAM,CAACmvB,OAAO,CAAClT,oBAAoB,CAAC,CAAC;YACtC;UACD,CAAC,MAAM;YACN,IAAItH,MAAM,GAAGpF,CAAC,CAAC8jB,KAAK,GAAGrzB,MAAM,CAACmvB,OAAO,CAACjiB,QAAQ,CAAC6lB,aAAa;YAE5D,IAAI/yB,MAAM,CAACmvB,OAAO,CAACjiB,QAAQ,CAACyH,MAAM,GAAGA,MAAM,GAAG,CAAC,EAAE;cAChD,IAAIkf,UAAU,GAAG7zB,MAAM,CAACmvB,OAAO,CAACjiB,QAAQ,CAACyH,MAAM,GAAGA,MAAM;cACxD3U,MAAM,CAACmvB,OAAO,CAACvsB,IAAI,CAAC5C,MAAM,CAACmvB,OAAO,CAACjiB,QAAQ,CAACmF,GAAG,CAAC,CAAC9B,YAAY,CAAC,QAAQ,EAAEsjB,UAAU,CAAC;cACnF;cACA7zB,MAAM,CAACmvB,OAAO,CAACvsB,IAAI,CAAC5C,MAAM,CAACmvB,OAAO,CAACjiB,QAAQ,CAACmF,GAAG,CAAC,CAACrM,KAAK,CAAC8V,WAAW,CAAE,2BAA2B,EAAEC,IAAI,CAACC,KAAK,CAAE,CAAC6X,UAAU,GAAC,EAAE,IAAI,EAAG,CAAE,CAAC;cACrI7zB,MAAM,CAACmvB,OAAO,CAAClT,oBAAoB,CAAC,CAAC;YACtC;UACD;QACD,CAAC,MAAM,IAAIjc,MAAM,CAACmvB,OAAO,CAAChiB,QAAQ,EAAE;UACnC,IAAInN,MAAM,CAACmvB,OAAO,CAAChiB,QAAQ,CAACsK,MAAM,EAAE;YACnC,IAAIoC,QAAQ,GAAGtK,CAAC,CAACwgB,MAAM,CAACjY,YAAY,CAAC,QAAQ,CAAC;YAC9C,IAAI+B,QAAQ,EAAE;cAEb,IAAI7Z,MAAM,CAACmvB,OAAO,CAAC1V,WAAW,CAACI,QAAQ,CAAC,CAACzL,MAAM,EAAE;gBAChD1M,OAAO,CAACC,KAAK,CAAC,qDAAqD,CAAC;cACrE,CAAC,MAAM;gBACN,KAAK,IAAI6M,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGxO,MAAM,CAACmvB,OAAO,CAACjjB,OAAO,CAACkC,MAAM,EAAEI,CAAC,EAAE,EAAE;kBACvDxO,MAAM,CAACmvB,OAAO,CAACjjB,OAAO,CAACsC,CAAC,CAAC,CAACnB,SAAS,CAAClL,MAAM,CAAC,eAAe,CAAC;kBAC3DnC,MAAM,CAACmvB,OAAO,CAACjjB,OAAO,CAACsC,CAAC,CAAC,CAACnB,SAAS,CAAClL,MAAM,CAAC,gBAAgB,CAAC;gBAC7D;gBAEA,IAAInC,MAAM,CAACmvB,OAAO,CAAChiB,QAAQ,CAACsK,MAAM,IAAIoC,QAAQ,EAAE;kBAC/C7Z,MAAM,CAACmvB,OAAO,CAAChiB,QAAQ,CAAC+lB,WAAW,GAAGhjB,QAAQ,CAAC2J,QAAQ,CAAC;gBACzD,CAAC,MAAM;kBACN,IAAItK,CAAC,CAACwgB,MAAM,CAACuD,WAAW,GAAG,CAAC,GAAG/jB,CAAC,CAACujB,OAAO,EAAE;oBACzC,IAAI9yB,MAAM,CAACmvB,OAAO,CAAChiB,QAAQ,CAACsK,MAAM,GAAGoC,QAAQ,EAAE;sBAC9C7Z,MAAM,CAACmvB,OAAO,CAAChiB,QAAQ,CAAC+lB,WAAW,GAAGhjB,QAAQ,CAAC2J,QAAQ,CAAC,GAAG,CAAC;oBAC7D,CAAC,MAAM;sBACN7Z,MAAM,CAACmvB,OAAO,CAAChiB,QAAQ,CAAC+lB,WAAW,GAAGhjB,QAAQ,CAAC2J,QAAQ,CAAC;oBACzD;oBACA7Z,MAAM,CAACmvB,OAAO,CAACjjB,OAAO,CAAC2N,QAAQ,CAAC,CAACxM,SAAS,CAACC,GAAG,CAAC,eAAe,CAAC;kBAChE,CAAC,MAAM;oBACN,IAAItN,MAAM,CAACmvB,OAAO,CAAChiB,QAAQ,CAACsK,MAAM,GAAGoC,QAAQ,EAAE;sBAC9C7Z,MAAM,CAACmvB,OAAO,CAAChiB,QAAQ,CAAC+lB,WAAW,GAAGhjB,QAAQ,CAAC2J,QAAQ,CAAC;oBACzD,CAAC,MAAM;sBACN7Z,MAAM,CAACmvB,OAAO,CAAChiB,QAAQ,CAAC+lB,WAAW,GAAGhjB,QAAQ,CAAC2J,QAAQ,CAAC,GAAG,CAAC;oBAC7D;oBACA7Z,MAAM,CAACmvB,OAAO,CAACjjB,OAAO,CAAC2N,QAAQ,CAAC,CAACxM,SAAS,CAACC,GAAG,CAAC,gBAAgB,CAAC;kBACjE;gBACD;cACD;YACD;UACD,CAAC,MAAM;YACN,IAAI2kB,KAAK,GAAG1iB,CAAC,CAACwgB,MAAM,CAACjY,YAAY,CAAC,QAAQ,CAAC;YAC3C,IAAIma,KAAK,EAAE;cACV,IAAIjyB,MAAM,CAACmvB,OAAO,CAACxV,WAAW,CAACsY,KAAK,CAAC,CAAC7jB,MAAM,EAAE;gBAC7C1M,OAAO,CAACC,KAAK,CAAC,kDAAkD,CAAC;cAClE,CAAC,MAAM;gBACN,IAAIouB,MAAM,GAAIxgB,CAAC,CAACwgB,MAAM,CAACE,YAAY,GAAG,CAAC,GAAG1gB,CAAC,CAAC0jB,OAAO,GAAI1jB,CAAC,CAACwgB,MAAM,CAAC9tB,UAAU,CAACsiB,WAAW,GAAGhV,CAAC,CAACwgB,MAAM,CAAC9tB,UAAU;gBAC5G,IAAIjC,MAAM,CAACmvB,OAAO,CAAChiB,QAAQ,CAAC2I,OAAO,IAAIia,MAAM,EAAE;kBAC9CxgB,CAAC,CAACwgB,MAAM,CAAC9tB,UAAU,CAACA,UAAU,CAACC,YAAY,CAAClC,MAAM,CAACmvB,OAAO,CAAChiB,QAAQ,CAAC2I,OAAO,EAAEia,MAAM,CAAC;kBACpF/vB,MAAM,CAACmvB,OAAO,CAAChiB,QAAQ,CAAC+lB,WAAW,GAAGtlB,KAAK,CAACC,SAAS,CAACyW,OAAO,CAACvW,IAAI,CAAC/N,MAAM,CAACmvB,OAAO,CAAChiB,QAAQ,CAAC2I,OAAO,CAAC7T,UAAU,CAACmV,QAAQ,EAAEpX,MAAM,CAACmvB,OAAO,CAAChiB,QAAQ,CAAC2I,OAAO,CAAC;gBACzJ;cACD;YACD;UACD;QACD;MACD,CAAC,MAAM;QACN,IAAIpC,CAAC,GAAGnE,CAAC,CAACwgB,MAAM,CAACjY,YAAY,CAAC,QAAQ,CAAC;QACvC,IAAInE,CAAC,GAAGpE,CAAC,CAACwgB,MAAM,CAACjY,YAAY,CAAC,QAAQ,CAAC;QACvC,IAAIyD,IAAI,GAAGhM,CAAC,CAACwgB,MAAM,CAAC5U,qBAAqB,CAAC,CAAC;QAE3C,IAAInb,MAAM,CAACmvB,OAAO,CAACviB,MAAM,EAAE;UAC1B5M,MAAM,CAACmvB,OAAO,CAACviB,MAAM,CAAC5G,KAAK,CAAC4G,MAAM,GAAG,EAAE;UACvC5M,MAAM,CAACmvB,OAAO,CAACviB,MAAM,GAAG,IAAI;QAC7B;QAEA,IAAI2C,CAAC,CAACwgB,MAAM,CAAC9tB,UAAU,CAACA,UAAU,IAAIsN,CAAC,CAACwgB,MAAM,CAAC9tB,UAAU,CAACA,UAAU,CAAC2O,SAAS,EAAE;UAC/E,IAAIrB,CAAC,CAACwgB,MAAM,CAAC9tB,UAAU,CAACA,UAAU,CAACoL,SAAS,CAACuG,QAAQ,CAAC,WAAW,CAAC,EAAE;YACnE,IAAIrE,CAAC,CAACwgB,MAAM,IAAIrc,CAAC,IAAI,CAAEC,CAAC,IAAK4H,IAAI,CAAC1M,KAAK,IAAIU,CAAC,CAACukB,OAAO,GAAGvY,IAAI,CAAC0D,IAAI,CAAC,GAAG,EAAG,EAAE;cAAE;cAC1Ejf,MAAM,CAACmvB,OAAO,CAACviB,MAAM,GAAG2C,CAAC,CAACwgB,MAAM;cAChC/vB,MAAM,CAACmvB,OAAO,CAACviB,MAAM,CAAC5G,KAAK,CAAC4G,MAAM,GAAG,YAAY;YAClD,CAAC,MAAM,IAAI2C,CAAC,CAACwgB,MAAM,IAAI,CAAErc,CAAC,IAAIC,CAAC,IAAK4H,IAAI,CAAC5G,MAAM,IAAIpF,CAAC,CAACwkB,OAAO,GAAGxY,IAAI,CAACI,GAAG,CAAC,GAAG,EAAG,EAAE;cAAE;cACjF3b,MAAM,CAACmvB,OAAO,CAACviB,MAAM,GAAG2C,CAAC,CAACwgB,MAAM;cAChC/vB,MAAM,CAACmvB,OAAO,CAACviB,MAAM,CAAC5G,KAAK,CAAC4G,MAAM,GAAG,YAAY;YAClD;UACD;UAEA,IAAI2C,CAAC,CAACwgB,MAAM,CAAC9tB,UAAU,CAACA,UAAU,CAACoL,SAAS,CAACuG,QAAQ,CAAC,WAAW,CAAC,EAAE;YACnE,IAAIrE,CAAC,CAACwgB,MAAM,IAAI,CAAErc,CAAC,IAAIC,CAAC,IAAK4H,IAAI,CAAC1M,KAAK,IAAIU,CAAC,CAACukB,OAAO,GAAGvY,IAAI,CAAC0D,IAAI,CAAC,GAAG,EAAG,EAAE;cAAE;cAC1Ejf,MAAM,CAACmvB,OAAO,CAACviB,MAAM,GAAG2C,CAAC,CAACwgB,MAAM;cAChC/vB,MAAM,CAACmvB,OAAO,CAACviB,MAAM,CAAC5G,KAAK,CAAC4G,MAAM,GAAG,MAAM;YAC5C,CAAC,MAAM,IAAI2C,CAAC,CAACwgB,MAAM,IAAIrc,CAAC,IAAI,CAAEC,CAAC,IAAK4H,IAAI,CAAC5G,MAAM,IAAIpF,CAAC,CAACwkB,OAAO,GAAGxY,IAAI,CAACI,GAAG,CAAC,GAAG,EAAG,IAAKpM,CAAC,CAACukB,OAAO,GAAGvY,IAAI,CAAC0D,IAAI,GAAG1D,IAAI,CAAC1M,KAAK,GAAG,EAAG,EAAE;cAAE;cAC9H7O,MAAM,CAACmvB,OAAO,CAACviB,MAAM,GAAG2C,CAAC,CAACwgB,MAAM;cAChC/vB,MAAM,CAACmvB,OAAO,CAACviB,MAAM,CAAC5G,KAAK,CAAC4G,MAAM,GAAG,MAAM;YAC5C;UACD;QACD;MACD;IACD;EACD,CAAC;EAED5M,MAAM,CAAC4wB,iBAAiB,GAAG,UAASrhB,CAAC,EAAE;IACtCA,CAAC,GAAGA,CAAC,IAAItP,MAAM,CAACuN,KAAK;IACrB,IAAI+B,CAAC,CAACijB,OAAO,EAAE;MACd,IAAIC,WAAW,GAAGljB,CAAC,CAACijB,OAAO;IAC5B,CAAC,MAAM,IAAIjjB,CAAC,CAACmjB,MAAM,EAAE;MACpB,IAAID,WAAW,GAAGljB,CAAC,CAACmjB,MAAM;IAC3B,CAAC,MAAM;MACN,IAAID,WAAW,GAAGljB,CAAC,CAAC6hB,KAAK;IAC1B;IAEA,IAAI,CAAEqB,WAAW,EAAE;MAClBzyB,MAAM,CAACuyB,aAAa,GAAG,KAAK;IAC7B;IAEA,IAAIvyB,MAAM,CAACmvB,OAAO,IAAInvB,MAAM,CAACuyB,aAAa,IAAI,IAAI,EAAE;MACnD;MACA,IAAII,WAAW,GAAG3yB,MAAM,CAAC4yB,UAAU,CAACrjB,CAAC,CAACwgB,MAAM,CAAC;MAE7C,IAAI4C,WAAW,CAAC,CAAC,CAAC,EAAE;QACnB;QACA,IAAI3yB,MAAM,CAACmvB,OAAO,IAAIwD,WAAW,CAAC,CAAC,CAAC,CAAC3yB,MAAM,EAAE;UAC5C,IAAIA,MAAM,CAACmvB,OAAO,EAAE;YACnB,OAAO,KAAK;UACb;QACD;QAEA,IAAItV,QAAQ,GAAGtK,CAAC,CAACwgB,MAAM,CAACjY,YAAY,CAAC,QAAQ,CAAC;QAC9C,IAAIma,KAAK,GAAG1iB,CAAC,CAACwgB,MAAM,CAACjY,YAAY,CAAC,QAAQ,CAAC;QAC3C,IAAI9X,MAAM,CAACmvB,OAAO,CAACjiB,QAAQ,IAAIlN,MAAM,CAACmvB,OAAO,CAAChiB,QAAQ,EAAE,CACxD,CAAC,MAAM;UACN;UACA,IAAIwlB,WAAW,CAAC,CAAC,CAAC,IAAI,CAAC,EAAE;YACxB,IAAI3yB,MAAM,CAACmvB,OAAO,CAAC0C,cAAc,EAAE;cAClC,IAAIhY,QAAQ,GAAGtK,CAAC,CAACwgB,MAAM,CAACjY,YAAY,CAAC,QAAQ,CAAC;cAC9C,IAAI/W,CAAC,GAAGf,MAAM,CAACmvB,OAAO,CAAC0C,cAAc;cACrC,IAAIjU,CAAC,GAAG/D,QAAQ;cAChB;cACA7Z,MAAM,CAACmvB,OAAO,CAACxQ,yBAAyB,CAAC5d,CAAC,EAAE,CAAC,EAAE6c,CAAC,EAAE5d,MAAM,CAACmvB,OAAO,CAAC/tB,OAAO,CAACoB,IAAI,CAAC4L,MAAM,GAAG,CAAC,CAAC;YAC1F;UACD;;UAEA;UACA,IAAIukB,WAAW,CAAC,CAAC,CAAC,IAAI,CAAC,EAAE;YACxB,IAAIpjB,CAAC,CAACwgB,MAAM,CAAC1iB,SAAS,CAACuG,QAAQ,CAAC,YAAY,CAAC,EAAE;cAC9C,IAAI5T,MAAM,CAACmvB,OAAO,CAACyC,WAAW,EAAE;gBAC/B,IAAI7wB,CAAC,GAAGf,MAAM,CAACmvB,OAAO,CAACyC,WAAW;gBAClC,IAAIhU,CAAC,GAAGqU,KAAK;gBACb;gBACAjyB,MAAM,CAACmvB,OAAO,CAACxQ,yBAAyB,CAAC,CAAC,EAAE5d,CAAC,EAAEf,MAAM,CAACmvB,OAAO,CAAC/tB,OAAO,CAACoB,IAAI,CAAC,CAAC,CAAC,CAAC4L,MAAM,GAAG,CAAC,EAAEwP,CAAC,CAAC;cAC7F;YACD,CAAC,MAAM;cACN;cACA,IAAI,CAAE5d,MAAM,CAACmvB,OAAO,CAACniB,OAAO,EAAE;gBAC7B,IAAI6M,QAAQ,IAAIoY,KAAK,EAAE;kBACtB,IAAIjyB,MAAM,CAACmvB,OAAO,CAAC0D,cAAc,EAAE;oBAClC7yB,MAAM,CAACmvB,OAAO,CAACtP,mBAAmB,CAAChG,QAAQ,EAAEoY,KAAK,CAAC;kBACpD,CAAC,MAAM;oBACN,IAAIjyB,MAAM,CAACmvB,OAAO,CAAC1iB,YAAY,EAAE;sBAChCzM,MAAM,CAACmvB,OAAO,CAACxQ,yBAAyB,CAAC3e,MAAM,CAACmvB,OAAO,CAAC1iB,YAAY,CAAC,CAAC,CAAC,EAAEzM,MAAM,CAACmvB,OAAO,CAAC1iB,YAAY,CAAC,CAAC,CAAC,EAAEoN,QAAQ,EAAEoY,KAAK,CAAC;oBAC1H;kBACD;gBACD;cACD;YACD;UACD;QACD;MACD;IACD;;IAEA;IACA,IAAIjyB,MAAM,CAACswB,WAAW,EAAE;MACvBgC,YAAY,CAACtyB,MAAM,CAACswB,WAAW,CAAC;MAChCtwB,MAAM,CAACswB,WAAW,GAAG,IAAI;IAC1B;EACD,CAAC;;EAED;AACD;AACA;EACCtwB,MAAM,CAAC6wB,mBAAmB,GAAG,UAASthB,CAAC,EAAE;IACxC;IACA,IAAIvP,MAAM,CAACmvB,OAAO,EAAE;MACnB;MACA,IAAI5f,CAAC,CAACwgB,MAAM,CAAC1iB,SAAS,CAACuG,QAAQ,CAAC,eAAe,CAAC,EAAE;QACjD;QACA,IAAI5T,MAAM,CAACmvB,OAAO,CAAC3iB,WAAW,CAAC4B,MAAM,GAAG,CAAC,EAAE;UAC1C;UACA,IAAIsK,EAAE,GAAG1Y,MAAM,CAACmvB,OAAO,CAAC3iB,WAAW,CAAC,CAAC,CAAC,CAACsL,YAAY,CAAC,QAAQ,CAAC;UAC7D,IAAIa,EAAE,GAAGzI,QAAQ,CAAClQ,MAAM,CAACmvB,OAAO,CAAC3iB,WAAW,CAACxM,MAAM,CAACmvB,OAAO,CAAC3iB,WAAW,CAAC4B,MAAM,GAAG,CAAC,CAAC,CAAC0J,YAAY,CAAC,QAAQ,CAAC,CAAC,GAAG,CAAC;UAC/G;UACA,IAAIc,EAAE,GAAG5Y,MAAM,CAACmvB,OAAO,CAAC3iB,WAAW,CAACxM,MAAM,CAACmvB,OAAO,CAAC3iB,WAAW,CAAC4B,MAAM,GAAG,CAAC,CAAC,CAAC0J,YAAY,CAAC,QAAQ,CAAC;UACjG,IAAIe,EAAE,GAAG7Y,MAAM,CAACmvB,OAAO,CAAChjB,OAAO,CAACiC,MAAM,GAAG,CAAC;UAC1C;UACApO,MAAM,CAACmvB,OAAO,CAACxR,QAAQ,CAAC3d,MAAM,CAACmvB,OAAO,CAAChjB,OAAO,CAACwM,EAAE,CAAC,CAACD,EAAE,CAAC,EAAE1Y,MAAM,CAACmvB,OAAO,CAAChjB,OAAO,CAAC0M,EAAE,CAAC,CAACD,EAAE,CAAC,CAAC;QACxF;MACD,CAAC,MAAM,IAAIrJ,CAAC,CAACwgB,MAAM,CAAC1iB,SAAS,CAACuG,QAAQ,CAAC,sBAAsB,CAAC,EAAE;QAC/D;QACA,IAAIiG,QAAQ,GAAGtK,CAAC,CAACwgB,MAAM,CAACjY,YAAY,CAAC,QAAQ,CAAC;QAC9C;QACA9X,MAAM,CAACmvB,OAAO,CAACvV,UAAU,CAACC,QAAQ,CAAC;MAEpC,CAAC,MAAM;QACN;QACA,IAAI8Y,WAAW,GAAG3yB,MAAM,CAAC4yB,UAAU,CAACrjB,CAAC,CAACwgB,MAAM,CAAC;;QAE7C;QACA,IAAI4C,WAAW,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI3yB,MAAM,CAACmvB,OAAO,CAAC/tB,OAAO,CAACuC,aAAa,IAAI,IAAI,EAAE;UACxE;UACA,IAAIkW,QAAQ,GAAGtK,CAAC,CAACwgB,MAAM,CAACjY,YAAY,CAAC,QAAQ,CAAC;UAC9C,IAAI+B,QAAQ,EAAE;YACb7Z,MAAM,CAACmvB,OAAO,CAAClM,OAAO,CAACpJ,QAAQ,CAAC;UACjC;QACD;;QAEA;QACA,IAAI8Y,WAAW,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI3yB,MAAM,CAACmvB,OAAO,CAAC/tB,OAAO,CAAC4C,QAAQ,IAAI,IAAI,EAAE;UACnE,IAAI,CAAEhE,MAAM,CAACmvB,OAAO,CAACniB,OAAO,EAAE;YAC7B,IAAIumB,aAAa,GAAG,SAAAA,CAASzd,OAAO,EAAE;cACrC,IAAIA,OAAO,CAAC7T,UAAU,EAAE;gBACvB,IAAIyR,CAAC,GAAGoC,OAAO,CAACgC,YAAY,CAAC,QAAQ,CAAC;gBACtC,IAAInE,CAAC,GAAGmC,OAAO,CAACgC,YAAY,CAAC,QAAQ,CAAC;gBACtC,IAAIpE,CAAC,IAAIC,CAAC,EAAE;kBACX,OAAOmC,OAAO;gBACf,CAAC,MAAM;kBACN,OAAOyd,aAAa,CAACzd,OAAO,CAAC7T,UAAU,CAAC;gBACzC;cACD;YACD,CAAC;YACD,IAAI2P,IAAI,GAAG2hB,aAAa,CAAChkB,CAAC,CAACwgB,MAAM,CAAC;YAClC,IAAIne,IAAI,IAAIA,IAAI,CAACvE,SAAS,CAACuG,QAAQ,CAAC,WAAW,CAAC,EAAE;cACjD5T,MAAM,CAACmvB,OAAO,CAACnU,UAAU,CAACpJ,IAAI,CAAC;YAChC;UACD;QACD;MACD;IACD;EACD,CAAC;EAED5R,MAAM,CAACgyB,YAAY,GAAG,UAASziB,CAAC,EAAE;IACjC,IAAIvP,MAAM,CAACmvB,OAAO,IAAInvB,MAAM,CAACgyB,YAAY,CAACgC,OAAO,EAAE;MAClD,IAAI,CAAEh0B,MAAM,CAACmvB,OAAO,CAACniB,OAAO,EAAE;QAC7BhN,MAAM,CAACmvB,OAAO,CAAC7kB,IAAI,CAAC,IAAI,CAAC;MAC1B;IACD;EACD,CAAC;EAEDtK,MAAM,CAAC+xB,WAAW,GAAG,UAASxiB,CAAC,EAAE;IAChC,IAAIvP,MAAM,CAACmvB,OAAO,EAAE;MACnB,IAAI,CAAEnvB,MAAM,CAACmvB,OAAO,CAACniB,OAAO,EAAE;QAC7BhN,MAAM,CAACmvB,OAAO,CAAC7kB,IAAI,CAAC,IAAI,CAAC;QACzB,IAAItK,MAAM,CAACmvB,OAAO,CAAC/tB,OAAO,CAAC4C,QAAQ,IAAI,IAAI,EAAE;UAC5ChE,MAAM,CAACmvB,OAAO,CAAC7a,QAAQ,CAACtU,MAAM,CAACmvB,OAAO,CAAC3iB,WAAW,EAAE,EAAE,CAAC;QACxD;MACD;IACD;EACD,CAAC;EAEDxM,MAAM,CAAC8wB,aAAa,GAAG,UAASvhB,CAAC,EAAE;IAClC,IAAIvP,MAAM,CAACmvB,OAAO,IAAInvB,MAAM,CAACmvB,OAAO,CAAC1iB,YAAY,EAAE;MAClD,IAAI,CAAEzM,MAAM,CAACmvB,OAAO,CAACniB,OAAO,EAAE;QAC7B,IAAIhN,MAAM,CAACmvB,OAAO,CAAC/tB,OAAO,CAAC4C,QAAQ,IAAI,IAAI,EAAE;UAC5C,IAAIuL,CAAC,IAAIA,CAAC,CAAC0kB,aAAa,EAAE;YACzBj0B,MAAM,CAACmvB,OAAO,CAAC5kB,KAAK,CAACvK,MAAM,CAACmvB,OAAO,CAAC1iB,YAAY,CAAC,CAAC,CAAC,EAAEzM,MAAM,CAACmvB,OAAO,CAAC1iB,YAAY,CAAC,CAAC,CAAC,EAAE8C,CAAC,CAAC0kB,aAAa,CAAC5gB,OAAO,CAAC,MAAM,CAAC,CAAC;YACrH9D,CAAC,CAAC8hB,cAAc,CAAC,CAAC;UACnB,CAAC,MAAM,IAAIpxB,MAAM,CAACg0B,aAAa,EAAE;YAChCj0B,MAAM,CAACmvB,OAAO,CAAC5kB,KAAK,CAACvK,MAAM,CAACmvB,OAAO,CAAC1iB,YAAY,CAAC,CAAC,CAAC,EAAEzM,MAAM,CAACmvB,OAAO,CAAC1iB,YAAY,CAAC,CAAC,CAAC,EAAExM,MAAM,CAACg0B,aAAa,CAAC5gB,OAAO,CAAC,MAAM,CAAC,CAAC;UAC3H;QACD;MACD;IACD;EACD,CAAC;EAEDrT,MAAM,CAAC+wB,mBAAmB,GAAG,UAASxhB,CAAC,EAAE;IACxCA,CAAC,GAAGA,CAAC,IAAItP,MAAM,CAACuN,KAAK;IACrB,IAAI,SAAS,IAAI+B,CAAC,EAAE;MACnB,IAAIkjB,WAAW,GAAGljB,CAAC,CAACijB,OAAO;IAC5B,CAAC,MAAM;MACN,IAAIC,WAAW,GAAGljB,CAAC,CAAC6hB,KAAK,IAAI7hB,CAAC,CAACmjB,MAAM;IACtC;IAEA,IAAI1yB,MAAM,CAACmvB,OAAO,EAAE;MACnB;MACA;MACC;MACD;MACA,IAAInvB,MAAM,CAACmvB,OAAO,CAAC/tB,OAAO,CAACkK,WAAW,EAAE;QACvCtL,MAAM,CAACmvB,OAAO,CAAC7jB,WAAW,CAAC0F,WAAW,CAACE,KAAK,CAAC,CAAC;QAE9C,IAAIlR,MAAM,CAACmvB,OAAO,EAAE;UACnB;UACA,IAAIY,MAAM,GAAIxgB,CAAC,CAACwgB,MAAM,CAACnuB,OAAO,KAAK,KAAK,IAAI2N,CAAC,CAACwgB,MAAM,CAACnuB,OAAO,KAAK,UAAU,GAAI2N,CAAC,CAACwgB,MAAM,CAAC9tB,UAAU,GAAGsN,CAAC,CAACwgB,MAAM;UAC7G,IAAIrc,CAAC,GAAGqc,MAAM,CAACjY,YAAY,CAAC,QAAQ,CAAC;UACrC,IAAInE,CAAC,GAAGoc,MAAM,CAACjY,YAAY,CAAC,QAAQ,CAAC;UAErC,IAAIpE,CAAC,IAAIC,CAAC,EAAE;YACX;AACN;AACA;AACA;YACM,MAAMpH,SAAS,GAAGvM,MAAM,CAACmvB,OAAO,CAAC1iB,YAAY;YAC7C,MAAMynB,aAAa,GAAG;cACrBC,CAAC,EAAEpY,IAAI,CAACqY,GAAG,CAAElkB,QAAQ,CAAE3D,SAAS,CAAC,CAAC,CAAE,CAAC,EAAE2D,QAAQ,CAAE3D,SAAS,CAAC,CAAC,CAAE,CAAE,CAAC;cACjE8nB,CAAC,EAAEtY,IAAI,CAACuY,GAAG,CAAEpkB,QAAQ,CAAE3D,SAAS,CAAC,CAAC,CAAE,CAAC,EAAE2D,QAAQ,CAAE3D,SAAS,CAAC,CAAC,CAAE,CAAE,CAAC;cACjE4I,CAAC,EAAE4G,IAAI,CAACqY,GAAG,CAAElkB,QAAQ,CAAE3D,SAAS,CAAC,CAAC,CAAE,CAAC,EAAE2D,QAAQ,CAAE3D,SAAS,CAAC,CAAC,CAAE,CAAE,CAAC;cACjEsL,CAAC,EAAEkE,IAAI,CAACuY,GAAG,CAAEpkB,QAAQ,CAAE3D,SAAS,CAAC,CAAC,CAAE,CAAC,EAAE2D,QAAQ,CAAE3D,SAAS,CAAC,CAAC,CAAE,CAAE;YACjE,CAAC;YACD,IAAKmH,CAAC,GAAGwgB,aAAa,CAACC,CAAC,IAAIzgB,CAAC,GAAGwgB,aAAa,CAACG,CAAC,IAAI1gB,CAAC,GAAGugB,aAAa,CAAC/e,CAAC,IAAIxB,CAAC,GAAGugB,aAAa,CAACrc,CAAC,EAAG;cAC/F7X,MAAM,CAACmvB,OAAO,CAACxQ,yBAAyB,CAACjL,CAAC,EAAEC,CAAC,EAAED,CAAC,EAAEC,CAAC,CAAC;YACrD;YACA;;YAEA;YACA,IAAI6b,KAAK,GAAGxvB,MAAM,CAACmvB,OAAO,CAAC/tB,OAAO,CAACkK,WAAW,CAACtL,MAAM,CAACmvB,OAAO,EAAEzb,CAAC,EAAEC,CAAC,EAAEpE,CAAC,CAAC;YACvE;YACAvP,MAAM,CAACmvB,OAAO,CAAC7jB,WAAW,CAAC0F,WAAW,CAACujB,IAAI,CAAChlB,CAAC,EAAEigB,KAAK,CAAC;YACrD;YACAjgB,CAAC,CAAC8hB,cAAc,CAAC,CAAC;UACnB;QACD;MACD;IACD;EACD,CAAC;EAEDrxB,MAAM,CAACgxB,kBAAkB,GAAG,UAASzhB,CAAC,EAAE;IACvC,IAAIojB,WAAW,GAAG3yB,MAAM,CAAC4yB,UAAU,CAACrjB,CAAC,CAACwgB,MAAM,CAAC;IAE7C,IAAI4C,WAAW,CAAC,CAAC,CAAC,EAAE;MACnB,IAAI3yB,MAAM,CAACmvB,OAAO,IAAIwD,WAAW,CAAC,CAAC,CAAC,CAAC3yB,MAAM,EAAE;QAC5C,IAAIA,MAAM,CAACmvB,OAAO,EAAE;UACnBnvB,MAAM,CAACmvB,OAAO,CAACpf,cAAc,CAAC,CAAC;QAChC;QACA/P,MAAM,CAACmvB,OAAO,GAAGwD,WAAW,CAAC,CAAC,CAAC,CAAC3yB,MAAM;MACvC;IACD,CAAC,MAAM;MACN,IAAIA,MAAM,CAACmvB,OAAO,EAAE;QACnBnvB,MAAM,CAACmvB,OAAO,CAACpf,cAAc,CAAC,CAAC;QAC/B/P,MAAM,CAACmvB,OAAO,GAAG,IAAI;MACtB;IACD;IAEA,IAAInvB,MAAM,CAACmvB,OAAO,EAAE;MACnB,IAAI,CAAEnvB,MAAM,CAACmvB,OAAO,CAACniB,OAAO,EAAE;QAC7B,IAAI6M,QAAQ,GAAGtK,CAAC,CAACwgB,MAAM,CAACjY,YAAY,CAAC,QAAQ,CAAC;QAC9C,IAAIma,KAAK,GAAG1iB,CAAC,CAACwgB,MAAM,CAACjY,YAAY,CAAC,QAAQ,CAAC;QAE3C,IAAI+B,QAAQ,IAAIoY,KAAK,EAAE;UACtBjyB,MAAM,CAACmvB,OAAO,CAACxQ,yBAAyB,CAAC9E,QAAQ,EAAEoY,KAAK,CAAC;UAEzDjyB,MAAM,CAACswB,WAAW,GAAGnJ,UAAU,CAAC,YAAW;YAC1C;YACA,IAAInnB,MAAM,CAACmvB,OAAO,CAAC/tB,OAAO,CAACyB,OAAO,CAACgX,QAAQ,CAAC,CAACvZ,IAAI,IAAI,OAAO,EAAE;cAC7DN,MAAM,CAACw0B,UAAU,GAAG,IAAI;YACzB,CAAC,MAAM;cACNx0B,MAAM,CAACw0B,UAAU,GAAGjlB,CAAC,CAACwgB,MAAM;YAC7B;YACA/vB,MAAM,CAACmvB,OAAO,CAACnU,UAAU,CAACzL,CAAC,CAACwgB,MAAM,EAAE,KAAK,EAAExgB,CAAC,CAAC;UAC9C,CAAC,EAAE,GAAG,CAAC;QACR;MACD;IACD;EACD,CAAC;EAEDvP,MAAM,CAACixB,gBAAgB,GAAG,UAAS1hB,CAAC,EAAE;IACrC;IACA,IAAIvP,MAAM,CAACswB,WAAW,EAAE;MACvBgC,YAAY,CAACtyB,MAAM,CAACswB,WAAW,CAAC;MAChCtwB,MAAM,CAACswB,WAAW,GAAG,IAAI;MACzB;MACA,IAAItwB,MAAM,CAACw0B,UAAU,IAAIx0B,MAAM,CAACw0B,UAAU,CAACpd,QAAQ,CAAC,CAAC,CAAC,CAACxV,OAAO,IAAI,OAAO,EAAE;QAC1E5B,MAAM,CAACw0B,UAAU,CAACpd,QAAQ,CAAC,CAAC,CAAC,CAACkE,KAAK,CAAC,CAAC;MACtC;MACAtb,MAAM,CAACw0B,UAAU,GAAG,IAAI;IACzB;EACD,CAAC;;EAED;AACD;AACA;;EAECx0B,MAAM,CAACy0B,IAAI,GAAG,UAASA,IAAI,EAAEziB,MAAM,EAAE;IACpC,IAAI0iB,SAAS,GAAG,EAAE;IAClB;IACA,IAAI,CAAED,IAAI,CAACpnB,SAAS,CAACuG,QAAQ,CAAC,aAAa,CAAC,EAAE;MAC7C6gB,IAAI,CAACpkB,SAAS,GAAG,EAAE;MACnBokB,IAAI,CAACpnB,SAAS,CAACC,GAAG,CAAC,aAAa,CAAC;MACjCmnB,IAAI,CAACz0B,MAAM,GAAG,EAAE;MAEhB,IAAI8B,GAAG,GAAGC,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;MACvC,IAAIkK,OAAO,GAAGuoB,IAAI,CAAC3kB,WAAW,CAAChO,GAAG,CAAC;MACnC,IAAIA,GAAG,GAAGC,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;MACvC,IAAIyJ,OAAO,GAAGgpB,IAAI,CAAC3kB,WAAW,CAAChO,GAAG,CAAC;IACpC,CAAC,MAAM;MACN,IAAIoK,OAAO,GAAGuoB,IAAI,CAACrd,QAAQ,CAAC,CAAC,CAAC;MAC9B,IAAI3L,OAAO,GAAGgpB,IAAI,CAACrd,QAAQ,CAAC,CAAC,CAAC;IAC/B;IAEA,IAAIud,WAAW,GAAG,EAAE;IACpB,IAAIC,IAAI,GAAG,EAAE;IACb,KAAK,IAAIpmB,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGwD,MAAM,CAAC5D,MAAM,EAAEI,CAAC,EAAE,EAAE;MACvC;MACAmmB,WAAW,CAACnmB,CAAC,CAAC,GAAGzM,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;MAC9C2yB,WAAW,CAACnmB,CAAC,CAAC,CAACnB,SAAS,CAACC,GAAG,CAAC,YAAY,CAAC;MAC1C,IAAIunB,SAAS,GAAG70B,MAAM,CAAC20B,WAAW,CAACnmB,CAAC,CAAC,EAAEwD,MAAM,CAACxD,CAAC,CAAC,CAAC;MACjD/C,OAAO,CAACqE,WAAW,CAAC6kB,WAAW,CAACnmB,CAAC,CAAC,CAAC;MACnCkmB,SAAS,CAAClmB,CAAC,CAAC,GAAGimB,IAAI,CAACz0B,MAAM,CAAC+O,IAAI,CAAC8lB,SAAS,CAAC;;MAE1C;MACAD,IAAI,CAACpmB,CAAC,CAAC,GAAGzM,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;MACvC4yB,IAAI,CAACpmB,CAAC,CAAC,CAACnB,SAAS,CAACC,GAAG,CAAC,iBAAiB,CAAC;MACxCsnB,IAAI,CAACpmB,CAAC,CAAC,CAAC+B,YAAY,CAAC,kBAAkB,EAAEkkB,IAAI,CAACz0B,MAAM,CAACoO,MAAM,GAAC,CAAC,CAAC;MAC9DwmB,IAAI,CAACpmB,CAAC,CAAC,CAAC6B,SAAS,GAAG2B,MAAM,CAACxD,CAAC,CAAC,CAACsmB,SAAS;MACvCF,IAAI,CAACpmB,CAAC,CAAC,CAACyC,OAAO,GAAG,YAAW;QAC5B,KAAK,IAAIT,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGtE,OAAO,CAACkL,QAAQ,CAAChJ,MAAM,EAAEoC,CAAC,EAAE,EAAE;UACjDtE,OAAO,CAACkL,QAAQ,CAAC5G,CAAC,CAAC,CAACnD,SAAS,CAAClL,MAAM,CAAC,UAAU,CAAC;UAChDsJ,OAAO,CAAC2L,QAAQ,CAAC5G,CAAC,CAAC,CAACxK,KAAK,CAAC6K,OAAO,GAAG,MAAM;QAC3C;QACA,IAAIrC,CAAC,GAAG,IAAI,CAACsJ,YAAY,CAAC,kBAAkB,CAAC;QAC7CrM,OAAO,CAAC2L,QAAQ,CAAC5I,CAAC,CAAC,CAACxI,KAAK,CAAC6K,OAAO,GAAG,OAAO;QAC3C3E,OAAO,CAACkL,QAAQ,CAAC5I,CAAC,CAAC,CAACnB,SAAS,CAACC,GAAG,CAAC,UAAU,CAAC;MAC9C,CAAC;MACDpB,OAAO,CAAC4D,WAAW,CAAC8kB,IAAI,CAACpmB,CAAC,CAAC,CAAC;IAC7B;;IAEA;IACA,KAAK,IAAIgC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGtE,OAAO,CAACkL,QAAQ,CAAChJ,MAAM,EAAEoC,CAAC,EAAE,EAAE;MACjDtE,OAAO,CAACkL,QAAQ,CAAC5G,CAAC,CAAC,CAACnD,SAAS,CAAClL,MAAM,CAAC,UAAU,CAAC;MAChDsJ,OAAO,CAAC2L,QAAQ,CAAC5G,CAAC,CAAC,CAACxK,KAAK,CAAC6K,OAAO,GAAG,MAAM;IAC3C;IACA3E,OAAO,CAACkL,QAAQ,CAAClL,OAAO,CAACkL,QAAQ,CAAChJ,MAAM,GAAG,CAAC,CAAC,CAACf,SAAS,CAACC,GAAG,CAAC,UAAU,CAAC;IACvE7B,OAAO,CAAC2L,QAAQ,CAAClL,OAAO,CAACkL,QAAQ,CAAChJ,MAAM,GAAG,CAAC,CAAC,CAACpI,KAAK,CAAC6K,OAAO,GAAG,OAAO;IAErE,OAAO6jB,SAAS;EACjB,CAAC;;EAED;EACA10B,MAAM,CAAC+0B,UAAU,GAAG/0B,MAAM,CAACy0B,IAAI;EAE/Bz0B,MAAM,CAACg1B,eAAe,GAAG,UAASC,IAAI,EAAEC,UAAU,EAAE;IACnD,IAAIC,OAAO,GAAG,SAAAA,CAASC,QAAQ,EAAE;MAChC,IAAIC,YAAY,GAAG,EAAE;MACrBD,QAAQ,CAACE,UAAU,CAACxK,OAAO,CAAC,UAASgK,SAAS,EAAE;QAC/C,IAAIH,WAAW,GAAG,CAAC,CAAC;QACpBA,WAAW,CAAC/xB,IAAI,GAAG,EAAE;QACrB+xB,WAAW,CAAC9xB,OAAO,GAAG,EAAE;QACxB8xB,WAAW,CAACnyB,IAAI,GAAG,EAAE;QACrBmyB,WAAW,CAAC3uB,KAAK,GAAG,CAAC,CAAC;QACtB2uB,WAAW,CAACG,SAAS,GAAGA,SAAS;;QAEjC;QACA,IAAI1kB,IAAI,GAAGglB,QAAQ,CAACG,MAAM,CAACT,SAAS,CAAC,CAAC,OAAO,CAAC;QAC9C,IAAI1kB,IAAI,IAAIA,IAAI,CAAChC,MAAM,EAAE;UACxB,KAAK,IAAII,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG4B,IAAI,CAAChC,MAAM,EAAEI,CAAC,EAAE,EAAE;YACrCmmB,WAAW,CAAC9xB,OAAO,CAAC2L,CAAC,CAAC,GAAG,CAAC,CAAC;YAC3B,IAAI4B,IAAI,CAAC5B,CAAC,CAAC,IAAI4B,IAAI,CAAC5B,CAAC,CAAC,CAACgnB,GAAG,EAAE;cAC3Bb,WAAW,CAAC9xB,OAAO,CAAC2L,CAAC,CAAC,CAACK,KAAK,GAAGuB,IAAI,CAAC5B,CAAC,CAAC,CAACgnB,GAAG,GAAG,IAAI;YAClD;UACA;QACF;QACA;QACA,IAAIplB,IAAI,GAAGglB,QAAQ,CAACG,MAAM,CAACT,SAAS,CAAC,CAAC,OAAO,CAAC;QAC9C,IAAI1kB,IAAI,IAAIA,IAAI,CAAChC,MAAM,EAAE;UACxB,KAAK,IAAII,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG4B,IAAI,CAAChC,MAAM,EAAEI,CAAC,EAAE,EAAE;YACrC,IAAI4B,IAAI,CAAC5B,CAAC,CAAC,IAAI4B,IAAI,CAAC5B,CAAC,CAAC,CAACinB,GAAG,EAAE;cAC3Bd,WAAW,CAAC/xB,IAAI,CAAC4L,CAAC,CAAC,GAAG,CAAC,CAAC;cACxBmmB,WAAW,CAAC/xB,IAAI,CAAC4L,CAAC,CAAC,CAACmG,MAAM,GAAGvE,IAAI,CAAC5B,CAAC,CAAC,CAACinB,GAAG,GAAG,IAAI;YAChD;UACD;QACD;QACA;QACA,IAAIrlB,IAAI,GAAGglB,QAAQ,CAACG,MAAM,CAACT,SAAS,CAAC,CAAC,SAAS,CAAC;QAChD,IAAI1kB,IAAI,IAAIA,IAAI,CAAChC,MAAM,GAAG,CAAC,EAAE;UAC5BumB,WAAW,CAACxvB,UAAU,GAAG,EAAE;UAC3B,KAAK,IAAIqJ,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG4B,IAAI,CAAChC,MAAM,EAAEI,CAAC,EAAE,EAAE;YACrC,IAAIkK,EAAE,GAAGtI,IAAI,CAAC5B,CAAC,CAAC,CAACknB,CAAC,CAACrY,CAAC;YACpB,IAAI1E,EAAE,GAAGvI,IAAI,CAAC5B,CAAC,CAAC,CAACknB,CAAC,CAACrB,CAAC;YACpB,IAAIzb,EAAE,GAAGxI,IAAI,CAAC5B,CAAC,CAAC,CAACe,CAAC,CAAC8N,CAAC;YACpB,IAAIxE,EAAE,GAAGzI,IAAI,CAAC5B,CAAC,CAAC,CAACe,CAAC,CAAC8kB,CAAC;YACpB,IAAItS,GAAG,GAAG/hB,MAAM,CAACqU,mBAAmB,CAAC,CAACqE,EAAE,EAACC,EAAE,CAAC,CAAC;YAC7Cgc,WAAW,CAACxvB,UAAU,CAAC4c,GAAG,CAAC,GAAG,CAAEnJ,EAAE,GAACF,EAAE,GAAC,CAAC,EAAEG,EAAE,GAACF,EAAE,GAAC,CAAC,CAAE;UACnD;QACD;QACA;QACA,IAAIgd,KAAK,GAAG,CAAC;QACb,IAAIC,KAAK,GAAG,CAAC;QACb,IAAIxlB,IAAI,GAAG9B,MAAM,CAACD,IAAI,CAAC+mB,QAAQ,CAACG,MAAM,CAACT,SAAS,CAAC,CAAC;QAClD,KAAK,IAAItmB,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG4B,IAAI,CAAChC,MAAM,EAAEI,CAAC,EAAE,EAAE;UACrC,IAAI4B,IAAI,CAAC5B,CAAC,CAAC,CAACsG,MAAM,CAAC,CAAC,EAAC,CAAC,CAAC,IAAI,GAAG,EAAE;YAC/B,IAAIlD,IAAI,GAAGwjB,QAAQ,CAACG,MAAM,CAACT,SAAS,CAAC,CAAC1kB,IAAI,CAAC5B,CAAC,CAAC,CAAC;YAC9C,IAAIrO,IAAI,GAAGH,MAAM,CAAC6R,mBAAmB,CAACzB,IAAI,CAAC5B,CAAC,CAAC,EAAE,IAAI,CAAC;YACpD,IAAI,CAAEmmB,WAAW,CAACnyB,IAAI,CAACrC,IAAI,CAAC,CAAC,CAAC,CAAC,EAAE;cAChCw0B,WAAW,CAACnyB,IAAI,CAACrC,IAAI,CAAC,CAAC,CAAC,CAAC,GAAG,EAAE;YAC/B;YACAw0B,WAAW,CAACnyB,IAAI,CAACrC,IAAI,CAAC,CAAC,CAAC,CAAC,CAACA,IAAI,CAAC,CAAC,CAAC,CAAC,GAAGyR,IAAI,CAACgX,CAAC,GAAG,GAAG,GAAGhX,IAAI,CAACgX,CAAC,GAAGhX,IAAI,CAACsP,CAAC;YACnE,IAAIyU,KAAK,GAAGx1B,IAAI,CAAC,CAAC,CAAC,EAAE;cACpBw1B,KAAK,GAAGx1B,IAAI,CAAC,CAAC,CAAC;YAChB;YACA,IAAIy1B,KAAK,GAAGz1B,IAAI,CAAC,CAAC,CAAC,EAAE;cACpBy1B,KAAK,GAAGz1B,IAAI,CAAC,CAAC,CAAC;YAChB;YACA;YACA,IAAIyR,IAAI,CAAC5L,KAAK,IAAIsI,MAAM,CAACD,IAAI,CAACuD,IAAI,CAAC5L,KAAK,CAAC,CAACoI,MAAM,GAAG,CAAC,EAAE;cACrDumB,WAAW,CAAC3uB,KAAK,CAACoK,IAAI,CAAC5B,CAAC,CAAC,CAAC,GAAGoD,IAAI,CAAC5L,KAAK;YACxC;YACA,IAAI4L,IAAI,CAAC8jB,CAAC,IAAI9jB,IAAI,CAAC8jB,CAAC,CAACG,OAAO,EAAE;cAC7B,IAAIlB,WAAW,CAAC3uB,KAAK,CAACoK,IAAI,CAAC5B,CAAC,CAAC,CAAC,EAAE;gBAC/BmmB,WAAW,CAAC3uB,KAAK,CAACoK,IAAI,CAAC5B,CAAC,CAAC,CAAC,IAAI,GAAG;cAClC;cACAmmB,WAAW,CAAC3uB,KAAK,CAACoK,IAAI,CAAC5B,CAAC,CAAC,CAAC,IAAI,oBAAoB,GAAGoD,IAAI,CAAC8jB,CAAC,CAACG,OAAO,CAACC,GAAG;YACxE;UACD;QACD;QACA,IAAIC,UAAU,GAAGpB,WAAW,CAAC9xB,OAAO;QACpC,KAAK,IAAI2N,CAAC,GAAG,CAAC,EAAEA,CAAC,IAAIolB,KAAK,EAAEplB,CAAC,EAAE,EAAE;UAChC,KAAK,IAAIhC,CAAC,GAAG,CAAC,EAAEA,CAAC,IAAImnB,KAAK,EAAEnnB,CAAC,EAAE,EAAE;YAChC,IAAI,CAAEmmB,WAAW,CAACnyB,IAAI,CAACgO,CAAC,CAAC,EAAE;cAC1BmkB,WAAW,CAACnyB,IAAI,CAACgO,CAAC,CAAC,GAAG,EAAE;YACzB;YACA,IAAI,CAAEmkB,WAAW,CAACnyB,IAAI,CAACgO,CAAC,CAAC,CAAChC,CAAC,CAAC,EAAE;cAC7B,IAAIunB,UAAU,GAAGvnB,CAAC,EAAE;gBACnBmmB,WAAW,CAACnyB,IAAI,CAACgO,CAAC,CAAC,CAAChC,CAAC,CAAC,GAAG,EAAE;cAC5B;YACD;UACD;QACD;QACA6mB,YAAY,CAACtmB,IAAI,CAAC4lB,WAAW,CAAC;MAC/B,CAAC,CAAC;MAEF,OAAOU,YAAY;IACpB,CAAC;IAED,IAAIW,IAAI;IACRA,IAAI,GAAG,IAAIC,cAAc,CAAC,CAAC;IAC3BD,IAAI,CAACzB,IAAI,CAAC,KAAK,EAAEU,IAAI,EAAE,IAAI,CAAC;IAE5B,IAAG,OAAOiB,UAAU,KAAK,WAAW,EAAE;MACrCF,IAAI,CAACG,YAAY,GAAG,aAAa;MACjCH,IAAI,CAACpvB,MAAM,GAAG,UAAS2I,CAAC,EAAE;QACzB,IAAI6mB,WAAW,GAAGJ,IAAI,CAACK,QAAQ;QAC/B,IAAI7zB,IAAI,GAAG,IAAI0zB,UAAU,CAACE,WAAW,CAAC;QACtC,IAAIE,EAAE,GAAGC,IAAI,CAACC,IAAI,CAACh0B,IAAI,EAAE;UAAClC,IAAI,EAAC,OAAO;UAAEm2B,WAAW,EAAC,IAAI;UAAEC,UAAU,EAAC;QAAK,CAAC,CAAC;QAC5ExB,UAAU,CAACC,OAAO,CAACmB,EAAE,CAAC,CAAC;MACxB,CAAC;IACF,CAAC,MAAM;MACNN,IAAI,CAACW,gBAAgB,CAAC,gBAAgB,EAAE,gBAAgB,CAAC;MACzDX,IAAI,CAACY,kBAAkB,GAAG,YAAW;QAAE,IAAGZ,IAAI,CAACa,UAAU,IAAI,CAAC,IAAIb,IAAI,CAACc,MAAM,IAAI,GAAG,EAAE;UACrF,IAAIC,EAAE,GAAGC,yBAAyB,CAAChB,IAAI,CAACiB,YAAY,CAAC;UACrD,IAAIX,EAAE,GAAGC,IAAI,CAACC,IAAI,CAACO,EAAE,EAAE;YAACz2B,IAAI,EAAC,QAAQ;YAAEm2B,WAAW,EAAC,IAAI;YAAEC,UAAU,EAAC;UAAK,CAAC,CAAC;UAC3ExB,UAAU,CAACC,OAAO,CAACmB,EAAE,CAAC,CAAC;QACxB;MAAC,CAAC;IACH;IAEAN,IAAI,CAACkB,IAAI,CAAC,CAAC;EACZ,CAAC;;EAED;AACD;AACA;;EAECl3B,MAAM,CAACqyB,WAAW,GAAG,UAAUlpB,IAAI,EAAE;IACpC,IAAIguB,KAAK,GAAG,woIAAwoI;IACppI,OAAOhuB,IAAI,CAACmM,KAAK,CAAC6hB,KAAK,CAAC,GAAG,CAAC,GAAG,CAAC;EACjC,CAAC;;EAED;AACD;AACA;EACCn3B,MAAM,CAAC6lB,WAAW,GAAG,UAAS9kB,CAAC,EAAEq2B,GAAG,EAAEC,GAAG,EAAE;IAC1C,OAAOt2B,CAAC,CAAC+M,KAAK,CAAC,CAAC,EAAEspB,GAAG,CAAC,CAACE,MAAM,CAACD,GAAG,CAAC,CAACC,MAAM,CAACv2B,CAAC,CAAC+M,KAAK,CAACspB,GAAG,CAAC,CAAC;EACxD,CAAC;;EAED;AACD;AACA;AACA;AACA;AACA;EACCp3B,MAAM,CAACiX,aAAa,GAAG,UAASzC,YAAY,EAAE;IAC7C,OAAOxU,MAAM,CAACu3B,OAAO,CAACtgB,aAAa,CAACzC,YAAY,CAAC;EAClD,CAAC;;EAED;AACD;AACA;AACA;AACA;AACA;EACCxU,MAAM,CAAC6R,mBAAmB,GAAG,UAAUf,EAAE,EAAEumB,GAAG,EAAE;IAC/C;IACA,IAAIliB,CAAC,GAAG,YAAY,CAACgT,IAAI,CAACrX,EAAE,CAAC;IAE7B,IAAIqE,CAAC,EAAE;MACN;MACA,IAAIqiB,IAAI,GAAG,CAAC;MACZ,KAAK,IAAIhpB,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG2G,CAAC,CAAC,CAAC,CAAC,CAAC/G,MAAM,EAAEI,CAAC,EAAE,EAAE;QACrCgpB,IAAI,IAAItnB,QAAQ,CAACiF,CAAC,CAAC,CAAC,CAAC,CAAC6Z,UAAU,CAACxgB,CAAC,CAAC,GAAG,EAAE,CAAC,GAAGuN,IAAI,CAAC0b,GAAG,CAAC,EAAE,EAAGtiB,CAAC,CAAC,CAAC,CAAC,CAAC/G,MAAM,GAAG,CAAC,GAAGI,CAAE,CAAC;MAChF;MACAgpB,IAAI,EAAE;MACN;MACA,IAAIA,IAAI,GAAG,CAAC,EAAE;QACbA,IAAI,GAAG,CAAC;MACT;;MAEA;MACA,IAAIpS,MAAM,GAAGlV,QAAQ,CAAC,SAAS,CAACiY,IAAI,CAACrX,EAAE,CAAC,CAAC;MACzC,IAAIsU,MAAM,GAAG,CAAC,EAAE;QACfA,MAAM,EAAE;MACT;MAEA,IAAIiS,GAAG,IAAI,IAAI,EAAE;QAChBvmB,EAAE,GAAG,CAAE0mB,IAAI,EAAEpS,MAAM,CAAE;MACtB,CAAC,MAAM;QACNtU,EAAE,GAAG0mB,IAAI,GAAG,GAAG,GAAGpS,MAAM;MACzB;IACD;IAEA,OAAOtU,EAAE;EACV,CAAC;;EAED;AACD;AACA;AACA;AACA;AACA;EACC9Q,MAAM,CAACqU,mBAAmB,GAAG,UAAUmO,MAAM,EAAE;IAC9C,IAAI,CAAE5U,KAAK,CAACwE,OAAO,CAACoQ,MAAM,CAAC,EAAE;MAC5BA,MAAM,GAAGA,MAAM,CAACpN,KAAK,CAAC,GAAG,CAAC;IAC3B;IAEA,OAAOpV,MAAM,CAACiX,aAAa,CAAC/G,QAAQ,CAACsS,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,IAAItS,QAAQ,CAACsS,MAAM,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;EAC7E,CAAC;;EAED;AACD;AACA;AACA;AACA;AACA;EACCxiB,MAAM,CAAC4yB,UAAU,GAAG,UAAS9c,OAAO,EAAE;IACrC,IAAI4hB,aAAa,GAAG,CAAC;IACrB,IAAIC,aAAa,GAAG,CAAC;IAErB,SAASC,IAAIA,CAAE9hB,OAAO,EAAE;MACvB,IAAIA,OAAO,CAAClF,SAAS,EAAE;QACtB,IAAIkF,OAAO,CAACzI,SAAS,CAACuG,QAAQ,CAAC,kBAAkB,CAAC,EAAE;UACnD+jB,aAAa,GAAG7hB,OAAO;QACxB;MACD;MAEA,IAAIA,OAAO,CAAClU,OAAO,IAAI,OAAO,EAAE;QAC/B81B,aAAa,GAAG,CAAC;MAClB,CAAC,MAAM,IAAI5hB,OAAO,CAAClU,OAAO,IAAI,OAAO,EAAE;QACtC81B,aAAa,GAAG,CAAC;MAClB;MAEA,IAAI5hB,OAAO,CAAC7T,UAAU,EAAE;QACvB,IAAI,CAAE01B,aAAa,EAAE;UACpBC,IAAI,CAAC9hB,OAAO,CAAC7T,UAAU,CAAC;QACzB;MACD;IACD;IAEA21B,IAAI,CAAC9hB,OAAO,CAAC;IAEb,OAAO,CAAE6hB,aAAa,EAAED,aAAa,CAAE;EACxC,CAAC;EAED13B,MAAM,CAACye,iBAAiB,GAAG,UAAS5d,CAAC,EAAE;IACtCA,CAAC,GAAG,EAAE,GAACA,CAAC;IACR,IAAIA,CAAC,CAACuN,MAAM,IAAI,CAAC,EAAE;MAClBvN,CAAC,GAAG,GAAG,GAACA,CAAC;IACV;IACA,OAAOA,CAAC;EACT,CAAC;EAEDb,MAAM,CAAC6B,eAAe,GAAG,UAASP,EAAE,EAAEF,OAAO,EAAE;IAC9C,IAAIE,EAAE,CAACM,OAAO,IAAI,OAAO,EAAE;MAC1BF,OAAO,CAACoY,GAAG,CAAC,wBAAwB,CAAC;IACtC,CAAC,MAAM;MACN;MACA,IAAI,CAAE1Y,OAAO,EAAE;QACdA,OAAO,GAAG,CAAC,CAAC;MACb;MACAA,OAAO,CAACyB,OAAO,GAAG,EAAE;MACpBzB,OAAO,CAACoB,IAAI,GAAG,EAAE;;MAEjB;MACA,IAAI8J,QAAQ,GAAGhL,EAAE,CAAC2sB,gBAAgB,CAAC,gBAAgB,CAAC;MACpD,IAAI3hB,QAAQ,CAAC8B,MAAM,EAAE;QACpB;QACA,KAAK,IAAII,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGlC,QAAQ,CAAC8B,MAAM,EAAEI,CAAC,EAAE,EAAE;UACzC,IAAIK,KAAK,GAAGvC,QAAQ,CAACkC,CAAC,CAAC,CAACxI,KAAK,CAAC6I,KAAK;UACnC,IAAI,CAAEA,KAAK,EAAE;YACZ,IAAIA,KAAK,GAAGvC,QAAQ,CAACkC,CAAC,CAAC,CAACsJ,YAAY,CAAC,OAAO,CAAC;UAC9C;UACA;UACA,IAAIjJ,KAAK,EAAE;YACV,IAAI,CAAEzN,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,EAAE;cACzBpN,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,GAAG,CAAC,CAAC;YACxB;YACApN,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAACK,KAAK,GAAGA,KAAK;UACjC;QACD;MACD;;MAEA;MACA,IAAIgpB,WAAW,GAAG,SAAAA,CAAS1L,MAAM,EAAE;QAClC;QACA,IAAIhsB,IAAI,GAAGgsB,MAAM,CAAChR,qBAAqB,CAAC,CAAC;QACzC,IAAItM,KAAK,GAAG1O,IAAI,CAAC0O,KAAK,GAAG,EAAE,GAAG1O,IAAI,CAAC0O,KAAK,GAAG,EAAE;;QAE7C;QACA,IAAI,CAAEzN,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,EAAE;UACzBpN,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,GAAG,CAAC,CAAC;QACxB;QACA,IAAI2d,MAAM,CAACrU,YAAY,CAAC,eAAe,CAAC,EAAE;UACzC1W,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAAClO,IAAI,GAAG6rB,MAAM,CAACrU,YAAY,CAAC,eAAe,CAAC;QAC/D,CAAC,MAAM;UACN1W,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAAClO,IAAI,GAAG,MAAM;QACjC;QACAc,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAACK,KAAK,GAAGA,KAAK,GAAG,IAAI;QACvCzN,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAACpO,KAAK,GAAG+rB,MAAM,CAAC9b,SAAS;QAC3CjP,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAACM,KAAK,GAAGqd,MAAM,CAACnmB,KAAK,CAAC6Q,SAAS,IAAI,QAAQ;QAE7D,IAAI1W,IAAI,GAAGgsB,MAAM,CAACrU,YAAY,CAAC,MAAM,CAAC,EAAE;UACvC1W,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAACC,IAAI,GAAGtO,IAAI;QAC/B;QACA,IAAIA,IAAI,GAAGgsB,MAAM,CAACrU,YAAY,CAAC,IAAI,CAAC,EAAE;UACrC1W,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAACsC,EAAE,GAAG3Q,IAAI;QAC7B;QACA,IAAIA,IAAI,GAAGgsB,MAAM,CAACrU,YAAY,CAAC,WAAW,CAAC,EAAE;UAC5C1W,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAACvN,IAAI,GAAGd,IAAI;QAC/B;MACD,CAAC;;MAED;MACA,IAAIwsB,MAAM,GAAG,EAAE;MACf,IAAIzgB,OAAO,GAAG5K,EAAE,CAAC2sB,gBAAgB,CAAC,qBAAqB,CAAC;MACxD,IAAI/hB,OAAO,CAACkC,MAAM,EAAE;QACnB,KAAK,IAAIoC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGtE,OAAO,CAACkC,MAAM,GAAG,CAAC,EAAEoC,CAAC,EAAE,EAAE;UAC5C,IAAIsI,KAAK,GAAG,EAAE;UACd,KAAK,IAAItK,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGtC,OAAO,CAACsE,CAAC,CAAC,CAAC4G,QAAQ,CAAChJ,MAAM,EAAEI,CAAC,EAAE,EAAE;YACpD,IAAI6D,GAAG,GAAG;cACTjS,KAAK,EAAE8L,OAAO,CAACsE,CAAC,CAAC,CAAC4G,QAAQ,CAAC5I,CAAC,CAAC,CAACqH,WAAW;cACzC0B,OAAO,EAAErL,OAAO,CAACsE,CAAC,CAAC,CAAC4G,QAAQ,CAAC5I,CAAC,CAAC,CAACsJ,YAAY,CAAC,SAAS,CAAC,IAAI;YAC5D,CAAC;YACDgB,KAAK,CAAC/J,IAAI,CAACsD,GAAG,CAAC;UAChB;UACAsa,MAAM,CAAC5d,IAAI,CAAC+J,KAAK,CAAC;QACnB;QACA;QACA5M,OAAO,GAAGA,OAAO,CAACA,OAAO,CAACkC,MAAM,GAAC,CAAC,CAAC,CAACgJ,QAAQ;QAC5C;QACA,KAAK,IAAI5I,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGtC,OAAO,CAACkC,MAAM,EAAEI,CAAC,EAAE,EAAE;UACxCqpB,WAAW,CAAC3rB,OAAO,CAACsC,CAAC,CAAC,CAAC;QACxB;MACD;;MAEA;MACA,IAAIsF,SAAS,GAAG,CAAC;MACjB,IAAI3O,UAAU,GAAG,CAAC,CAAC;MACnB,IAAIvC,IAAI,GAAG,CAAC,CAAC;MACb,IAAIoD,KAAK,GAAG,CAAC,CAAC;MACd,IAAIC,OAAO,GAAG,CAAC,CAAC;MAEhB,IAAIwF,OAAO,GAAGnK,EAAE,CAAC2sB,gBAAgB,CAAC,kCAAkC,CAAC;MACrE,KAAK,IAAIzd,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG/E,OAAO,CAAC2C,MAAM,EAAEoC,CAAC,EAAE,EAAE;QACxCpP,OAAO,CAACoB,IAAI,CAACsR,SAAS,CAAC,GAAG,EAAE;QAC5B,IAAI1S,OAAO,CAAC4D,0BAA0B,IAAI,IAAI,IAAI,CAAEkH,OAAO,CAACkC,MAAM,IAAIoC,CAAC,IAAI,CAAC,EAAE;UAC7E,KAAK,IAAIhC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG/C,OAAO,CAAC+E,CAAC,CAAC,CAAC4G,QAAQ,CAAChJ,MAAM,EAAEI,CAAC,EAAE,EAAE;YACpDqpB,WAAW,CAACpsB,OAAO,CAAC+E,CAAC,CAAC,CAAC4G,QAAQ,CAAC5I,CAAC,CAAC,CAAC;UACpC;QACD,CAAC,MAAM;UACN,KAAK,IAAIA,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG/C,OAAO,CAAC+E,CAAC,CAAC,CAAC4G,QAAQ,CAAChJ,MAAM,EAAEI,CAAC,EAAE,EAAE;YACpD;YACA,IAAI5N,KAAK,GAAG6K,OAAO,CAAC+E,CAAC,CAAC,CAAC4G,QAAQ,CAAC5I,CAAC,CAAC,CAACsJ,YAAY,CAAC,cAAc,CAAC;YAC/D,IAAIlX,KAAK,EAAE;cACV,IAAIA,KAAK,CAACkU,MAAM,CAAC,CAAC,EAAC,CAAC,CAAC,IAAI,GAAG,EAAE;gBAC7BlU,KAAK,GAAG,GAAG,GAAGA,KAAK;cACpB;YACD,CAAC,MAAM;cACN,IAAIA,KAAK,GAAG6K,OAAO,CAAC+E,CAAC,CAAC,CAAC4G,QAAQ,CAAC5I,CAAC,CAAC,CAAC6B,SAAS;YAC7C;YACAjP,OAAO,CAACoB,IAAI,CAACsR,SAAS,CAAC,CAAC/E,IAAI,CAACnO,KAAK,CAAC;;YAEnC;YACA,IAAIyX,QAAQ,GAAGrY,MAAM,CAACqU,mBAAmB,CAAC,CAAE7F,CAAC,EAAEgC,CAAC,CAAE,CAAC;;YAEnD;YACA,IAAI0F,GAAG,GAAGzK,OAAO,CAAC+E,CAAC,CAAC,CAAC4G,QAAQ,CAAC5I,CAAC,CAAC,CAACsJ,YAAY,CAAC,OAAO,CAAC;YACtD,IAAI5B,GAAG,EAAE;cACRjQ,OAAO,CAACoS,QAAQ,CAAC,GAAGnC,GAAG;YACxB;;YAEA;YACA,IAAI4hB,aAAa,GAAG5nB,QAAQ,CAACzE,OAAO,CAAC+E,CAAC,CAAC,CAAC4G,QAAQ,CAAC5I,CAAC,CAAC,CAACsJ,YAAY,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC;YACjF,IAAIigB,aAAa,GAAG7nB,QAAQ,CAACzE,OAAO,CAAC+E,CAAC,CAAC,CAAC4G,QAAQ,CAAC5I,CAAC,CAAC,CAACsJ,YAAY,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC;YACjF,IAAIggB,aAAa,IAAIC,aAAa,EAAE;cACnC5yB,UAAU,CAACkT,QAAQ,CAAC,GAAG,CAAEyf,aAAa,IAAI,CAAC,EAAEC,aAAa,IAAI,CAAC,CAAE;YAClE;;YAEA;YACA,IAAIrC,CAAC,GAAGjqB,OAAO,CAAC+E,CAAC,CAAC,CAAC4G,QAAQ,CAAC5I,CAAC,CAAC,CAACxI,KAAK,IAAIyF,OAAO,CAAC+E,CAAC,CAAC,CAAC4G,QAAQ,CAAC5I,CAAC,CAAC,CAACxI,KAAK,CAAC6K,OAAO,IAAI,MAAM,EAAE;cACvFpF,OAAO,CAAC+E,CAAC,CAAC,CAAC4G,QAAQ,CAAC5I,CAAC,CAAC,CAACxI,KAAK,CAAC6K,OAAO,GAAG,EAAE;YAC1C;YACA;YACA,IAAI6kB,CAAC,GAAGjqB,OAAO,CAAC+E,CAAC,CAAC,CAAC4G,QAAQ,CAAC5I,CAAC,CAAC,CAACsJ,YAAY,CAAC,OAAO,CAAC;YACpD,IAAI4d,CAAC,EAAE;cACN1vB,KAAK,CAACqS,QAAQ,CAAC,GAAGqd,CAAC;YACpB;YACA;YACA,IAAIjqB,OAAO,CAAC+E,CAAC,CAAC,CAAC4G,QAAQ,CAAC5I,CAAC,CAAC,CAACnB,SAAS,CAACuG,QAAQ,CAAC,WAAW,CAAC,EAAE;cAC3D,IAAI5N,KAAK,CAACqS,QAAQ,CAAC,EAAE;gBACpBrS,KAAK,CAACqS,QAAQ,CAAC,IAAI,qBAAqB;cACzC,CAAC,MAAM;gBACNrS,KAAK,CAACqS,QAAQ,CAAC,GAAG,mBAAmB;cACtC;YACD;UACD;;UAEA;UACA,IAAI5M,OAAO,CAAC+E,CAAC,CAAC,CAACxK,KAAK,IAAIyF,OAAO,CAAC+E,CAAC,CAAC,CAACxK,KAAK,CAAC2O,MAAM,EAAE;YAChD/R,IAAI,CAAC4N,CAAC,CAAC,GAAG;cAAEmE,MAAM,EAAElJ,OAAO,CAAC+E,CAAC,CAAC,CAACxK,KAAK,CAAC2O;YAAO,CAAC;UAC9C;;UAEA;UACAb,SAAS,EAAE;QACZ;MACD;;MAEA;MACA,IAAIxF,MAAM,CAACD,IAAI,CAACse,MAAM,CAAC,CAACve,MAAM,GAAG,CAAC,EAAE;QACnChN,OAAO,CAAC6B,aAAa,GAAG0pB,MAAM;MAC/B;MACA;MACA,IAAIre,MAAM,CAACD,IAAI,CAACrI,KAAK,CAAC,CAACoI,MAAM,GAAG,CAAC,EAAE;QAClChN,OAAO,CAAC4E,KAAK,GAAGA,KAAK;MACtB;MACA;MACA,IAAIsI,MAAM,CAACD,IAAI,CAAClJ,UAAU,CAAC,CAACiJ,MAAM,GAAG,CAAC,EAAE;QACvChN,OAAO,CAAC+D,UAAU,GAAGA,UAAU;MAChC;MACA;MACA,IAAImJ,MAAM,CAACD,IAAI,CAACzL,IAAI,CAAC,CAACwL,MAAM,GAAG,CAAC,EAAE;QACjChN,OAAO,CAACwB,IAAI,GAAGA,IAAI;MACpB;MACA;MACA,IAAI0L,MAAM,CAACD,IAAI,CAACpI,OAAO,CAAC,CAACmI,MAAM,GAAG,CAAC,EAAE;QACpChN,OAAO,CAAC6E,OAAO,GAAGA,OAAO;MAC1B;MAEA,IAAIwF,OAAO,GAAGnK,EAAE,CAAC2sB,gBAAgB,CAAC,UAAU,CAAC;MAC7C,IAAIxiB,OAAO,CAAC2C,MAAM,EAAE;QACnB,IAAI3H,OAAO,GAAG,EAAE;QAChB,KAAK,IAAI+J,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG/E,OAAO,CAAC2C,MAAM,EAAEoC,CAAC,EAAE,EAAE;UACxC,IAAIwnB,MAAM,GAAG,EAAE;UACf,KAAK,IAAIxpB,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG/C,OAAO,CAAC+E,CAAC,CAAC,CAAC4G,QAAQ,CAAChJ,MAAM,EAAEI,CAAC,EAAE,EAAE;YACpDwpB,MAAM,CAACjpB,IAAI,CAACtD,OAAO,CAAC+E,CAAC,CAAC,CAAC4G,QAAQ,CAAC5I,CAAC,CAAC,CAACqH,WAAW,CAAC;UAChD;UACApP,OAAO,CAACsI,IAAI,CAACipB,MAAM,CAAC;QACrB;QACA,IAAI1pB,MAAM,CAACD,IAAI,CAAC5H,OAAO,CAAC,CAAC2H,MAAM,GAAG,CAAC,EAAE;UACpChN,OAAO,CAACqF,OAAO,GAAGA,OAAO;QAC1B;MACD;MACA;;MAEA;MACA,IAAIrF,OAAO,CAAC6D,sBAAsB,IAAI,IAAI,EAAE;QAC3C,IAAIgzB,OAAO,GAAG,EAAE;QAChB,KAAK,IAAIzpB,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGpN,OAAO,CAACyB,OAAO,CAACuL,MAAM,EAAEI,CAAC,EAAE,EAAE;UAChD,IAAIgK,IAAI,GAAG,IAAI;UACf,IAAI0f,YAAY,GAAG,IAAI;UACvBD,OAAO,CAACzpB,CAAC,CAAC,GAAG,EAAE;UACf,KAAK,IAAIgC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGpP,OAAO,CAACoB,IAAI,CAAC4L,MAAM,EAAEoC,CAAC,EAAE,EAAE;YAC7C,IAAI5P,KAAK,GAAGQ,OAAO,CAACoB,IAAI,CAACgO,CAAC,CAAC,CAAChC,CAAC,CAAC;YAC9B,IAAI,CAAEypB,OAAO,CAACzpB,CAAC,CAAC,CAAC5N,KAAK,CAAC,EAAE;cACxBq3B,OAAO,CAACzpB,CAAC,CAAC,CAAC5N,KAAK,CAAC,GAAG,CAAC;YACtB;YACAq3B,OAAO,CAACzpB,CAAC,CAAC,CAAC5N,KAAK,CAAC,EAAE;YACnB,IAAIA,KAAK,CAACwN,MAAM,GAAG,EAAE,EAAE;cACtBoK,IAAI,GAAG,KAAK;YACb;YACA,IAAI5X,KAAK,CAACwN,MAAM,IAAI,EAAE,EAAE;cACvB,IAAI,EAAGxN,KAAK,CAACkU,MAAM,CAAC,CAAC,EAAC,CAAC,CAAC,IAAI,GAAG,IAAIlU,KAAK,CAACkU,MAAM,CAAC,CAAC,EAAC,CAAC,CAAC,IAAI,GAAG,CAAC,EAAE;gBAC7DojB,YAAY,GAAG,KAAK;cACrB;YACD,CAAC,MAAM;cACNA,YAAY,GAAG,KAAK;YACrB;UACD;UAEA,IAAI7pB,IAAI,GAAGC,MAAM,CAACD,IAAI,CAAC4pB,OAAO,CAACzpB,CAAC,CAAC,CAAC,CAACJ,MAAM;UACzC,IAAI8pB,YAAY,EAAE;YACjB92B,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAAClO,IAAI,GAAG,UAAU;UACrC,CAAC,MAAM,IAAIkY,IAAI,IAAI,IAAI,IAAInK,IAAI,GAAG,CAAC,IAAIA,IAAI,IAAI6B,QAAQ,CAAC9O,OAAO,CAACoB,IAAI,CAAC4L,MAAM,GAAG,GAAG,CAAC,EAAE;YACnFhN,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAAClO,IAAI,GAAG,UAAU;YACpCc,OAAO,CAACyB,OAAO,CAAC2L,CAAC,CAAC,CAACE,MAAM,GAAGJ,MAAM,CAACD,IAAI,CAAC4pB,OAAO,CAACzpB,CAAC,CAAC,CAAC;UACpD;QACD;MACD;MAEA,OAAOpN,OAAO;IACf;EACD,CAAC;;EAED;EACApB,MAAM,CAACu3B,OAAO,GAAI,YAAW;IAC5B,IAAIY,SAAS,GAAG,CAAC,CAAC;;IAElB;AACF;AACA;IACEA,SAAS,CAACC,aAAa,GAAG,UAAS7oB,CAAC,EAAE;MACrC,IAAI,IAAI,CAAC8oB,MAAM,CAAC11B,IAAI,EAAE;QACrB,IAAIib,CAAC,GAAG,IAAI,CAACya,MAAM,CAAC11B,IAAI;MACzB,CAAC,MAAM;QACN,IAAIib,CAAC,GAAG3d,MAAM;MACf;MACA,IAAIq4B,GAAG,GAAG,CAAC;MACX,IAAI5C,CAAC,GAAG9X,CAAC,CAAC2a,YAAY,CAAC,CAAC;MACxB,IAAI7C,CAAC,EAAE;QACN,IAAIA,CAAC,CAAC8C,UAAU,KAAK,CAAC,EAAE;UACvB,IAAInE,CAAC,GAAGqB,CAAC,CAAC+C,UAAU,CAAC,CAAC,CAAC;UACvB,IAAIC,CAAC,GAAGrE,CAAC,CAACsE,UAAU,CAAC,CAAC;UACtBD,CAAC,CAACE,kBAAkB,CAACrpB,CAAC,CAAC;UACvBmpB,CAAC,CAACG,MAAM,CAACxE,CAAC,CAACyE,YAAY,EAAEzE,CAAC,CAAC0E,SAAS,CAAC;UACrCT,GAAG,GAAGI,CAAC,CAACpL,QAAQ,CAAC,CAAC,CAAClf,MAAM;QAC1B;MACD;MACA,OAAOkqB,GAAG;IACX,CAAC;;IAED;AACF;AACA;IACEH,SAAS,CAACa,MAAM,GAAG,UAASj4B,CAAC,EAAE;MAC9B,IAAI6c,CAAC,GAAG,EAAE;MACV,IAAIjM,CAAC,GAAGrD,MAAM,CAACD,IAAI,CAACtN,CAAC,CAAC;MACtB,KAAK,IAAIyN,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGmD,CAAC,CAACvD,MAAM,EAAEI,CAAC,EAAE,EAAE;QAClCoP,CAAC,CAAC7c,CAAC,CAAC4Q,CAAC,CAACnD,CAAC,CAAC,CAAC,CAAC,GAAGmD,CAAC,CAACnD,CAAC,CAAC;MAClB;MACA,OAAOoP,CAAC;IACT,CAAC;;IAED;AACF;AACA;AACA;AACA;AACA;IACEua,SAAS,CAAClhB,aAAa,GAAG,UAASzC,YAAY,EAAE;MAChD,IAAIykB,QAAQ,GAAGzkB,YAAY,GAAC,CAAC;MAC7B,IAAIhL,UAAU,GAAG,EAAE;MACnB,IAAI0vB,MAAM;MACV,OAAOD,QAAQ,GAAG,CAAC,EAAE;QACpBC,MAAM,GAAG,CAACD,QAAQ,GAAG,CAAC,IAAI,EAAE;QAC5BzvB,UAAU,GAAG2oB,MAAM,CAACC,YAAY,CAAC,EAAE,GAAG8G,MAAM,CAAC,CAAC5L,QAAQ,CAAC,CAAC,GAAG9jB,UAAU;QACrEyvB,QAAQ,GAAG/oB,QAAQ,CAAC,CAAC+oB,QAAQ,GAAGC,MAAM,IAAI,EAAE,CAAC;MAC9C;MACA,OAAQ1vB,UAAU;IACnB,CAAC;;IAED;AACF;AACA;IACE2uB,SAAS,CAACgB,uBAAuB,GAAG,UAASzlB,CAAC,EAAEC,CAAC,EAAE;MAClD,OAAOwkB,SAAS,CAAClhB,aAAa,CAAC/G,QAAQ,CAACwD,CAAC,CAAC,CAAC,IAAIxD,QAAQ,CAACyD,CAAC,CAAC,GAAG,CAAC,CAAC;IAChE,CAAC;IAEDwkB,SAAS,CAACiB,uBAAuB,GAAG,UAAS5vB,UAAU,EAAE;MACxD;MACA,IAAI2L,CAAC,GAAG,YAAY,CAACgT,IAAI,CAAC3e,UAAU,CAAC;MAErC,IAAI2L,CAAC,EAAE;QACN;QACA,IAAIqiB,IAAI,GAAG,CAAC;QACZ,KAAK,IAAIhpB,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG2G,CAAC,CAAC,CAAC,CAAC,CAAC/G,MAAM,EAAEI,CAAC,EAAE,EAAE;UACrCgpB,IAAI,IAAItnB,QAAQ,CAACiF,CAAC,CAAC,CAAC,CAAC,CAAC6Z,UAAU,CAACxgB,CAAC,CAAC,GAAG,EAAE,CAAC,GAAGuN,IAAI,CAAC0b,GAAG,CAAC,EAAE,EAAGtiB,CAAC,CAAC,CAAC,CAAC,CAAC/G,MAAM,GAAG,CAAC,GAAGI,CAAE,CAAC;QAChF;QACAgpB,IAAI,EAAE;QACN;QACA,IAAIA,IAAI,GAAG,CAAC,EAAE;UACbA,IAAI,GAAG,CAAC;QACT;;QAEA;QACA,IAAIpS,MAAM,GAAGlV,QAAQ,CAAC,SAAS,CAACiY,IAAI,CAAC3e,UAAU,CAAC,CAAC,IAAI,IAAI;QACzD,IAAI4b,MAAM,GAAG,CAAC,EAAE;UACfA,MAAM,EAAE;QACT;QAEA,OAAO,CAAEoS,IAAI,EAAEpS,MAAM,CAAE;MACxB;IACD,CAAC;;IAED;AACF;AACA;IACE+S,SAAS,CAACt2B,eAAe,GAAG,YAAW,CAAC,CAAC;;IAEzC;AACF;AACA;IACEs2B,SAAS,CAACtS,WAAW,GAAG,UAAS9kB,CAAC,EAAEq2B,GAAG,EAAEC,GAAG,EAAE;MAC7C,OAAOt2B,CAAC,CAAC+M,KAAK,CAAC,CAAC,EAAEspB,GAAG,CAAC,CAACE,MAAM,CAACD,GAAG,CAAC,CAACC,MAAM,CAACv2B,CAAC,CAAC+M,KAAK,CAACspB,GAAG,CAAC,CAAC;IACxD,CAAC;;IAED;AACF;AACA;IACEe,SAAS,CAAC5K,QAAQ,GAAG,UAASV,GAAG,EAAEZ,SAAS,EAAE;MAC7C;MACAA,SAAS,GAAIA,SAAS,IAAI,GAAI;;MAE9B;MACA,IAAIxO,GAAG,GAAG,CAAC;MACX,IAAIpL,GAAG,GAAG,CAAC;MACX,IAAIc,GAAG,GAAG,CAAC;MACX,IAAI3Q,IAAI,GAAG,CAAC,EAAE,CAAC;MACf,IAAI62B,KAAK,GAAG,CAAC;MACb,IAAIC,IAAI,GAAG,IAAI;MACf,IAAIlR,MAAM,GAAG,KAAK;MAClB,IAAImR,MAAM,GAAG,KAAK;;MAElB;MACA,KAAK,IAAI/qB,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGqe,GAAG,CAACze,MAAM,EAAEI,CAAC,EAAE,EAAE;QACpC;QACA,IAAI,CAAEhM,IAAI,CAAC6P,GAAG,CAAC,EAAE;UAChB7P,IAAI,CAAC6P,GAAG,CAAC,GAAG,EAAE;QACf;QACA;QACA,IAAI,CAAE7P,IAAI,CAAC6P,GAAG,CAAC,CAACoL,GAAG,CAAC,EAAE;UACrBjb,IAAI,CAAC6P,GAAG,CAAC,CAACoL,GAAG,CAAC,GAAG,EAAE;QACpB;;QAEA;QACA,IAAIoP,GAAG,CAACre,CAAC,CAAC,IAAI,IAAI,EAAE;UACnB;QACD;;QAEA;QACA,IAAI,CAACqe,GAAG,CAACre,CAAC,CAAC,IAAI,IAAI,IAAIqe,GAAG,CAACre,CAAC,CAAC,IAAIyd,SAAS,MAAM7D,MAAM,IAAI,KAAK,IAAImR,MAAM,IAAI,IAAI,IAAI,CAAED,IAAI,CAAC,EAAE;UAC7F;UACAA,IAAI,GAAG,IAAI;UACXlR,MAAM,GAAG,KAAK;UACdmR,MAAM,GAAG,KAAK;UAEd,IAAI/2B,IAAI,CAAC6P,GAAG,CAAC,CAACoL,GAAG,CAAC,CAAC,CAAC,CAAC,IAAI,GAAG,EAAE;YAC7B,IAAI9H,GAAG,GAAGnT,IAAI,CAAC6P,GAAG,CAAC,CAACoL,GAAG,CAAC,CAACkF,IAAI,CAAC,CAAC;YAC/B,IAAIhN,GAAG,CAACA,GAAG,CAACvH,MAAM,GAAC,CAAC,CAAC,IAAI,GAAG,EAAE;cAC7B5L,IAAI,CAAC6P,GAAG,CAAC,CAACoL,GAAG,CAAC,GAAG9H,GAAG,CAACb,MAAM,CAAC,CAAC,EAAEa,GAAG,CAACvH,MAAM,GAAC,CAAC,CAAC;YAC7C;UACD;;UAEA;UACA,IAAIye,GAAG,CAACre,CAAC,CAAC,IAAI,IAAI,EAAE;YACnB;YACAiP,GAAG,GAAG,CAAC;YACPpL,GAAG,EAAE;UACN,CAAC,MAAM;YACN;YACAoL,GAAG,EAAE;YACL,IAAIA,GAAG,GAAG4b,KAAK,EAAE;cAChB;cACAA,KAAK,GAAG5b,GAAG;YACZ;UACD;QACD,CAAC,MAAM;UACN;UACA,IAAIoP,GAAG,CAACre,CAAC,CAAC,IAAI,GAAG,EAAE;YAClB4Z,MAAM,GAAG,CAAEA,MAAM;UAClB;UAEA,IAAIkR,IAAI,KAAK,IAAI,EAAE;YAClBA,IAAI,GAAGlR,MAAM;YACb,IAAIkR,IAAI,IAAI,IAAI,EAAE;cACjB;YACD;UACD,CAAC,MAAM,IAAIA,IAAI,KAAK,IAAI,IAAI,CAAEC,MAAM,EAAE;YACrC,IAAI1M,GAAG,CAACre,CAAC,CAAC,IAAI,GAAG,EAAE;cAClB,IAAIqe,GAAG,CAACre,CAAC,GAAC,CAAC,CAAC,IAAI,GAAG,EAAE;gBACpB4Z,MAAM,GAAG,IAAI;gBACb5lB,IAAI,CAAC6P,GAAG,CAAC,CAACoL,GAAG,CAAC,IAAIoP,GAAG,CAACre,CAAC,CAAC;gBACxBA,CAAC,EAAE;cACJ,CAAC,MAAM;gBACN+qB,MAAM,GAAG,IAAI;cACd;cACA;YACD;UACD;UAEA/2B,IAAI,CAAC6P,GAAG,CAAC,CAACoL,GAAG,CAAC,IAAIoP,GAAG,CAACre,CAAC,CAAC;QACzB;MACD;;MAEA;MACA,KAAK,IAAIgC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGhO,IAAI,CAAC4L,MAAM,EAAEoC,CAAC,EAAE,EAAE;QACrC,KAAK,IAAIhC,CAAC,GAAG,CAAC,EAAEA,CAAC,IAAI6qB,KAAK,EAAE7qB,CAAC,EAAE,EAAE;UAChC,IAAIhM,IAAI,CAACgO,CAAC,CAAC,CAAChC,CAAC,CAAC,KAAKoE,SAAS,EAAE;YAC7BpQ,IAAI,CAACgO,CAAC,CAAC,CAAChC,CAAC,CAAC,GAAG,EAAE;UAChB;QACD;MACD;MAEA,OAAOhM,IAAI;IACZ,CAAC;IAED,OAAO21B,SAAS;EACjB,CAAC,CAAE,CAAC;;EAEJ;AACD;AACA;EACC,IAAI,OAAOqB,MAAO,IAAI,WAAW,EAAE;IAClC,CAAC,UAASlY,CAAC,EAAC;MACXA,CAAC,CAACmY,EAAE,CAAC15B,YAAY,GAAGuhB,CAAC,CAACmY,EAAE,CAACz5B,MAAM,GAAG,UAAS0kB,KAAK,EAAE;QACjD,IAAIgV,oBAAoB,GAAGpY,CAAC,CAAC,IAAI,CAAC,CAACyI,GAAG,CAAC,CAAC,CAAC;QACzC,IAAI,CAAE2P,oBAAoB,CAAC15B,MAAM,EAAE;UAClC,OAAOA,MAAM,CAACshB,CAAC,CAAC,IAAI,CAAC,CAACyI,GAAG,CAAC,CAAC,CAAC,EAAEpc,SAAS,CAAC,CAAC,CAAC,CAAC;QAC5C,CAAC,MAAM;UACN,IAAIC,KAAK,CAACwE,OAAO,CAACsnB,oBAAoB,CAAC15B,MAAM,CAAC,EAAE;YAC/C,OAAO05B,oBAAoB,CAAC15B,MAAM,CAAC0kB,KAAK,CAAC,CAAC/W,SAAS,CAAC,CAAC,CAAC,CAAC,CAACD,KAAK,CAAC,IAAI,EAAEE,KAAK,CAACC,SAAS,CAACC,KAAK,CAACC,IAAI,CAAEJ,SAAS,EAAE,CAAE,CAAC,CAAC;UAChH,CAAC,MAAM;YACN,OAAO+rB,oBAAoB,CAAC15B,MAAM,CAAC0kB,KAAK,CAAC,CAAChX,KAAK,CAAC,IAAI,EAAEE,KAAK,CAACC,SAAS,CAACC,KAAK,CAACC,IAAI,CAAEJ,SAAS,EAAE,CAAE,CAAC,CAAC;UAClG;QACD;MACD,CAAC;IAEF,CAAC,EAAE6rB,MAAM,CAAC;EACX;EAEA,OAAOx5B,MAAM;AACd,CAAE,CAAC,C","sources":["webpack://@tablepress/tablepress/./admin/js/jspreadsheet.js"],"sourcesContent":["/**\r\n * Jspreadsheet v4.2.1\r\n *\r\n * Website: https://bossanova.uk/jspreadsheet/\r\n * Description: Create amazing web based spreadsheets.\r\n *\r\n * This software is distributed under MIT License\r\n */\r\n\r\n// TablePress: var formula = ... removed.\r\n\r\n;(function (global, factory) {\r\n\t// TablePress: Comment out next to lines to force creation of a global jspreadsheet object.\r\n\t// typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\r\n\t// typeof define === 'function' && define.amd ? define(factory) :\r\n\tglobal.jspreadsheet = global.jexcel = factory();\r\n}(window, (function () { // TablePress: Use `window` instead of `this` to get a global jspreadsheet object.\r\n\r\n\t'use strict';\r\n\r\n\t// Basic version information\r\n\tvar Version = function() {\r\n\t\t// Information\r\n\t\tvar info = {\r\n\t\t\ttitle: 'Jspreadsheet',\r\n\t\t\tversion: '4.2.1',\r\n\t\t\ttype: 'CE',\r\n\t\t\thost: 'https://bossanova.uk/jspreadsheet',\r\n\t\t\tlicense: 'MIT',\r\n\t\t\tprint: function() {\r\n\t\t\t\treturn [ this.title + ' ' + this.type + ' ' + this.version, this.host, this.license ].join('\\r\\n');\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn function() {\r\n\t\t\treturn info;\r\n\t\t};\r\n\t}();\r\n\r\n\t/**\r\n\t * The value is a formula\r\n\t */\r\n\tvar isFormula = function(value) {\r\n\t\tvar v = (''+value)[0];\r\n\t\treturn v == '=' || v == '#' ? true : false;\r\n\t}\r\n\r\n\t/**\r\n\t * Get the mask in the jSuites.mask format\r\n\t */\r\n\tvar getMask = function(o) {\r\n\t\tif (o.format || o.mask || o.locale) {\r\n\t\t\tvar opt = {};\r\n\t\t\tif (o.mask) {\r\n\t\t\t\topt.mask = o.mask;\r\n\t\t\t} else if (o.format) {\r\n\t\t\t\topt.mask = o.format;\r\n\t\t\t} else {\r\n\t\t\t\topt.locale = o.locale;\r\n\t\t\t\topt.options = o.options;\r\n\t\t\t}\r\n\r\n\t\t\tif (o.decimal) {\r\n\t\t\t\tif (! opt.options) {\r\n\t\t\t\t\topt.options = {};\r\n\t\t\t\t}\r\n\t\t\t\topt.options = { decimal: o.decimal };\r\n\t\t\t}\r\n\t\t\treturn opt;\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\t}\r\n\r\n\t// Jspreadsheet core object\r\n\tvar jexcel = (function(el, options) {\r\n\t\t// Create jspreadsheet object\r\n\t\tvar obj = {};\r\n\t\tobj.options = {};\r\n\r\n\t\tif (! (el instanceof Element || el instanceof HTMLDocument)) {\r\n\t\t\tconsole.error('Jspreadsheet: el is not a valid DOM element');\r\n\t\t\treturn false;\r\n\t\t} else if (el.tagName == 'TABLE') {\r\n\t\t\tif (options = jexcel.createFromTable(el, options)) {\r\n\t\t\t\tvar div = document.createElement('div');\r\n\t\t\t\tel.parentNode.insertBefore(div, el);\r\n\t\t\t\tel.remove();\r\n\t\t\t\tel = div;\r\n\t\t\t} else {\r\n\t\t\t\tconsole.error('Jspreadsheet: el is not a valid DOM element');\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Loading default configuration\r\n\t\tvar defaults = {\r\n\t\t\t// External data\r\n\t\t\turl:null,\r\n\t\t\t// Ajax options\r\n\t\t\tmethod: 'GET',\r\n\t\t\trequestVariables: null,\r\n\t\t\t// Data\r\n\t\t\tdata:null,\r\n\t\t\t// Custom sorting handler\r\n\t\t\tsorting:null,\r\n\t\t\t// Copy behavior\r\n\t\t\tcopyCompatibility:false,\r\n\t\t\troot:null,\r\n\t\t\t// Rows and columns definitions\r\n\t\t\trows:[],\r\n\t\t\tcolumns:[],\r\n\t\t\t// Deprected legacy options\r\n\t\t\tcolHeaders:[],\r\n\t\t\tcolWidths:[],\r\n\t\t\tcolAlignments:[],\r\n\t\t\tnestedHeaders:null,\r\n\t\t\t// Column width that is used by default\r\n\t\t\tdefaultColWidth:50,\r\n\t\t\tdefaultColAlign:'center',\r\n\t\t\t// Rows height default\r\n\t\t\tdefaultRowHeight: null,\r\n\t\t\t// Spare rows and columns\r\n\t\t\tminSpareRows:0,\r\n\t\t\tminSpareCols:0,\r\n\t\t\t// Minimal table dimensions\r\n\t\t\tminDimensions:[0,0],\r\n\t\t\t// Allow Export\r\n\t\t\tallowExport:true,\r\n\t\t\t// @type {boolean} - Include the header titles on download\r\n\t\t\tincludeHeadersOnDownload:false,\r\n\t\t\t// @type {boolean} - Include the header titles on copy\r\n\t\t\tincludeHeadersOnCopy:false,\r\n\t\t\t// Allow column sorting\r\n\t\t\tcolumnSorting:true,\r\n\t\t\t// Allow column dragging\r\n\t\t\tcolumnDrag:false,\r\n\t\t\t// Allow column resizing\r\n\t\t\tcolumnResize:true,\r\n\t\t\t// Allow row resizing\r\n\t\t\trowResize:false,\r\n\t\t\t// Allow row dragging\r\n\t\t\trowDrag:true,\r\n\t\t\t// Allow table edition\r\n\t\t\teditable:true,\r\n\t\t\t// Allow new rows\r\n\t\t\tallowInsertRow:true,\r\n\t\t\t// Allow new rows\r\n\t\t\tallowManualInsertRow:true,\r\n\t\t\t// Allow new columns\r\n\t\t\tallowInsertColumn:true,\r\n\t\t\t// Allow new rows\r\n\t\t\tallowManualInsertColumn:true,\r\n\t\t\t// Allow row delete\r\n\t\t\tallowDeleteRow:true,\r\n\t\t\t// Allow deleting of all rows\r\n\t\t\tallowDeletingAllRows:false,\r\n\t\t\t// Allow column delete\r\n\t\t\tallowDeleteColumn:true,\r\n\t\t\t// Allow rename column\r\n\t\t\tallowRenameColumn:true,\r\n\t\t\t// Allow comments\r\n\t\t\tallowComments:false,\r\n\t\t\t// Global wrap\r\n\t\t\twordWrap:false,\r\n\t\t\t// Image options\r\n\t\t\timageOptions: null,\r\n\t\t\t// CSV source\r\n\t\t\tcsv:null,\r\n\t\t\t// Filename\r\n\t\t\tcsvFileName:'jspreadsheet',\r\n\t\t\t// Consider first line as header\r\n\t\t\tcsvHeaders:true,\r\n\t\t\t// Delimiters\r\n\t\t\tcsvDelimiter:',',\r\n\t\t\t// First row as header\r\n\t\t\tparseTableFirstRowAsHeader:false,\r\n\t\t\tparseTableAutoCellType:false,\r\n\t\t\t// Disable corner selection\r\n\t\t\tselectionCopy:true,\r\n\t\t\t// Merged cells\r\n\t\t\tmergeCells:{},\r\n\t\t\t// Create toolbar\r\n\t\t\ttoolbar:null,\r\n\t\t\t// Allow search\r\n\t\t\tsearch:false,\r\n\t\t\t// Create pagination\r\n\t\t\tpagination:false,\r\n\t\t\tpaginationOptions:null,\r\n\t\t\t// Full screen\r\n\t\t\tfullscreen:false,\r\n\t\t\t// Lazy loading\r\n\t\t\tlazyLoading:false,\r\n\t\t\tloadingSpin:false,\r\n\t\t\t// Table overflow\r\n\t\t\ttableOverflow:false,\r\n\t\t\ttableHeight:'300px',\r\n\t\t\ttableWidth:null,\r\n\t\t\ttextOverflow:false,\r\n\t\t\t// Meta\r\n\t\t\tmeta: null,\r\n\t\t\t// Style\r\n\t\t\tstyle:null,\r\n\t\t\tclasses:null,\r\n\t\t\t// Execute formulas\r\n\t\t\tparseFormulas:true,\r\n\t\t\tautoIncrement:true,\r\n\t\t\tautoCasting:true,\r\n\t\t\t// Security\r\n\t\t\tsecureFormulas:true,\r\n\t\t\tstripHTML:true,\r\n\t\t\tstripHTMLOnCopy:false,\r\n\t\t\t// Filters\r\n\t\t\tfilters:false,\r\n\t\t\tfooters:null,\r\n\t\t\t// Event handles\r\n\t\t\tonundo:null,\r\n\t\t\tonredo:null,\r\n\t\t\tonload:null,\r\n\t\t\tonchange:null,\r\n\t\t\toncomments:null,\r\n\t\t\tonbeforechange:null,\r\n\t\t\tonafterchanges:null,\r\n\t\t\tonbeforeinsertrow: null,\r\n\t\t\toninsertrow:null,\r\n\t\t\tonbeforeinsertcolumn: null,\r\n\t\t\toninsertcolumn:null,\r\n\t\t\tonbeforedeleterow:null,\r\n\t\t\tondeleterow:null,\r\n\t\t\tonbeforedeletecolumn:null,\r\n\t\t\tondeletecolumn:null,\r\n\t\t\tonmoverow:null,\r\n\t\t\tonmovecolumn:null,\r\n\t\t\tonresizerow:null,\r\n\t\t\tonresizecolumn:null,\r\n\t\t\tonsort:null,\r\n\t\t\tonselection:null,\r\n\t\t\toncopy:null,\r\n\t\t\tonpaste:null,\r\n\t\t\tonbeforepaste:null,\r\n\t\t\tonmerge:null,\r\n\t\t\tonfocus:null,\r\n\t\t\tonblur:null,\r\n\t\t\tonchangeheader:null,\r\n\t\t\toncreateeditor:null,\r\n\t\t\toneditionstart:null,\r\n\t\t\toneditionend:null,\r\n\t\t\tonchangestyle:null,\r\n\t\t\tonchangemeta:null,\r\n\t\t\tonchangepage:null,\r\n\t\t\tonbeforesave:null,\r\n\t\t\tonsave:null,\r\n\t\t\t// Global event dispatcher\r\n\t\t\tonevent:null,\r\n\t\t\t// Persistance\r\n\t\t\tpersistance:false,\r\n\t\t\t// Customize any cell behavior\r\n\t\t\tupdateTable:null,\r\n\t\t\t// Detach the HTML table when calling updateTable\r\n\t\t\tdetachForUpdates: false,\r\n\t\t\tfreezeColumns:null,\r\n\t\t\t// Texts\r\n\t\t\ttext:{\r\n\t\t\t\tnoRecordsFound: 'No records found',\r\n\t\t\t\tshowingPage: 'Showing page {0} of {1} entries',\r\n\t\t\t\tshow: 'Show ',\r\n\t\t\t\tsearch: 'Search',\r\n\t\t\t\tentries: ' entries',\r\n\t\t\t\tcolumnName: 'Column name',\r\n\t\t\t\tinsertANewColumnBefore: 'Insert a new column before',\r\n\t\t\t\tinsertANewColumnAfter: 'Insert a new column after',\r\n\t\t\t\tdeleteSelectedColumns: 'Delete selected columns',\r\n\t\t\t\trenameThisColumn: 'Rename this column',\r\n\t\t\t\torderAscending: 'Order ascending',\r\n\t\t\t\torderDescending: 'Order descending',\r\n\t\t\t\tinsertANewRowBefore: 'Insert a new row before',\r\n\t\t\t\tinsertANewRowAfter: 'Insert a new row after',\r\n\t\t\t\tdeleteSelectedRows: 'Delete selected rows',\r\n\t\t\t\teditComments: 'Edit comments',\r\n\t\t\t\taddComments: 'Add comments',\r\n\t\t\t\tcomments: 'Comments',\r\n\t\t\t\tclearComments: 'Clear comments',\r\n\t\t\t\tcopy: 'Copy...',\r\n\t\t\t\tpaste: 'Paste...',\r\n\t\t\t\tsaveAs: 'Save as...',\r\n\t\t\t\tabout: 'About',\r\n\t\t\t\tareYouSureToDeleteTheSelectedRows: 'Are you sure to delete the selected rows?',\r\n\t\t\t\tareYouSureToDeleteTheSelectedColumns: 'Are you sure to delete the selected columns?',\r\n\t\t\t\tthisActionWillDestroyAnyExistingMergedCellsAreYouSure: 'This action will destroy any existing merged cells. Are you sure?',\r\n\t\t\t\tthisActionWillClearYourSearchResultsAreYouSure: 'This action will clear your search results. Are you sure?',\r\n\t\t\t\tthereIsAConflictWithAnotherMergedCell: 'There is a conflict with another merged cell',\r\n\t\t\t\tinvalidMergeProperties: 'Invalid merged properties',\r\n\t\t\t\tcellAlreadyMerged: 'Cell already merged',\r\n\t\t\t\tnoCellsSelected: 'No cells selected',\r\n\t\t\t},\r\n\t\t\t// About message\r\n\t\t\tabout: true,\r\n\t\t};\r\n\r\n\t\t// Loading initial configuration from user\r\n\t\tfor (var property in defaults) {\r\n\t\t\tif (options && options.hasOwnProperty(property)) {\r\n\t\t\t\tif (property === 'text') {\r\n\t\t\t\t\tobj.options[property] = defaults[property];\r\n\t\t\t\t\tfor (var textKey in options[property]) {\r\n\t\t\t\t\t\tif (options[property].hasOwnProperty(textKey)){\r\n\t\t\t\t\t\t\tobj.options[property][textKey] = options[property][textKey];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tobj.options[property] = options[property];\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tobj.options[property] = defaults[property];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Global elements\r\n\t\tobj.el = el;\r\n\t\tobj.corner = null;\r\n\t\tobj.contextMenu = null;\r\n\t\tobj.textarea = null;\r\n\t\tobj.ads = null;\r\n\t\tobj.content = null;\r\n\t\tobj.table = null;\r\n\t\tobj.thead = null;\r\n\t\tobj.tbody = null;\r\n\t\tobj.rows = [];\r\n\t\tobj.results = null;\r\n\t\tobj.searchInput = null;\r\n\t\tobj.toolbar = null;\r\n\t\tobj.pagination = null;\r\n\t\tobj.pageNumber = null;\r\n\t\tobj.headerContainer = null;\r\n\t\tobj.colgroupContainer = null;\r\n\r\n\t\t// Containers\r\n\t\tobj.headers = [];\r\n\t\tobj.records = [];\r\n\t\tobj.history = [];\r\n\t\tobj.formula = [];\r\n\t\tobj.colgroup = [];\r\n\t\tobj.selection = [];\r\n\t\tobj.highlighted  = [];\r\n\t\tobj.selectedCell = null;\r\n\t\tobj.selectedContainer = null;\r\n\t\tobj.style = [];\r\n\t\tobj.data = null;\r\n\t\tobj.filter = null;\r\n\t\tobj.filters = [];\r\n\r\n\t\t// Internal controllers\r\n\t\tobj.cursor = null;\r\n\t\tobj.historyIndex = -1;\r\n\t\tobj.ignoreEvents = false;\r\n\t\tobj.ignoreHistory = false;\r\n\t\tobj.edition = null;\r\n\t\tobj.hashString = null;\r\n\t\tobj.resizing = null;\r\n\t\tobj.dragging = null;\r\n\r\n\t\t// Lazy loading\r\n\t\tif (obj.options.lazyLoading == true && (obj.options.tableOverflow == false && obj.options.fullscreen == false)) {\r\n\t\t\tconsole.error('Jspreadsheet: The lazyloading only works when tableOverflow = yes or fullscreen = yes');\r\n\t\t\tobj.options.lazyLoading = false;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Activate/Disable fullscreen\r\n\t\t * use programmatically : table.fullscreen(); or table.fullscreen(true); or table.fullscreen(false);\r\n\t\t * @Param {boolean} activate\r\n\t\t */\r\n\t\tobj.fullscreen = function(activate) {\r\n\t\t\t// If activate not defined, get reverse options.fullscreen\r\n\t\t\tif (activate == null) {\r\n\t\t\t\tactivate = ! obj.options.fullscreen;\r\n\t\t\t}\r\n\r\n\t\t\t// If change\r\n\t\t\tif (obj.options.fullscreen != activate) {\r\n\t\t\t\tobj.options.fullscreen = activate;\r\n\r\n\t\t\t\t// Test LazyLoading conflict\r\n\t\t\t\tif (activate == true) {\r\n\t\t\t\t\tel.classList.add('fullscreen');\r\n\t\t\t\t} else {\r\n\t\t\t\t\tel.classList.remove('fullscreen');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Trigger events\r\n\t\t */\r\n\t\tobj.dispatch = function(event) {\r\n\t\t\t// Dispatch events\r\n\t\t\tif (! obj.ignoreEvents) {\r\n\t\t\t\t// Call global event\r\n\t\t\t\tif (typeof(obj.options.onevent) == 'function') {\r\n\t\t\t\t\tvar ret = obj.options.onevent.apply(this, arguments);\r\n\t\t\t\t}\r\n\t\t\t\t// Call specific events\r\n\t\t\t\tif (typeof(obj.options[event]) == 'function') {\r\n\t\t\t\t\tvar ret = obj.options[event].apply(this, Array.prototype.slice.call(arguments, 1));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Persistance\r\n\t\t\tif (event == 'onafterchanges' && obj.options.persistance) {\r\n\t\t\t\tvar url = obj.options.persistance == true ? obj.options.url : obj.options.persistance;\r\n\t\t\t\tvar data = obj.prepareJson(arguments[2]);\r\n\t\t\t\tobj.save(url, data);\r\n\t\t\t}\r\n\r\n\t\t\treturn ret;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Prepare the jspreadsheet table\r\n\t\t *\r\n\t\t * @Param config\r\n\t\t */\r\n\t\tobj.prepareTable = function() {\r\n\t\t\t// Loading initial data from remote sources\r\n\t\t\tvar results = [];\r\n\r\n\t\t\t// Number of columns\r\n\t\t\tvar size = obj.options.columns.length;\r\n\r\n\t\t\tif (obj.options.data && typeof(obj.options.data[0]) !== 'undefined') {\r\n\t\t\t\t// Data keys\r\n\t\t\t\tvar keys = Object.keys(obj.options.data[0]);\r\n\r\n\t\t\t\tif (keys.length > size) {\r\n\t\t\t\t\tsize = keys.length;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Minimal dimensions\r\n\t\t\tif (obj.options.minDimensions[0] > size) {\r\n\t\t\t\tsize = obj.options.minDimensions[0];\r\n\t\t\t}\r\n\r\n\t\t\t// Requests\r\n\t\t\tvar multiple = [];\r\n\r\n\t\t\t// Preparations\r\n\t\t\tfor (var i = 0; i < size; i++) {\r\n\t\t\t\t// Deprected options. You should use only columns\r\n\t\t\t\tif (! obj.options.colHeaders[i]) {\r\n\t\t\t\t\tobj.options.colHeaders[i] = '';\r\n\t\t\t\t}\r\n\t\t\t\tif (! obj.options.colWidths[i]) {\r\n\t\t\t\t\tobj.options.colWidths[i] = obj.options.defaultColWidth;\r\n\t\t\t\t}\r\n\t\t\t\tif (! obj.options.colAlignments[i]) {\r\n\t\t\t\t\tobj.options.colAlignments[i] = obj.options.defaultColAlign;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Default column description\r\n\t\t\t\tif (! obj.options.columns[i]) {\r\n\t\t\t\t\tobj.options.columns[i] = { type:'text' };\r\n\t\t\t\t} else if (! obj.options.columns[i].type) {\r\n\t\t\t\t\tobj.options.columns[i].type = 'text';\r\n\t\t\t\t}\r\n\t\t\t\tif (! obj.options.columns[i].name) {\r\n\t\t\t\t\tobj.options.columns[i].name = keys && keys[i] ? keys[i] : i;\r\n\t\t\t\t}\r\n\t\t\t\tif (! obj.options.columns[i].source) {\r\n\t\t\t\t\tobj.options.columns[i].source = [];\r\n\t\t\t\t}\r\n\t\t\t\tif (! obj.options.columns[i].options) {\r\n\t\t\t\t\tobj.options.columns[i].options = [];\r\n\t\t\t\t}\r\n\t\t\t\tif (! obj.options.columns[i].editor) {\r\n\t\t\t\t\tobj.options.columns[i].editor = null;\r\n\t\t\t\t}\r\n\t\t\t\tif (! obj.options.columns[i].allowEmpty) {\r\n\t\t\t\t\tobj.options.columns[i].allowEmpty = false;\r\n\t\t\t\t}\r\n\t\t\t\tif (! obj.options.columns[i].title) {\r\n\t\t\t\t\tobj.options.columns[i].title = obj.options.colHeaders[i] ? obj.options.colHeaders[i] : '';\r\n\t\t\t\t}\r\n\t\t\t\tif (! obj.options.columns[i].width) {\r\n\t\t\t\t\tobj.options.columns[i].width = obj.options.colWidths[i] ? obj.options.colWidths[i] : obj.options.defaultColWidth;\r\n\t\t\t\t}\r\n\t\t\t\tif (! obj.options.columns[i].align) {\r\n\t\t\t\t\tobj.options.columns[i].align = obj.options.colAlignments[i] ? obj.options.colAlignments[i] : 'center';\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Pre-load initial source for json autocomplete\r\n\t\t\t\tif (obj.options.columns[i].type == 'autocomplete' || obj.options.columns[i].type == 'dropdown') {\r\n\t\t\t\t\t// if remote content\r\n\t\t\t\t\tif (obj.options.columns[i].url) {\r\n\t\t\t\t\t\tmultiple.push({\r\n\t\t\t\t\t\t\turl: obj.options.columns[i].url,\r\n\t\t\t\t\t\t\tindex: i,\r\n\t\t\t\t\t\t\tmethod: 'GET',\r\n\t\t\t\t\t\t\tdataType: 'json',\r\n\t\t\t\t\t\t\tsuccess: function(data) {\r\n\t\t\t\t\t\t\t\tvar source = [];\r\n\t\t\t\t\t\t\t\tfor (var i = 0; i < data.length; i++) {\r\n\t\t\t\t\t\t\t\t\tobj.options.columns[this.index].source.push(data[i]);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (obj.options.columns[i].type == 'calendar') {\r\n\t\t\t\t\t// Default format for date columns\r\n\t\t\t\t\tif (! obj.options.columns[i].options.format) {\r\n\t\t\t\t\t\tobj.options.columns[i].options.format = 'DD/MM/YYYY';\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// Create the table when is ready\r\n\t\t\tif (! multiple.length) {\r\n\t\t\t\tobj.createTable();\r\n\t\t\t} else {\r\n\t\t\t\tjSuites.ajax(multiple, function() {\r\n\t\t\t\t\tobj.createTable();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tobj.createTable = function() {\r\n\t\t\t// Elements\r\n\t\t\tobj.table = document.createElement('table');\r\n\t\t\tobj.thead = document.createElement('thead');\r\n\t\t\tobj.tbody = document.createElement('tbody');\r\n\r\n\t\t\t// Create headers controllers\r\n\t\t\tobj.headers = [];\r\n\t\t\tobj.colgroup = [];\r\n\r\n\t\t\t// Create table container\r\n\t\t\tobj.content = document.createElement('div');\r\n\t\t\tobj.content.classList.add('jexcel_content');\r\n\t\t\tobj.content.onscroll = function(e) {\r\n\t\t\t\tobj.scrollControls(e);\r\n\t\t\t}\r\n\t\t\tobj.content.onwheel = function(e) {\r\n\t\t\t\tobj.wheelControls(e);\r\n\t\t\t}\r\n\r\n\t\t\t// Create toolbar object\r\n\t\t\tobj.toolbar = document.createElement('div');\r\n\t\t\tobj.toolbar.classList.add('jexcel_toolbar');\r\n\r\n\t\t\t// Search\r\n\t\t\tvar searchContainer = document.createElement('div');\r\n\t\t\tvar searchText = document.createTextNode((obj.options.text.search) + ': ');\r\n\t\t\tobj.searchInput = document.createElement('input');\r\n\t\t\tobj.searchInput.classList.add('jexcel_search');\r\n\t\t\tsearchContainer.appendChild(searchText);\r\n\t\t\tsearchContainer.appendChild(obj.searchInput);\r\n\t\t\tobj.searchInput.onfocus = function() {\r\n\t\t\t\tobj.resetSelection();\r\n\t\t\t}\r\n\r\n\t\t\t// Pagination select option\r\n\t\t\tvar paginationUpdateContainer = document.createElement('div');\r\n\r\n\t\t\tif (obj.options.pagination > 0 && obj.options.paginationOptions && obj.options.paginationOptions.length > 0) {\r\n\t\t\t\tobj.paginationDropdown = document.createElement('select');\r\n\t\t\t\tobj.paginationDropdown.classList.add('jexcel_pagination_dropdown');\r\n\t\t\t\tobj.paginationDropdown.onchange = function() {\r\n\t\t\t\t\tobj.options.pagination = parseInt(this.value);\r\n\t\t\t\t\tobj.page(0);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor (var i = 0; i < obj.options.paginationOptions.length; i++) {\r\n\t\t\t\t\tvar temp = document.createElement('option');\r\n\t\t\t\t\ttemp.value = obj.options.paginationOptions[i];\r\n\t\t\t\t\ttemp.innerHTML = obj.options.paginationOptions[i];\r\n\t\t\t\t\tobj.paginationDropdown.appendChild(temp);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Set initial pagination value\r\n\t\t\t\tobj.paginationDropdown.value = obj.options.pagination;\r\n\r\n\t\t\t\tpaginationUpdateContainer.appendChild(document.createTextNode(obj.options.text.show));\r\n\t\t\t\tpaginationUpdateContainer.appendChild(obj.paginationDropdown);\r\n\t\t\t\tpaginationUpdateContainer.appendChild(document.createTextNode(obj.options.text.entries));\r\n\t\t\t}\r\n\r\n\t\t\t// Filter and pagination container\r\n\t\t\tvar filter = document.createElement('div');\r\n\t\t\tfilter.classList.add('jexcel_filter');\r\n\t\t\tfilter.appendChild(paginationUpdateContainer);\r\n\t\t\tfilter.appendChild(searchContainer);\r\n\r\n\t\t\t// Colsgroup\r\n\t\t\tobj.colgroupContainer = document.createElement('colgroup');\r\n\t\t\tvar tempCol = document.createElement('col');\r\n\t\t\ttempCol.setAttribute('width', '50');\r\n\t\t\tobj.colgroupContainer.appendChild(tempCol);\r\n\r\n\t\t\t// Nested\r\n\t\t\tif (obj.options.nestedHeaders && obj.options.nestedHeaders.length > 0) {\r\n\t\t\t\t// Flexible way to handle nestedheaders\r\n\t\t\t\tif (obj.options.nestedHeaders[0] && obj.options.nestedHeaders[0][0]) {\r\n\t\t\t\t\tfor (var j = 0; j < obj.options.nestedHeaders.length; j++) {\r\n\t\t\t\t\t\tobj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders[j]));\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tobj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Row\r\n\t\t\tobj.headerContainer = document.createElement('tr');\r\n\t\t\tvar tempCol = document.createElement('td');\r\n\t\t\ttempCol.classList.add('jexcel_selectall');\r\n\t\t\tobj.headerContainer.appendChild(tempCol);\r\n\r\n\t\t\tfor (var i = 0; i < obj.options.columns.length; i++) {\r\n\t\t\t\t// Create header\r\n\t\t\t\tobj.createCellHeader(i);\r\n\t\t\t\t// Append cell to the container\r\n\t\t\t\tobj.headerContainer.appendChild(obj.headers[i]);\r\n\t\t\t\tobj.colgroupContainer.appendChild(obj.colgroup[i]);\r\n\t\t\t}\r\n\r\n\t\t\tobj.thead.appendChild(obj.headerContainer);\r\n\r\n\t\t\t// Filters\r\n\t\t\tif (obj.options.filters == true) {\r\n\t\t\t\tobj.filter = document.createElement('tr');\r\n\t\t\t\tvar td = document.createElement('td');\r\n\t\t\t\tobj.filter.appendChild(td);\r\n\r\n\t\t\t\tfor (var i = 0; i < obj.options.columns.length; i++) {\r\n\t\t\t\t\tvar td = document.createElement('td');\r\n\t\t\t\t\ttd.innerHTML = '&nbsp;';\r\n\t\t\t\t\ttd.setAttribute('data-x', i);\r\n\t\t\t\t\ttd.className = 'jexcel_column_filter';\r\n\t\t\t\t\tif (obj.options.columns[i].type == 'hidden') {\r\n\t\t\t\t\t\ttd.style.display = 'none';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tobj.filter.appendChild(td);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tobj.thead.appendChild(obj.filter);\r\n\t\t\t}\r\n\r\n\t\t\t// Content table\r\n\t\t\tobj.table = document.createElement('table');\r\n\t\t\tobj.table.classList.add('jexcel');\r\n\t\t\tobj.table.setAttribute('cellpadding', '0');\r\n\t\t\tobj.table.setAttribute('cellspacing', '0');\r\n\t\t\tobj.table.setAttribute('unselectable', 'yes');\r\n\t\t\t//obj.table.setAttribute('onselectstart', 'return false');\r\n\t\t\tobj.table.appendChild(obj.colgroupContainer);\r\n\t\t\tobj.table.appendChild(obj.thead);\r\n\t\t\tobj.table.appendChild(obj.tbody);\r\n\r\n\t\t\tif (! obj.options.textOverflow) {\r\n\t\t\t\tobj.table.classList.add('jexcel_overflow');\r\n\t\t\t}\r\n\r\n\t\t\t// Spreadsheet corner\r\n\t\t\tobj.corner = document.createElement('div');\r\n\t\t\tobj.corner.className = 'jexcel_corner';\r\n\t\t\tobj.corner.setAttribute('unselectable', 'on');\r\n\t\t\tobj.corner.setAttribute('onselectstart', 'return false');\r\n\r\n\t\t\tif (obj.options.selectionCopy == false) {\r\n\t\t\t\tobj.corner.style.display = 'none';\r\n\t\t\t}\r\n\r\n\t\t\t// Textarea helper\r\n\t\t\tobj.textarea = document.createElement('textarea');\r\n\t\t\tobj.textarea.className = 'jexcel_textarea';\r\n\t\t\tobj.textarea.id = 'jexcel_textarea';\r\n\t\t\tobj.textarea.tabIndex = '-1';\r\n\r\n\t\t\t// Contextmenu container\r\n\t\t\tobj.contextMenu = document.createElement('div');\r\n\t\t\tobj.contextMenu.className = 'jexcel_contextmenu';\r\n\r\n\t\t\t// Create element\r\n\t\t\tjSuites.contextmenu(obj.contextMenu, {\r\n\t\t\t\tonclick:function() {\r\n\t\t\t\t\tobj.contextMenu.contextmenu.close(false);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t// Powered by Jspreadsheet\r\n\t\t\tvar ads = document.createElement('a');\r\n\t\t\tads.setAttribute('href', 'https://bossanova.uk/jspreadsheet/');\r\n\t\t\tobj.ads = document.createElement('div');\r\n\t\t\tobj.ads.className = 'jexcel_about';\r\n\t\t\t/* // TablePress: Remove this as it loads a file from the Jspreadsheet server.\r\n\t\t\ttry {\r\n\t\t\t\tif (typeof(sessionStorage) !== \"undefined\" && ! sessionStorage.getItem('jexcel')) {\r\n\t\t\t\t\tsessionStorage.setItem('jexcel', true);\r\n\t\t\t\t\tvar img = document.createElement('img');\r\n\t\t\t\t\timg.src = '//bossanova.uk/jspreadsheet/logo.png';\r\n\t\t\t\t\tads.appendChild(img);\r\n\t\t\t\t}\r\n\t\t\t} catch (exception) {\r\n\t\t\t}\r\n\t\t\t*/\r\n\t\t\tvar span = document.createElement('span');\r\n\t\t\tspan.innerHTML = 'Jspreadsheet CE';\r\n\t\t\tads.appendChild(span);\r\n\t\t\tobj.ads.appendChild(ads);\r\n\r\n\t\t\t// Create table container TODO: frozen columns\r\n\t\t\tvar container = document.createElement('div');\r\n\t\t\tcontainer.classList.add('jexcel_table');\r\n\r\n\t\t\t// Pagination\r\n\t\t\tobj.pagination = document.createElement('div');\r\n\t\t\tobj.pagination.classList.add('jexcel_pagination');\r\n\t\t\tvar paginationInfo = document.createElement('div');\r\n\t\t\tvar paginationPages = document.createElement('div');\r\n\t\t\tobj.pagination.appendChild(paginationInfo);\r\n\t\t\tobj.pagination.appendChild(paginationPages);\r\n\r\n\t\t\t// Hide pagination if not in use\r\n\t\t\tif (! obj.options.pagination) {\r\n\t\t\t\tobj.pagination.style.display = 'none';\r\n\t\t\t}\r\n\r\n\t\t\t// Append containers to the table\r\n\t\t\tif (obj.options.search == true) {\r\n\t\t\t\tel.appendChild(filter);\r\n\t\t\t}\r\n\r\n\t\t\t// Elements\r\n\t\t\tobj.content.appendChild(obj.table);\r\n\t\t\tobj.content.appendChild(obj.corner);\r\n\t\t\tobj.content.appendChild(obj.textarea);\r\n\r\n\t\t\tel.appendChild(obj.toolbar);\r\n\t\t\tel.appendChild(obj.content);\r\n\t\t\tel.appendChild(obj.pagination);\r\n\t\t\tel.appendChild(obj.contextMenu);\r\n\t\t\tel.appendChild(obj.ads);\r\n\t\t\tel.classList.add('jexcel_container');\r\n\r\n\t\t\t// Create toolbar\r\n\t\t\tif (obj.options.toolbar && obj.options.toolbar.length) {\r\n\t\t\t\tobj.createToolbar();\r\n\t\t\t}\r\n\r\n\t\t\t// Fullscreen\r\n\t\t\tif (obj.options.fullscreen == true) {\r\n\t\t\t\tel.classList.add('fullscreen');\r\n\t\t\t} else {\r\n\t\t\t\t// Overflow\r\n\t\t\t\tif (obj.options.tableOverflow == true) {\r\n\t\t\t\t\tif (obj.options.tableHeight) {\r\n\t\t\t\t\t\tobj.content.style['overflow-y'] = 'auto';\r\n\t\t\t\t\t\tobj.content.style['box-shadow'] = 'rgb(221 221 221) 2px 2px 5px 0.1px';\r\n\t\t\t\t\t\tobj.content.style.maxHeight = obj.options.tableHeight;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (obj.options.tableWidth) {\r\n\t\t\t\t\t\tobj.content.style['overflow-x'] = 'auto';\r\n\t\t\t\t\t\tobj.content.style.width = obj.options.tableWidth;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// With toolbars\r\n\t\t\tif (obj.options.tableOverflow != true && obj.options.toolbar) {\r\n\t\t\t\tel.classList.add('with-toolbar');\r\n\t\t\t}\r\n\r\n\t\t\t// Actions\r\n\t\t\tif (obj.options.columnDrag == true) {\r\n\t\t\t\tobj.thead.classList.add('draggable');\r\n\t\t\t}\r\n\t\t\tif (obj.options.columnResize == true) {\r\n\t\t\t\tobj.thead.classList.add('resizable');\r\n\t\t\t}\r\n\t\t\tif (obj.options.rowDrag == true) {\r\n\t\t\t\tobj.tbody.classList.add('draggable');\r\n\t\t\t}\r\n\t\t\tif (obj.options.rowResize == true) {\r\n\t\t\t\tobj.tbody.classList.add('resizable');\r\n\t\t\t}\r\n\r\n\t\t\t// Load data\r\n\t\t\tobj.setData();\r\n\r\n\t\t\t// Style\r\n\t\t\tif (obj.options.style) {\r\n\t\t\t\tobj.setStyle(obj.options.style, null, null, 1, 1);\r\n\t\t\t}\r\n\r\n\t\t\t// Classes\r\n\t\t\tif (obj.options.classes) {\r\n\t\t\t\tvar k = Object.keys(obj.options.classes);\r\n\t\t\t\tfor (var i = 0; i < k.length; i++) {\r\n\t\t\t\t\tvar cell = jexcel.getIdFromColumnName(k[i], true);\r\n\t\t\t\t\tobj.records[cell[1]][cell[0]].classList.add(obj.options.classes[k[i]]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Refresh the data\r\n\t\t *\r\n\t\t * @return void\r\n\t\t */\r\n\t\tobj.refresh = function() {\r\n\t\t\tif (obj.options.url) {\r\n\t\t\t\t// Loading\r\n\t\t\t\tif (obj.options.loadingSpin == true) {\r\n\t\t\t\t\tjSuites.loading.show();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tjSuites.ajax({\r\n\t\t\t\t\turl: obj.options.url,\r\n\t\t\t\t\tmethod: obj.options.method,\r\n\t\t\t\t\tdata: obj.options.requestVariables,\r\n\t\t\t\t\tdataType: 'json',\r\n\t\t\t\t\tsuccess: function(result) {\r\n\t\t\t\t\t\t// Data\r\n\t\t\t\t\t\tobj.options.data = (result.data) ? result.data : result;\r\n\t\t\t\t\t\t// Prepare table\r\n\t\t\t\t\t\tobj.setData();\r\n\t\t\t\t\t\t// Hide spin\r\n\t\t\t\t\t\tif (obj.options.loadingSpin == true) {\r\n\t\t\t\t\t\t\tjSuites.loading.hide();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tobj.setData();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Set data\r\n\t\t *\r\n\t\t * @param array data In case no data is sent, default is reloaded\r\n\t\t * @return void\r\n\t\t */\r\n\t\tobj.setData = function(data) {\r\n\t\t\t// Update data\r\n\t\t\tif (data) {\r\n\t\t\t\tif (typeof(data) == 'string') {\r\n\t\t\t\t\tdata = JSON.parse(data);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tobj.options.data = data;\r\n\t\t\t}\r\n\r\n\t\t\t// Data\r\n\t\t\tif (! obj.options.data) {\r\n\t\t\t\tobj.options.data = [];\r\n\t\t\t}\r\n\r\n\t\t\t// Prepare data\r\n\t\t\tif (obj.options.data && obj.options.data[0]) {\r\n\t\t\t\tif (! Array.isArray(obj.options.data[0])) {\r\n\t\t\t\t\tvar data = [];\r\n\t\t\t\t\tfor (var j = 0; j < obj.options.data.length; j++) {\r\n\t\t\t\t\t\tvar row = [];\r\n\t\t\t\t\t\tfor (var i = 0; i < obj.options.columns.length; i++) {\r\n\t\t\t\t\t\t\trow[i] = obj.options.data[j][obj.options.columns[i].name];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdata.push(row);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tobj.options.data = data;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Adjust minimal dimensions\r\n\t\t\tvar j = 0;\r\n\t\t\tvar i = 0;\r\n\t\t\tvar size_i = obj.options.columns.length;\r\n\t\t\tvar size_j = obj.options.data.length;\r\n\t\t\tvar min_i = obj.options.minDimensions[0];\r\n\t\t\tvar min_j = obj.options.minDimensions[1];\r\n\t\t\tvar max_i = min_i > size_i ? min_i : size_i;\r\n\t\t\tvar max_j = min_j > size_j ? min_j : size_j;\r\n\r\n\t\t\tfor (j = 0; j < max_j; j++) {\r\n\t\t\t\tfor (i = 0; i < max_i; i++) {\r\n\t\t\t\t\tif (obj.options.data[j] == undefined) {\r\n\t\t\t\t\t\tobj.options.data[j] = [];\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (obj.options.data[j][i] == undefined) {\r\n\t\t\t\t\t\tobj.options.data[j][i] = '';\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Reset containers\r\n\t\t\tobj.rows = [];\r\n\t\t\tobj.results = null;\r\n\t\t\tobj.records = [];\r\n\t\t\tobj.history = [];\r\n\r\n\t\t\t// Reset internal controllers\r\n\t\t\tobj.historyIndex = -1;\r\n\r\n\t\t\t// Reset data\r\n\t\t\tobj.tbody.innerHTML = '';\r\n\r\n\t\t\t// Lazy loading\r\n\t\t\tif (obj.options.lazyLoading == true) {\r\n\t\t\t\t// Load only 100 records\r\n\t\t\t\tvar startNumber = 0\r\n\t\t\t\tvar finalNumber = obj.options.data.length < 100 ? obj.options.data.length : 100;\r\n\r\n\t\t\t\tif (obj.options.pagination) {\r\n\t\t\t\t\tobj.options.pagination = false;\r\n\t\t\t\t\tconsole.error('Jspreadsheet: Pagination will be disable due the lazyLoading');\r\n\t\t\t\t}\r\n\t\t\t} else if (obj.options.pagination) {\r\n\t\t\t\t// Pagination\r\n\t\t\t\tif (! obj.pageNumber) {\r\n\t\t\t\t\tobj.pageNumber = 0;\r\n\t\t\t\t}\r\n\t\t\t\tvar quantityPerPage = obj.options.pagination;\r\n\t\t\t\tstartNumber = (obj.options.pagination * obj.pageNumber);\r\n\t\t\t\tfinalNumber = (obj.options.pagination * obj.pageNumber) + obj.options.pagination;\r\n\r\n\t\t\t\tif (obj.options.data.length < finalNumber) {\r\n\t\t\t\t\tfinalNumber = obj.options.data.length;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tvar startNumber = 0;\r\n\t\t\t\tvar finalNumber = obj.options.data.length;\r\n\t\t\t}\r\n\r\n\t\t\t// Append nodes to the HTML\r\n\t\t\tfor (j = 0; j < obj.options.data.length; j++) {\r\n\t\t\t\t// Create row\r\n\t\t\t\tvar tr = obj.createRow(j, obj.options.data[j]);\r\n\t\t\t\t// Append line to the table\r\n\t\t\t\tif (j >= startNumber && j < finalNumber) {\r\n\t\t\t\t\tobj.tbody.appendChild(tr);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (obj.options.lazyLoading == true) {\r\n\t\t\t\t// Do not create pagination with lazyloading activated\r\n\t\t\t} else if (obj.options.pagination) {\r\n\t\t\t\tobj.updatePagination();\r\n\t\t\t}\r\n\r\n\t\t\t// Merge cells\r\n\t\t\tif (obj.options.mergeCells) {\r\n\t\t\t\tvar keys = Object.keys(obj.options.mergeCells);\r\n\t\t\t\tfor (var i = 0; i < keys.length; i++) {\r\n\t\t\t\t\tvar num = obj.options.mergeCells[keys[i]];\r\n\t\t\t\t\tobj.setMerge(keys[i], num[0], num[1], 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Update table with custom configurations if applicable\r\n\t\t\tobj.updateTable();\r\n\r\n\t\t\t// Onload\r\n\t\t\tobj.dispatch('onload', el, obj);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Get the whole table data\r\n\t\t *\r\n\t\t * @param bool get highlighted cells only\r\n\t\t * @return array data\r\n\t\t */\r\n\t\tobj.getData = function(highlighted, dataOnly) {\r\n\t\t\t// Control vars\r\n\t\t\tvar dataset = [];\r\n\t\t\tvar px = 0;\r\n\t\t\tvar py = 0;\r\n\r\n\t\t\t// Data type\r\n\t\t\tvar dataType = dataOnly == true || obj.options.copyCompatibility == false ? true : false;\r\n\r\n\t\t\t// Column and row length\r\n\t\t\tvar x = obj.options.columns.length\r\n\t\t\tvar y = obj.options.data.length\r\n\r\n\t\t\t// Go through the columns to get the data\r\n\t\t\tfor (var j = 0; j < y; j++) {\r\n\t\t\t\tpx = 0;\r\n\t\t\t\tfor (var i = 0; i < x; i++) {\r\n\t\t\t\t\t// Cell selected or fullset\r\n\t\t\t\t\tif (! highlighted || obj.records[j][i].classList.contains('highlight')) {\r\n\t\t\t\t\t\t// Get value\r\n\t\t\t\t\t\tif (! dataset[py]) {\r\n\t\t\t\t\t\t\tdataset[py] = [];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (! dataType) {\r\n\t\t\t\t\t\t\tdataset[py][px] = obj.records[j][i].innerHTML;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tdataset[py][px] = obj.options.data[j][i];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tpx++;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (px > 0) {\r\n\t\t\t\t\tpy++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn dataset;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t* Get json data by row number\r\n\t\t*\r\n\t\t* @param integer row number\r\n\t\t* @return object\r\n\t\t*/\r\n\t\tobj.getJsonRow = function(rowNumber) {\r\n\t\t\tvar rowData = obj.options.data[rowNumber];\r\n\t\t\tvar x = obj.options.columns.length\r\n\r\n\t\t\tvar row = {};\r\n\t\t\tfor (var i = 0; i < x; i++) {\r\n\t\t\t\tif (! obj.options.columns[i].name) {\r\n\t\t\t\t\tobj.options.columns[i].name = i;\r\n\t\t\t\t}\r\n\t\t\t\trow[obj.options.columns[i].name] = rowData[i];\r\n\t\t\t}\r\n\r\n\t\t\treturn row;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Get the whole table data\r\n\t\t *\r\n\t\t * @param bool highlighted cells only\r\n\t\t * @return string value\r\n\t\t */\r\n\t\tobj.getJson = function(highlighted) {\r\n\t\t\t// Control vars\r\n\t\t\tvar data = [];\r\n\r\n\t\t\t// Column and row length\r\n\t\t\tvar x = obj.options.columns.length\r\n\t\t\tvar y = obj.options.data.length\r\n\r\n\t\t\t// Go through the columns to get the data\r\n\t\t\tfor (var j = 0; j < y; j++) {\r\n\t\t\t\tvar row = null;\r\n\t\t\t\tfor (var i = 0; i < x; i++) {\r\n\t\t\t\t\tif (! highlighted || obj.records[j][i].classList.contains('highlight')) {\r\n\t\t\t\t\t\tif (row == null) {\r\n\t\t\t\t\t\t\trow = {};\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (! obj.options.columns[i].name) {\r\n\t\t\t\t\t\t\tobj.options.columns[i].name = i;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\trow[obj.options.columns[i].name] = obj.options.data[j][i];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (row != null) {\r\n\t\t\t\t\tdata.push(row);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn data;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Prepare JSON in the correct format\r\n\t\t */\r\n\t\tobj.prepareJson = function(data) {\r\n\t\t\tvar rows = [];\r\n\t\t\tfor (var i = 0; i < data.length; i++) {\r\n\t\t\t\tvar x = data[i].x;\r\n\t\t\t\tvar y = data[i].y;\r\n\t\t\t\tvar k = obj.options.columns[x].name ? obj.options.columns[x].name : x;\r\n\r\n\t\t\t\t// Create row\r\n\t\t\t\tif (! rows[y]) {\r\n\t\t\t\t\trows[y] = {\r\n\t\t\t\t\t\trow: y,\r\n\t\t\t\t\t\tdata: {},\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t\trows[y].data[k] = data[i].newValue;\r\n\t\t\t}\r\n\r\n\t\t\t// Filter rows\r\n\t\t\treturn rows.filter(function (el) {\r\n\t\t\t\treturn el != null;\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Post json to a remote server\r\n\t\t */\r\n\t\tobj.save = function(url, data) {\r\n\t\t\t// Parse anything in the data before sending to the server\r\n\t\t\tvar ret = obj.dispatch('onbeforesave', el, obj, data);\r\n\t\t\tif (ret) {\r\n\t\t\t\tvar data = ret;\r\n\t\t\t} else {\r\n\t\t\t\tif (ret === false) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Remove update\r\n\t\t\tjSuites.ajax({\r\n\t\t\t\turl: url,\r\n\t\t\t\tmethod: 'POST',\r\n\t\t\t\tdataType: 'json',\r\n\t\t\t\tdata: { data: JSON.stringify(data) },\r\n\t\t\t\tsuccess: function(result) {\r\n\t\t\t\t\t// Event\r\n\t\t\t\t\tobj.dispatch('onsave', el, obj, data);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Get a row data by rowNumber\r\n\t\t */\r\n\t\tobj.getRowData = function(rowNumber) {\r\n\t\t\treturn obj.options.data[rowNumber];\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Set a row data by rowNumber\r\n\t\t */\r\n\t\tobj.setRowData = function(rowNumber, data) {\r\n\t\t\tfor (var i = 0; i < obj.headers.length; i++) {\r\n\t\t\t\t// Update cell\r\n\t\t\t\tvar columnName = jexcel.getColumnNameFromId([ i, rowNumber ]);\r\n\t\t\t\t// Set value\r\n\t\t\t\tif (data[i] != null) {\r\n\t\t\t\t\tobj.setValue(columnName, data[i]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Get a column data by columnNumber\r\n\t\t */\r\n\t\tobj.getColumnData = function(columnNumber) {\r\n\t\t\tvar dataset = [];\r\n\t\t\t// Go through the rows to get the data\r\n\t\t\tfor (var j = 0; j < obj.options.data.length; j++) {\r\n\t\t\t\tdataset.push(obj.options.data[j][columnNumber]);\r\n\t\t\t}\r\n\t\t\treturn dataset;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Set a column data by colNumber\r\n\t\t */\r\n\t\tobj.setColumnData = function(colNumber, data) {\r\n\t\t\tfor (var j = 0; j < obj.rows.length; j++) {\r\n\t\t\t\t// Update cell\r\n\t\t\t\tvar columnName = jexcel.getColumnNameFromId([ colNumber, j ]);\r\n\t\t\t\t// Set value\r\n\t\t\t\tif (data[j] != null) {\r\n\t\t\t\t\tobj.setValue(columnName, data[j]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Create row\r\n\t\t */\r\n\t\tobj.createRow = function(j, data) {\r\n\t\t\t// Create container\r\n\t\t\tif (! obj.records[j]) {\r\n\t\t\t\tobj.records[j] = [];\r\n\t\t\t}\r\n\t\t\t// Default data\r\n\t\t\tif (! data) {\r\n\t\t\t\tvar data = obj.options.data[j];\r\n\t\t\t}\r\n\t\t\t// New line of data to be append in the table\r\n\t\t\tobj.rows[j] = document.createElement('tr');\r\n\t\t\tobj.rows[j].setAttribute('data-y', j);\r\n\t\t\t// Index\r\n\t\t\tvar index = null;\r\n\r\n\t\t\t// Set default row height\r\n\t\t\tif (obj.options.defaultRowHeight) {\r\n\t\t\t\tobj.rows[j].style.height = obj.options.defaultRowHeight + 'px'\r\n\t\t\t}\r\n\r\n\t\t\t// Definitions\r\n\t\t\tif (obj.options.rows[j]) {\r\n\t\t\t\tif (obj.options.rows[j].height) {\r\n\t\t\t\t\tobj.rows[j].style.height = obj.options.rows[j].height;\r\n\t\t\t\t}\r\n\t\t\t\tif (obj.options.rows[j].title) {\r\n\t\t\t\t\tindex = obj.options.rows[j].title;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (! index) {\r\n\t\t\t\tindex = parseInt(j + 1);\r\n\t\t\t}\r\n\t\t\t// Row number label\r\n\t\t\tvar td = document.createElement('td');\r\n\t\t\ttd.innerHTML = index;\r\n\t\t\ttd.setAttribute('data-y', j);\r\n\t\t\ttd.className = 'jexcel_row';\r\n\t\t\tobj.rows[j].appendChild(td);\r\n\r\n\t\t\t// Data columns\r\n\t\t\tfor (var i = 0; i < obj.options.columns.length; i++) {\r\n\t\t\t\t// New column of data to be append in the line\r\n\t\t\t\tobj.records[j][i] = obj.createCell(i, j, data[i]);\r\n\t\t\t\t// Add column to the row\r\n\t\t\t\tobj.rows[j].appendChild(obj.records[j][i]);\r\n\t\t\t}\r\n\r\n\t\t\t// Add row to the table body\r\n\t\t\treturn obj.rows[j];\r\n\t\t}\r\n\r\n\t\tobj.parseValue = function(i, j, value, cell) {\r\n\t\t\tif ((''+value).substr(0,1) == '=' && obj.options.parseFormulas == true) {\r\n\t\t\t\tvalue = obj.executeFormula(value, i, j)\r\n\t\t\t}\r\n\r\n\t\t\t// Column options\r\n\t\t\tvar options = obj.options.columns[i];\r\n\t\t\tif (options && ! isFormula(value)) {\r\n\t\t\t\t// Mask options\r\n\t\t\t\tvar opt = null;\r\n\t\t\t\tif (opt = getMask(options)) {\r\n\t\t\t\t\tif (value && value == Number(value)) {\r\n\t\t\t\t\t\tvalue = Number(value);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// Process the decimals to match the mask\r\n\t\t\t\t\tvar masked = jSuites.mask.render(value, opt, true);\r\n\t\t\t\t\t// Negative indication\r\n\t\t\t\t\tif (cell) {\r\n\t\t\t\t\t\tif (opt.mask) {\r\n\t\t\t\t\t\t\tvar t = opt.mask.split(';');\r\n\t\t\t\t\t\t\tif (t[1]) {\r\n\t\t\t\t\t\t\t\tvar t1 = t[1].match(new RegExp('\\\\[Red\\\\]', 'gi'));\r\n\t\t\t\t\t\t\t\tif (t1) {\r\n\t\t\t\t\t\t\t\t\tif (value < 0) {\r\n\t\t\t\t\t\t\t\t\t\tcell.classList.add('red');\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tcell.classList.remove('red');\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tvar t2 = t[1].match(new RegExp('\\\\(', 'gi'));\r\n\t\t\t\t\t\t\t\tif (t2) {\r\n\t\t\t\t\t\t\t\t\tif (value < 0) {\r\n\t\t\t\t\t\t\t\t\t\tmasked = '(' + masked + ')';\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (masked) {\r\n\t\t\t\t\t\tvalue = masked;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn value;\r\n\t\t}\r\n\r\n\t\tvar validDate = function(date) {\r\n\t\t\tdate = ''+date;\r\n\t\t\tif (date.substr(4,1) == '-' && date.substr(7,1) == '-') {\r\n\t\t\t\treturn true;\r\n\t\t\t} else {\r\n\t\t\t\tdate = date.split('-');\r\n\t\t\t\tif ((date[0].length == 4 && date[0] == Number(date[0]) && date[1].length == 2 && date[1] == Number(date[1]))) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Create cell\r\n\t\t */\r\n\t\tobj.createCell = function(i, j, value) {\r\n\t\t\t// Create cell and properties\r\n\t\t\tvar td = document.createElement('td');\r\n\t\t\ttd.setAttribute('data-x', i);\r\n\t\t\ttd.setAttribute('data-y', j);\r\n\r\n\t\t\t// Security\r\n\t\t\tif ((''+value).substr(0,1) == '=' && obj.options.secureFormulas == true) {\r\n\t\t\t\tvar val = secureFormula(value);\r\n\t\t\t\tif (val != value) {\r\n\t\t\t\t\t// Update the data container\r\n\t\t\t\t\tvalue = val;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Custom column\r\n\t\t\tif (obj.options.columns[i].editor) {\r\n\t\t\t\tif (obj.options.stripHTML === false || obj.options.columns[i].stripHTML === false) {\r\n\t\t\t\t\ttd.innerHTML = value;\r\n\t\t\t\t} else {\r\n\t\t\t\t\ttd.textContent = value;\r\n\t\t\t\t}\r\n\t\t\t\tif (typeof(obj.options.columns[i].editor.createCell) == 'function') {\r\n\t\t\t\t\ttd = obj.options.columns[i].editor.createCell(td);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\t// Hidden column\r\n\t\t\t\tif (obj.options.columns[i].type == 'hidden') {\r\n\t\t\t\t\ttd.style.display = 'none';\r\n\t\t\t\t\ttd.textContent = value;\r\n\t\t\t\t} else if (obj.options.columns[i].type == 'checkbox' || obj.options.columns[i].type == 'radio') {\r\n\t\t\t\t\t// Create input\r\n\t\t\t\t\tvar element = document.createElement('input');\r\n\t\t\t\t\telement.type = obj.options.columns[i].type;\r\n\t\t\t\t\telement.name = 'c' + i;\r\n\t\t\t\t\telement.checked = (value == 1 || value == true || value == 'true') ? true : false;\r\n\t\t\t\t\telement.onclick = function() {\r\n\t\t\t\t\t\tobj.setValue(td, this.checked);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (obj.options.columns[i].readOnly == true || obj.options.editable == false) {\r\n\t\t\t\t\t\telement.setAttribute('disabled', 'disabled');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Append to the table\r\n\t\t\t\t\ttd.appendChild(element);\r\n\t\t\t\t\t// Make sure the values are correct\r\n\t\t\t\t\tobj.options.data[j][i] = element.checked;\r\n\t\t\t\t} else if (obj.options.columns[i].type == 'calendar') {\r\n\t\t\t\t\t// Try formatted date\r\n\t\t\t\t\tvar formatted = null;\r\n\t\t\t\t\tif (! validDate(value)) {\r\n\t\t\t\t\t\tvar tmp = jSuites.calendar.extractDateFromString(value, obj.options.columns[i].options.format);\r\n\t\t\t\t\t\tif (tmp) {\r\n\t\t\t\t\t\t\tformatted = tmp;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// Create calendar cell\r\n\t\t\t\t\ttd.textContent = jSuites.calendar.getDateString(formatted ? formatted : value, obj.options.columns[i].options.format);\r\n\t\t\t\t} else if (obj.options.columns[i].type == 'dropdown' || obj.options.columns[i].type == 'autocomplete') {\r\n\t\t\t\t\t// Create dropdown cell\r\n\t\t\t\t\ttd.classList.add('jexcel_dropdown');\r\n\t\t\t\t\ttd.textContent = obj.getDropDownValue(i, value);\r\n\t\t\t\t} else if (obj.options.columns[i].type == 'color') {\r\n\t\t\t\t\tif (obj.options.columns[i].render == 'square') {\r\n\t\t\t\t\t\tvar color = document.createElement('div');\r\n\t\t\t\t\t\tcolor.className = 'color';\r\n\t\t\t\t\t\tcolor.style.backgroundColor = value;\r\n\t\t\t\t\t\ttd.appendChild(color);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\ttd.style.color = value;\r\n\t\t\t\t\t\ttd.textContent = value;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (obj.options.columns[i].type == 'image') {\r\n\t\t\t\t\tif (value && value.substr(0, 10) == 'data:image') {\r\n\t\t\t\t\t\tvar img = document.createElement('img');\r\n\t\t\t\t\t\timg.src = value;\r\n\t\t\t\t\t\ttd.appendChild(img);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (obj.options.columns[i].type == 'html') {\r\n\t\t\t\t\t\ttd.innerHTML = stripScript(obj.parseValue(i, j, value, td));\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (obj.options.stripHTML === false || obj.options.columns[i].stripHTML === false) {\r\n\t\t\t\t\t\t\ttd.innerHTML = stripScript(obj.parseValue(i, j, value, td));\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t// TablePress: Add a div container inside each cell.\r\n\t\t\t\t\t\t\t// td.textContent = obj.parseValue(i, j, value, td);\r\n\t\t\t\t\t\t\tvar div = document.createElement('div');\r\n\t\t\t\t\t\t\tdiv.textContent = obj.parseValue(i, j, value, td);\r\n\t\t\t\t\t\t\ttd.appendChild(div);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Readonly\r\n\t\t\tif (obj.options.columns[i].readOnly == true) {\r\n\t\t\t\ttd.className = 'readonly';\r\n\t\t\t}\r\n\r\n\t\t\t// Text align\r\n\t\t\tvar colAlign = obj.options.columns[i].align ? obj.options.columns[i].align : 'center';\r\n\t\t\ttd.style.textAlign = colAlign;\r\n\r\n\t\t\t// Wrap option\r\n\t\t\tif (obj.options.columns[i].wordWrap != false && (obj.options.wordWrap == true || obj.options.columns[i].wordWrap == true || td.innerHTML.length > 200)) {\r\n\t\t\t\ttd.style.whiteSpace = 'pre-wrap';\r\n\t\t\t}\r\n\r\n\t\t\t// Overflow\r\n\t\t\tif (i > 0) {\r\n\t\t\t\tif (this.options.textOverflow == true) {\r\n\t\t\t\t\tif (value || td.innerHTML) {\r\n\t\t\t\t\t\tobj.records[j][i-1].style.overflow = 'hidden';\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (i == obj.options.columns.length - 1) {\r\n\t\t\t\t\t\t\ttd.style.overflow = 'hidden';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn td;\r\n\t\t}\r\n\r\n\t\tobj.createCellHeader = function(colNumber) {\r\n\t\t\t// Create col global control\r\n\t\t\tvar colWidth = obj.options.columns[colNumber].width ? obj.options.columns[colNumber].width : obj.options.defaultColWidth;\r\n\t\t\tvar colAlign = obj.options.columns[colNumber].align ? obj.options.columns[colNumber].align : obj.options.defaultColAlign;\r\n\r\n\t\t\t// Create header cell\r\n\t\t\tobj.headers[colNumber] = document.createElement('td');\r\n\t\t\tif (obj.options.stripHTML) {\r\n\t\t\t\tobj.headers[colNumber].textContent = obj.options.columns[colNumber].title ? obj.options.columns[colNumber].title : jexcel.getColumnName(colNumber);\r\n\t\t\t} else {\r\n\t\t\t\tobj.headers[colNumber].innerHTML = obj.options.columns[colNumber].title ? obj.options.columns[colNumber].title : jexcel.getColumnName(colNumber);\r\n\t\t\t}\r\n\t\t\tobj.headers[colNumber].setAttribute('data-x', colNumber);\r\n\t\t\tobj.headers[colNumber].style.textAlign = colAlign;\r\n\t\t\tif (obj.options.columns[colNumber].title) {\r\n\t\t\t\tobj.headers[colNumber].setAttribute('title', obj.headers[colNumber].innerText);\r\n\t\t\t}\r\n\t\t\tif (obj.options.columns[colNumber].id) {\r\n\t\t\t\tobj.headers[colNumber].setAttribute('id', obj.options.columns[colNumber].id);\r\n\t\t\t}\r\n\r\n\t\t\t// Width control\r\n\t\t\tobj.colgroup[colNumber] = document.createElement('col');\r\n\t\t\tobj.colgroup[colNumber].setAttribute('width', colWidth);\r\n\r\n\t\t\t// Hidden column\r\n\t\t\tif (obj.options.columns[colNumber].type == 'hidden') {\r\n\t\t\t\tobj.headers[colNumber].style.display = 'none';\r\n\t\t\t\tobj.colgroup[colNumber].style.display = 'none';\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Update a nested header title\r\n\t\t */\r\n\t\tobj.updateNestedHeader = function(x, y, title) {\r\n\t\t\tif (obj.options.nestedHeaders[y][x].title) {\r\n\t\t\t\tobj.options.nestedHeaders[y][x].title = title;\r\n\t\t\t\tobj.options.nestedHeaders[y].element.children[x+1].textContent = title;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Create a nested header object\r\n\t\t */\r\n\t\tobj.createNestedHeader = function(nestedInformation) {\r\n\t\t\tvar tr = document.createElement('tr');\r\n\t\t\ttr.classList.add('jexcel_nested');\r\n\t\t\tvar td = document.createElement('td');\r\n\t\t\ttr.appendChild(td);\r\n\t\t\t// Element\r\n\t\t\tnestedInformation.element = tr;\r\n\r\n\t\t\tvar headerIndex = 0;\r\n\t\t\tfor (var i = 0; i < nestedInformation.length; i++) {\r\n\t\t\t\t// Default values\r\n\t\t\t\tif (! nestedInformation[i].colspan) {\r\n\t\t\t\t\tnestedInformation[i].colspan = 1;\r\n\t\t\t\t}\r\n\t\t\t\tif (! nestedInformation[i].align) {\r\n\t\t\t\t\tnestedInformation[i].align = 'center';\r\n\t\t\t\t}\r\n\t\t\t\tif (! nestedInformation[i].title) {\r\n\t\t\t\t\tnestedInformation[i].title = '';\r\n\t\t\t\t}\r\n\t\t\t\tif (! nestedInformation[i].id) {\r\n\t\t\t\t\tnestedInformation[i].id = '';\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Number of columns\r\n\t\t\t\tvar numberOfColumns = nestedInformation[i].colspan;\r\n\r\n\t\t\t\t// Classes container\r\n\t\t\t\tvar column = [];\r\n\t\t\t\t// Header classes for this cell\r\n\t\t\t\tfor (var x = 0; x < numberOfColumns; x++) {\r\n\t\t\t\t\tif (obj.options.columns[headerIndex] && obj.options.columns[headerIndex].type == 'hidden') {\r\n\t\t\t\t\t\tnumberOfColumns++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcolumn.push(headerIndex);\r\n\t\t\t\t\theaderIndex++;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Created the nested cell\r\n\t\t\t\tvar td = document.createElement('td');\r\n\t\t\t\ttd.setAttribute('data-column', column.join(','));\r\n\t\t\t\ttd.setAttribute('colspan', nestedInformation[i].colspan);\r\n\t\t\t\ttd.setAttribute('align', nestedInformation[i].align);\r\n\t\t\t\ttd.setAttribute('id', nestedInformation[i].id);\r\n\t\t\t\ttd.textContent = nestedInformation[i].title;\r\n\t\t\t\ttr.appendChild(td);\r\n\t\t\t}\r\n\r\n\t\t\treturn tr;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Create toolbar\r\n\t\t */\r\n\t\tobj.createToolbar = function(toolbar) {\r\n\t\t\tif (toolbar) {\r\n\t\t\t\tobj.options.toolbar = toolbar;\r\n\t\t\t} else {\r\n\t\t\t\tvar toolbar = obj.options.toolbar;\r\n\t\t\t}\r\n\t\t\tfor (var i = 0; i < toolbar.length; i++) {\r\n\t\t\t\tif (toolbar[i].type == 'i') {\r\n\t\t\t\t\tvar toolbarItem = document.createElement('i');\r\n\t\t\t\t\ttoolbarItem.classList.add('jexcel_toolbar_item');\r\n\t\t\t\t\ttoolbarItem.classList.add('material-icons');\r\n\t\t\t\t\ttoolbarItem.setAttribute('data-k', toolbar[i].k);\r\n\t\t\t\t\ttoolbarItem.setAttribute('data-v', toolbar[i].v);\r\n\t\t\t\t\ttoolbarItem.setAttribute('id', toolbar[i].id);\r\n\r\n\t\t\t\t\t// Tooltip\r\n\t\t\t\t\tif (toolbar[i].tooltip) {\r\n\t\t\t\t\t\ttoolbarItem.setAttribute('title', toolbar[i].tooltip);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// Handle click\r\n\t\t\t\t\tif (toolbar[i].onclick && typeof(toolbar[i].onclick)) {\r\n\t\t\t\t\t\ttoolbarItem.onclick = (function (a) {\r\n\t\t\t\t\t\t\tvar b = a;\r\n\t\t\t\t\t\t\treturn function () {\r\n\t\t\t\t\t\t\t\ttoolbar[b].onclick(el, obj, this);\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t})(i);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\ttoolbarItem.onclick = function() {\r\n\t\t\t\t\t\t\tvar k = this.getAttribute('data-k');\r\n\t\t\t\t\t\t\tvar v = this.getAttribute('data-v');\r\n\t\t\t\t\t\t\tobj.setStyle(obj.highlighted, k, v);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// Append element\r\n\t\t\t\t\ttoolbarItem.textContent = toolbar[i].content;\r\n\t\t\t\t\tobj.toolbar.appendChild(toolbarItem);\r\n\t\t\t\t} else if (toolbar[i].type == 'select') {\r\n\t\t\t\t\tvar toolbarItem = document.createElement('select');\r\n\t\t\t\t\tvar raiseInitialOnChange = false;\r\n\t\t\t\t\ttoolbarItem.classList.add('jexcel_toolbar_item');\r\n\t\t\t\t\ttoolbarItem.setAttribute('data-k', toolbar[i].k);\r\n\t\t\t\t\t// Tooltip\r\n\t\t\t\t\tif (toolbar[i].tooltip) {\r\n\t\t\t\t\t\ttoolbarItem.setAttribute('title', toolbar[i].tooltip);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// Handle onchange\r\n\t\t\t\t\tif (toolbar[i].onchange && typeof(toolbar[i].onchange)) {\r\n\t\t\t\t\t\ttoolbarItem.onchange = toolbar[i].onchange;\r\n\t\t\t\t\t\traiseInitialOnChange = true;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\ttoolbarItem.onchange = function() {\r\n\t\t\t\t\t\t\tvar k = this.getAttribute('data-k');\r\n\t\t\t\t\t\t\tobj.setStyle(obj.highlighted, k, this.value);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// Add options to the dropdown\r\n\t\t\t\t\tfor(var j = 0; j < toolbar[i].v.length; j++) {\r\n\t\t\t\t\t\tvar toolbarDropdownOption = document.createElement('option');\r\n\t\t\t\t\t\ttoolbarDropdownOption.value = toolbar[i].v[j];\r\n\t\t\t\t\t\ttoolbarDropdownOption.textContent = toolbar[i].v[j];\r\n\t\t\t\t\t\tif (toolbar[i].selectedValue && toolbarDropdownOption.value === toolbar[i].selectedValue) {\r\n\t\t\t\t\t\t\ttoolbarDropdownOption.selected = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\ttoolbarItem.appendChild(toolbarDropdownOption);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (raiseInitialOnChange) {\r\n\t\t\t\t\t\ttoolbarItem.dispatchEvent(new Event('change'));\r\n\t\t\t\t\t}\r\n\t\t\t\t\tobj.toolbar.appendChild(toolbarItem);\r\n\t\t\t\t} else if (toolbar[i].type == 'color') {\r\n\t\t\t\t\t var toolbarItem = document.createElement('i');\r\n\t\t\t\t\t toolbarItem.classList.add('jexcel_toolbar_item');\r\n\t\t\t\t\t toolbarItem.classList.add('material-icons');\r\n\t\t\t\t\t toolbarItem.setAttribute('data-k', toolbar[i].k);\r\n\t\t\t\t\t toolbarItem.setAttribute('data-v', '');\r\n\t\t\t\t\t // Tooltip\r\n\t\t\t\t\t if (toolbar[i].tooltip) {\r\n\t\t\t\t\t\t toolbarItem.setAttribute('title', toolbar[i].tooltip);\r\n\t\t\t\t\t }\r\n\t\t\t\t\t obj.toolbar.appendChild(toolbarItem);\r\n\t\t\t\t\t toolbarItem.textContent = toolbar[i].content;\r\n\t\t\t\t\t jSuites.color(toolbarItem, {\r\n\t\t\t\t\t\t onchange:function(o, v) {\r\n\t\t\t\t\t\t\t var k = o.getAttribute('data-k');\r\n\t\t\t\t\t\t\t obj.setStyle(obj.highlighted, k, v);\r\n\t\t\t\t\t\t }\r\n\t\t\t\t\t });\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Merge cells\r\n\t\t * @param cellName\r\n\t\t * @param colspan\r\n\t\t * @param rowspan\r\n\t\t * @param ignoreHistoryAndEvents\r\n\t\t */\r\n\t\tobj.setMerge = function(cellName, colspan, rowspan, ignoreHistoryAndEvents) {\r\n\t\t\tvar test = false;\r\n\r\n\t\t\tif (! cellName) {\r\n\t\t\t\tif (! obj.highlighted.length) {\r\n\t\t\t\t\talert(obj.options.text.noCellsSelected);\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvar x1 = parseInt(obj.highlighted[0].getAttribute('data-x'));\r\n\t\t\t\t\tvar y1 = parseInt(obj.highlighted[0].getAttribute('data-y'));\r\n\t\t\t\t\tvar x2 = parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute('data-x'));\r\n\t\t\t\t\tvar y2 = parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute('data-y'));\r\n\t\t\t\t\tvar cellName = jexcel.getColumnNameFromId([ x1, y1 ]);\r\n\t\t\t\t\tvar colspan = (x2 - x1) + 1;\r\n\t\t\t\t\tvar rowspan = (y2 - y1) + 1;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tvar cell = jexcel.getIdFromColumnName(cellName, true);\r\n\r\n\t\t\tif (obj.options.mergeCells[cellName]) {\r\n\t\t\t\tif (obj.records[cell[1]][cell[0]].getAttribute('data-merged')) {\r\n\t\t\t\t\ttest = obj.options.text.cellAlreadyMerged;\r\n\t\t\t\t}\r\n\t\t\t} else if ((! colspan || colspan < 2) && (! rowspan || rowspan < 2)) {\r\n\t\t\t\ttest = obj.options.text.invalidMergeProperties;\r\n\t\t\t} else {\r\n\t\t\t\tvar cells = [];\r\n\t\t\t\tfor (var j = cell[1]; j < cell[1] + rowspan; j++) {\r\n\t\t\t\t\tfor (var i = cell[0]; i < cell[0] + colspan; i++) {\r\n\t\t\t\t\t\tvar columnName = jexcel.getColumnNameFromId([i, j]);\r\n\t\t\t\t\t\tif (obj.records[j][i].getAttribute('data-merged')) {\r\n\t\t\t\t\t\t\ttest = obj.options.text.thereIsAConflictWithAnotherMergedCell;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (test) {\r\n\t\t\t\talert(test);\r\n\t\t\t} else {\r\n\t\t\t\t// Add property\r\n\t\t\t\tif (colspan > 1) {\r\n\t\t\t\t\tobj.records[cell[1]][cell[0]].setAttribute('colspan', colspan);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcolspan = 1;\r\n\t\t\t\t}\r\n\t\t\t\tif (rowspan > 1) {\r\n\t\t\t\t\tobj.records[cell[1]][cell[0]].setAttribute('rowspan', rowspan);\r\n\t\t\t\t} else {\r\n\t\t\t\t\trowspan = 1;\r\n\t\t\t\t}\r\n\t\t\t\t// Keep links to the existing nodes\r\n\t\t\t\tobj.options.mergeCells[cellName] = [ colspan, rowspan, [] ];\r\n\t\t\t\t// Mark cell as merged\r\n\t\t\t\tobj.records[cell[1]][cell[0]].setAttribute('data-merged', 'true');\r\n\t\t\t\t// Overflow\r\n\t\t\t\tobj.records[cell[1]][cell[0]].style.overflow = 'hidden';\r\n\t\t\t\t// History data\r\n\t\t\t\tvar data = [];\r\n\t\t\t\t// Adjust the nodes\r\n\t\t\t\tfor (var y = cell[1]; y < cell[1] + rowspan; y++) {\r\n\t\t\t\t\tfor (var x = cell[0]; x < cell[0] + colspan; x++) {\r\n\t\t\t\t\t\tif (! (cell[0] == x && cell[1] == y)) {\r\n\t\t\t\t\t\t\tdata.push(obj.options.data[y][x]);\r\n\t\t\t\t\t\t\tobj.updateCell(x, y, '', true);\r\n\t\t\t\t\t\t\tobj.options.mergeCells[cellName][2].push(obj.records[y][x]);\r\n\t\t\t\t\t\t\tobj.records[y][x].style.display = 'none';\r\n\t\t\t\t\t\t\tobj.records[y][x] = obj.records[cell[1]][cell[0]];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t// In the initialization is not necessary keep the history\r\n\t\t\t\tobj.updateSelection(obj.records[cell[1]][cell[0]]);\r\n\r\n\t\t\t\tif (! ignoreHistoryAndEvents) {\r\n\t\t\t\t\tobj.setHistory({\r\n\t\t\t\t\t\taction:'setMerge',\r\n\t\t\t\t\t\tcolumn:cellName,\r\n\t\t\t\t\t\tcolspan:colspan,\r\n\t\t\t\t\t\trowspan:rowspan,\r\n\t\t\t\t\t\tdata:data,\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tobj.dispatch('onmerge', el, cellName, colspan, rowspan);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Merge cells\r\n\t\t * @param cellName\r\n\t\t * @param colspan\r\n\t\t * @param rowspan\r\n\t\t * @param ignoreHistoryAndEvents\r\n\t\t */\r\n\t\tobj.getMerge = function(cellName) {\r\n\t\t\tvar data = {};\r\n\t\t\tif (cellName) {\r\n\t\t\t\tif (obj.options.mergeCells[cellName]) {\r\n\t\t\t\t\tdata = [ obj.options.mergeCells[cellName][0], obj.options.mergeCells[cellName][1] ];\r\n\t\t\t\t} else {\r\n\t\t\t\t\tdata = null;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (obj.options.mergeCells) {\r\n\t\t\t\t\tvar mergedCells = obj.options.mergeCells;\r\n\t\t\t\t\tvar keys = Object.keys(obj.options.mergeCells);\r\n\t\t\t\t\tfor (var i = 0; i < keys.length; i++) {\r\n\t\t\t\t\t\tdata[keys[i]] = [ obj.options.mergeCells[keys[i]][0], obj.options.mergeCells[keys[i]][1] ];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn data;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Remove merge by cellname\r\n\t\t * @param cellName\r\n\t\t */\r\n\t\tobj.removeMerge = function(cellName, data, keepOptions) {\r\n\t\t\tif (obj.options.mergeCells[cellName]) {\r\n\t\t\t\tvar cell = jexcel.getIdFromColumnName(cellName, true);\r\n\t\t\t\tobj.records[cell[1]][cell[0]].removeAttribute('colspan');\r\n\t\t\t\tobj.records[cell[1]][cell[0]].removeAttribute('rowspan');\r\n\t\t\t\tobj.records[cell[1]][cell[0]].removeAttribute('data-merged');\r\n\t\t\t\tvar info = obj.options.mergeCells[cellName];\r\n\r\n\t\t\t\tvar index = 0;\r\n\t\t\t\tfor (var j = 0; j < info[1]; j++) {\r\n\t\t\t\t\tfor (var i = 0; i < info[0]; i++) {\r\n\t\t\t\t\t\tif (j > 0 || i > 0) {\r\n\t\t\t\t\t\t\tobj.records[cell[1]+j][cell[0]+i] = info[2][index];\r\n\t\t\t\t\t\t\tobj.records[cell[1]+j][cell[0]+i].style.display = '';\r\n\t\t\t\t\t\t\t// Recover data\r\n\t\t\t\t\t\t\tif (data && data[index]) {\r\n\t\t\t\t\t\t\t\tobj.updateCell(cell[0]+i, cell[1]+j, data[index]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tindex++;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Update selection\r\n\t\t\t\tobj.updateSelection(obj.records[cell[1]][cell[0]], obj.records[cell[1]+j-1][cell[0]+i-1]);\r\n\r\n\t\t\t\tif (! keepOptions) {\r\n\t\t\t\t\tdelete(obj.options.mergeCells[cellName]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Remove all merged cells\r\n\t\t */\r\n\t\tobj.destroyMerged = function(keepOptions) {\r\n\t\t\t// Remove any merged cells\r\n\t\t\tif (obj.options.mergeCells) {\r\n\t\t\t\tvar mergedCells = obj.options.mergeCells;\r\n\t\t\t\tvar keys = Object.keys(obj.options.mergeCells);\r\n\t\t\t\tfor (var i = 0; i < keys.length; i++) {\r\n\t\t\t\t\tobj.removeMerge(keys[i], null, keepOptions);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Is column merged\r\n\t\t */\r\n\t\tobj.isColMerged = function(x, insertBefore) {\r\n\t\t\tvar cols = [];\r\n\t\t\t// Remove any merged cells\r\n\t\t\tif (obj.options.mergeCells) {\r\n\t\t\t\tvar keys = Object.keys(obj.options.mergeCells);\r\n\t\t\t\tfor (var i = 0; i < keys.length; i++) {\r\n\t\t\t\t\tvar info = jexcel.getIdFromColumnName(keys[i], true);\r\n\t\t\t\t\tvar colspan = obj.options.mergeCells[keys[i]][0];\r\n\t\t\t\t\tvar x1 = info[0];\r\n\t\t\t\t\tvar x2 = info[0] + (colspan > 1 ? colspan - 1 : 0);\r\n\r\n\t\t\t\t\tif (insertBefore == null) {\r\n\t\t\t\t\t\tif ((x1 <= x && x2 >= x)) {\r\n\t\t\t\t\t\t\tcols.push(keys[i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (insertBefore) {\r\n\t\t\t\t\t\t\tif ((x1 < x && x2 >= x)) {\r\n\t\t\t\t\t\t\t\tcols.push(keys[i]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tif ((x1 <= x && x2 > x)) {\r\n\t\t\t\t\t\t\t\tcols.push(keys[i]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn cols;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Is rows merged\r\n\t\t */\r\n\t\tobj.isRowMerged = function(y, insertBefore) {\r\n\t\t\tvar rows = [];\r\n\t\t\t// Remove any merged cells\r\n\t\t\tif (obj.options.mergeCells) {\r\n\t\t\t\tvar keys = Object.keys(obj.options.mergeCells);\r\n\t\t\t\tfor (var i = 0; i < keys.length; i++) {\r\n\t\t\t\t\tvar info = jexcel.getIdFromColumnName(keys[i], true);\r\n\t\t\t\t\tvar rowspan = obj.options.mergeCells[keys[i]][1];\r\n\t\t\t\t\tvar y1 = info[1];\r\n\t\t\t\t\tvar y2 = info[1] + (rowspan > 1 ? rowspan - 1 : 0);\r\n\r\n\t\t\t\t\tif (insertBefore == null) {\r\n\t\t\t\t\t\tif ((y1 <= y && y2 >= y)) {\r\n\t\t\t\t\t\t\trows.push(keys[i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (insertBefore) {\r\n\t\t\t\t\t\t\tif ((y1 < y && y2 >= y)) {\r\n\t\t\t\t\t\t\t\trows.push(keys[i]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tif ((y1 <= y && y2 > y)) {\r\n\t\t\t\t\t\t\t\trows.push(keys[i]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn rows;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Open the column filter\r\n\t\t */\r\n\t\tobj.openFilter = function(columnId) {\r\n\t\t\tif (! obj.options.filters) {\r\n\t\t\t\tconsole.log('Jspreadsheet: filters not enabled.');\r\n\t\t\t} else {\r\n\t\t\t\t// Make sure is integer\r\n\t\t\t\tcolumnId = parseInt(columnId);\r\n\t\t\t\t// Reset selection\r\n\t\t\t\tobj.resetSelection();\r\n\t\t\t\t// Load options\r\n\t\t\t\tvar optionsFiltered = [];\r\n\t\t\t\tif (obj.options.columns[columnId].type == 'checkbox') {\r\n\t\t\t\t\toptionsFiltered.push({ id: 'true', name: 'True' });\r\n\t\t\t\t\toptionsFiltered.push({ id: 'false', name: 'False' });\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvar options = [];\r\n\t\t\t\t\tvar hasBlanks = false;\r\n\t\t\t\t\tfor (var j = 0; j < obj.options.data.length; j++) {\r\n\t\t\t\t\t\tvar k = obj.options.data[j][columnId];\r\n\t\t\t\t\t\tvar v = obj.records[j][columnId].innerHTML;\r\n\t\t\t\t\t\tif (k && v) {\r\n\t\t\t\t\t\t\toptions[k] = v;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tvar hasBlanks = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar keys = Object.keys(options);\r\n\t\t\t\t\tvar optionsFiltered = [];\r\n\t\t\t\t\tfor (var j = 0; j < keys.length; j++) {\r\n\t\t\t\t\t\toptionsFiltered.push({ id: keys[j], name: options[keys[j]] });\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// Has blank options\r\n\t\t\t\t\tif (hasBlanks) {\r\n\t\t\t\t\t\toptionsFiltered.push({ value: '', id: '', name: '(Blanks)' });\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Create dropdown\r\n\t\t\t\tvar div = document.createElement('div');\r\n\t\t\t\tobj.filter.children[columnId + 1].innerHTML = '';\r\n\t\t\t\tobj.filter.children[columnId + 1].appendChild(div);\r\n\t\t\t\tobj.filter.children[columnId + 1].style.paddingLeft = '0px';\r\n\t\t\t\tobj.filter.children[columnId + 1].style.paddingRight = '0px';\r\n\t\t\t\tobj.filter.children[columnId + 1].style.overflow = 'initial';\r\n\r\n\t\t\t\tvar opt = {\r\n\t\t\t\t\tdata: optionsFiltered,\r\n\t\t\t\t\tmultiple: true,\r\n\t\t\t\t\tautocomplete: true,\r\n\t\t\t\t\topened: true,\r\n\t\t\t\t\tvalue: obj.filters[columnId] !== undefined ? obj.filters[columnId] : null,\r\n\t\t\t\t\twidth:'100%',\r\n\t\t\t\t\tposition: (obj.options.tableOverflow == true || obj.options.fullscreen == true) ? true : false,\r\n\t\t\t\t\tonclose: function(o) {\r\n\t\t\t\t\t\tobj.resetFilters();\r\n\t\t\t\t\t\tobj.filters[columnId] = o.dropdown.getValue(true);\r\n\t\t\t\t\t\tobj.filter.children[columnId + 1].innerHTML = o.dropdown.getText();\r\n\t\t\t\t\t\tobj.filter.children[columnId + 1].style.paddingLeft = '';\r\n\t\t\t\t\t\tobj.filter.children[columnId + 1].style.paddingRight = '';\r\n\t\t\t\t\t\tobj.filter.children[columnId + 1].style.overflow = '';\r\n\t\t\t\t\t\tobj.closeFilter(columnId);\r\n\t\t\t\t\t\tobj.refreshSelection();\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\r\n\t\t\t\t// Dynamic dropdown\r\n\t\t\t\tjSuites.dropdown(div, opt);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tobj.resetFilters = function() {\r\n\t\t\tif (obj.options.filters) {\r\n\t\t\t\tfor (var i = 0; i < obj.filter.children.length; i++) {\r\n\t\t\t\t\tobj.filter.children[i].innerHTML = '&nbsp;';\r\n\t\t\t\t\tobj.filters[i] = null;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tobj.results = null;\r\n\t\t\tobj.updateResult();\r\n\t\t}\r\n\r\n\t\tobj.closeFilter = function(columnId) {\r\n\t\t\tif (! columnId) {\r\n\t\t\t\tfor (var i = 0; i < obj.filter.children.length; i++) {\r\n\t\t\t\t\tif (obj.filters[i]) {\r\n\t\t\t\t\t\tcolumnId = i;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Search filter\r\n\t\t\tvar search = function(query, x, y) {\r\n\t\t\t\tfor (var i = 0; i < query.length; i++) {\r\n\t\t\t\t\tvar value = ''+obj.options.data[y][x];\r\n\t\t\t\t\tvar label = ''+obj.records[y][x].innerHTML;\r\n\t\t\t\t\tif (query[i] == value || query[i] == label) {\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\tvar query = obj.filters[columnId];\r\n\t\t\tobj.results = [];\r\n\t\t\tfor (var j = 0; j < obj.options.data.length; j++) {\r\n\t\t\t\tif (search(query, columnId, j)) {\r\n\t\t\t\t\tobj.results.push(j);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (! obj.results.length) {\r\n\t\t\t\tobj.results = null;\r\n\t\t\t}\r\n\r\n\t\t\tobj.updateResult();\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Open the editor\r\n\t\t *\r\n\t\t * @param object cell\r\n\t\t * @return void\r\n\t\t */\r\n\t\tobj.openEditor = function(cell, empty, e) {\r\n\t\t\t// Get cell position\r\n\t\t\tvar y = cell.getAttribute('data-y');\r\n\t\t\tvar x = cell.getAttribute('data-x');\r\n\r\n\t\t\t// On edition start\r\n\t\t\tobj.dispatch('oneditionstart', el, cell, x, y);\r\n\r\n\t\t\t// Overflow\r\n\t\t\tif (x > 0) {\r\n\t\t\t\tobj.records[y][x-1].style.overflow = 'hidden';\r\n\t\t\t}\r\n\r\n\t\t\t// Create editor\r\n\t\t\tvar createEditor = function(type) {\r\n\t\t\t\t// Cell information\r\n\t\t\t\tvar info = cell.getBoundingClientRect();\r\n\r\n\t\t\t\t// Create dropdown\r\n\t\t\t\tvar editor = document.createElement(type);\r\n\t\t\t\t/* TablePress: The values in the differences were adjusted to make the textarea fit. */\r\n\t\t\t\teditor.style.width = (info.width - 6) + 'px';\r\n\t\t\t\teditor.style.height = (info.height - 6) + 'px';\r\n\t\t\t\teditor.style.minHeight = (info.height - 6) + 'px';\r\n\r\n\t\t\t\t// Edit cell\r\n\t\t\t\tcell.classList.add('editor');\r\n\t\t\t\tcell.innerHTML = '';\r\n\t\t\t\tcell.appendChild(editor);\r\n\r\n\t\t\t\t// On edition start\r\n\t\t\t\tobj.dispatch('oncreateeditor', el, cell, x, y, editor);\r\n\r\n\t\t\t\treturn editor;\r\n\t\t\t}\r\n\r\n\t\t\t// Readonly\r\n\t\t\tif (cell.classList.contains('readonly') == true) {\r\n\t\t\t\t// Do nothing\r\n\t\t\t} else {\r\n\t\t\t\t// Holder\r\n\t\t\t\tobj.edition = [ obj.records[y][x], obj.records[y][x].innerHTML, x, y ];\r\n\r\n\t\t\t\t// If there is a custom editor for it\r\n\t\t\t\tif (obj.options.columns[x].editor) {\r\n\t\t\t\t\t// Custom editors\r\n\t\t\t\t\tobj.options.columns[x].editor.openEditor(cell, el, empty, e);\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Native functions\r\n\t\t\t\t\tif (obj.options.columns[x].type == 'hidden') {\r\n\t\t\t\t\t\t// Do nothing\r\n\t\t\t\t\t} else if (obj.options.columns[x].type == 'checkbox' || obj.options.columns[x].type == 'radio') {\r\n\t\t\t\t\t\t// Get value\r\n\t\t\t\t\t\tvar value = cell.children[0].checked ? false : true;\r\n\t\t\t\t\t\t// Toogle value\r\n\t\t\t\t\t\tobj.setValue(cell, value);\r\n\t\t\t\t\t\t// Do not keep edition open\r\n\t\t\t\t\t\tobj.edition = null;\r\n\t\t\t\t\t} else if (obj.options.columns[x].type == 'dropdown' || obj.options.columns[x].type == 'autocomplete') {\r\n\t\t\t\t\t\t// Get current value\r\n\t\t\t\t\t\tvar value = obj.options.data[y][x];\r\n\t\t\t\t\t\tif (obj.options.columns[x].multiple && !Array.isArray(value)) {\r\n\t\t\t\t\t\t\tvalue = value.split(';');\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// Create dropdown\r\n\t\t\t\t\t\tif (typeof(obj.options.columns[x].filter) == 'function') {\r\n\t\t\t\t\t\t\tvar source = obj.options.columns[x].filter(el, cell, x, y, obj.options.columns[x].source);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tvar source = obj.options.columns[x].source;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// Do not change the original source\r\n\t\t\t\t\t\tvar data = [];\r\n\t\t\t\t\t\tfor (var j = 0; j < source.length; j++) {\r\n\t\t\t\t\t\t\tdata.push(source[j]);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// Create editor\r\n\t\t\t\t\t\tvar editor = createEditor('div');\r\n\t\t\t\t\t\tvar options = {\r\n\t\t\t\t\t\t\tdata: data,\r\n\t\t\t\t\t\t\tmultiple: obj.options.columns[x].multiple ? true : false,\r\n\t\t\t\t\t\t\tautocomplete: obj.options.columns[x].autocomplete || obj.options.columns[x].type == 'autocomplete' ? true : false,\r\n\t\t\t\t\t\t\topened:true,\r\n\t\t\t\t\t\t\tvalue: value,\r\n\t\t\t\t\t\t\twidth:'100%',\r\n\t\t\t\t\t\t\theight:editor.style.minHeight,\r\n\t\t\t\t\t\t\tposition: (obj.options.tableOverflow == true || obj.options.fullscreen == true) ? true : false,\r\n\t\t\t\t\t\t\tonclose:function() {\r\n\t\t\t\t\t\t\t\tobj.closeEditor(cell, true);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tif (obj.options.columns[x].options && obj.options.columns[x].options.type) {\r\n\t\t\t\t\t\t\toptions.type = obj.options.columns[x].options.type;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tjSuites.dropdown(editor, options);\r\n\t\t\t\t\t} else if (obj.options.columns[x].type == 'calendar' || obj.options.columns[x].type == 'color') {\r\n\t\t\t\t\t\t// Value\r\n\t\t\t\t\t\tvar value = obj.options.data[y][x];\r\n\t\t\t\t\t\t// Create editor\r\n\t\t\t\t\t\tvar editor = createEditor('input');\r\n\t\t\t\t\t\teditor.value = value;\r\n\r\n\t\t\t\t\t\tif (obj.options.tableOverflow == true || obj.options.fullscreen == true) {\r\n\t\t\t\t\t\t\tobj.options.columns[x].options.position = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tobj.options.columns[x].options.value = obj.options.data[y][x];\r\n\t\t\t\t\t\tobj.options.columns[x].options.opened = true;\r\n\t\t\t\t\t\tobj.options.columns[x].options.onclose = function(el, value) {\r\n\t\t\t\t\t\t\tobj.closeEditor(cell, true);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// Current value\r\n\t\t\t\t\t\tif (obj.options.columns[x].type == 'color') {\r\n\t\t\t\t\t\t\tjSuites.color(editor, obj.options.columns[x].options);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tjSuites.calendar(editor, obj.options.columns[x].options);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// Focus on editor\r\n\t\t\t\t\t\teditor.focus();\r\n\t\t\t\t\t} else if (obj.options.columns[x].type == 'html') {\r\n\t\t\t\t\t\tvar value = obj.options.data[y][x];\r\n\t\t\t\t\t\t// Create editor\r\n\t\t\t\t\t\tvar editor = createEditor('div');\r\n\t\t\t\t\t\teditor.style.position = 'relative';\r\n\t\t\t\t\t\tvar div = document.createElement('div');\r\n\t\t\t\t\t\tdiv.classList.add('jexcel_richtext');\r\n\t\t\t\t\t\teditor.appendChild(div);\r\n\t\t\t\t\t\tjSuites.editor(div, {\r\n\t\t\t\t\t\t\tfocus: true,\r\n\t\t\t\t\t\t\tvalue: value,\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tvar rect = cell.getBoundingClientRect();\r\n\t\t\t\t\t\tvar rectContent = div.getBoundingClientRect();\r\n\t\t\t\t\t\tif (window.innerHeight < rect.bottom + rectContent.height) {\r\n\t\t\t\t\t\t\tdiv.style.top = (rect.top - (rectContent.height + 2)) + 'px';\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tdiv.style.top = (rect.top) + 'px';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (obj.options.columns[x].type == 'image') {\r\n\t\t\t\t\t\t// Value\r\n\t\t\t\t\t\tvar img = cell.children[0];\r\n\t\t\t\t\t\t// Create editor\r\n\t\t\t\t\t\tvar editor = createEditor('div');\r\n\t\t\t\t\t\teditor.style.position = 'relative';\r\n\t\t\t\t\t\tvar div = document.createElement('div');\r\n\t\t\t\t\t\tdiv.classList.add('jclose');\r\n\t\t\t\t\t\tif (img && img.src) {\r\n\t\t\t\t\t\t\tdiv.appendChild(img);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\teditor.appendChild(div);\r\n\t\t\t\t\t\tjSuites.image(div, obj.options.imageOptions);\r\n\t\t\t\t\t\tvar rect = cell.getBoundingClientRect();\r\n\t\t\t\t\t\tvar rectContent = div.getBoundingClientRect();\r\n\t\t\t\t\t\tif (window.innerHeight < rect.bottom + rectContent.height) {\r\n\t\t\t\t\t\t\tdiv.style.top = (rect.top - (rectContent.height + 2)) + 'px';\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tdiv.style.top = (rect.top) + 'px';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// TablePress: Show all lines of text in an edited cell, and show at least that number of lines in other cells of the row.\r\n\t\t\t\t\t\tcell.classList.add('editing');\r\n\t\t\t\t\t\tvar cell_height = cell.getBoundingClientRect().height;\r\n\t\t\t\t\t\tobj.rows[y].style.setProperty( '--table-editor-line-clamp-editing', Math.floor( (cell_height-10) / 14 ) );\r\n\t\t\t\t\t\tobj.updateCornerPosition();\r\n\r\n\t\t\t\t\t\t// Value\r\n\t\t\t\t\t\tvar value = empty == true ? '' : obj.options.data[y][x];\r\n\r\n\t\t\t\t\t\t// Basic editor\r\n\t\t\t\t\t\tif (obj.options.columns[x].wordWrap != false && (obj.options.wordWrap == true || obj.options.columns[x].wordWrap == true)) {\r\n\t\t\t\t\t\t\tvar editor = createEditor('textarea');\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tvar editor = createEditor('input');\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\teditor.focus();\r\n\t\t\t\t\t\teditor.value = value;\r\n\r\n\t\t\t\t\t\t// Column options\r\n\t\t\t\t\t\tvar options = obj.options.columns[x];\r\n\t\t\t\t\t\t// Format\r\n\t\t\t\t\t\tvar opt = null;\r\n\r\n\t\t\t\t\t\t// Apply format when is not a formula\r\n\t\t\t\t\t\tif (! isFormula(value)) {\r\n\t\t\t\t\t\t\t// Format\r\n\t\t\t\t\t\t\tif (opt = getMask(options)) {\r\n\t\t\t\t\t\t\t\t// Masking\r\n\t\t\t\t\t\t\t\tif (! options.disabledMaskOnEdition) {\r\n\t\t\t\t\t\t\t\t\tif (options.mask) {\r\n\t\t\t\t\t\t\t\t\t\tvar m = options.mask.split(';')\r\n\t\t\t\t\t\t\t\t\t\teditor.setAttribute('data-mask', m[0]);\r\n\t\t\t\t\t\t\t\t\t} else if (options.locale) {\r\n\t\t\t\t\t\t\t\t\t\teditor.setAttribute('data-locale', options.locale);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t// Input\r\n\t\t\t\t\t\t\t\topt.input = editor;\r\n\t\t\t\t\t\t\t\t// Configuration\r\n\t\t\t\t\t\t\t\teditor.mask = opt;\r\n\t\t\t\t\t\t\t\t// Do not treat the decimals\r\n\t\t\t\t\t\t\t\tjSuites.mask.render(value, opt, false);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\teditor.onblur = function() {\r\n\t\t\t\t\t\t\tobj.closeEditor(cell, true);\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\teditor.scrollLeft = editor.scrollWidth;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Close the editor and save the information\r\n\t\t *\r\n\t\t * @param object cell\r\n\t\t * @param boolean save\r\n\t\t * @return void\r\n\t\t */\r\n\t\tobj.closeEditor = function(cell, save) {\r\n\t\t\tvar x = parseInt(cell.getAttribute('data-x'));\r\n\t\t\tvar y = parseInt(cell.getAttribute('data-y'));\r\n\r\n\t\t\t// TablePress: Reset cell/row heights to previous values.\r\n\t\t\tcell.classList.remove('editing');\r\n\t\t\tobj.rows[y].style.removeProperty( '--table-editor-line-clamp-editing' );\r\n\t\t\tobj.updateCornerPosition();\r\n\r\n\t\t\t// Get cell properties\r\n\t\t\tif (save == true) {\r\n\t\t\t\t// If custom editor\r\n\t\t\t\tif (obj.options.columns[x].editor) {\r\n\t\t\t\t\t// Custom editor\r\n\t\t\t\t\tvar value = obj.options.columns[x].editor.closeEditor(cell, save);\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Native functions\r\n\t\t\t\t\tif (obj.options.columns[x].type == 'checkbox' || obj.options.columns[x].type == 'radio' || obj.options.columns[x].type == 'hidden') {\r\n\t\t\t\t\t\t// Do nothing\r\n\t\t\t\t\t} else if (obj.options.columns[x].type == 'dropdown' || obj.options.columns[x].type == 'autocomplete') {\r\n\t\t\t\t\t\tvar value = cell.children[0].dropdown.close(true);\r\n\t\t\t\t\t} else if (obj.options.columns[x].type == 'calendar') {\r\n\t\t\t\t\t\tvar value = cell.children[0].calendar.close(true);\r\n\t\t\t\t\t} else if (obj.options.columns[x].type == 'color') {\r\n\t\t\t\t\t\tvar value = cell.children[0].color.close(true);\r\n\t\t\t\t\t} else if (obj.options.columns[x].type == 'html') {\r\n\t\t\t\t\t\tvar value = cell.children[0].children[0].editor.getData();\r\n\t\t\t\t\t} else if (obj.options.columns[x].type == 'image') {\r\n\t\t\t\t\t\tvar img = cell.children[0].children[0].children[0];\r\n\t\t\t\t\t\tvar value = img && img.tagName == 'IMG' ? img.src : '';\r\n\t\t\t\t\t} else if (obj.options.columns[x].type == 'numeric') {\r\n\t\t\t\t\t\tvar value = cell.children[0].value;\r\n\t\t\t\t\t\tif ((''+value).substr(0,1) != '=') {\r\n\t\t\t\t\t\t\tif (value == '') {\r\n\t\t\t\t\t\t\t\tvalue = obj.options.columns[x].allowEmpty ? '' : 0;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcell.children[0].onblur = null;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tvar value = cell.children[0].value;\r\n\t\t\t\t\t\tcell.children[0].onblur = null;\r\n\r\n\t\t\t\t\t\t// Column options\r\n\t\t\t\t\t\tvar options = obj.options.columns[x];\r\n\t\t\t\t\t\t// Format\r\n\t\t\t\t\t\tvar opt = null;\r\n\t\t\t\t\t\tif (opt = getMask(options)) {\r\n\t\t\t\t\t\t\t// Keep numeric in the raw data\r\n\t\t\t\t\t\t\tif (value !== '' && ! isFormula(value) && typeof(value) !== 'number') {\r\n\t\t\t\t\t\t\t\tvar t = jSuites.mask.extract(value, opt, true);\r\n\t\t\t\t\t\t\t\tif (t && t.value !== '') {\r\n\t\t\t\t\t\t\t\t\tvalue = t.value;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Ignore changes if the value is the same\r\n\t\t\t\tif (obj.options.data[y][x] == value) {\r\n\t\t\t\t\tcell.innerHTML = obj.edition[1];\r\n\t\t\t\t} else {\r\n\t\t\t\t\tobj.setValue(cell, value);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (obj.options.columns[x].editor) {\r\n\t\t\t\t\t// Custom editor\r\n\t\t\t\t\tobj.options.columns[x].editor.closeEditor(cell, save);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (obj.options.columns[x].type == 'dropdown' || obj.options.columns[x].type == 'autocomplete') {\r\n\t\t\t\t\t\tcell.children[0].dropdown.close(true);\r\n\t\t\t\t\t} else if (obj.options.columns[x].type == 'calendar') {\r\n\t\t\t\t\t\tcell.children[0].calendar.close(true);\r\n\t\t\t\t\t} else if (obj.options.columns[x].type == 'color') {\r\n\t\t\t\t\t\tcell.children[0].color.close(true);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tcell.children[0].onblur = null;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Restore value\r\n\t\t\t\tcell.innerHTML = obj.edition && obj.edition[1] ? obj.edition[1] : '';\r\n\t\t\t}\r\n\r\n\t\t\t// On edition end\r\n\t\t\tobj.dispatch('oneditionend', el, cell, x, y, value, save);\r\n\r\n\t\t\t// Remove editor class\r\n\t\t\tcell.classList.remove('editor');\r\n\r\n\t\t\t// Finish edition\r\n\t\t\tobj.edition = null;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Get the cell object\r\n\t\t *\r\n\t\t * @param object cell\r\n\t\t * @return string value\r\n\t\t */\r\n\t\tobj.getCell = function(cell) {\r\n\t\t\t// Convert in case name is excel liked ex. A10, BB92\r\n\t\t\tcell = jexcel.getIdFromColumnName(cell, true);\r\n\t\t\tvar x = cell[0];\r\n\t\t\tvar y = cell[1];\r\n\r\n\t\t\treturn obj.records[y][x];\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Get the column options\r\n\t\t * @param x\r\n\t\t * @param y\r\n\t\t * @returns {{type: string}}\r\n\t\t */\r\n\t\tobj.getColumnOptions = function(x, y) {\r\n\t\t\t// Type\r\n\t\t\tvar options = obj.options.columns[x];\r\n\r\n\t\t\t// Cell type\r\n\t\t\tif (! options) {\r\n\t\t\t\toptions = { type: 'text' };\r\n\t\t\t}\r\n\r\n\t\t\treturn options;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Get the cell object from coords\r\n\t\t *\r\n\t\t * @param object cell\r\n\t\t * @return string value\r\n\t\t */\r\n\t\tobj.getCellFromCoords = function(x, y) {\r\n\t\t\treturn obj.records[y][x];\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Get label\r\n\t\t *\r\n\t\t * @param object cell\r\n\t\t * @return string value\r\n\t\t */\r\n\t\tobj.getLabel = function(cell) {\r\n\t\t\t// Convert in case name is excel liked ex. A10, BB92\r\n\t\t\tcell = jexcel.getIdFromColumnName(cell, true);\r\n\t\t\tvar x = cell[0];\r\n\t\t\tvar y = cell[1];\r\n\r\n\t\t\treturn obj.records[y][x].innerHTML;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Get labelfrom coords\r\n\t\t *\r\n\t\t * @param object cell\r\n\t\t * @return string value\r\n\t\t */\r\n\t\tobj.getLabelFromCoords = function(x, y) {\r\n\t\t\treturn obj.records[y][x].innerHTML;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Get the value from a cell\r\n\t\t *\r\n\t\t * @param object cell\r\n\t\t * @return string value\r\n\t\t */\r\n\t\tobj.getValue = function(cell, processedValue) {\r\n\t\t\tif (typeof(cell) == 'object') {\r\n\t\t\t\tvar x = cell.getAttribute('data-x');\r\n\t\t\t\tvar y = cell.getAttribute('data-y');\r\n\t\t\t} else {\r\n\t\t\t\tcell = jexcel.getIdFromColumnName(cell, true);\r\n\t\t\t\tvar x = cell[0];\r\n\t\t\t\tvar y = cell[1];\r\n\t\t\t}\r\n\r\n\t\t\tvar value = null;\r\n\r\n\t\t\tif (x != null && y != null) {\r\n\t\t\t\tif (obj.records[y] && obj.records[y][x] && (processedValue || obj.options.copyCompatibility == true)) {\r\n\t\t\t\t\tvalue = obj.records[y][x].innerHTML;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (obj.options.data[y] && obj.options.data[y][x] != 'undefined') {\r\n\t\t\t\t\t\tvalue = obj.options.data[y][x];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn value;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Get the value from a coords\r\n\t\t *\r\n\t\t * @param int x\r\n\t\t * @param int y\r\n\t\t * @return string value\r\n\t\t */\r\n\t\tobj.getValueFromCoords = function(x, y, processedValue) {\r\n\t\t\tvar value = null;\r\n\r\n\t\t\tif (x != null && y != null) {\r\n\t\t\t\tif ((obj.records[y] && obj.records[y][x]) && processedValue || obj.options.copyCompatibility == true) {\r\n\t\t\t\t\tvalue = obj.records[y][x].innerHTML;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (obj.options.data[y] && obj.options.data[y][x] != 'undefined') {\r\n\t\t\t\t\t\tvalue = obj.options.data[y][x];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn value;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Set a cell value\r\n\t\t *\r\n\t\t * @param mixed cell destination cell\r\n\t\t * @param string value value\r\n\t\t * @return void\r\n\t\t */\r\n\t\tobj.setValue = function(cell, value, force) {\r\n\t\t\tvar records = [];\r\n\r\n\t\t\tif (typeof(cell) == 'string') {\r\n\t\t\t\tvar columnId = jexcel.getIdFromColumnName(cell, true);\r\n\t\t\t\tvar x = columnId[0];\r\n\t\t\t\tvar y = columnId[1];\r\n\r\n\t\t\t\t// Update cell\r\n\t\t\t\trecords.push(obj.updateCell(x, y, value, force));\r\n\r\n\t\t\t\t// Update all formulas in the chain\r\n\t\t\t\tobj.updateFormulaChain(x, y, records);\r\n\t\t\t} else {\r\n\t\t\t\tvar x = null;\r\n\t\t\t\tvar y = null;\r\n\t\t\t\tif (cell && cell.getAttribute) {\r\n\t\t\t\t\tvar x = cell.getAttribute('data-x');\r\n\t\t\t\t\tvar y = cell.getAttribute('data-y');\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Update cell\r\n\t\t\t\tif (x != null && y != null) {\r\n\t\t\t\t\trecords.push(obj.updateCell(x, y, value, force));\r\n\r\n\t\t\t\t\t// Update all formulas in the chain\r\n\t\t\t\t\tobj.updateFormulaChain(x, y, records);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvar keys = Object.keys(cell);\r\n\t\t\t\t\tif (keys.length > 0) {\r\n\t\t\t\t\t\tfor (var i = 0; i < keys.length; i++) {\r\n\t\t\t\t\t\t\tif (typeof(cell[i]) == 'string') {\r\n\t\t\t\t\t\t\t\tvar columnId = jexcel.getIdFromColumnName(cell[i], true);\r\n\t\t\t\t\t\t\t\tvar x = columnId[0];\r\n\t\t\t\t\t\t\t\tvar y = columnId[1];\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tif (cell[i].x != null && cell[i].y != null) {\r\n\t\t\t\t\t\t\t\t\tvar x = cell[i].x;\r\n\t\t\t\t\t\t\t\t\tvar y = cell[i].y;\r\n\t\t\t\t\t\t\t\t\t// Flexible setup\r\n\t\t\t\t\t\t\t\t\tif (cell[i].newValue != null) {\r\n\t\t\t\t\t\t\t\t\t\tvalue = cell[i].newValue;\r\n\t\t\t\t\t\t\t\t\t} else if (cell[i].value != null) {\r\n\t\t\t\t\t\t\t\t\t\tvalue = cell[i].value;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tvar x = cell[i].getAttribute('data-x');\r\n\t\t\t\t\t\t\t\t\tvar y = cell[i].getAttribute('data-y');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t // Update cell\r\n\t\t\t\t\t\t\tif (x != null && y != null) {\r\n\t\t\t\t\t\t\t\trecords.push(obj.updateCell(x, y, value, force));\r\n\r\n\t\t\t\t\t\t\t\t// Update all formulas in the chain\r\n\t\t\t\t\t\t\t\tobj.updateFormulaChain(x, y, records);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Update history\r\n\t\t\tobj.setHistory({\r\n\t\t\t\taction:'setValue',\r\n\t\t\t\trecords:records,\r\n\t\t\t\tselection:obj.selectedCell,\r\n\t\t\t});\r\n\r\n\t\t\t// Update table with custom configurations if applicable\r\n\t\t\tobj.updateTable();\r\n\r\n\t\t\t// On after changes\r\n\t\t\tobj.onafterchanges(el, records);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Set a cell value based on coordinates\r\n\t\t *\r\n\t\t * @param int x destination cell\r\n\t\t * @param int y destination cell\r\n\t\t * @param string value\r\n\t\t * @return void\r\n\t\t */\r\n\t\tobj.setValueFromCoords = function(x, y, value, force) {\r\n\t\t\tvar records = [];\r\n\t\t\trecords.push(obj.updateCell(x, y, value, force));\r\n\r\n\t\t\t// Update all formulas in the chain\r\n\t\t\tobj.updateFormulaChain(x, y, records);\r\n\r\n\t\t\t// Update history\r\n\t\t\tobj.setHistory({\r\n\t\t\t\taction:'setValue',\r\n\t\t\t\trecords:records,\r\n\t\t\t\tselection:obj.selectedCell,\r\n\t\t\t});\r\n\r\n\t\t\t// Update table with custom configurations if applicable\r\n\t\t\tobj.updateTable();\r\n\r\n\t\t\t// On after changes\r\n\t\t\tobj.onafterchanges(el, records);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Toogle\r\n\t\t */\r\n\t\tobj.setCheckRadioValue = function() {\r\n\t\t\tvar records = [];\r\n\t\t\tvar keys = Object.keys(obj.highlighted);\r\n\t\t\tfor (var i = 0; i < keys.length; i++) {\r\n\t\t\t\tvar x = obj.highlighted[i].getAttribute('data-x');\r\n\t\t\t\tvar y = obj.highlighted[i].getAttribute('data-y');\r\n\r\n\t\t\t\tif (obj.options.columns[x].type == 'checkbox' || obj.options.columns[x].type == 'radio') {\r\n\t\t\t\t\t// Update cell\r\n\t\t\t\t\trecords.push(obj.updateCell(x, y, ! obj.options.data[y][x]));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (records.length) {\r\n\t\t\t\t// Update history\r\n\t\t\t\tobj.setHistory({\r\n\t\t\t\t\taction:'setValue',\r\n\t\t\t\t\trecords:records,\r\n\t\t\t\t\tselection:obj.selectedCell,\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// On after changes\r\n\t\t\t\tobj.onafterchanges(el, records);\r\n\t\t\t}\r\n\t\t}\r\n\t\t/**\r\n\t\t * Strip tags\r\n\t\t */\r\n\t\tvar stripScript = function(a) {\r\n\t\t\tvar b = new Option;\r\n\t\t\tb.innerHTML = a;\r\n\t\t\tvar c = null;\r\n\t\t\tfor (a = b.getElementsByTagName('script'); c=a[0];) c.parentNode.removeChild(c);\r\n\t\t\treturn b.innerHTML;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Update cell content\r\n\t\t *\r\n\t\t * @param object cell\r\n\t\t * @return void\r\n\t\t */\r\n\t\tobj.updateCell = function(x, y, value, force) {\r\n\t\t\t// Changing value depending on the column type\r\n\t\t\tif (obj.records[y][x].classList.contains('readonly') == true && ! force) {\r\n\t\t\t\t// Do nothing\r\n\t\t\t\tvar record = {\r\n\t\t\t\t\tx: x,\r\n\t\t\t\t\ty: y,\r\n\t\t\t\t\tcol: x,\r\n\t\t\t\t\trow: y\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\t// Security\r\n\t\t\t\tif ((''+value).substr(0,1) == '=' && obj.options.secureFormulas == true) {\r\n\t\t\t\t\tvar val = secureFormula(value);\r\n\t\t\t\t\tif (val != value) {\r\n\t\t\t\t\t\t// Update the data container\r\n\t\t\t\t\t\tvalue = val;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// On change\r\n\t\t\t\tvar val = obj.dispatch('onbeforechange', el, obj.records[y][x], x, y, value);\r\n\r\n\t\t\t\t// If you return something this will overwrite the value\r\n\t\t\t\tif (val != undefined) {\r\n\t\t\t\t\tvalue = val;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (obj.options.columns[x].editor && typeof(obj.options.columns[x].editor.updateCell) == 'function') {\r\n\t\t\t\t\tvalue = obj.options.columns[x].editor.updateCell(obj.records[y][x], value, force);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// History format\r\n\t\t\t\tvar record = {\r\n\t\t\t\t\tx: x,\r\n\t\t\t\t\ty: y,\r\n\t\t\t\t\tcol: x,\r\n\t\t\t\t\trow: y,\r\n\t\t\t\t\tnewValue: value,\r\n\t\t\t\t\toldValue: obj.options.data[y][x],\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet editor = obj.options.columns[x].editor;\r\n\t\t\t\tif (editor) {\r\n\t\t\t\t\t// Update data and cell\r\n\t\t\t\t\tobj.options.data[y][x] = value;\r\n\t\t\t\t\tif (typeof(editor.setValue) === 'function') {\r\n\t\t\t\t\t\teditor.setValue(obj.records[y][x], value);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Native functions\r\n\t\t\t\t\tif (obj.options.columns[x].type == 'checkbox' || obj.options.columns[x].type == 'radio') {\r\n\t\t\t\t\t\t// Unchecked all options\r\n\t\t\t\t\t\tif (obj.options.columns[x].type == 'radio') {\r\n\t\t\t\t\t\t\tfor (var j = 0; j < obj.options.data.length; j++) {\r\n\t\t\t\t\t\t\t\tobj.options.data[j][x] = false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// Update data and cell\r\n\t\t\t\t\t\tobj.records[y][x].children[0].checked = (value == 1 || value == true || value == 'true' || value == 'TRUE') ? true : false;\r\n\t\t\t\t\t\tobj.options.data[y][x] = obj.records[y][x].children[0].checked;\r\n\t\t\t\t\t} else if (obj.options.columns[x].type == 'dropdown' || obj.options.columns[x].type == 'autocomplete') {\r\n\t\t\t\t\t\t// Update data and cell\r\n\t\t\t\t\t\tobj.options.data[y][x] = value;\r\n\t\t\t\t\t\tobj.records[y][x].textContent = obj.getDropDownValue(x, value);\r\n\t\t\t\t\t} else if (obj.options.columns[x].type == 'calendar') {\r\n\t\t\t\t\t\t// Try formatted date\r\n\t\t\t\t\t\tvar formatted = null;\r\n\t\t\t\t\t\tif (! validDate(value)) {\r\n\t\t\t\t\t\t\tvar tmp = jSuites.calendar.extractDateFromString(value, obj.options.columns[x].options.format);\r\n\t\t\t\t\t\t\tif (tmp) {\r\n\t\t\t\t\t\t\t\tformatted = tmp;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// Update data and cell\r\n\t\t\t\t\t\tobj.options.data[y][x] = value;\r\n\t\t\t\t\t\tobj.records[y][x].textContent = jSuites.calendar.getDateString(formatted ? formatted : value, obj.options.columns[x].options.format);\r\n\t\t\t\t\t} else if (obj.options.columns[x].type == 'color') {\r\n\t\t\t\t\t\t// Update color\r\n\t\t\t\t\t\tobj.options.data[y][x] = value;\r\n\t\t\t\t\t\t// Render\r\n\t\t\t\t\t\tif (obj.options.columns[x].render == 'square') {\r\n\t\t\t\t\t\t\tvar color = document.createElement('div');\r\n\t\t\t\t\t\t\tcolor.className = 'color';\r\n\t\t\t\t\t\t\tcolor.style.backgroundColor = value;\r\n\t\t\t\t\t\t\tobj.records[y][x].textContent = '';\r\n\t\t\t\t\t\t\tobj.records[y][x].appendChild(color);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tobj.records[y][x].style.color = value;\r\n\t\t\t\t\t\t\tobj.records[y][x].textContent = value;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (obj.options.columns[x].type == 'image') {\r\n\t\t\t\t\t\tvalue = ''+value;\r\n\t\t\t\t\t\tobj.options.data[y][x] = value;\r\n\t\t\t\t\t\tobj.records[y][x].innerHTML = '';\r\n\t\t\t\t\t\tif (value && value.substr(0, 10) == 'data:image') {\r\n\t\t\t\t\t\t\tvar img = document.createElement('img');\r\n\t\t\t\t\t\t\timg.src = value;\r\n\t\t\t\t\t\t\tobj.records[y][x].appendChild(img);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// Update data and cell\r\n\t\t\t\t\t\tobj.options.data[y][x] = value;\r\n\t\t\t\t\t\t// Label\r\n\t\t\t\t\t\tif (obj.options.columns[x].type == 'html') {\r\n\t\t\t\t\t\t\tobj.records[y][x].innerHTML = stripScript(obj.parseValue(x, y, value));\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tif (obj.options.stripHTML === false || obj.options.columns[x].stripHTML === false) {\r\n\t\t\t\t\t\t\t\tobj.records[y][x].innerHTML = stripScript(obj.parseValue(x, y, value, obj.records[y][x]));\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t// TablePress: Add a div container inside each cell.\r\n\t\t\t\t\t\t\t\t// obj.records[y][x].textContent = obj.parseValue(x, y, value, obj.records[y][x]);\r\n\t\t\t\t\t\t\t\tvar div = document.createElement('div');\r\n\t\t\t\t\t\t\t\tdiv.textContent = obj.parseValue(x, y, value, obj.records[y][x]);\r\n\t\t\t\t\t\t\t\tobj.records[y][x].textContent = '';\r\n\t\t\t\t\t\t\t\tobj.records[y][x].appendChild(div);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// Handle big text inside a cell\r\n\t\t\t\t\t\tif (obj.options.columns[x].wordWrap != false && (obj.options.wordWrap == true || obj.options.columns[x].wordWrap == true || obj.records[y][x].innerHTML.length > 200)) {\r\n\t\t\t\t\t\t\tobj.records[y][x].style.whiteSpace = 'pre-wrap';\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tobj.records[y][x].style.whiteSpace = '';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Overflow\r\n\t\t\t\tif (x > 0) {\r\n\t\t\t\t\tif (value) {\r\n\t\t\t\t\t\tobj.records[y][x-1].style.overflow = 'hidden';\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tobj.records[y][x-1].style.overflow = '';\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// On change\r\n\t\t\t\tobj.dispatch('onchange', el, (obj.records[y] && obj.records[y][x] ? obj.records[y][x] : null), x, y, value, record.oldValue);\r\n\t\t\t}\r\n\r\n\t\t\treturn record;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Helper function to copy data using the corner icon\r\n\t\t */\r\n\t\tobj.copyData = function(o, d) {\r\n\t\t\t// Get data from all selected cells\r\n\t\t\tvar data = obj.getData(true, true);\r\n\r\n\t\t\t// Selected cells\r\n\t\t\tvar h = obj.selectedContainer;\r\n\r\n\t\t\t// Cells\r\n\t\t\tvar x1 = parseInt(o.getAttribute('data-x'));\r\n\t\t\tvar y1 = parseInt(o.getAttribute('data-y'));\r\n\t\t\tvar x2 = parseInt(d.getAttribute('data-x'));\r\n\t\t\tvar y2 = parseInt(d.getAttribute('data-y'));\r\n\r\n\t\t\t// Records\r\n\t\t\tvar records = [];\r\n\t\t\tvar breakControl = false;\r\n\r\n\t\t\tif (h[0] == x1) {\r\n\t\t\t\t// Vertical copy\r\n\t\t\t\tif (y1 < h[1]) {\r\n\t\t\t\t\tvar rowNumber = y1 - h[1];\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvar rowNumber = 1;\r\n\t\t\t\t}\r\n\t\t\t\tvar colNumber = 0;\r\n\t\t\t} else {\r\n\t\t\t\tif (x1 < h[0]) {\r\n\t\t\t\t\tvar colNumber = x1 - h[0];\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvar colNumber = 1;\r\n\t\t\t\t}\r\n\t\t\t\tvar rowNumber = 0;\r\n\t\t\t}\r\n\r\n\t\t\t// Copy data procedure\r\n\t\t\tvar posx = 0;\r\n\t\t\tvar posy = 0;\r\n\r\n\t\t\tfor (var j = y1; j <= y2; j++) {\r\n\t\t\t\t// Skip hidden rows\r\n\t\t\t\tif (obj.rows[j] && obj.rows[j].style.display == 'none') {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Controls\r\n\t\t\t\tif (data[posy] == undefined) {\r\n\t\t\t\t\tposy = 0;\r\n\t\t\t\t}\r\n\t\t\t\tposx = 0;\r\n\r\n\t\t\t\t// Data columns\r\n\t\t\t\tif (h[0] != x1) {\r\n\t\t\t\t\tif (x1 < h[0]) {\r\n\t\t\t\t\t\tvar colNumber = x1 - h[0];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tvar colNumber = 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t// Data columns\r\n\t\t\t\tfor (var i = x1; i <= x2; i++) {\r\n\t\t\t\t\t// Update non-readonly\r\n\t\t\t\t\tif (obj.records[j][i] && ! obj.records[j][i].classList.contains('readonly') && obj.records[j][i].style.display != 'none' && breakControl == false) {\r\n\t\t\t\t\t\t// Stop if contains value\r\n\t\t\t\t\t\tif (! obj.selection.length) {\r\n\t\t\t\t\t\t\tif (obj.options.data[j][i] != '') {\r\n\t\t\t\t\t\t\t\tbreakControl = true;\r\n\t\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// Column\r\n\t\t\t\t\t\tif (data[posy] == undefined) {\r\n\t\t\t\t\t\t\tposx = 0;\r\n\t\t\t\t\t\t} else if (data[posy][posx] == undefined) {\r\n\t\t\t\t\t\t\tposx = 0;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// Value\r\n\t\t\t\t\t\tvar value = data[posy][posx];\r\n\r\n\t\t\t\t\t\tif (value && ! data[1] && obj.options.autoIncrement == true) {\r\n\t\t\t\t\t\t\tif (obj.options.columns[i].type == 'text' || obj.options.columns[i].type == 'number') {\r\n\t\t\t\t\t\t\t\tif ((''+value).substr(0,1) == '=') {\r\n\t\t\t\t\t\t\t\t\tvar tokens = value.match(/([A-Z]+[0-9]+)/g);\r\n\r\n\t\t\t\t\t\t\t\t\tif (tokens) {\r\n\t\t\t\t\t\t\t\t\t\tvar affectedTokens = [];\r\n\t\t\t\t\t\t\t\t\t\tfor (var index = 0; index < tokens.length; index++) {\r\n\t\t\t\t\t\t\t\t\t\t\tvar position = jexcel.getIdFromColumnName(tokens[index], 1);\r\n\t\t\t\t\t\t\t\t\t\t\tposition[0] += colNumber;\r\n\t\t\t\t\t\t\t\t\t\t\tposition[1] += rowNumber;\r\n\t\t\t\t\t\t\t\t\t\t\tif (position[1] < 0) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tposition[1] = 0;\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\tvar token = jexcel.getColumnNameFromId([position[0], position[1]]);\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tif (token != tokens[index]) {\r\n\t\t\t\t\t\t\t\t\t\t\t\taffectedTokens[tokens[index]] = token;\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t// Update formula\r\n\t\t\t\t\t\t\t\t\t\tif (affectedTokens) {\r\n\t\t\t\t\t\t\t\t\t\t\tvalue = obj.updateFormula(value, affectedTokens)\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tif (value == Number(value)) {\r\n\t\t\t\t\t\t\t\t\t\tvalue = Number(value) + rowNumber;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else if (obj.options.columns[i].type == 'calendar') {\r\n\t\t\t\t\t\t\t\tvar date = new Date(value);\r\n\t\t\t\t\t\t\t\tdate.setDate(date.getDate() + rowNumber);\r\n\t\t\t\t\t\t\t\tvalue = date.getFullYear() + '-' + jexcel.doubleDigitFormat(parseInt(date.getMonth() + 1)) + '-' + jexcel.doubleDigitFormat(date.getDate()) + ' ' + '00:00:00';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\trecords.push(obj.updateCell(i, j, value));\r\n\r\n\t\t\t\t\t\t// Update all formulas in the chain\r\n\t\t\t\t\t\tobj.updateFormulaChain(i, j, records);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tposx++;\r\n\t\t\t\t\tif (h[0] != x1) {\r\n\t\t\t\t\t\tcolNumber++;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tposy++;\r\n\t\t\t\trowNumber++;\r\n\t\t\t}\r\n\r\n\t\t\t// Update history\r\n\t\t\tobj.setHistory({\r\n\t\t\t\taction:'setValue',\r\n\t\t\t\trecords:records,\r\n\t\t\t\tselection:obj.selectedCell,\r\n\t\t\t});\r\n\r\n\t\t\t// Update table with custom configuration if applicable\r\n\t\t\tobj.updateTable();\r\n\r\n\t\t\t// On after changes\r\n\t\t\tobj.onafterchanges(el, records);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Refresh current selection\r\n\t\t */\r\n\t\tobj.refreshSelection = function() {\r\n\t\t\tif (obj.selectedCell) {\r\n\t\t\t\tobj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Move coords to A1 in case overlaps with an excluded cell\r\n\t\t */\r\n\t\tobj.conditionalSelectionUpdate = function(type, o, d) {\r\n\t\t\tif (type == 1) {\r\n\t\t\t\tif (obj.selectedCell && ((o >= obj.selectedCell[1] && o <= obj.selectedCell[3]) || (d >= obj.selectedCell[1] && d <= obj.selectedCell[3]))) {\r\n\t\t\t\t\tobj.resetSelection();\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (obj.selectedCell && ((o >= obj.selectedCell[0] && o <= obj.selectedCell[2]) || (d >= obj.selectedCell[0] && d <= obj.selectedCell[2]))) {\r\n\t\t\t\t\tobj.resetSelection();\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Clear table selection\r\n\t\t */\r\n\t\tobj.resetSelection = function(blur) {\r\n\t\t\t// Remove style\r\n\t\t\tif (! obj.highlighted.length) {\r\n\t\t\t\tvar previousStatus = 0;\r\n\t\t\t} else {\r\n\t\t\t\tvar previousStatus = 1;\r\n\r\n\t\t\t\tfor (var i = 0; i < obj.highlighted.length; i++) {\r\n\t\t\t\t\tobj.highlighted[i].classList.remove('highlight');\r\n\t\t\t\t\tobj.highlighted[i].classList.remove('highlight-left');\r\n\t\t\t\t\tobj.highlighted[i].classList.remove('highlight-right');\r\n\t\t\t\t\tobj.highlighted[i].classList.remove('highlight-top');\r\n\t\t\t\t\tobj.highlighted[i].classList.remove('highlight-bottom');\r\n\t\t\t\t\tobj.highlighted[i].classList.remove('highlight-selected');\r\n\r\n\t\t\t\t\tvar px = parseInt(obj.highlighted[i].getAttribute('data-x'));\r\n\t\t\t\t\tvar py = parseInt(obj.highlighted[i].getAttribute('data-y'));\r\n\r\n\t\t\t\t\t// Check for merged cells\r\n\t\t\t\t\tif (obj.highlighted[i].getAttribute('data-merged')) {\r\n\t\t\t\t\t\tvar colspan = parseInt(obj.highlighted[i].getAttribute('colspan'));\r\n\t\t\t\t\t\tvar rowspan = parseInt(obj.highlighted[i].getAttribute('rowspan'));\r\n\t\t\t\t\t\tvar ux = colspan > 0 ? px + (colspan - 1) : px;\r\n\t\t\t\t\t\tvar uy = rowspan > 0 ? py + (rowspan - 1): py;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tvar ux = px;\r\n\t\t\t\t\t\tvar uy = py;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Remove selected from headers\r\n\t\t\t\t\tfor (var j = px; j <= ux; j++) {\r\n\t\t\t\t\t\tif (obj.headers[j]) {\r\n\t\t\t\t\t\t\tobj.headers[j].classList.remove('selected');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Remove selected from rows\r\n\t\t\t\t\tfor (var j = py; j <= uy; j++) {\r\n\t\t\t\t\t\tif (obj.rows[j]) {\r\n\t\t\t\t\t\t\tobj.rows[j].classList.remove('selected');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Reset highlighted cells\r\n\t\t\tobj.highlighted = [];\r\n\r\n\t\t\t// Reset\r\n\t\t\tobj.selectedCell = null;\r\n\r\n\t\t\t// Hide corner\r\n\t\t\tobj.corner.style.top = '-2000px';\r\n\t\t\tobj.corner.style.left = '-2000px';\r\n\r\n\t\t\tif (blur == true && previousStatus == 1) {\r\n\t\t\t\tobj.dispatch('onblur', el);\r\n\t\t\t}\r\n\r\n\t\t\treturn previousStatus;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Update selection based on two cells\r\n\t\t */\r\n\t\tobj.updateSelection = function(el1, el2, origin) {\r\n\t\t\tvar x1 = el1.getAttribute('data-x');\r\n\t\t\tvar y1 = el1.getAttribute('data-y');\r\n\t\t\tif (el2) {\r\n\t\t\t\tvar x2 = el2.getAttribute('data-x');\r\n\t\t\t\tvar y2 = el2.getAttribute('data-y');\r\n\t\t\t} else {\r\n\t\t\t\tvar x2 = x1;\r\n\t\t\t\tvar y2 = y1;\r\n\t\t\t}\r\n\r\n\t\t\tobj.updateSelectionFromCoords(x1, y1, x2, y2, origin);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Update selection from coords\r\n\t\t */\r\n\t\tobj.updateSelectionFromCoords = function(x1, y1, x2, y2, origin) {\r\n\t\t\t// Reset Selection\r\n\t\t\tvar updated = null;\r\n\t\t\tvar previousState = obj.resetSelection();\r\n\r\n\t\t\t// select column\r\n\t\t\tif (y1 == null) {\r\n\t\t\t\ty1 = 0;\r\n\t\t\t\ty2 = obj.rows.length - 1;\r\n\t\t\t}\r\n\r\n\t\t\t// Same element\r\n\t\t\tif (x2 == null) {\r\n\t\t\t\tx2 = x1;\r\n\t\t\t}\r\n\t\t\tif (y2 == null) {\r\n\t\t\t\ty2 = y1;\r\n\t\t\t}\r\n\r\n\t\t\t// Selection must be within the existing data\r\n\t\t\tif (x1 >= obj.headers.length) {\r\n\t\t\t\tx1 = obj.headers.length - 1;\r\n\t\t\t}\r\n\t\t\tif (y1 >= obj.rows.length) {\r\n\t\t\t\ty1 = obj.rows.length - 1;\r\n\t\t\t}\r\n\t\t\tif (x2 >= obj.headers.length) {\r\n\t\t\t\tx2 = obj.headers.length - 1;\r\n\t\t\t}\r\n\t\t\tif (y2 >= obj.rows.length) {\r\n\t\t\t\ty2 = obj.rows.length - 1;\r\n\t\t\t}\r\n\r\n\t\t\t// Keep selected cell\r\n\t\t\tobj.selectedCell = [x1, y1, x2, y2];\r\n\r\n\t\t\t// Select cells\r\n\t\t\tif (x1 != null) {\r\n\t\t\t\t// Add selected cell\r\n\t\t\t\tif (obj.records[y1][x1]) {\r\n\t\t\t\t\tobj.records[y1][x1].classList.add('highlight-selected');\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Origin & Destination\r\n\t\t\t\tif (parseInt(x1) < parseInt(x2)) {\r\n\t\t\t\t\tvar px = parseInt(x1);\r\n\t\t\t\t\tvar ux = parseInt(x2);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvar px = parseInt(x2);\r\n\t\t\t\t\tvar ux = parseInt(x1);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (parseInt(y1) < parseInt(y2)) {\r\n\t\t\t\t\tvar py = parseInt(y1);\r\n\t\t\t\t\tvar uy = parseInt(y2);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvar py = parseInt(y2);\r\n\t\t\t\t\tvar uy = parseInt(y1);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Verify merged columns\r\n\t\t\t\tfor (var i = px; i <= ux; i++) {\r\n\t\t\t\t\tfor (var j = py; j <= uy; j++) {\r\n\t\t\t\t\t\tif (obj.records[j][i] && obj.records[j][i].getAttribute('data-merged')) {\r\n\t\t\t\t\t\t\tvar x = parseInt(obj.records[j][i].getAttribute('data-x'));\r\n\t\t\t\t\t\t\tvar y = parseInt(obj.records[j][i].getAttribute('data-y'));\r\n\t\t\t\t\t\t\tvar colspan = parseInt(obj.records[j][i].getAttribute('colspan'));\r\n\t\t\t\t\t\t\tvar rowspan = parseInt(obj.records[j][i].getAttribute('rowspan'));\r\n\r\n\t\t\t\t\t\t\tif (colspan > 1) {\r\n\t\t\t\t\t\t\t\tif (x < px) {\r\n\t\t\t\t\t\t\t\t\tpx = x;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (x + colspan > ux) {\r\n\t\t\t\t\t\t\t\t\tux = x + colspan - 1;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif (rowspan) {\r\n\t\t\t\t\t\t\t\tif (y < py) {\r\n\t\t\t\t\t\t\t\t\tpy = y;\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (y + rowspan > uy) {\r\n\t\t\t\t\t\t\t\t\tuy = y + rowspan - 1;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Limits\r\n\t\t\t\tvar borderLeft = null;\r\n\t\t\t\tvar borderRight = null;\r\n\t\t\t\tvar borderTop = null;\r\n\t\t\t\tvar borderBottom = null;\r\n\r\n\t\t\t\t// Vertical limits\r\n\t\t\t\tfor (var j = py; j <= uy; j++) {\r\n\t\t\t\t\tif (obj.rows[j].style.display != 'none') {\r\n\t\t\t\t\t\tif (borderTop == null) {\r\n\t\t\t\t\t\t\tborderTop = j;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tborderBottom = j;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Redefining styles\r\n\t\t\t\tfor (var i = px; i <= ux; i++) {\r\n\t\t\t\t\tfor (var j = py; j <= uy; j++) {\r\n\t\t\t\t\t\tif (obj.rows[j].style.display != 'none' && obj.records[j][i].style.display != 'none') {\r\n\t\t\t\t\t\t\tobj.records[j][i].classList.add('highlight');\r\n\t\t\t\t\t\t\tobj.highlighted.push(obj.records[j][i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Horizontal limits\r\n\t\t\t\t\tif (obj.options.columns[i].type != 'hidden') {\r\n\t\t\t\t\t\tif (borderLeft == null) {\r\n\t\t\t\t\t\t\tborderLeft = i;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tborderRight = i;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Create borders\r\n\t\t\t\tif (! borderLeft) {\r\n\t\t\t\t\tborderLeft = 0;\r\n\t\t\t\t}\r\n\t\t\t\tif (! borderRight) {\r\n\t\t\t\t\tborderRight = 0;\r\n\t\t\t\t}\r\n\t\t\t\tfor (var i = borderLeft; i <= borderRight; i++) {\r\n\t\t\t\t\tif (obj.options.columns[i].type != 'hidden' && obj.colgroup[i].style && obj.colgroup[i].style.display != 'none') {\r\n\t\t\t\t\t\t// Top border\r\n\t\t\t\t\t\tif (obj.records[borderTop] && obj.records[borderTop][i]) {\r\n\t\t\t\t\t\t\tobj.records[borderTop][i].classList.add('highlight-top');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// Bottom border\r\n\t\t\t\t\t\tif (obj.records[borderBottom] && obj.records[borderBottom][i]) {\r\n\t\t\t\t\t\t\tobj.records[borderBottom][i].classList.add('highlight-bottom');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// Add selected from headers\r\n\t\t\t\t\t\tobj.headers[i].classList.add('selected');\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor (var j = borderTop; j <= borderBottom; j++) {\r\n\t\t\t\t\tif (obj.rows[j] && obj.rows[j].style.display != 'none') {\r\n\t\t\t\t\t\t// Left border\r\n\t\t\t\t\t\tobj.records[j][borderLeft].classList.add('highlight-left');\r\n\t\t\t\t\t\t// Right border\r\n\t\t\t\t\t\tobj.records[j][borderRight].classList.add('highlight-right');\r\n\t\t\t\t\t\t// Add selected from rows\r\n\t\t\t\t\t\tobj.rows[j].classList.add('selected');\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tobj.selectedContainer = [ borderLeft, borderTop, borderRight, borderBottom ];\r\n\t\t\t}\r\n\r\n\t\t\t// Handle events\r\n\t\t\tif (previousState == 0) {\r\n\t\t\t\tobj.dispatch('onfocus', el);\r\n\r\n\t\t\t\tobj.removeCopyingSelection();\r\n\t\t\t}\r\n\r\n\t\t\tobj.dispatch('onselection', el, borderLeft, borderTop, borderRight, borderBottom, origin);\r\n\r\n\t\t\t// Find corner cell\r\n\t\t\tobj.updateCornerPosition();\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Remove copy selection\r\n\t\t *\r\n\t\t * @return void\r\n\t\t */\r\n\t\tobj.removeCopySelection = function() {\r\n\t\t\t// Remove current selection\r\n\t\t\tfor (var i = 0; i < obj.selection.length; i++) {\r\n\t\t\t\tobj.selection[i].classList.remove('selection');\r\n\t\t\t\tobj.selection[i].classList.remove('selection-left');\r\n\t\t\t\tobj.selection[i].classList.remove('selection-right');\r\n\t\t\t\tobj.selection[i].classList.remove('selection-top');\r\n\t\t\t\tobj.selection[i].classList.remove('selection-bottom');\r\n\t\t\t}\r\n\r\n\t\t\tobj.selection = [];\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Update copy selection\r\n\t\t *\r\n\t\t * @param int x, y\r\n\t\t * @return void\r\n\t\t */\r\n\t\tobj.updateCopySelection = function(x3, y3) {\r\n\t\t\t// Remove selection\r\n\t\t\tobj.removeCopySelection();\r\n\r\n\t\t\t// Get elements first and last\r\n\t\t\tvar x1 = obj.selectedContainer[0];\r\n\t\t\tvar y1 = obj.selectedContainer[1];\r\n\t\t\tvar x2 = obj.selectedContainer[2];\r\n\t\t\tvar y2 = obj.selectedContainer[3];\r\n\r\n\t\t\tif (x3 != null && y3 != null) {\r\n\t\t\t\tif (x3 - x2 > 0) {\r\n\t\t\t\t\tvar px = parseInt(x2) + 1;\r\n\t\t\t\t\tvar ux = parseInt(x3);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvar px = parseInt(x3);\r\n\t\t\t\t\tvar ux = parseInt(x1) - 1;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (y3 - y2 > 0) {\r\n\t\t\t\t\tvar py = parseInt(y2) + 1;\r\n\t\t\t\t\tvar uy = parseInt(y3);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvar py = parseInt(y3);\r\n\t\t\t\t\tvar uy = parseInt(y1) - 1;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (ux - px <= uy - py) {\r\n\t\t\t\t\tvar px = parseInt(x1);\r\n\t\t\t\t\tvar ux = parseInt(x2);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvar py = parseInt(y1);\r\n\t\t\t\t\tvar uy = parseInt(y2);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor (var j = py; j <= uy; j++) {\r\n\t\t\t\t\tfor (var i = px; i <= ux; i++) {\r\n\t\t\t\t\t\tif (obj.records[j][i] && obj.rows[j].style.display != 'none' && obj.records[j][i].style.display != 'none') {\r\n\t\t\t\t\t\t\tobj.records[j][i].classList.add('selection');\r\n\t\t\t\t\t\t\tobj.records[py][i].classList.add('selection-top');\r\n\t\t\t\t\t\t\tobj.records[uy][i].classList.add('selection-bottom');\r\n\t\t\t\t\t\t\tobj.records[j][px].classList.add('selection-left');\r\n\t\t\t\t\t\t\tobj.records[j][ux].classList.add('selection-right');\r\n\r\n\t\t\t\t\t\t\t// Persist selected elements\r\n\t\t\t\t\t\t\tobj.selection.push(obj.records[j][i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Update corner position\r\n\t\t *\r\n\t\t * @return void\r\n\t\t */\r\n\t\tobj.updateCornerPosition = function() {\r\n\t\t\t// If any selected cells\r\n\t\t\tif (! obj.highlighted.length) {\r\n\t\t\t\tobj.corner.style.top = '-2000px';\r\n\t\t\t\tobj.corner.style.left = '-2000px';\r\n\t\t\t} else {\r\n\t\t\t\t// Get last cell\r\n\t\t\t\tvar last = obj.highlighted[obj.highlighted.length-1];\r\n\t\t\t\tvar lastX = last.getAttribute('data-x');\r\n\r\n\t\t\t\tvar contentRect = obj.content.getBoundingClientRect();\r\n\t\t\t\tvar x1 = contentRect.left;\r\n\t\t\t\tvar y1 = contentRect.top;\r\n\r\n\t\t\t\tvar lastRect = last.getBoundingClientRect();\r\n\t\t\t\tvar x2 = lastRect.left;\r\n\t\t\t\tvar y2 = lastRect.top;\r\n\t\t\t\tvar w2 = lastRect.width;\r\n\t\t\t\tvar h2 = lastRect.height;\r\n\r\n\t\t\t\tvar x = (x2 - x1) + obj.content.scrollLeft + w2 - 4;\r\n\t\t\t\tvar y = (y2 - y1) + obj.content.scrollTop + h2 - 4;\r\n\r\n\t\t\t\t// Place the corner in the correct place\r\n\t\t\t\tobj.corner.style.top = y + 'px';\r\n\t\t\t\tobj.corner.style.left = x + 'px';\r\n\r\n\t\t\t\tif (obj.options.freezeColumns) {\r\n\t\t\t\t\tvar width = obj.getFreezeWidth();\r\n\t\t\t\t\t// Only check if the last column is not part of the merged cells\r\n\t\t\t\t\tif (lastX > obj.options.freezeColumns-1 && x2 - x1 + w2 < width) {\r\n\t\t\t\t\t\tobj.corner.style.display = 'none';\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (obj.options.selectionCopy == true) {\r\n\t\t\t\t\t\t\tobj.corner.style.display = '';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (obj.options.selectionCopy == true) {\r\n\t\t\t\t\t\tobj.corner.style.display = '';\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Update scroll position based on the selection\r\n\t\t */\r\n\t\tobj.updateScroll = function(direction) {\r\n\t\t\t// Jspreadsheet Container information\r\n\t\t\tvar contentRect = obj.content.getBoundingClientRect();\r\n\t\t\tvar x1 = contentRect.left;\r\n\t\t\tvar y1 = contentRect.top;\r\n\t\t\tvar w1 = contentRect.width;\r\n\t\t\tvar h1 = contentRect.height;\r\n\r\n\t\t\t// Direction Left or Up\r\n\t\t\tvar reference = obj.records[obj.selectedCell[3]][obj.selectedCell[2]];\r\n\r\n\t\t\t// Reference\r\n\t\t\tvar referenceRect = reference.getBoundingClientRect();\r\n\t\t\tvar x2 = referenceRect.left;\r\n\t\t\tvar y2 = referenceRect.top;\r\n\t\t\tvar w2 = referenceRect.width;\r\n\t\t\tvar h2 = referenceRect.height;\r\n\r\n\t\t\t// Direction\r\n\t\t\tif (direction == 0 || direction == 1) {\r\n\t\t\t\tvar x = (x2 - x1) + obj.content.scrollLeft;\r\n\t\t\t\tvar y = (y2 - y1) + obj.content.scrollTop - 2;\r\n\t\t\t} else {\r\n\t\t\t\tvar x = (x2 - x1) + obj.content.scrollLeft + w2;\r\n\t\t\t\tvar y = (y2 - y1) + obj.content.scrollTop + h2;\r\n\t\t\t}\r\n\r\n\t\t\t// Top position check\r\n\t\t\tif (y > (obj.content.scrollTop + 30) && y < (obj.content.scrollTop + h1)) {\r\n\t\t\t\t// In the viewport\r\n\t\t\t} else {\r\n\t\t\t\t// Out of viewport\r\n\t\t\t\tif (y < obj.content.scrollTop + 30) {\r\n\t\t\t\t\tobj.content.scrollTop = y - h2;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tobj.content.scrollTop = y - (h1 - 2);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Freeze columns?\r\n\t\t\tvar freezed = obj.getFreezeWidth();\r\n\r\n\t\t\t// Left position check - TODO: change that to the bottom border of the element\r\n\t\t\tif (x > (obj.content.scrollLeft + freezed) && x < (obj.content.scrollLeft + w1)) {\r\n\t\t\t\t// In the viewport\r\n\t\t\t} else {\r\n\t\t\t\t// Out of viewport\r\n\t\t\t\tif (x < obj.content.scrollLeft + 30) {\r\n\t\t\t\t\tobj.content.scrollLeft = x;\r\n\t\t\t\t\tif (obj.content.scrollLeft < 50) {\r\n\t\t\t\t\t\tobj.content.scrollLeft = 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (x < obj.content.scrollLeft + freezed) {\r\n\t\t\t\t\tobj.content.scrollLeft = x - freezed - 1;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tobj.content.scrollLeft = x - (w1 - 20);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Get the column width\r\n\t\t *\r\n\t\t * @param int column column number (first column is: 0)\r\n\t\t * @return int current width\r\n\t\t */\r\n\t\tobj.getWidth = function(column) {\r\n\t\t\tif (typeof column === 'undefined') {\r\n\t\t\t\t// Get all headers\r\n\t\t\t\tvar data = [];\r\n\t\t\t\tfor (var i = 0; i < obj.headers.length; i++) {\r\n\t\t\t\t\tdata.push(obj.options.columns[i].width);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\t// In case the column is an object\r\n\t\t\t\tif (typeof(column) == 'object') {\r\n\t\t\t\t\tcolumn = column.getAttribute('data-x');\r\n\t\t\t\t}\r\n\r\n\t\t\t\tdata = obj.colgroup[column].getAttribute('width')\r\n\t\t\t}\r\n\r\n\t\t\treturn data;\r\n\t\t}\r\n\r\n\r\n\t\t/**\r\n\t\t * Set the column width\r\n\t\t *\r\n\t\t * @param int column number (first column is: 0)\r\n\t\t * @param int new column width\r\n\t\t * @param int old column width\r\n\t\t */\r\n\t\tobj.setWidth = function (column, width, oldWidth) {\r\n\t\t\tif (width) {\r\n\t\t\t\tif (Array.isArray(column)) {\r\n\t\t\t\t\t// Oldwidth\r\n\t\t\t\t\tif (! oldWidth) {\r\n\t\t\t\t\t\tvar oldWidth = [];\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// Set width\r\n\t\t\t\t\tfor (var i = 0; i < column.length; i++) {\r\n\t\t\t\t\t\tif (! oldWidth[i]) {\r\n\t\t\t\t\t\t\toldWidth[i] = obj.colgroup[column[i]].getAttribute('width');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar w = Array.isArray(width) && width[i] ? width[i] : width;\r\n\t\t\t\t\t\tobj.colgroup[column[i]].setAttribute('width', w);\r\n\t\t\t\t\t\tobj.options.columns[column[i]].width = w;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Oldwidth\r\n\t\t\t\t\tif (! oldWidth) {\r\n\t\t\t\t\t\toldWidth = obj.colgroup[column].getAttribute('width');\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// Set width\r\n\t\t\t\t\tobj.colgroup[column].setAttribute('width', width);\r\n\t\t\t\t\tobj.options.columns[column].width = width;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Keeping history of changes\r\n\t\t\t\tobj.setHistory({\r\n\t\t\t\t\taction:'setWidth',\r\n\t\t\t\t\tcolumn:column,\r\n\t\t\t\t\toldValue:oldWidth,\r\n\t\t\t\t\tnewValue:width,\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// On resize column\r\n\t\t\t\tobj.dispatch('onresizecolumn', el, column, width, oldWidth);\r\n\r\n\t\t\t\t// Update corner position\r\n\t\t\t\tobj.updateCornerPosition();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Set the row height\r\n\t\t *\r\n\t\t * @param row - row number (first row is: 0)\r\n\t\t * @param height - new row height\r\n\t\t * @param oldHeight - old row height\r\n\t\t */\r\n\t\tobj.setHeight = function (row, height, oldHeight) {\r\n\t\t\tif (height > 0) {\r\n\t\t\t\t// In case the column is an object\r\n\t\t\t\tif (typeof(row) == 'object') {\r\n\t\t\t\t\trow = row.getAttribute('data-y');\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Oldwidth\r\n\t\t\t\tif (! oldHeight) {\r\n\t\t\t\t\toldHeight = obj.rows[row].getAttribute('height');\r\n\r\n\t\t\t\t\tif (! oldHeight) {\r\n\t\t\t\t\t\tvar rect = obj.rows[row].getBoundingClientRect();\r\n\t\t\t\t\t\toldHeight = rect.height;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Integer\r\n\t\t\t\theight = parseInt(height);\r\n\r\n\t\t\t\t// TablePress: Add a custom CSS variable to adjust the number of shown lines of text to the row height.\r\n\t\t\t\tobj.rows[row].style.setProperty( '--table-editor-line-clamp', Math.floor( (height-10) / 14 ) );\r\n\r\n\t\t\t\t// Set width\r\n\t\t\t\t// TablePress: Don't set the row height as a CSS property. This makes the resizing behavior lose its preview when making a row smaller.\r\n\t\t\t\t//obj.rows[row].style.height = height + 'px';\r\n\r\n\t\t\t\t// Keep options updated\r\n\t\t\t\tif (! obj.options.rows[row]) {\r\n\t\t\t\t\tobj.options.rows[row] = {};\r\n\t\t\t\t}\r\n\t\t\t\tobj.options.rows[row].height = height;\r\n\r\n\t\t\t\t// Keeping history of changes\r\n\t\t\t\tobj.setHistory({\r\n\t\t\t\t\taction:'setHeight',\r\n\t\t\t\t\trow:row,\r\n\t\t\t\t\toldValue:oldHeight,\r\n\t\t\t\t\tnewValue:height,\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// On resize column\r\n\t\t\t\tobj.dispatch('onresizerow', el, row, height, oldHeight);\r\n\r\n\t\t\t\t// Update corner position\r\n\t\t\t\tobj.updateCornerPosition();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Get the row height\r\n\t\t *\r\n\t\t * @param row - row number (first row is: 0)\r\n\t\t * @return height - current row height\r\n\t\t */\r\n\t\tobj.getHeight = function(row) {\r\n\t\t\tif (typeof row === 'undefined') {\r\n\t\t\t\t// Get height of all rows\r\n\t\t\t\tvar data = [];\r\n\t\t\t\tfor (var j = 0; j < obj.rows.length; j++) {\r\n\t\t\t\t\tvar h = obj.rows[j].style.height;\r\n\t\t\t\t\tif (h) {\r\n\t\t\t\t\t\tdata[j] = h;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\t// In case the row is an object\r\n\t\t\t\tif (typeof(row) == 'object') {\r\n\t\t\t\t\trow = $(row).getAttribute('data-y');\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar data = obj.rows[row].style.height;\r\n\t\t\t}\r\n\r\n\t\t\treturn data;\r\n\t\t}\r\n\r\n\t\tobj.setFooter = function(data) {\r\n\t\t\tif (data) {\r\n\t\t\t\tobj.options.footers = data;\r\n\t\t\t}\r\n\r\n\t\t\tif (obj.options.footers) {\r\n\t\t\t\tif (! obj.tfoot) {\r\n\t\t\t\t\tobj.tfoot = document.createElement('tfoot');\r\n\t\t\t\t\tobj.table.appendChild(obj.tfoot);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor (var j = 0; j < obj.options.footers.length; j++) {\r\n\t\t\t\t\tif (obj.tfoot.children[j]) {\r\n\t\t\t\t\t\tvar tr = obj.tfoot.children[j];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tvar tr = document.createElement('tr');\r\n\t\t\t\t\t\tvar td = document.createElement('td');\r\n\t\t\t\t\t\ttr.appendChild(td);\r\n\t\t\t\t\t\tobj.tfoot.appendChild(tr);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor (var i = 0; i < obj.headers.length; i++) {\r\n\t\t\t\t\t\tif (! obj.options.footers[j][i]) {\r\n\t\t\t\t\t\t\tobj.options.footers[j][i] = '';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (obj.tfoot.children[j].children[i+1]) {\r\n\t\t\t\t\t\t\tvar td = obj.tfoot.children[j].children[i+1];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tvar td = document.createElement('td');\r\n\t\t\t\t\t\t\ttr.appendChild(td);\r\n\r\n\t\t\t\t\t\t\t// Text align\r\n\t\t\t\t\t\t\tvar colAlign = obj.options.columns[i].align ? obj.options.columns[i].align : 'center';\r\n\t\t\t\t\t\t\ttd.style.textAlign = colAlign;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\ttd.textContent = obj.parseValue(+obj.records.length + i, j, obj.options.footers[j][i]);\r\n\r\n\t\t\t\t\t\t// Hide/Show with hideColumn()/showColumn()\r\n\t\t\t\t\t\ttd.style.display = obj.colgroup[i].style.display;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Get the column title\r\n\t\t *\r\n\t\t * @param column - column number (first column is: 0)\r\n\t\t * @param title - new column title\r\n\t\t */\r\n\t\tobj.getHeader = function(column) {\r\n\t\t\treturn obj.headers[column].textContent;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Set the column title\r\n\t\t *\r\n\t\t * @param column - column number (first column is: 0)\r\n\t\t * @param title - new column title\r\n\t\t */\r\n\t\tobj.setHeader = function(column, newValue) {\r\n\t\t\tif (obj.headers[column]) {\r\n\t\t\t\tvar oldValue = obj.headers[column].textContent;\r\n\r\n\t\t\t\tif (! newValue) {\r\n\t\t\t\t\tnewValue = prompt(obj.options.text.columnName, oldValue)\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (newValue) {\r\n\t\t\t\t\tobj.headers[column].textContent = newValue;\r\n\t\t\t\t\t// Keep the title property\r\n\t\t\t\t\tobj.headers[column].setAttribute('title', newValue);\r\n\t\t\t\t\t// Update title\r\n\t\t\t\t\tobj.options.columns[column].title = newValue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tobj.setHistory({\r\n\t\t\t\t\taction: 'setHeader',\r\n\t\t\t\t\tcolumn: column,\r\n\t\t\t\t\toldValue: oldValue,\r\n\t\t\t\t\tnewValue: newValue\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// On onchange header\r\n\t\t\t\tobj.dispatch('onchangeheader', el, column, oldValue, newValue);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Get the headers\r\n\t\t *\r\n\t\t * @param asArray\r\n\t\t * @return mixed\r\n\t\t */\r\n\t\tobj.getHeaders = function (asArray) {\r\n\t\t\tvar title = [];\r\n\r\n\t\t\tfor (var i = 0; i < obj.headers.length; i++) {\r\n\t\t\t\ttitle.push(obj.getHeader(i));\r\n\t\t\t}\r\n\r\n\t\t\treturn asArray ? title : title.join(obj.options.csvDelimiter);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Get meta information from cell(s)\r\n\t\t *\r\n\t\t * @return integer\r\n\t\t */\r\n\t\tobj.getMeta = function(cell, key) {\r\n\t\t\tif (! cell) {\r\n\t\t\t\treturn obj.options.meta;\r\n\t\t\t} else {\r\n\t\t\t\tif (key) {\r\n\t\t\t\t\treturn obj.options.meta[cell] && obj.options.meta[cell][key] ? obj.options.meta[cell][key] : null;\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn obj.options.meta[cell] ? obj.options.meta[cell] : null;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Set meta information to cell(s)\r\n\t\t *\r\n\t\t * @return integer\r\n\t\t */\r\n\t\tobj.setMeta = function(o, k, v) {\r\n\t\t\tif (! obj.options.meta) {\r\n\t\t\t\tobj.options.meta = {}\r\n\t\t\t}\r\n\r\n\t\t\tif (k && v) {\r\n\t\t\t\t// Set data value\r\n\t\t\t\tif (! obj.options.meta[o]) {\r\n\t\t\t\t\tobj.options.meta[o] = {};\r\n\t\t\t\t}\r\n\t\t\t\tobj.options.meta[o][k] = v;\r\n\t\t\t} else {\r\n\t\t\t\t// Apply that for all cells\r\n\t\t\t\tvar keys = Object.keys(o);\r\n\t\t\t\tfor (var i = 0; i < keys.length; i++) {\r\n\t\t\t\t\tif (! obj.options.meta[keys[i]]) {\r\n\t\t\t\t\t\tobj.options.meta[keys[i]] = {};\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar prop = Object.keys(o[keys[i]]);\r\n\t\t\t\t\tfor (var j = 0; j < prop.length; j++) {\r\n\t\t\t\t\t\tobj.options.meta[keys[i]][prop[j]] = o[keys[i]][prop[j]];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tobj.dispatch('onchangemeta', el, o, k, v);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Update meta information\r\n\t\t *\r\n\t\t * @return integer\r\n\t\t */\r\n\t\tobj.updateMeta = function(affectedCells) {\r\n\t\t\tif (obj.options.meta) {\r\n\t\t\t\tvar newMeta = {};\r\n\t\t\t\tvar keys = Object.keys(obj.options.meta);\r\n\t\t\t\tfor (var i = 0; i < keys.length; i++) {\r\n\t\t\t\t\tif (affectedCells[keys[i]]) {\r\n\t\t\t\t\t\tnewMeta[affectedCells[keys[i]]] = obj.options.meta[keys[i]];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tnewMeta[keys[i]] = obj.options.meta[keys[i]];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t// Update meta information\r\n\t\t\t\tobj.options.meta = newMeta;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Get style information from cell(s)\r\n\t\t *\r\n\t\t * @return integer\r\n\t\t */\r\n\t\tobj.getStyle = function(cell, key) {\r\n\t\t\t// Cell\r\n\t\t\tif (! cell) {\r\n\t\t\t\t// Control vars\r\n\t\t\t\tvar data = {};\r\n\r\n\t\t\t\t// Column and row length\r\n\t\t\t\tvar x = obj.options.data[0].length;\r\n\t\t\t\tvar y = obj.options.data.length;\r\n\r\n\t\t\t\t// Go through the columns to get the data\r\n\t\t\t\tfor (var j = 0; j < y; j++) {\r\n\t\t\t\t\tfor (var i = 0; i < x; i++) {\r\n\t\t\t\t\t\t// Value\r\n\t\t\t\t\t\tvar v = key ? obj.records[j][i].style[key] : obj.records[j][i].getAttribute('style');\r\n\r\n\t\t\t\t\t\t// Any meta data for this column?\r\n\t\t\t\t\t\tif (v) {\r\n\t\t\t\t\t\t\t// Column name\r\n\t\t\t\t\t\t\tvar k = jexcel.getColumnNameFromId([i, j]);\r\n\t\t\t\t\t\t\t// Value\r\n\t\t\t\t\t\t\tdata[k] = v;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn data;\r\n\t\t\t} else {\r\n\t\t\t\tcell = jexcel.getIdFromColumnName(cell, true);\r\n\r\n\t\t\t\treturn key ? obj.records[cell[1]][cell[0]].style[key] : obj.records[cell[1]][cell[0]].getAttribute('style');\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tobj.resetStyle = function(o, ignoreHistoryAndEvents) {\r\n\t\t\tvar keys = Object.keys(o);\r\n\t\t\tfor (var i = 0; i < keys.length; i++) {\r\n\t\t\t\t// Position\r\n\t\t\t\tvar cell = jexcel.getIdFromColumnName(keys[i], true);\r\n\t\t\t\tif (obj.records[cell[1]] && obj.records[cell[1]][cell[0]]) {\r\n\t\t\t\t\tobj.records[cell[1]][cell[0]].setAttribute('style', '');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tobj.setStyle(o, null, null, null, ignoreHistoryAndEvents);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Set meta information to cell(s)\r\n\t\t *\r\n\t\t * @return integer\r\n\t\t */\r\n\t\tobj.setStyle = function(o, k, v, force, ignoreHistoryAndEvents) {\r\n\t\t\tvar newValue = {};\r\n\t\t\tvar oldValue = {};\r\n\r\n\t\t\t// Apply style\r\n\t\t\tvar applyStyle = function(cellId, key, value) {\r\n\t\t\t\t// Position\r\n\t\t\t\tvar cell = jexcel.getIdFromColumnName(cellId, true);\r\n\r\n\t\t\t\tif (obj.records[cell[1]] && obj.records[cell[1]][cell[0]] && (obj.records[cell[1]][cell[0]].classList.contains('readonly')==false || force)) {\r\n\t\t\t\t\t// Current value\r\n\t\t\t\t\tvar currentValue = obj.records[cell[1]][cell[0]].style[key];\r\n\r\n\t\t\t\t\t// Change layout\r\n\t\t\t\t\tif (currentValue == value && ! force) {\r\n\t\t\t\t\t\tvalue = '';\r\n\t\t\t\t\t\tobj.records[cell[1]][cell[0]].style[key] = '';\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tobj.records[cell[1]][cell[0]].style[key] = value;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// History\r\n\t\t\t\t\tif (! oldValue[cellId]) {\r\n\t\t\t\t\t\toldValue[cellId] = [];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (! newValue[cellId]) {\r\n\t\t\t\t\t\tnewValue[cellId] = [];\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\toldValue[cellId].push([key + ':' + currentValue]);\r\n\t\t\t\t\tnewValue[cellId].push([key + ':' + value]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (k && v) {\r\n\t\t\t\t// Get object from string\r\n\t\t\t\tif (typeof(o) == 'string') {\r\n\t\t\t\t\tapplyStyle(o, k, v);\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Avoid duplications\r\n\t\t\t\t\tvar oneApplication = [];\r\n\t\t\t\t\t// Apply that for all cells\r\n\t\t\t\t\tfor (var i = 0; i < o.length; i++) {\r\n\t\t\t\t\t\tvar x = o[i].getAttribute('data-x');\r\n\t\t\t\t\t\tvar y = o[i].getAttribute('data-y');\r\n\t\t\t\t\t\tvar cellName = jexcel.getColumnNameFromId([x, y]);\r\n\t\t\t\t\t\t// This happens when is a merged cell\r\n\t\t\t\t\t\tif (! oneApplication[cellName]) {\r\n\t\t\t\t\t\t\tapplyStyle(cellName, k, v);\r\n\t\t\t\t\t\t\toneApplication[cellName] = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tvar keys = Object.keys(o);\r\n\t\t\t\tfor (var i = 0; i < keys.length; i++) {\r\n\t\t\t\t\tvar style = o[keys[i]];\r\n\t\t\t\t\tif (typeof(style) == 'string') {\r\n\t\t\t\t\t\tstyle = style.split(';');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor (var j = 0; j < style.length; j++) {\r\n\t\t\t\t\t\tif (typeof(style[j]) == 'string') {\r\n\t\t\t\t\t\t\tstyle[j] = style[j].split(':');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// Apply value\r\n\t\t\t\t\t\tif (style[j][0].trim()) {\r\n\t\t\t\t\t\t\tapplyStyle(keys[i], style[j][0].trim(), style[j][1]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tvar keys = Object.keys(oldValue);\r\n\t\t\tfor (var i = 0; i < keys.length; i++) {\r\n\t\t\t\toldValue[keys[i]] = oldValue[keys[i]].join(';');\r\n\t\t\t}\r\n\t\t\tvar keys = Object.keys(newValue);\r\n\t\t\tfor (var i = 0; i < keys.length; i++) {\r\n\t\t\t\tnewValue[keys[i]] = newValue[keys[i]].join(';');\r\n\t\t\t}\r\n\r\n\t\t\tif (! ignoreHistoryAndEvents) {\r\n\t\t\t\t// Keeping history of changes\r\n\t\t\t\tobj.setHistory({\r\n\t\t\t\t\taction: 'setStyle',\r\n\t\t\t\t\toldValue: oldValue,\r\n\t\t\t\t\tnewValue: newValue,\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tobj.dispatch('onchangestyle', el, o, k, v);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Get cell comments, null cell for all\r\n\t\t */\r\n\t\tobj.getComments = function(cell, withAuthor) {\r\n\t\t\tif (cell) {\r\n\t\t\t\tif (typeof(cell) == 'string') {\r\n\t\t\t\t\tvar cell = jexcel.getIdFromColumnName(cell, true);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (withAuthor) {\r\n\t\t\t\t\treturn [obj.records[cell[1]][cell[0]].getAttribute('title'), obj.records[cell[1]][cell[0]].getAttribute('author')];\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn obj.records[cell[1]][cell[0]].getAttribute('title') || '';\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tvar data = {};\r\n\t\t\t\tfor (var j = 0; j < obj.options.data.length; j++) {\r\n\t\t\t\t\tfor (var i = 0; i < obj.options.columns.length; i++) {\r\n\t\t\t\t\t\tvar comments = obj.records[j][i].getAttribute('title');\r\n\t\t\t\t\t\tif (comments) {\r\n\t\t\t\t\t\t\tvar cell = jexcel.getColumnNameFromId([i, j]);\r\n\t\t\t\t\t\t\tdata[cell] = comments;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn data;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Set cell comments\r\n\t\t */\r\n\t\tobj.setComments = function(cellId, comments, author) {\r\n\t\t\tif (typeof(cellId) == 'string') {\r\n\t\t\t\tvar cell = jexcel.getIdFromColumnName(cellId, true);\r\n\t\t\t} else {\r\n\t\t\t\tvar cell = cellId;\r\n\t\t\t}\r\n\r\n\t\t\t// Keep old value\r\n\t\t\tvar title = obj.records[cell[1]][cell[0]].getAttribute('title');\r\n\t\t\tvar author = obj.records[cell[1]][cell[0]].getAttribute('data-author');\r\n\t\t\tvar oldValue = [ title, author ];\r\n\r\n\t\t\t// Set new values\r\n\t\t\tobj.records[cell[1]][cell[0]].setAttribute('title', comments ? comments : '');\r\n\t\t\tobj.records[cell[1]][cell[0]].setAttribute('data-author', author ? author : '');\r\n\r\n\t\t\t// Remove class if there is no comment\r\n\t\t\tif (comments) {\r\n\t\t\t\tobj.records[cell[1]][cell[0]].classList.add('jexcel_comments');\r\n\t\t\t} else {\r\n\t\t\t\tobj.records[cell[1]][cell[0]].classList.remove('jexcel_comments');\r\n\t\t\t}\r\n\r\n\t\t\t// Save history\r\n\t\t\tobj.setHistory({\r\n\t\t\t\taction:'setComments',\r\n\t\t\t\tcolumn: cellId,\r\n\t\t\t\tnewValue: [ comments, author ],\r\n\t\t\t\toldValue: oldValue,\r\n\t\t\t});\r\n\t\t\t// Set comments\r\n\t\t\tobj.dispatch('oncomments', el, comments, title, cell, cell[0], cell[1]);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Get table config information\r\n\t\t */\r\n\t\tobj.getConfig = function() {\r\n\t\t\tvar options = obj.options;\r\n\t\t\toptions.style = obj.getStyle();\r\n\t\t\toptions.mergeCells = obj.getMerge();\r\n\t\t\toptions.comments = obj.getComments();\r\n\r\n\t\t\treturn options;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Sort data and reload table\r\n\t\t */\r\n\t\tobj.orderBy = function(column, order) {\r\n\t\t\tif (column >= 0) {\r\n\t\t\t\t// Merged cells\r\n\t\t\t\tif (Object.keys(obj.options.mergeCells).length > 0) {\r\n\t\t\t\t\tif (! confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure)) {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// Remove merged cells\r\n\t\t\t\t\t\tobj.destroyMerged();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Direction\r\n\t\t\t\tif (order == null) {\r\n\t\t\t\t\torder = obj.headers[column].classList.contains('arrow-down') ? 1 : 0;\r\n\t\t\t\t} else {\r\n\t\t\t\t\torder = order ? 1 : 0;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Test order\r\n\t\t\t\tvar temp = [];\r\n\t\t\t\tif (obj.options.columns[column].type == 'number' || obj.options.columns[column].type == 'numeric' || obj.options.columns[column].type == 'percentage' || obj.options.columns[column].type == 'autonumber' || obj.options.columns[column].type == 'color') {\r\n\t\t\t\t\tfor (var j = 0; j < obj.options.data.length; j++) {\r\n\t\t\t\t\t\ttemp[j] = [ j, Number(obj.options.data[j][column]) ];\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (obj.options.columns[column].type == 'calendar' || obj.options.columns[column].type == 'checkbox' || obj.options.columns[column].type == 'radio') {\r\n\t\t\t\t\tfor (var j = 0; j < obj.options.data.length; j++) {\r\n\t\t\t\t\t\ttemp[j] = [ j, obj.options.data[j][column] ];\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tfor (var j = 0; j < obj.options.data.length; j++) {\r\n\t\t\t\t\t\ttemp[j] = [ j, obj.records[j][column].textContent.toLowerCase() ];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Default sorting method\r\n\t\t\t\tif (typeof(obj.options.sorting) !== 'function') {\r\n\t\t\t\t\tobj.options.sorting = function(direction) {\r\n\t\t\t\t\t\treturn function(a, b) {\r\n\t\t\t\t\t\t\tvar valueA = a[1];\r\n\t\t\t\t\t\t\tvar valueB = b[1];\r\n\r\n\t\t\t\t\t\t\tif (! direction) {\r\n\t\t\t\t\t\t\t\treturn (valueA === '' && valueB !== '') ? 1 : (valueA !== '' && valueB === '') ? -1 : (valueA > valueB) ? 1 : (valueA < valueB) ? -1 :  0;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\treturn (valueA === '' && valueB !== '') ? 1 : (valueA !== '' && valueB === '') ? -1 : (valueA > valueB) ? -1 : (valueA < valueB) ? 1 :  0;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttemp = temp.sort(obj.options.sorting(order));\r\n\r\n\t\t\t\t// Save history\r\n\t\t\t\tvar newValue = [];\r\n\t\t\t\tfor (var j = 0; j < temp.length; j++) {\r\n\t\t\t\t\tnewValue[j] = temp[j][0];\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// TablePress: Keep Table Head and Table Foot row at the top/bottom, if used.\r\n\t\t\t\tif ( window?.tp?.table?.options?.table_head ) {\r\n\t\t\t\t\tconst first_row_idx = 0;\r\n\t\t\t\t\tnewValue = newValue.filter( ( row_idx ) => ( row_idx > first_row_idx ) );\r\n\t\t\t\t\tnewValue.unshift( first_row_idx );\r\n\t\t\t\t}\r\n\t\t\t\tif ( window?.tp?.table?.options?.table_foot ) {\r\n\t\t\t\t\tconst last_row_idx = newValue.length - 1;\r\n\t\t\t\t\tnewValue = newValue.filter( ( row_idx ) => ( row_idx < last_row_idx ) );\r\n\t\t\t\t\tnewValue.push( last_row_idx );\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Save history\r\n\t\t\t\tobj.setHistory({\r\n\t\t\t\t\taction: 'orderBy',\r\n\t\t\t\t\trows: newValue,\r\n\t\t\t\t\tcolumn: column,\r\n\t\t\t\t\torder: order,\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// Update order\r\n\t\t\t\tobj.updateOrderArrow(column, order);\r\n\t\t\t\tobj.updateOrder(newValue);\r\n\r\n\t\t\t\t// On sort event\r\n\t\t\t\tobj.dispatch('onsort', el, column, order);\r\n\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Update order arrow\r\n\t\t */\r\n\t\tobj.updateOrderArrow = function(column, order) {\r\n\t\t\t// Remove order\r\n\t\t\tfor (var i = 0; i < obj.headers.length; i++) {\r\n\t\t\t\tobj.headers[i].classList.remove('arrow-up');\r\n\t\t\t\tobj.headers[i].classList.remove('arrow-down');\r\n\t\t\t}\r\n\r\n\t\t\t// No order specified then toggle order\r\n\t\t\tif (order) {\r\n\t\t\t\tobj.headers[column].classList.add('arrow-up');\r\n\t\t\t} else {\r\n\t\t\t\tobj.headers[column].classList.add('arrow-down');\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Update rows position\r\n\t\t */\r\n\t\tobj.updateOrder = function(rows) {\r\n\t\t\t// History\r\n\t\t\tvar data = []\r\n\t\t\tfor (var j = 0; j < rows.length; j++) {\r\n\t\t\t\tdata[j] = obj.options.data[rows[j]];\r\n\t\t\t}\r\n\t\t\tobj.options.data = data;\r\n\r\n\t\t\tvar data = []\r\n\t\t\tfor (var j = 0; j < rows.length; j++) {\r\n\t\t\t\tdata[j] = obj.records[rows[j]];\r\n\t\t\t}\r\n\t\t\tobj.records = data;\r\n\r\n\t\t\tvar data = []\r\n\t\t\tfor (var j = 0; j < rows.length; j++) {\r\n\t\t\t\tdata[j] = obj.rows[rows[j]];\r\n\t\t\t}\r\n\t\t\tobj.rows = data;\r\n\r\n\t\t\t// Update references\r\n\t\t\tobj.updateTableReferences();\r\n\r\n\t\t\t// Redo search\r\n\t\t\tif (obj.results && obj.results.length) {\r\n\t\t\t\tif (obj.searchInput.value) {\r\n\t\t\t\t\tobj.search(obj.searchInput.value);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tobj.closeFilter();\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\t// Create page\r\n\t\t\t\tobj.results = null;\r\n\t\t\t\tobj.pageNumber = 0;\r\n\r\n\t\t\t\tif (obj.options.pagination > 0) {\r\n\t\t\t\t\tobj.page(0);\r\n\t\t\t\t} else if (obj.options.lazyLoading == true) {\r\n\t\t\t\t\tobj.loadPage(0);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tfor (var j = 0; j < obj.rows.length; j++) {\r\n\t\t\t\t\t\tobj.tbody.appendChild(obj.rows[j]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Move row\r\n\t\t *\r\n\t\t * @return void\r\n\t\t */\r\n\t\tobj.moveRow = function(o, d, ignoreDom) {\r\n\t\t\tif (Object.keys(obj.options.mergeCells).length > 0) {\r\n\t\t\t\tif (o > d) {\r\n\t\t\t\t\tvar insertBefore = 1;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvar insertBefore = 0;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (obj.isRowMerged(o).length || obj.isRowMerged(d, insertBefore).length) {\r\n\t\t\t\t\tif (! confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure)) {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tobj.destroyMerged();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (obj.options.search == true) {\r\n\t\t\t\tif (obj.results && obj.results.length != obj.rows.length) {\r\n\t\t\t\t\tif (confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure)) {\r\n\t\t\t\t\t\tobj.resetSearch();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tobj.results = null;\r\n\t\t\t}\r\n\r\n\t\t\tif (! ignoreDom) {\r\n\t\t\t\tif (Array.prototype.indexOf.call(obj.tbody.children, obj.rows[d]) >= 0) {\r\n\t\t\t\t\tif (o > d) {\r\n\t\t\t\t\t\tobj.tbody.insertBefore(obj.rows[o], obj.rows[d]);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tobj.tbody.insertBefore(obj.rows[o], obj.rows[d].nextSibling);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tobj.tbody.removeChild(obj.rows[o]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Place references in the correct position\r\n\t\t\tobj.rows.splice(d, 0, obj.rows.splice(o, 1)[0]);\r\n\t\t\tobj.records.splice(d, 0, obj.records.splice(o, 1)[0]);\r\n\t\t\tobj.options.data.splice(d, 0, obj.options.data.splice(o, 1)[0]);\r\n\r\n\t\t\t// Respect pagination\r\n\t\t\tif (obj.options.pagination > 0 && obj.tbody.children.length != obj.options.pagination) {\r\n\t\t\t\tobj.page(obj.pageNumber);\r\n\t\t\t}\r\n\r\n\t\t\t// Keeping history of changes\r\n\t\t\tobj.setHistory({\r\n\t\t\t\taction:'moveRow',\r\n\t\t\t\toldValue: o,\r\n\t\t\t\tnewValue: d,\r\n\t\t\t});\r\n\r\n\t\t\t// Update table references\r\n\t\t\tobj.updateTableReferences();\r\n\r\n\t\t\t// Events\r\n\t\t\tobj.dispatch('onmoverow', el, o, d);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Insert a new row\r\n\t\t *\r\n\t\t * @param mixed - number of blank lines to be insert or a single array with the data of the new row\r\n\t\t * @param rowNumber\r\n\t\t * @param insertBefore\r\n\t\t * @return void\r\n\t\t */\r\n\t\tobj.insertRow = function(mixed, rowNumber, insertBefore) {\r\n\t\t\t// Configuration\r\n\t\t\tif (obj.options.allowInsertRow == true) {\r\n\t\t\t\t// Records\r\n\t\t\t\tvar records = [];\r\n\r\n\t\t\t\t// Data to be insert\r\n\t\t\t\tvar data = [];\r\n\r\n\t\t\t\t// The insert could be lead by number of rows or the array of data\r\n\t\t\t\tif (mixed > 0) {\r\n\t\t\t\t\tvar numOfRows = mixed;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvar numOfRows = 1;\r\n\r\n\t\t\t\t\tif (mixed) {\r\n\t\t\t\t\t\tdata = mixed;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Direction\r\n\t\t\t\tvar insertBefore = insertBefore ? true : false;\r\n\r\n\t\t\t\t// Current column number\r\n\t\t\t\tvar lastRow = obj.options.data.length - 1;\r\n\r\n\t\t\t\tif (rowNumber == undefined || rowNumber >= parseInt(lastRow) || rowNumber < 0) {\r\n\t\t\t\t\trowNumber = lastRow;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Onbeforeinsertrow\r\n\t\t\t\tif (obj.dispatch('onbeforeinsertrow', el, rowNumber, numOfRows, insertBefore) === false) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Merged cells\r\n\t\t\t\tif (Object.keys(obj.options.mergeCells).length > 0) {\r\n\t\t\t\t\tif (obj.isRowMerged(rowNumber, insertBefore).length) {\r\n\t\t\t\t\t\tif (! confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure)) {\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tobj.destroyMerged();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Clear any search\r\n\t\t\t\tif (obj.options.search == true) {\r\n\t\t\t\t\tif (obj.results && obj.results.length != obj.rows.length) {\r\n\t\t\t\t\t\tif (confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure)) {\r\n\t\t\t\t\t\t\tobj.resetSearch();\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tobj.results = null;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Insertbefore\r\n\t\t\t\tvar rowIndex = (! insertBefore) ? rowNumber + 1 : rowNumber;\r\n\r\n\t\t\t\t// Keep the current data\r\n\t\t\t\tvar currentRecords = obj.records.splice(rowIndex);\r\n\t\t\t\tvar currentData = obj.options.data.splice(rowIndex);\r\n\t\t\t\tvar currentRows = obj.rows.splice(rowIndex);\r\n\r\n\t\t\t\t// Adding lines\r\n\t\t\t\tvar rowRecords = [];\r\n\t\t\t\tvar rowData = [];\r\n\t\t\t\tvar rowNode = [];\r\n\r\n\t\t\t\tfor (var row = rowIndex; row < (numOfRows + rowIndex); row++) {\r\n\t\t\t\t\t// Push data to the data container\r\n\t\t\t\t\tobj.options.data[row] = [];\r\n\t\t\t\t\tfor (var col = 0; col < obj.options.columns.length; col++) {\r\n\t\t\t\t\t\tobj.options.data[row][col]  = data[col] ? data[col] : '';\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// Create row\r\n\t\t\t\t\tvar tr = obj.createRow(row, obj.options.data[row]);\r\n\t\t\t\t\t// Append node\r\n\t\t\t\t\tif (currentRows[0]) {\r\n\t\t\t\t\t\tif (Array.prototype.indexOf.call(obj.tbody.children, currentRows[0]) >= 0) {\r\n\t\t\t\t\t\t\tobj.tbody.insertBefore(tr, currentRows[0]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (Array.prototype.indexOf.call(obj.tbody.children, obj.rows[rowNumber]) >= 0) {\r\n\t\t\t\t\t\t\tobj.tbody.appendChild(tr);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// Record History\r\n\t\t\t\t\trowRecords.push(obj.records[row]);\r\n\t\t\t\t\trowData.push(obj.options.data[row]);\r\n\t\t\t\t\trowNode.push(tr);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Copy the data back to the main data\r\n\t\t\t\tArray.prototype.push.apply(obj.records, currentRecords);\r\n\t\t\t\tArray.prototype.push.apply(obj.options.data, currentData);\r\n\t\t\t\tArray.prototype.push.apply(obj.rows, currentRows);\r\n\r\n\t\t\t\t// Respect pagination\r\n\t\t\t\tif (obj.options.pagination > 0) {\r\n\t\t\t\t\tobj.page(obj.pageNumber);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Keep history\r\n\t\t\t\tobj.setHistory({\r\n\t\t\t\t\taction: 'insertRow',\r\n\t\t\t\t\trowNumber: rowNumber,\r\n\t\t\t\t\tnumOfRows: numOfRows,\r\n\t\t\t\t\tinsertBefore: insertBefore,\r\n\t\t\t\t\trowRecords: rowRecords,\r\n\t\t\t\t\trowData: rowData,\r\n\t\t\t\t\trowNode: rowNode,\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// Remove table references\r\n\t\t\t\tobj.updateTableReferences();\r\n\r\n\t\t\t\t// Events\r\n\t\t\t\tobj.dispatch('oninsertrow', el, rowNumber, numOfRows, rowRecords, insertBefore);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Delete a row by number\r\n\t\t *\r\n\t\t * @param integer rowNumber - row number to be excluded\r\n\t\t * @param integer numOfRows - number of lines\r\n\t\t * @return void\r\n\t\t */\r\n\t\tobj.deleteRow = function(rowNumber, numOfRows) {\r\n\t\t\t// Global Configuration\r\n\t\t\tif (obj.options.allowDeleteRow == true) {\r\n\t\t\t\tif (obj.options.allowDeletingAllRows == true || obj.options.data.length > 1) {\r\n\t\t\t\t\t// Delete row definitions\r\n\t\t\t\t\tif (rowNumber == undefined) {\r\n\t\t\t\t\t\tvar number = obj.getSelectedRows();\r\n\r\n\t\t\t\t\t\tif (! number[0]) {\r\n\t\t\t\t\t\t\trowNumber = obj.options.data.length - 1;\r\n\t\t\t\t\t\t\tnumOfRows = 1;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\trowNumber = parseInt(number[0].getAttribute('data-y'));\r\n\t\t\t\t\t\t\tnumOfRows = number.length;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Last column\r\n\t\t\t\t\tvar lastRow = obj.options.data.length - 1;\r\n\r\n\t\t\t\t\tif (rowNumber == undefined || rowNumber > lastRow || rowNumber < 0) {\r\n\t\t\t\t\t\trowNumber = lastRow;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (! numOfRows) {\r\n\t\t\t\t\t\tnumOfRows = 1;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Do not delete more than the number of records\r\n\t\t\t\t\tif (rowNumber + numOfRows >= obj.options.data.length) {\r\n\t\t\t\t\t\tnumOfRows = obj.options.data.length - rowNumber;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Onbeforedeleterow\r\n\t\t\t\t\tif (obj.dispatch('onbeforedeleterow', el, rowNumber, numOfRows) === false) {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (parseInt(rowNumber) > -1) {\r\n\t\t\t\t\t\t// Merged cells\r\n\t\t\t\t\t\tvar mergeExists = false;\r\n\t\t\t\t\t\tif (Object.keys(obj.options.mergeCells).length > 0) {\r\n\t\t\t\t\t\t\tfor (var row = rowNumber; row < rowNumber + numOfRows; row++) {\r\n\t\t\t\t\t\t\t\tif (obj.isRowMerged(row, false).length) {\r\n\t\t\t\t\t\t\t\t\tmergeExists = true;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (mergeExists) {\r\n\t\t\t\t\t\t\tif (! confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure)) {\r\n\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tobj.destroyMerged();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// Clear any search\r\n\t\t\t\t\t\tif (obj.options.search == true) {\r\n\t\t\t\t\t\t\tif (obj.results && obj.results.length != obj.rows.length) {\r\n\t\t\t\t\t\t\t\tif (confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure)) {\r\n\t\t\t\t\t\t\t\t\tobj.resetSearch();\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tobj.results = null;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// If delete all rows, and set allowDeletingAllRows false, will stay one row\r\n\t\t\t\t\t\tif (obj.options.allowDeletingAllRows == false && lastRow + 1 === numOfRows) {\r\n\t\t\t\t\t\t\tnumOfRows--;\r\n\t\t\t\t\t\t\tconsole.error('Jspreadsheet: It is not possible to delete the last row');\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// Remove node\r\n\t\t\t\t\t\tfor (var row = rowNumber; row < rowNumber + numOfRows; row++) {\r\n\t\t\t\t\t\t\tif (Array.prototype.indexOf.call(obj.tbody.children, obj.rows[row]) >= 0) {\r\n\t\t\t\t\t\t\t\tobj.rows[row].className = '';\r\n\t\t\t\t\t\t\t\tobj.rows[row].parentNode.removeChild(obj.rows[row]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// Remove data\r\n\t\t\t\t\t\tvar rowRecords = obj.records.splice(rowNumber, numOfRows);\r\n\t\t\t\t\t\tvar rowData = obj.options.data.splice(rowNumber, numOfRows);\r\n\t\t\t\t\t\tvar rowNode = obj.rows.splice(rowNumber, numOfRows);\r\n\r\n\t\t\t\t\t\t// Respect pagination\r\n\t\t\t\t\t\tif (obj.options.pagination > 0 && obj.tbody.children.length != obj.options.pagination) {\r\n\t\t\t\t\t\t\tobj.page(obj.pageNumber);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// Remove selection\r\n\t\t\t\t\t\tobj.conditionalSelectionUpdate(1, rowNumber, (rowNumber + numOfRows) - 1);\r\n\r\n\t\t\t\t\t\t// Keep history\r\n\t\t\t\t\t\tobj.setHistory({\r\n\t\t\t\t\t\t\taction: 'deleteRow',\r\n\t\t\t\t\t\t\trowNumber: rowNumber,\r\n\t\t\t\t\t\t\tnumOfRows: numOfRows,\r\n\t\t\t\t\t\t\tinsertBefore: 1,\r\n\t\t\t\t\t\t\trowRecords: rowRecords,\r\n\t\t\t\t\t\t\trowData: rowData,\r\n\t\t\t\t\t\t\trowNode: rowNode\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t// Remove table references\r\n\t\t\t\t\t\tobj.updateTableReferences();\r\n\r\n\t\t\t\t\t\t// Events\r\n\t\t\t\t\t\tobj.dispatch('ondeleterow', el, rowNumber, numOfRows, rowRecords);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconsole.error('Jspreadsheet: It is not possible to delete the last row');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\r\n\t\t/**\r\n\t\t * Move column\r\n\t\t *\r\n\t\t * @return void\r\n\t\t */\r\n\t\tobj.moveColumn = function(o, d) {\r\n\t\t\tif (Object.keys(obj.options.mergeCells).length > 0) {\r\n\t\t\t\tif (o > d) {\r\n\t\t\t\t\tvar insertBefore = 1;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvar insertBefore = 0;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (obj.isColMerged(o).length || obj.isColMerged(d, insertBefore).length) {\r\n\t\t\t\t\tif (! confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure)) {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tobj.destroyMerged();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tvar o = parseInt(o);\r\n\t\t\tvar d = parseInt(d);\r\n\r\n\t\t\tif (o > d) {\r\n\t\t\t\tobj.headerContainer.insertBefore(obj.headers[o], obj.headers[d]);\r\n\t\t\t\tobj.colgroupContainer.insertBefore(obj.colgroup[o], obj.colgroup[d]);\r\n\r\n\t\t\t\tfor (var j = 0; j < obj.rows.length; j++) {\r\n\t\t\t\t\tobj.rows[j].insertBefore(obj.records[j][o], obj.records[j][d]);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tobj.headerContainer.insertBefore(obj.headers[o], obj.headers[d].nextSibling);\r\n\t\t\t\tobj.colgroupContainer.insertBefore(obj.colgroup[o], obj.colgroup[d].nextSibling);\r\n\r\n\t\t\t\tfor (var j = 0; j < obj.rows.length; j++) {\r\n\t\t\t\t\tobj.rows[j].insertBefore(obj.records[j][o], obj.records[j][d].nextSibling);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tobj.options.columns.splice(d, 0, obj.options.columns.splice(o, 1)[0]);\r\n\t\t\tobj.headers.splice(d, 0, obj.headers.splice(o, 1)[0]);\r\n\t\t\tobj.colgroup.splice(d, 0, obj.colgroup.splice(o, 1)[0]);\r\n\r\n\t\t\tfor (var j = 0; j < obj.rows.length; j++) {\r\n\t\t\t\tobj.options.data[j].splice(d, 0, obj.options.data[j].splice(o, 1)[0]);\r\n\t\t\t\tobj.records[j].splice(d, 0, obj.records[j].splice(o, 1)[0]);\r\n\t\t\t}\r\n\r\n\t\t\t// Update footers position\r\n\t\t\tif (obj.options.footers) {\r\n\t\t\t\tfor (var j = 0; j < obj.options.footers.length; j++) {\r\n\t\t\t\t\tobj.options.footers[j].splice(d, 0, obj.options.footers[j].splice(o, 1)[0]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Keeping history of changes\r\n\t\t\tobj.setHistory({\r\n\t\t\t\taction:'moveColumn',\r\n\t\t\t\toldValue: o,\r\n\t\t\t\tnewValue: d,\r\n\t\t\t});\r\n\r\n\t\t\t// Update table references\r\n\t\t\tobj.updateTableReferences();\r\n\r\n\t\t\t// Events\r\n\t\t\tobj.dispatch('onmovecolumn', el, o, d);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Insert a new column\r\n\t\t *\r\n\t\t * @param mixed - num of columns to be added or data to be added in one single column\r\n\t\t * @param int columnNumber - number of columns to be created\r\n\t\t * @param bool insertBefore\r\n\t\t * @param object properties - column properties\r\n\t\t * @return void\r\n\t\t */\r\n\t\tobj.insertColumn = function(mixed, columnNumber, insertBefore, properties) {\r\n\t\t\t// Configuration\r\n\t\t\tif (obj.options.allowInsertColumn == true) {\r\n\t\t\t\t// Records\r\n\t\t\t\tvar records = [];\r\n\r\n\t\t\t\t// Data to be insert\r\n\t\t\t\tvar data = [];\r\n\r\n\t\t\t\t// The insert could be lead by number of rows or the array of data\r\n\t\t\t\tif (mixed > 0) {\r\n\t\t\t\t\tvar numOfColumns = mixed;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvar numOfColumns = 1;\r\n\r\n\t\t\t\t\tif (mixed) {\r\n\t\t\t\t\t\tdata = mixed;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Direction\r\n\t\t\t\tvar insertBefore = insertBefore ? true : false;\r\n\r\n\t\t\t\t// Current column number\r\n\t\t\t\tvar lastColumn = obj.options.columns.length - 1;\r\n\r\n\t\t\t\t// Confirm position\r\n\t\t\t\tif (columnNumber == undefined || columnNumber >= parseInt(lastColumn) || columnNumber < 0) {\r\n\t\t\t\t\tcolumnNumber = lastColumn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Onbeforeinsertcolumn\r\n\t\t\t\tif (obj.dispatch('onbeforeinsertcolumn', el, columnNumber, numOfColumns, insertBefore) === false) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Merged cells\r\n\t\t\t\tif (Object.keys(obj.options.mergeCells).length > 0) {\r\n\t\t\t\t\tif (obj.isColMerged(columnNumber, insertBefore).length) {\r\n\t\t\t\t\t\tif (! confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure)) {\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tobj.destroyMerged();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Create default properties\r\n\t\t\t\tif (! properties) {\r\n\t\t\t\t\tproperties = [];\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor (var i = 0; i < numOfColumns; i++) {\r\n\t\t\t\t\tif (! properties[i]) {\r\n\t\t\t\t\t\tproperties[i] = { type:'text', source:[], options:[], width:obj.options.defaultColWidth, align:obj.options.defaultColAlign };\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Insert before\r\n\t\t\t\tvar columnIndex = (! insertBefore) ? columnNumber + 1 : columnNumber;\r\n\t\t\t\tobj.options.columns = jexcel.injectArray(obj.options.columns, columnIndex, properties);\r\n\r\n\t\t\t\t// Open space in the containers\r\n\t\t\t\tvar currentHeaders = obj.headers.splice(columnIndex);\r\n\t\t\t\tvar currentColgroup = obj.colgroup.splice(columnIndex);\r\n\r\n\t\t\t\t// History\r\n\t\t\t\tvar historyHeaders = [];\r\n\t\t\t\tvar historyColgroup = [];\r\n\t\t\t\tvar historyRecords = [];\r\n\t\t\t\tvar historyData = [];\r\n\t\t\t\tvar historyFooters = [];\r\n\r\n\t\t\t\t// Add new headers\r\n\t\t\t\tfor (var col = columnIndex; col < (numOfColumns + columnIndex); col++) {\r\n\t\t\t\t\tobj.createCellHeader(col);\r\n\t\t\t\t\tobj.headerContainer.insertBefore(obj.headers[col], obj.headerContainer.children[col+1]);\r\n\t\t\t\t\tobj.colgroupContainer.insertBefore(obj.colgroup[col], obj.colgroupContainer.children[col+1]);\r\n\r\n\t\t\t\t\thistoryHeaders.push(obj.headers[col]);\r\n\t\t\t\t\thistoryColgroup.push(obj.colgroup[col]);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Add new footer cells\r\n\t\t\t\tif (obj.options.footers) {\r\n\t\t\t\t\tfor (var j = 0; j < obj.options.footers.length; j++) {\r\n\t\t\t\t\t\thistoryFooters[j] = [];\r\n\t\t\t\t\t\tfor (var i = 0; i < numOfColumns; i++) {\r\n\t\t\t\t\t\t\thistoryFooters[j].push('');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tobj.options.footers[j].splice(columnIndex, 0, historyFooters[j]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Adding visual columns\r\n\t\t\t\tfor (var row = 0; row < obj.options.data.length; row++) {\r\n\t\t\t\t\t// Keep the current data\r\n\t\t\t\t\tvar currentData = obj.options.data[row].splice(columnIndex);\r\n\t\t\t\t\tvar currentRecord = obj.records[row].splice(columnIndex);\r\n\r\n\t\t\t\t\t// History\r\n\t\t\t\t\thistoryData[row] = [];\r\n\t\t\t\t\thistoryRecords[row] = [];\r\n\r\n\t\t\t\t\tfor (var col = columnIndex; col < (numOfColumns + columnIndex); col++) {\r\n\t\t\t\t\t\t// New value\r\n\t\t\t\t\t\tvar value = data[row] ? data[row] : '';\r\n\t\t\t\t\t\tobj.options.data[row][col] = value;\r\n\t\t\t\t\t\t// New cell\r\n\t\t\t\t\t\tvar td = obj.createCell(col, row, obj.options.data[row][col]);\r\n\t\t\t\t\t\tobj.records[row][col] = td;\r\n\t\t\t\t\t\t// Add cell to the row\r\n\t\t\t\t\t\tif (obj.rows[row]) {\r\n\t\t\t\t\t\t\tobj.rows[row].insertBefore(td, obj.rows[row].children[col+1]);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// Record History\r\n\t\t\t\t\t\thistoryData[row].push(value);\r\n\t\t\t\t\t\thistoryRecords[row].push(td);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Copy the data back to the main data\r\n\t\t\t\t\tArray.prototype.push.apply(obj.options.data[row], currentData);\r\n\t\t\t\t\tArray.prototype.push.apply(obj.records[row], currentRecord);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tArray.prototype.push.apply(obj.headers, currentHeaders);\r\n\t\t\t\tArray.prototype.push.apply(obj.colgroup, currentColgroup);\r\n\r\n\t\t\t\t// Adjust nested headers\r\n\t\t\t\tif (obj.options.nestedHeaders && obj.options.nestedHeaders.length > 0) {\r\n\t\t\t\t\t// Flexible way to handle nestedheaders\r\n\t\t\t\t\tif (obj.options.nestedHeaders[0] && obj.options.nestedHeaders[0][0]) {\r\n\t\t\t\t\t\tfor (var j = 0; j < obj.options.nestedHeaders.length; j++) {\r\n\t\t\t\t\t\t\tvar colspan = parseInt(obj.options.nestedHeaders[j][obj.options.nestedHeaders[j].length-1].colspan) + numOfColumns;\r\n\t\t\t\t\t\t\tobj.options.nestedHeaders[j][obj.options.nestedHeaders[j].length-1].colspan = colspan;\r\n\t\t\t\t\t\t\tobj.thead.children[j].children[obj.thead.children[j].children.length-1].setAttribute('colspan', colspan);\r\n\t\t\t\t\t\t\tvar o = obj.thead.children[j].children[obj.thead.children[j].children.length-1].getAttribute('data-column');\r\n\t\t\t\t\t\t\to = o.split(',');\r\n\t\t\t\t\t\t\tfor (var col = columnIndex; col < (numOfColumns + columnIndex); col++) {\r\n\t\t\t\t\t\t\t\to.push(col);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tobj.thead.children[j].children[obj.thead.children[j].children.length-1].setAttribute('data-column', o);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tvar colspan = parseInt(obj.options.nestedHeaders[0].colspan) + numOfColumns;\r\n\t\t\t\t\t\tobj.options.nestedHeaders[0].colspan = colspan;\r\n\t\t\t\t\t\tobj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute('colspan', colspan);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Keep history\r\n\t\t\t\tobj.setHistory({\r\n\t\t\t\t\taction: 'insertColumn',\r\n\t\t\t\t\tcolumnNumber:columnNumber,\r\n\t\t\t\t\tnumOfColumns:numOfColumns,\r\n\t\t\t\t\tinsertBefore:insertBefore,\r\n\t\t\t\t\tcolumns:properties,\r\n\t\t\t\t\theaders:historyHeaders,\r\n\t\t\t\t\tcolgroup:historyColgroup,\r\n\t\t\t\t\trecords:historyRecords,\r\n\t\t\t\t\tfooters:historyFooters,\r\n\t\t\t\t\tdata:historyData,\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// Remove table references\r\n\t\t\t\tobj.updateTableReferences();\r\n\r\n\t\t\t\t// Events\r\n\t\t\t\tobj.dispatch('oninsertcolumn', el, columnNumber, numOfColumns, historyRecords, insertBefore);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Delete a column by number\r\n\t\t *\r\n\t\t * @param integer columnNumber - reference column to be excluded\r\n\t\t * @param integer numOfColumns - number of columns to be excluded from the reference column\r\n\t\t * @return void\r\n\t\t */\r\n\t\tobj.deleteColumn = function(columnNumber, numOfColumns) {\r\n\t\t\t// Global Configuration\r\n\t\t\tif (obj.options.allowDeleteColumn == true) {\r\n\t\t\t\tif (obj.headers.length > 1) {\r\n\t\t\t\t\t// Delete column definitions\r\n\t\t\t\t\tif (columnNumber == undefined) {\r\n\t\t\t\t\t\tvar number = obj.getSelectedColumns(true);\r\n\r\n\t\t\t\t\t\tif (! number.length) {\r\n\t\t\t\t\t\t\t// Remove last column\r\n\t\t\t\t\t\t\tcolumnNumber = obj.headers.length - 1;\r\n\t\t\t\t\t\t\tnumOfColumns = 1;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t// Remove selected\r\n\t\t\t\t\t\t\tcolumnNumber = parseInt(number[0]);\r\n\t\t\t\t\t\t\tnumOfColumns = parseInt(number.length);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Lasat column\r\n\t\t\t\t\tvar lastColumn = obj.options.data[0].length - 1;\r\n\r\n\t\t\t\t\tif (columnNumber == undefined || columnNumber > lastColumn || columnNumber < 0) {\r\n\t\t\t\t\t\tcolumnNumber = lastColumn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Minimum of columns to be delete is 1\r\n\t\t\t\t\tif (! numOfColumns) {\r\n\t\t\t\t\t\tnumOfColumns = 1;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Can't delete more than the limit of the table\r\n\t\t\t\t\tif (numOfColumns > obj.options.data[0].length - columnNumber) {\r\n\t\t\t\t\t\tnumOfColumns = obj.options.data[0].length - columnNumber;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// onbeforedeletecolumn\r\n\t\t\t\t\tif (obj.dispatch('onbeforedeletecolumn', el, columnNumber, numOfColumns) === false) {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Can't remove the last column\r\n\t\t\t\t\tif (parseInt(columnNumber) > -1) {\r\n\t\t\t\t\t\t// Merged cells\r\n\t\t\t\t\t\tvar mergeExists = false;\r\n\t\t\t\t\t\tif (Object.keys(obj.options.mergeCells).length > 0) {\r\n\t\t\t\t\t\t\tfor (var col = columnNumber; col < columnNumber + numOfColumns; col++) {\r\n\t\t\t\t\t\t\t\tif (obj.isColMerged(col, false).length) {\r\n\t\t\t\t\t\t\t\t\tmergeExists = true;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (mergeExists) {\r\n\t\t\t\t\t\t\tif (! confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure)) {\r\n\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tobj.destroyMerged();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// Delete the column properties\r\n\t\t\t\t\t\tvar columns = obj.options.columns.splice(columnNumber, numOfColumns);\r\n\r\n\t\t\t\t\t\tfor (var col = columnNumber; col < columnNumber + numOfColumns; col++) {\r\n\t\t\t\t\t\t\tobj.colgroup[col].className = '';\r\n\t\t\t\t\t\t\tobj.headers[col].className = '';\r\n\t\t\t\t\t\t\tobj.colgroup[col].parentNode.removeChild(obj.colgroup[col]);\r\n\t\t\t\t\t\t\tobj.headers[col].parentNode.removeChild(obj.headers[col]);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tvar historyHeaders = obj.headers.splice(columnNumber, numOfColumns);\r\n\t\t\t\t\t\tvar historyColgroup = obj.colgroup.splice(columnNumber, numOfColumns);\r\n\t\t\t\t\t\tvar historyRecords = [];\r\n\t\t\t\t\t\tvar historyData = [];\r\n\t\t\t\t\t\tvar historyFooters = [];\r\n\r\n\t\t\t\t\t\tfor (var row = 0; row < obj.options.data.length; row++) {\r\n\t\t\t\t\t\t\tfor (var col = columnNumber; col < columnNumber + numOfColumns; col++) {\r\n\t\t\t\t\t\t\t\tobj.records[row][col].className = '';\r\n\t\t\t\t\t\t\t\tobj.records[row][col].parentNode.removeChild(obj.records[row][col]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// Delete headers\r\n\t\t\t\t\t\tfor (var row = 0; row < obj.options.data.length; row++) {\r\n\t\t\t\t\t\t\t// History\r\n\t\t\t\t\t\t\thistoryData[row] = obj.options.data[row].splice(columnNumber, numOfColumns);\r\n\t\t\t\t\t\t\thistoryRecords[row] = obj.records[row].splice(columnNumber, numOfColumns);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// Delete footers\r\n\t\t\t\t\t\tif (obj.options.footers) {\r\n\t\t\t\t\t\t\tfor (var row = 0; row < obj.options.footers.length; row++) {\r\n\t\t\t\t\t\t\t\thistoryFooters[row] = obj.options.footers[row].splice(columnNumber, numOfColumns);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// Remove selection\r\n\t\t\t\t\t\tobj.conditionalSelectionUpdate(0, columnNumber, (columnNumber + numOfColumns) - 1);\r\n\r\n\t\t\t\t\t\t// Adjust nested headers\r\n\t\t\t\t\t\tif (obj.options.nestedHeaders && obj.options.nestedHeaders.length > 0) {\r\n\t\t\t\t\t\t\t// Flexible way to handle nestedheaders\r\n\t\t\t\t\t\t\tif (obj.options.nestedHeaders[0] && obj.options.nestedHeaders[0][0]) {\r\n\t\t\t\t\t\t\t\tfor (var j = 0; j < obj.options.nestedHeaders.length; j++) {\r\n\t\t\t\t\t\t\t\t\tvar colspan = parseInt(obj.options.nestedHeaders[j][obj.options.nestedHeaders[j].length-1].colspan) - numOfColumns;\r\n\t\t\t\t\t\t\t\t\tobj.options.nestedHeaders[j][obj.options.nestedHeaders[j].length-1].colspan = colspan;\r\n\t\t\t\t\t\t\t\t\tobj.thead.children[j].children[obj.thead.children[j].children.length-1].setAttribute('colspan', colspan);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tvar colspan = parseInt(obj.options.nestedHeaders[0].colspan) - numOfColumns;\r\n\t\t\t\t\t\t\t\tobj.options.nestedHeaders[0].colspan = colspan;\r\n\t\t\t\t\t\t\t\tobj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute('colspan', colspan);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// Keeping history of changes\r\n\t\t\t\t\t\tobj.setHistory({\r\n\t\t\t\t\t\t\taction:'deleteColumn',\r\n\t\t\t\t\t\t\tcolumnNumber:columnNumber,\r\n\t\t\t\t\t\t\tnumOfColumns:numOfColumns,\r\n\t\t\t\t\t\t\tinsertBefore: 1,\r\n\t\t\t\t\t\t\tcolumns:columns,\r\n\t\t\t\t\t\t\theaders:historyHeaders,\r\n\t\t\t\t\t\t\tcolgroup:historyColgroup,\r\n\t\t\t\t\t\t\trecords:historyRecords,\r\n\t\t\t\t\t\t\tfooters:historyFooters,\r\n\t\t\t\t\t\t\tdata:historyData,\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t// Update table references\r\n\t\t\t\t\t\tobj.updateTableReferences();\r\n\r\n\t\t\t\t\t\t// Delete\r\n\t\t\t\t\t\tobj.dispatch('ondeletecolumn', el, columnNumber, numOfColumns, historyRecords);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconsole.error('Jspreadsheet: It is not possible to delete the last column');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Get selected rows numbers\r\n\t\t *\r\n\t\t * @return array\r\n\t\t */\r\n\t\tobj.getSelectedRows = function(asIds) {\r\n\t\t\tvar rows = [];\r\n\t\t\t// Get all selected rows\r\n\t\t\tfor (var j = 0; j < obj.rows.length; j++) {\r\n\t\t\t\tif (obj.rows[j].classList.contains('selected')) {\r\n\t\t\t\t\tif (asIds) {\r\n\t\t\t\t\t\trows.push(j);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\trows.push(obj.rows[j]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn rows;\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Get selected column numbers\r\n\t\t *\r\n\t\t * @return array\r\n\t\t */\r\n\t\tobj.getSelectedColumns = function() {\r\n\t\t\tvar cols = [];\r\n\t\t\t// Get all selected cols\r\n\t\t\tfor (var i = 0; i < obj.headers.length; i++) {\r\n\t\t\t\tif (obj.headers[i].classList.contains('selected')) {\r\n\t\t\t\t\tcols.push(i);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn cols;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Get highlighted\r\n\t\t *\r\n\t\t * @return array\r\n\t\t */\r\n\t\tobj.getHighlighted = function() {\r\n\t\t\treturn obj.highlighted;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Update cell references\r\n\t\t *\r\n\t\t * @return void\r\n\t\t */\r\n\t\tobj.updateTableReferences = function() {\r\n\t\t\t// Update headers\r\n\t\t\tfor (var i = 0; i < obj.headers.length; i++) {\r\n\t\t\t\tvar x = obj.headers[i].getAttribute('data-x');\r\n\r\n\t\t\t\tif (x != i) {\r\n\t\t\t\t\t// Update coords\r\n\t\t\t\t\tobj.headers[i].setAttribute('data-x', i);\r\n\t\t\t\t\t// Title\r\n\t\t\t\t\tif (! obj.headers[i].getAttribute('title')) {\r\n\t\t\t\t\t\tobj.headers[i].innerHTML = jexcel.getColumnName(i);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Update all rows\r\n\t\t\tfor (var j = 0; j < obj.rows.length; j++) {\r\n\t\t\t\tif (obj.rows[j]) {\r\n\t\t\t\t\tvar y = obj.rows[j].getAttribute('data-y');\r\n\r\n\t\t\t\t\tif (y != j) {\r\n\t\t\t\t\t\t// Update coords\r\n\t\t\t\t\t\tobj.rows[j].setAttribute('data-y', j);\r\n\t\t\t\t\t\tobj.rows[j].children[0].setAttribute('data-y', j);\r\n\t\t\t\t\t\t// Row number\r\n\t\t\t\t\t\tobj.rows[j].children[0].innerHTML = j + 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Regular cells affected by this change\r\n\t\t\tvar affectedTokens = [];\r\n\t\t\tvar mergeCellUpdates = [];\r\n\r\n\t\t\t// Update cell\r\n\t\t\tvar updatePosition = function(x,y,i,j) {\r\n\t\t\t\tif (x != i) {\r\n\t\t\t\t\tobj.records[j][i].setAttribute('data-x', i);\r\n\t\t\t\t}\r\n\t\t\t\tif (y != j) {\r\n\t\t\t\t\tobj.records[j][i].setAttribute('data-y', j);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Other updates\r\n\t\t\t\tif (x != i || y != j) {\r\n\t\t\t\t\tvar columnIdFrom = jexcel.getColumnNameFromId([x, y]);\r\n\t\t\t\t\tvar columnIdTo = jexcel.getColumnNameFromId([i, j]);\r\n\t\t\t\t\taffectedTokens[columnIdFrom] = columnIdTo;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tfor (var j = 0; j < obj.records.length; j++) {\r\n\t\t\t\tfor (var i = 0; i < obj.records[0].length; i++) {\r\n\t\t\t\t\tif (obj.records[j][i]) {\r\n\t\t\t\t\t\t// Current values\r\n\t\t\t\t\t\tvar x = obj.records[j][i].getAttribute('data-x');\r\n\t\t\t\t\t\tvar y = obj.records[j][i].getAttribute('data-y');\r\n\r\n\t\t\t\t\t\t// Update column\r\n\t\t\t\t\t\tif (obj.records[j][i].getAttribute('data-merged')) {\r\n\t\t\t\t\t\t\tvar columnIdFrom = jexcel.getColumnNameFromId([x, y]);\r\n\t\t\t\t\t\t\tvar columnIdTo = jexcel.getColumnNameFromId([i, j]);\r\n\t\t\t\t\t\t\tif (mergeCellUpdates[columnIdFrom] == null) {\r\n\t\t\t\t\t\t\t\tif (columnIdFrom == columnIdTo) {\r\n\t\t\t\t\t\t\t\t\tmergeCellUpdates[columnIdFrom] = false;\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tvar totalX = parseInt(i - x);\r\n\t\t\t\t\t\t\t\t\tvar totalY = parseInt(j - y);\r\n\t\t\t\t\t\t\t\t\tmergeCellUpdates[columnIdFrom] = [ columnIdTo, totalX, totalY ];\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tupdatePosition(x,y,i,j);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Update merged if applicable\r\n\t\t\tvar keys = Object.keys(mergeCellUpdates);\r\n\t\t\tif (keys.length) {\r\n\t\t\t\tfor (var i = 0; i < keys.length; i++) {\r\n\t\t\t\t\tif (mergeCellUpdates[keys[i]]) {\r\n\t\t\t\t\t\tvar info = jexcel.getIdFromColumnName(keys[i], true)\r\n\t\t\t\t\t\tvar x = info[0];\r\n\t\t\t\t\t\tvar y = info[1];\r\n\t\t\t\t\t\tupdatePosition(x,y,x + mergeCellUpdates[keys[i]][1],y + mergeCellUpdates[keys[i]][2]);\r\n\r\n\t\t\t\t\t\tvar columnIdFrom = keys[i];\r\n\t\t\t\t\t\tvar columnIdTo = mergeCellUpdates[keys[i]][0];\r\n\t\t\t\t\t\tfor (var j = 0; j < obj.options.mergeCells[columnIdFrom][2].length; j++) {\r\n\t\t\t\t\t\t\tvar x = parseInt(obj.options.mergeCells[columnIdFrom][2][j].getAttribute('data-x'));\r\n\t\t\t\t\t\t\tvar y = parseInt(obj.options.mergeCells[columnIdFrom][2][j].getAttribute('data-y'));\r\n\t\t\t\t\t\t\tobj.options.mergeCells[columnIdFrom][2][j].setAttribute('data-x', x + mergeCellUpdates[keys[i]][1]);\r\n\t\t\t\t\t\t\tobj.options.mergeCells[columnIdFrom][2][j].setAttribute('data-y', y + mergeCellUpdates[keys[i]][2]);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tobj.options.mergeCells[columnIdTo] = obj.options.mergeCells[columnIdFrom];\r\n\t\t\t\t\t\tdelete(obj.options.mergeCells[columnIdFrom]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Update formulas\r\n\t\t\tobj.updateFormulas(affectedTokens);\r\n\r\n\t\t\t// Update meta data\r\n\t\t\tobj.updateMeta(affectedTokens);\r\n\r\n\t\t\t// Refresh selection\r\n\t\t\tobj.refreshSelection();\r\n\r\n\t\t\t// Update table with custom configuration if applicable\r\n\t\t\tobj.updateTable();\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Custom settings for the cells\r\n\t\t */\r\n\t\tobj.updateTable = function() {\r\n\t\t\t// Check for spare\r\n\t\t\tif (obj.options.minSpareRows > 0) {\r\n\t\t\t\tvar numBlankRows = 0;\r\n\t\t\t\tfor (var j = obj.rows.length - 1; j >= 0; j--) {\r\n\t\t\t\t\tvar test = false;\r\n\t\t\t\t\tfor (var i = 0; i < obj.headers.length; i++) {\r\n\t\t\t\t\t\tif (obj.options.data[j][i]) {\r\n\t\t\t\t\t\t\ttest = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (test) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tnumBlankRows++;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (obj.options.minSpareRows - numBlankRows > 0) {\r\n\t\t\t\t\tobj.insertRow(obj.options.minSpareRows - numBlankRows)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (obj.options.minSpareCols > 0) {\r\n\t\t\t\tvar numBlankCols = 0;\r\n\t\t\t\tfor (var i = obj.headers.length - 1; i >= 0 ; i--) {\r\n\t\t\t\t\tvar test = false;\r\n\t\t\t\t\tfor (var j = 0; j < obj.rows.length; j++) {\r\n\t\t\t\t\t\tif (obj.options.data[j][i]) {\r\n\t\t\t\t\t\t\ttest = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (test) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tnumBlankCols++;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (obj.options.minSpareCols - numBlankCols > 0) {\r\n\t\t\t\t\tobj.insertColumn(obj.options.minSpareCols - numBlankCols)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Customizations by the developer\r\n\t\t\tif (typeof(obj.options.updateTable) == 'function') {\r\n\t\t\t\tif (obj.options.detachForUpdates) {\r\n\t\t\t\t\tel.removeChild(obj.content);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor (var j = 0; j < obj.rows.length; j++) {\r\n\t\t\t\t\tfor (var i = 0; i < obj.headers.length; i++) {\r\n\t\t\t\t\t\tobj.options.updateTable(el, obj.records[j][i], i, j, obj.options.data[j][i], obj.records[j][i].textContent, jexcel.getColumnNameFromId([i, j]));\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (obj.options.detachForUpdates) {\r\n\t\t\t\t\tel.insertBefore(obj.content, obj.pagination);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Update footers\r\n\t\t\tif (obj.options.footers) {\r\n\t\t\t\tobj.setFooter();\r\n\t\t\t}\r\n\r\n\t\t\t// Update corner position\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\tobj.updateCornerPosition();\r\n\t\t\t},0);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Readonly\r\n\t\t */\r\n\t\tobj.isReadOnly = function(cell) {\r\n\t\t\tif (cell = obj.getCell(cell)) {\r\n\t\t\t\treturn cell.classList.contains('readonly') ? true : false;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Readonly\r\n\t\t */\r\n\t\tobj.setReadOnly = function(cell, state) {\r\n\t\t\tif (cell = obj.getCell(cell)) {\r\n\t\t\t\tif (state) {\r\n\t\t\t\t\tcell.classList.add('readonly');\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcell.classList.remove('readonly');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Show row\r\n\t\t */\r\n\t\tobj.showRow = function(rowNumber) {\r\n\t\t\tobj.rows[rowNumber].style.display = '';\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Hide row\r\n\t\t */\r\n\t\tobj.hideRow = function(rowNumber) {\r\n\t\t\tobj.rows[rowNumber].style.display = 'none';\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Show column\r\n\t\t */\r\n\t\tobj.showColumn = function(colNumber) {\r\n\t\t\tobj.headers[colNumber].style.display = '';\r\n\t\t\tobj.colgroup[colNumber].style.display = '';\r\n\t\t\tif (obj.filter && obj.filter.children.length > colNumber + 1) {\r\n\t\t\t\tobj.filter.children[colNumber + 1].style.display = '';\r\n\t\t\t}\r\n\t\t\tfor (var j = 0; j < obj.options.data.length; j++) {\r\n\t\t\t\tobj.records[j][colNumber].style.display = '';\r\n\t\t\t}\r\n\r\n\t\t\t// Update footers\r\n\t\t\tif (obj.options.footers) {\r\n\t\t\t\tobj.setFooter();\r\n\t\t\t}\r\n\r\n\t\t\tobj.resetSelection();\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Hide column\r\n\t\t */\r\n\t\tobj.hideColumn = function(colNumber) {\r\n\t\t\tobj.headers[colNumber].style.display = 'none';\r\n\t\t\tobj.colgroup[colNumber].style.display = 'none';\r\n\t\t\tif (obj.filter && obj.filter.children.length > colNumber + 1) {\r\n\t\t\t\tobj.filter.children[colNumber + 1].style.display = 'none';\r\n\t\t\t}\r\n\t\t\tfor (var j = 0; j < obj.options.data.length; j++) {\r\n\t\t\t\tobj.records[j][colNumber].style.display = 'none';\r\n\t\t\t}\r\n\r\n\t\t\t// Update footers\r\n\t\t\tif (obj.options.footers) {\r\n\t\t\t\tobj.setFooter();\r\n\t\t\t}\r\n\r\n\t\t\tobj.resetSelection();\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Show index column\r\n\t\t */\r\n\t\tobj.showIndex = function() {\r\n\t\t\tobj.table.classList.remove('jexcel_hidden_index');\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Hide index column\r\n\t\t */\r\n\t\tobj.hideIndex = function() {\r\n\t\t\tobj.table.classList.add('jexcel_hidden_index');\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Update all related cells in the chain\r\n\t\t */\r\n\t\tvar chainLoopProtection = [];\r\n\r\n\t\tobj.updateFormulaChain = function(x, y, records) {\r\n\t\t\tvar cellId = jexcel.getColumnNameFromId([x, y]);\r\n\t\t\tif (obj.formula[cellId] && obj.formula[cellId].length > 0) {\r\n\t\t\t\tif (chainLoopProtection[cellId]) {\r\n\t\t\t\t\tobj.records[y][x].innerHTML = '#ERROR';\r\n\t\t\t\t\tobj.formula[cellId] = '';\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Protection\r\n\t\t\t\t\tchainLoopProtection[cellId] = true;\r\n\r\n\t\t\t\t\tfor (var i = 0; i < obj.formula[cellId].length; i++) {\r\n\t\t\t\t\t\tvar cell = jexcel.getIdFromColumnName(obj.formula[cellId][i], true);\r\n\t\t\t\t\t\t// Update cell\r\n\t\t\t\t\t\tvar value = ''+obj.options.data[cell[1]][cell[0]];\r\n\t\t\t\t\t\tif (value.substr(0,1) == '=') {\r\n\t\t\t\t\t\t\trecords.push(obj.updateCell(cell[0], cell[1], value, true));\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t// No longer a formula, remove from the chain\r\n\t\t\t\t\t\t\tObject.keys(obj.formula)[i] = null;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tobj.updateFormulaChain(cell[0], cell[1], records);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tchainLoopProtection = [];\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Update formulas\r\n\t\t */\r\n\t\tobj.updateFormulas = function(referencesToUpdate) {\r\n\t\t\t// Update formulas\r\n\t\t\tfor (var j = 0; j < obj.options.data.length; j++) {\r\n\t\t\t\tfor (var i = 0; i < obj.options.data[0].length; i++) {\r\n\t\t\t\t\tvar value = '' + obj.options.data[j][i];\r\n\t\t\t\t\t// Is formula\r\n\t\t\t\t\tif (value.substr(0,1) == '=') {\r\n\t\t\t\t\t\t// Replace tokens\r\n\t\t\t\t\t\tvar newFormula = obj.updateFormula(value, referencesToUpdate);\r\n\t\t\t\t\t\tif (newFormula != value) {\r\n\t\t\t\t\t\t\t/* TablePress: Only setting the value is not enough. updateCell is needed to update the DOM. */\r\n\t\t\t\t\t\t\t//obj.options.data[j][i] = newFormula;\r\n\t\t\t\t\t\t\tobj.updateCell( i, j, newFormula );\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Update formula chain\r\n\t\t\tvar formula = [];\r\n\t\t\tvar keys = Object.keys(obj.formula);\r\n\t\t\tfor (var j = 0; j < keys.length; j++) {\r\n\t\t\t\t// Current key and values\r\n\t\t\t\tvar key = keys[j];\r\n\t\t\t\tvar value = obj.formula[key];\r\n\t\t\t\t// Update key\r\n\t\t\t\tif (referencesToUpdate[key]) {\r\n\t\t\t\t\tkey = referencesToUpdate[key];\r\n\t\t\t\t}\r\n\t\t\t\t// Update values\r\n\t\t\t\tformula[key] = [];\r\n\t\t\t\tfor (var i = 0; i < value.length; i++) {\r\n\t\t\t\t\tvar letter = value[i];\r\n\t\t\t\t\tif (referencesToUpdate[letter]) {\r\n\t\t\t\t\t\tletter = referencesToUpdate[letter];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tformula[key].push(letter);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tobj.formula = formula;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Update formula\r\n\t\t *\r\n\t\t * TablePress @TODO: This currently updates all references, including those outside of {} delimiters.\r\n\t\t * Replace this with the code of the existing implementation.\r\n\t\t */\r\n\t\tobj.updateFormula = function(formula, referencesToUpdate) {\r\n\t\t\tvar testLetter = /[A-Z]/;\r\n\t\t\tvar testNumber = /[0-9]/;\r\n\r\n\t\t\tvar newFormula = '';\r\n\t\t\tvar letter = null;\r\n\t\t\tvar number = null;\r\n\t\t\tvar token = '';\r\n\r\n\t\t\tfor (var index = 0; index < formula.length; index++) {\r\n\t\t\t\tif (testLetter.exec(formula[index])) {\r\n\t\t\t\t\tletter = 1;\r\n\t\t\t\t\tnumber = 0;\r\n\t\t\t\t\ttoken += formula[index];\r\n\t\t\t\t} else if (testNumber.exec(formula[index])) {\r\n\t\t\t\t\tnumber = letter ? 1 : 0;\r\n\t\t\t\t\ttoken += formula[index];\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (letter && number) {\r\n\t\t\t\t\t\ttoken = referencesToUpdate[token] ? referencesToUpdate[token] : token;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tnewFormula += token;\r\n\t\t\t\t\tnewFormula += formula[index];\r\n\t\t\t\t\tletter = 0;\r\n\t\t\t\t\tnumber = 0;\r\n\t\t\t\t\ttoken = '';\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (token) {\r\n\t\t\t\tif (letter && number) {\r\n\t\t\t\t\ttoken = referencesToUpdate[token] ? referencesToUpdate[token] : token;\r\n\t\t\t\t}\r\n\t\t\t\tnewFormula += token;\r\n\t\t\t}\r\n\r\n\t\t\treturn newFormula;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Secure formula\r\n\t\t */\r\n\t\tvar secureFormula = function(oldValue) {\r\n\t\t\tvar newValue = '';\r\n\t\t\tvar inside = 0;\r\n\r\n\t\t\tfor (var i = 0; i < oldValue.length; i++) {\r\n\t\t\t\tif (oldValue[i] == '\"') {\r\n\t\t\t\t\tif (inside == 0) {\r\n\t\t\t\t\t\tinside = 1;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tinside = 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (inside == 1) {\r\n\t\t\t\t\tnewValue += oldValue[i];\r\n\t\t\t\t} else {\r\n\t\t\t\t\tnewValue += oldValue[i].toUpperCase();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn newValue;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Parse formulas\r\n\t\t */\r\n\t\tobj.executeFormula = function(expression, x, y) {\r\n\r\n\t\t\tvar formulaResults = [];\r\n\t\t\tvar formulaLoopProtection = [];\r\n\r\n\t\t\t// Execute formula with loop protection\r\n\t\t\tvar execute = function(expression, x, y) {\r\n\t\t\t // Parent column identification\r\n\t\t\t\tvar parentId = jexcel.getColumnNameFromId([x, y]);\r\n\r\n\t\t\t\t// Code protection\r\n\t\t\t\tif (formulaLoopProtection[parentId]) {\r\n\t\t\t\t\tconsole.error('Reference loop detected');\r\n\t\t\t\t\treturn '#ERROR';\r\n\t\t\t\t}\r\n\r\n\t\t\t\tformulaLoopProtection[parentId] = true;\r\n\r\n\t\t\t\t// Convert range tokens\r\n\t\t\t\tvar tokensUpdate = function(tokens) {\r\n\t\t\t\t\tfor (var index = 0; index < tokens.length; index++) {\r\n\t\t\t\t\t\tvar f = [];\r\n\t\t\t\t\t\tvar token = tokens[index].split(':');\r\n\t\t\t\t\t\tvar e1 = jexcel.getIdFromColumnName(token[0], true);\r\n\t\t\t\t\t\tvar e2 = jexcel.getIdFromColumnName(token[1], true);\r\n\r\n\t\t\t\t\t\tif (e1[0] <= e2[0]) {\r\n\t\t\t\t\t\t\tvar x1 = e1[0];\r\n\t\t\t\t\t\t\tvar x2 = e2[0];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tvar x1 = e2[0];\r\n\t\t\t\t\t\t\tvar x2 = e1[0];\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (e1[1] <= e2[1]) {\r\n\t\t\t\t\t\t\tvar y1 = e1[1];\r\n\t\t\t\t\t\t\tvar y2 = e2[1];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tvar y1 = e2[1];\r\n\t\t\t\t\t\t\tvar y2 = e1[1];\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tfor (var j = y1; j <= y2; j++) {\r\n\t\t\t\t\t\t\tfor (var i = x1; i <= x2; i++) {\r\n\t\t\t\t\t\t\t\tf.push(jexcel.getColumnNameFromId([i, j]));\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\texpression = expression.replace(tokens[index], f.join(','));\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Range with $ remove $\r\n\t\t\t\texpression = expression.replace(/\\$?([A-Z]+)\\$?([0-9]+)/g, \"$1$2\");\r\n\r\n\t\t\t\tvar tokens = expression.match(/([A-Z]+[0-9]+)\\:([A-Z]+[0-9]+)/g);\r\n\t\t\t\tif (tokens && tokens.length) {\r\n\t\t\t\t\ttokensUpdate(tokens);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Get tokens\r\n\t\t\t\tvar tokens = expression.match(/([A-Z]+[0-9]+)/g);\r\n\r\n\t\t\t\t// Direct self-reference protection\r\n\t\t\t\tif (tokens && tokens.indexOf(parentId) > -1) {\r\n\t\t\t\t\tconsole.error('Self Reference detected');\r\n\t\t\t\t\treturn '#ERROR';\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Expressions to be used in the parsing\r\n\t\t\t\t\tvar formulaExpressions = {};\r\n\r\n\t\t\t\t\tif (tokens) {\r\n\t\t\t\t\t\tfor (var i = 0; i < tokens.length; i++) {\r\n\t\t\t\t\t\t\t// Keep chain\r\n\t\t\t\t\t\t\tif (! obj.formula[tokens[i]]) {\r\n\t\t\t\t\t\t\t\tobj.formula[tokens[i]] = [];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t// Is already in the register\r\n\t\t\t\t\t\t\tif (obj.formula[tokens[i]].indexOf(parentId) < 0) {\r\n\t\t\t\t\t\t\t\tobj.formula[tokens[i]].push(parentId);\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t// Do not calculate again\r\n\t\t\t\t\t\t\tif (eval('typeof(' + tokens[i] + ') == \"undefined\"')) {\r\n\t\t\t\t\t\t\t\t// Coords\r\n\t\t\t\t\t\t\t\tvar position = jexcel.getIdFromColumnName(tokens[i], 1);\r\n\t\t\t\t\t\t\t\t// Get value\r\n\t\t\t\t\t\t\t\tif (typeof(obj.options.data[position[1]]) != 'undefined' && typeof(obj.options.data[position[1]][position[0]]) != 'undefined') {\r\n\t\t\t\t\t\t\t\t\tvar value = obj.options.data[position[1]][position[0]];\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tvar value = '';\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t// Get column data\r\n\t\t\t\t\t\t\t\tif ((''+value).substr(0,1) == '=') {\r\n\t\t\t\t\t\t\t\t\tif (typeof formulaResults[tokens[i]] !== 'undefined') {\r\n\t\t\t\t\t\t\t\t\t\tvalue = formulaResults[tokens[i]];\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tvalue = execute(value, position[0], position[1]);\r\n\t\t\t\t\t\t\t\t\t\tformulaResults[tokens[i]] = value;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t// Type!\r\n\t\t\t\t\t\t\t\tif ((''+value).trim() == '') {\r\n\t\t\t\t\t\t\t\t\t// Null\r\n\t\t\t\t\t\t\t\t\tformulaExpressions[tokens[i]] = null;\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tif (value == Number(value) && obj.options.autoCasting == true) {\r\n\t\t\t\t\t\t\t\t\t\t// Number\r\n\t\t\t\t\t\t\t\t\t\tformulaExpressions[tokens[i]] = Number(value);\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t// Trying any formatted number\r\n\t\t\t\t\t\t\t\t\t\tvar number = obj.parseNumber(value, position[0])\r\n\t\t\t\t\t\t\t\t\t\tif (obj.options.autoCasting == true && number) {\r\n\t\t\t\t\t\t\t\t\t\t\tformulaExpressions[tokens[i]] = number;\r\n\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\tformulaExpressions[tokens[i]] = '\"' + value + '\"';\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Convert formula to javascript\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tvar res = jexcel.formula(expression.substr(1), formulaExpressions, x, y, obj);\r\n\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\tvar res = '#ERROR';\r\n\t\t\t\t\t\tconsole.log(e)\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn res;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn execute(expression, x, y);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Trying to extract a number from a string\r\n\t\t */\r\n\t\tobj.parseNumber = function(value, columnNumber) {\r\n\t\t\t// Decimal point\r\n\t\t\tvar decimal = columnNumber && obj.options.columns[columnNumber].decimal ? obj.options.columns[columnNumber].decimal : '.';\r\n\r\n\t\t\t// Parse both parts of the number\r\n\t\t\tvar number = ('' + value);\r\n\t\t\tnumber = number.split(decimal);\r\n\t\t\tnumber[0] = number[0].match(/[+-]?[0-9]/g);\r\n\t\t\tif (number[0]) {\r\n\t\t\t\tnumber[0] = number[0].join('');\r\n\t\t\t}\r\n\t\t\tif (number[1]) {\r\n\t\t\t\tnumber[1] = number[1].match(/[0-9]*/g).join('');\r\n\t\t\t}\r\n\r\n\t\t\t// Is a valid number\r\n\t\t\tif (number[0] && Number.isInteger(Number(number[0]))) {\r\n\t\t\t\tif (! number[1]) {\r\n\t\t\t\t\tvar value = Number(number[0] + '.00');\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvar value = Number(number[0] + '.' + number[1]);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tvar value = null;\r\n\t\t\t}\r\n\r\n\t\t\treturn value;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Get row number\r\n\t\t */\r\n\t\tobj.row = function(cell) {\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Get col number\r\n\t\t */\r\n\t\tobj.col = function(cell) {\r\n\t\t}\r\n\r\n\t\tobj.up = function(shiftKey, ctrlKey) {\r\n\t\t\tif (shiftKey) {\r\n\t\t\t\tif (obj.selectedCell[3] > 0) {\r\n\t\t\t\t\tobj.up.visible(1, ctrlKey ? 0 : 1)\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (obj.selectedCell[1] > 0) {\r\n\t\t\t\t\tobj.up.visible(0, ctrlKey ? 0 : 1)\r\n\t\t\t\t}\r\n\t\t\t\tobj.selectedCell[2] = obj.selectedCell[0];\r\n\t\t\t\tobj.selectedCell[3] = obj.selectedCell[1];\r\n\t\t\t}\r\n\r\n\t\t\t// Update selection\r\n\t\t\tobj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\r\n\r\n\t\t\t// Change page\r\n\t\t\tif (obj.options.lazyLoading == true) {\r\n\t\t\t\tif (obj.selectedCell[1] == 0 || obj.selectedCell[3] == 0) {\r\n\t\t\t\t\tobj.loadPage(0);\r\n\t\t\t\t\tobj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (obj.loadValidation()) {\r\n\t\t\t\t\t\tobj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tvar item = parseInt(obj.tbody.firstChild.getAttribute('data-y'));\r\n\t\t\t\t\t\tif (obj.selectedCell[1] - item < 30) {\r\n\t\t\t\t\t\t\tobj.loadUp();\r\n\t\t\t\t\t\t\tobj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else if (obj.options.pagination > 0) {\r\n\t\t\t\tvar pageNumber = obj.whichPage(obj.selectedCell[3]);\r\n\t\t\t\tif (pageNumber != obj.pageNumber) {\r\n\t\t\t\t\tobj.page(pageNumber);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tobj.updateScroll(1);\r\n\t\t}\r\n\r\n\t\tobj.up.visible = function(group, direction) {\r\n\t\t\tif (group == 0) {\r\n\t\t\t\tvar x = parseInt(obj.selectedCell[0]);\r\n\t\t\t\tvar y = parseInt(obj.selectedCell[1]);\r\n\t\t\t} else {\r\n\t\t\t\tvar x = parseInt(obj.selectedCell[2]);\r\n\t\t\t\tvar y = parseInt(obj.selectedCell[3]);\r\n\t\t\t}\r\n\r\n\t\t\tif (direction == 0) {\r\n\t\t\t\tfor (var j = 0; j < y; j++) {\r\n\t\t\t\t\tif (obj.records[j][x].style.display != 'none' && obj.rows[j].style.display != 'none') {\r\n\t\t\t\t\t\ty = j;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\ty = obj.up.get(x, y);\r\n\t\t\t}\r\n\r\n\t\t\tif (group == 0) {\r\n\t\t\t\tobj.selectedCell[0] = x;\r\n\t\t\t\tobj.selectedCell[1] = y;\r\n\t\t\t} else {\r\n\t\t\t\tobj.selectedCell[2] = x;\r\n\t\t\t\tobj.selectedCell[3] = y;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tobj.up.get = function(x, y) {\r\n\t\t\tvar x = parseInt(x);\r\n\t\t\tvar y = parseInt(y);\r\n\t\t\tfor (var j = (y - 1); j >= 0; j--) {\r\n\t\t\t\tif (obj.records[j][x].style.display != 'none' && obj.rows[j].style.display != 'none') {\r\n\t\t\t\t\tif (obj.records[j][x].getAttribute('data-merged')) {\r\n\t\t\t\t\t\tif (obj.records[j][x] == obj.records[y][x]) {\r\n\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\ty = j;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn y;\r\n\t\t}\r\n\r\n\t\tobj.down = function(shiftKey, ctrlKey) {\r\n\t\t\tif (shiftKey) {\r\n\t\t\t\tif (obj.selectedCell[3] < obj.records.length - 1) {\r\n\t\t\t\t\tobj.down.visible(1, ctrlKey ? 0 : 1)\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (obj.selectedCell[1] < obj.records.length - 1) {\r\n\t\t\t\t\tobj.down.visible(0, ctrlKey ? 0 : 1)\r\n\t\t\t\t}\r\n\t\t\t\tobj.selectedCell[2] = obj.selectedCell[0];\r\n\t\t\t\tobj.selectedCell[3] = obj.selectedCell[1];\r\n\t\t\t}\r\n\r\n\t\t\tobj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\r\n\r\n\t\t\t// Change page\r\n\t\t\tif (obj.options.lazyLoading == true) {\r\n\t\t\t\tif ((obj.selectedCell[1] == obj.records.length - 1 || obj.selectedCell[3] == obj.records.length - 1)) {\r\n\t\t\t\t\tobj.loadPage(-1);\r\n\t\t\t\t\tobj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (obj.loadValidation()) {\r\n\t\t\t\t\t\tobj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tvar item = parseInt(obj.tbody.lastChild.getAttribute('data-y'));\r\n\t\t\t\t\t\tif (item - obj.selectedCell[3] < 30) {\r\n\t\t\t\t\t\t\tobj.loadDown();\r\n\t\t\t\t\t\t\tobj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else if (obj.options.pagination > 0) {\r\n\t\t\t\tvar pageNumber = obj.whichPage(obj.selectedCell[3]);\r\n\t\t\t\tif (pageNumber != obj.pageNumber) {\r\n\t\t\t\t\tobj.page(pageNumber);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tobj.updateScroll(3);\r\n\t\t}\r\n\r\n\t\tobj.down.visible = function(group, direction) {\r\n\t\t\tif (group == 0) {\r\n\t\t\t\tvar x = parseInt(obj.selectedCell[0]);\r\n\t\t\t\tvar y = parseInt(obj.selectedCell[1]);\r\n\t\t\t} else {\r\n\t\t\t\tvar x = parseInt(obj.selectedCell[2]);\r\n\t\t\t\tvar y = parseInt(obj.selectedCell[3]);\r\n\t\t\t}\r\n\r\n\t\t\tif (direction == 0) {\r\n\t\t\t\tfor (var j = obj.rows.length - 1; j > y; j--) {\r\n\t\t\t\t\tif (obj.records[j][x].style.display != 'none' && obj.rows[j].style.display != 'none') {\r\n\t\t\t\t\t\ty = j;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\ty = obj.down.get(x, y);\r\n\t\t\t}\r\n\r\n\t\t\tif (group == 0) {\r\n\t\t\t\tobj.selectedCell[0] = x;\r\n\t\t\t\tobj.selectedCell[1] = y;\r\n\t\t\t} else {\r\n\t\t\t\tobj.selectedCell[2] = x;\r\n\t\t\t\tobj.selectedCell[3] = y;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tobj.down.get = function(x, y) {\r\n\t\t\tvar x = parseInt(x);\r\n\t\t\tvar y = parseInt(y);\r\n\t\t\tfor (var j = (y + 1); j < obj.rows.length; j++) {\r\n\t\t\t\tif (obj.records[j][x].style.display != 'none' && obj.rows[j].style.display != 'none') {\r\n\t\t\t\t\tif (obj.records[j][x].getAttribute('data-merged')) {\r\n\t\t\t\t\t\tif (obj.records[j][x] == obj.records[y][x]) {\r\n\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\ty = j;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn y;\r\n\t\t}\r\n\r\n\t\tobj.right = function(shiftKey, ctrlKey) {\r\n\t\t\tif (shiftKey) {\r\n\t\t\t\tif (obj.selectedCell[2] < obj.headers.length - 1) {\r\n\t\t\t\t\tobj.right.visible(1, ctrlKey ? 0 : 1)\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (obj.selectedCell[0] < obj.headers.length - 1) {\r\n\t\t\t\t\tobj.right.visible(0, ctrlKey ? 0 : 1)\r\n\t\t\t\t}\r\n\t\t\t\tobj.selectedCell[2] = obj.selectedCell[0];\r\n\t\t\t\tobj.selectedCell[3] = obj.selectedCell[1];\r\n\t\t\t}\r\n\r\n\t\t\tobj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\r\n\t\t\tobj.updateScroll(2);\r\n\t\t}\r\n\r\n\t\tobj.right.visible = function(group, direction) {\r\n\t\t\tif (group == 0) {\r\n\t\t\t\tvar x = parseInt(obj.selectedCell[0]);\r\n\t\t\t\tvar y = parseInt(obj.selectedCell[1]);\r\n\t\t\t} else {\r\n\t\t\t\tvar x = parseInt(obj.selectedCell[2]);\r\n\t\t\t\tvar y = parseInt(obj.selectedCell[3]);\r\n\t\t\t}\r\n\r\n\t\t\tif (direction == 0) {\r\n\t\t\t\tfor (var i = obj.headers.length - 1; i > x; i--) {\r\n\t\t\t\t\tif (obj.records[y][i].style.display != 'none') {\r\n\t\t\t\t\t\tx = i;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tx = obj.right.get(x, y);\r\n\t\t\t}\r\n\r\n\t\t\tif (group == 0) {\r\n\t\t\t\tobj.selectedCell[0] = x;\r\n\t\t\t\tobj.selectedCell[1] = y;\r\n\t\t\t} else {\r\n\t\t\t\tobj.selectedCell[2] = x;\r\n\t\t\t\tobj.selectedCell[3] = y;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tobj.right.get = function(x, y) {\r\n\t\t\tvar x = parseInt(x);\r\n\t\t\tvar y = parseInt(y);\r\n\r\n\t\t\tfor (var i = (x + 1); i < obj.headers.length; i++) {\r\n\t\t\t\tif (obj.records[y][i].style.display != 'none') {\r\n\t\t\t\t\tif (obj.records[y][i].getAttribute('data-merged')) {\r\n\t\t\t\t\t\tif (obj.records[y][i] == obj.records[y][x]) {\r\n\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tx = i;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn x;\r\n\t\t}\r\n\r\n\t\tobj.left = function(shiftKey, ctrlKey) {\r\n\t\t\tif (shiftKey) {\r\n\t\t\t\tif (obj.selectedCell[2] > 0) {\r\n\t\t\t\t\tobj.left.visible(1, ctrlKey ? 0 : 1)\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (obj.selectedCell[0] > 0) {\r\n\t\t\t\t\tobj.left.visible(0, ctrlKey ? 0 : 1)\r\n\t\t\t\t}\r\n\t\t\t\tobj.selectedCell[2] = obj.selectedCell[0];\r\n\t\t\t\tobj.selectedCell[3] = obj.selectedCell[1];\r\n\t\t\t}\r\n\r\n\t\t\tobj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\r\n\t\t\tobj.updateScroll(0);\r\n\t\t}\r\n\r\n\t\tobj.left.visible = function(group, direction) {\r\n\t\t\tif (group == 0) {\r\n\t\t\t\tvar x = parseInt(obj.selectedCell[0]);\r\n\t\t\t\tvar y = parseInt(obj.selectedCell[1]);\r\n\t\t\t} else {\r\n\t\t\t\tvar x = parseInt(obj.selectedCell[2]);\r\n\t\t\t\tvar y = parseInt(obj.selectedCell[3]);\r\n\t\t\t}\r\n\r\n\t\t\tif (direction == 0) {\r\n\t\t\t\tfor (var i = 0; i < x; i++) {\r\n\t\t\t\t\tif (obj.records[y][i].style.display != 'none') {\r\n\t\t\t\t\t\tx = i;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tx = obj.left.get(x, y);\r\n\t\t\t}\r\n\r\n\t\t\tif (group == 0) {\r\n\t\t\t\tobj.selectedCell[0] = x;\r\n\t\t\t\tobj.selectedCell[1] = y;\r\n\t\t\t} else {\r\n\t\t\t\tobj.selectedCell[2] = x;\r\n\t\t\t\tobj.selectedCell[3] = y;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tobj.left.get = function(x, y) {\r\n\t\t\tvar x = parseInt(x);\r\n\t\t\tvar y = parseInt(y);\r\n\t\t\tfor (var i = (x - 1); i >= 0; i--) {\r\n\t\t\t\tif (obj.records[y][i].style.display != 'none') {\r\n\t\t\t\t\tif (obj.records[y][i].getAttribute('data-merged')) {\r\n\t\t\t\t\t\tif (obj.records[y][i] == obj.records[y][x]) {\r\n\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tx = i;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn x;\r\n\t\t}\r\n\r\n\t\tobj.first = function(shiftKey, ctrlKey) {\r\n\t\t\tif (shiftKey) {\r\n\t\t\t\tif (ctrlKey) {\r\n\t\t\t\t\tobj.selectedCell[3] = 0;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tobj.left.visible(1, 0);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (ctrlKey) {\r\n\t\t\t\t\tobj.selectedCell[1] = 0;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tobj.left.visible(0, 0);\r\n\t\t\t\t}\r\n\t\t\t\tobj.selectedCell[2] = obj.selectedCell[0];\r\n\t\t\t\tobj.selectedCell[3] = obj.selectedCell[1];\r\n\t\t\t}\r\n\r\n\t\t\t// Change page\r\n\t\t\tif (obj.options.lazyLoading == true && (obj.selectedCell[1] == 0 || obj.selectedCell[3] == 0)) {\r\n\t\t\t\tobj.loadPage(0);\r\n\t\t\t} else if (obj.options.pagination > 0) {\r\n\t\t\t\tvar pageNumber = obj.whichPage(obj.selectedCell[3]);\r\n\t\t\t\tif (pageNumber != obj.pageNumber) {\r\n\t\t\t\t\tobj.page(pageNumber);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tobj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\r\n\t\t\tobj.updateScroll(1);\r\n\t\t}\r\n\r\n\t\tobj.last = function(shiftKey, ctrlKey) {\r\n\t\t\tif (shiftKey) {\r\n\t\t\t\tif (ctrlKey) {\r\n\t\t\t\t\tobj.selectedCell[3] = obj.records.length - 1;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tobj.right.visible(1, 0);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (ctrlKey) {\r\n\t\t\t\t\tobj.selectedCell[1] = obj.records.length - 1;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tobj.right.visible(0, 0);\r\n\t\t\t\t}\r\n\t\t\t\tobj.selectedCell[2] = obj.selectedCell[0];\r\n\t\t\t\tobj.selectedCell[3] = obj.selectedCell[1];\r\n\t\t\t}\r\n\r\n\t\t\t// Change page\r\n\t\t\tif (obj.options.lazyLoading == true && (obj.selectedCell[1] == obj.records.length - 1 || obj.selectedCell[3] == obj.records.length - 1)) {\r\n\t\t\t\tobj.loadPage(-1);\r\n\t\t\t} else if (obj.options.pagination > 0) {\r\n\t\t\t\tvar pageNumber = obj.whichPage(obj.selectedCell[3]);\r\n\t\t\t\tif (pageNumber != obj.pageNumber) {\r\n\t\t\t\t\tobj.page(pageNumber);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tobj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\r\n\t\t\tobj.updateScroll(3);\r\n\t\t}\r\n\r\n\t\tobj.selectAll = function() {\r\n\t\t\tif (! obj.selectedCell) {\r\n\t\t\t\tobj.selectedCell = [];\r\n\t\t\t}\r\n\r\n\t\t\tobj.selectedCell[0] = 0;\r\n\t\t\tobj.selectedCell[1] = 0;\r\n\t\t\tobj.selectedCell[2] = obj.headers.length - 1;\r\n\t\t\tobj.selectedCell[3] = obj.records.length - 1;\r\n\r\n\t\t\tobj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Go to a page in a lazyLoading\r\n\t\t */\r\n\t\tobj.loadPage = function(pageNumber) {\r\n\t\t\t// Search\r\n\t\t\tif ((obj.options.search == true || obj.options.filters == true) && obj.results) {\r\n\t\t\t\tvar results = obj.results;\r\n\t\t\t} else {\r\n\t\t\t\tvar results = obj.rows;\r\n\t\t\t}\r\n\r\n\t\t\t// Per page\r\n\t\t\tvar quantityPerPage = 100;\r\n\r\n\t\t\t// pageNumber\r\n\t\t\tif (pageNumber == null || pageNumber == -1) {\r\n\t\t\t\t// Last page\r\n\t\t\t\tpageNumber = Math.ceil(results.length / quantityPerPage) - 1;\r\n\t\t\t}\r\n\r\n\t\t\tvar startRow = (pageNumber * quantityPerPage);\r\n\t\t\tvar finalRow = (pageNumber * quantityPerPage) + quantityPerPage;\r\n\t\t\tif (finalRow > results.length) {\r\n\t\t\t\tfinalRow = results.length;\r\n\t\t\t}\r\n\t\t\tstartRow = finalRow - 100;\r\n\t\t\tif (startRow < 0) {\r\n\t\t\t\tstartRow = 0;\r\n\t\t\t}\r\n\r\n\t\t\t// Appeding items\r\n\t\t\tfor (var j = startRow; j < finalRow; j++) {\r\n\t\t\t\tif ((obj.options.search == true || obj.options.filters == true) && obj.results) {\r\n\t\t\t\t\tobj.tbody.appendChild(obj.rows[results[j]]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tobj.tbody.appendChild(obj.rows[j]);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (obj.tbody.children.length > quantityPerPage) {\r\n\t\t\t\t\tobj.tbody.removeChild(obj.tbody.firstChild);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tobj.loadUp = function() {\r\n\t\t\t// Search\r\n\t\t\tif ((obj.options.search == true || obj.options.filters == true) && obj.results) {\r\n\t\t\t\tvar results = obj.results;\r\n\t\t\t} else {\r\n\t\t\t\tvar results = obj.rows;\r\n\t\t\t}\r\n\t\t\tvar test = 0;\r\n\t\t\tif (results.length > 100) {\r\n\t\t\t\t// Get the first element in the page\r\n\t\t\t\tvar item = parseInt(obj.tbody.firstChild.getAttribute('data-y'));\r\n\t\t\t\tif ((obj.options.search == true || obj.options.filters == true) && obj.results) {\r\n\t\t\t\t\titem = results.indexOf(item);\r\n\t\t\t\t}\r\n\t\t\t\tif (item > 0) {\r\n\t\t\t\t\tfor (var j = 0; j < 30; j++) {\r\n\t\t\t\t\t\titem = item - 1;\r\n\t\t\t\t\t\tif (item > -1) {\r\n\t\t\t\t\t\t\tif ((obj.options.search == true || obj.options.filters == true) && obj.results) {\r\n\t\t\t\t\t\t\t\tobj.tbody.insertBefore(obj.rows[results[item]], obj.tbody.firstChild);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tobj.tbody.insertBefore(obj.rows[item], obj.tbody.firstChild);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (obj.tbody.children.length > 100) {\r\n\t\t\t\t\t\t\t\tobj.tbody.removeChild(obj.tbody.lastChild);\r\n\t\t\t\t\t\t\t\ttest = 1;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn test;\r\n\t\t}\r\n\r\n\t\tobj.loadDown = function() {\r\n\t\t\t// Search\r\n\t\t\tif ((obj.options.search == true || obj.options.filters == true) && obj.results) {\r\n\t\t\t\tvar results = obj.results;\r\n\t\t\t} else {\r\n\t\t\t\tvar results = obj.rows;\r\n\t\t\t}\r\n\t\t\tvar test = 0;\r\n\t\t\tif (results.length > 100) {\r\n\t\t\t\t// Get the last element in the page\r\n\t\t\t\tvar item = parseInt(obj.tbody.lastChild.getAttribute('data-y'));\r\n\t\t\t\tif ((obj.options.search == true || obj.options.filters == true) && obj.results) {\r\n\t\t\t\t\titem = results.indexOf(item);\r\n\t\t\t\t}\r\n\t\t\t\tif (item < obj.rows.length - 1) {\r\n\t\t\t\t\tfor (var j = 0; j <= 30; j++) {\r\n\t\t\t\t\t\tif (item < results.length) {\r\n\t\t\t\t\t\t\tif ((obj.options.search == true || obj.options.filters == true) && obj.results) {\r\n\t\t\t\t\t\t\t\tobj.tbody.appendChild(obj.rows[results[item]]);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tobj.tbody.appendChild(obj.rows[item]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (obj.tbody.children.length > 100) {\r\n\t\t\t\t\t\t\t\tobj.tbody.removeChild(obj.tbody.firstChild);\r\n\t\t\t\t\t\t\t\ttest = 1;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\titem = item + 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn test;\r\n\t\t}\r\n\r\n\t\tobj.loadValidation = function() {\r\n\t\t\tif (obj.selectedCell) {\r\n\t\t\t\tvar currentPage = parseInt(obj.tbody.firstChild.getAttribute('data-y')) / 100;\r\n\t\t\t\tvar selectedPage = parseInt(obj.selectedCell[3] / 100);\r\n\t\t\t\tvar totalPages = parseInt(obj.rows.length / 100);\r\n\r\n\t\t\t\tif (currentPage != selectedPage && selectedPage <= totalPages) {\r\n\t\t\t\t\tif (! Array.prototype.indexOf.call(obj.tbody.children, obj.rows[obj.selectedCell[3]])) {\r\n\t\t\t\t\t\tobj.loadPage(selectedPage);\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Reset search\r\n\t\t */\r\n\t\tobj.resetSearch = function() {\r\n\t\t\tobj.searchInput.value = '';\r\n\t\t\tobj.search('');\r\n\t\t\tobj.results = null;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Search\r\n\t\t */\r\n\t\tobj.search = function(query) {\r\n\t\t\t// Reset any filter\r\n\t\t\tif (obj.options.filters) {\r\n\t\t\t\tobj.resetFilters();\r\n\t\t\t}\r\n\r\n\t\t\t// Reset selection\r\n\t\t\tobj.resetSelection();\r\n\r\n\t\t\t// Total of results\r\n\t\t\tobj.pageNumber = 0;\r\n\t\t\tobj.results = [];\r\n\r\n\t\t\tif (query) {\r\n\t\t\t\t// Search filter\r\n\t\t\t\tvar search = function(item, query, index) {\r\n\t\t\t\t\tfor (var i = 0; i < item.length; i++) {\r\n\t\t\t\t\t\tif ((''+item[i]).toLowerCase().search(query) >= 0 ||\r\n\t\t\t\t\t\t\t(''+obj.records[index][i].innerHTML).toLowerCase().search(query) >= 0) {\r\n\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Result\r\n\t\t\t\tvar addToResult = function(k) {\r\n\t\t\t\t\tif (obj.results.indexOf(k) == -1) {\r\n\t\t\t\t\t\tobj.results.push(k);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar parsedQuery = query.replace(/[-[\\]{}()*+?.,\\\\^$|#\\s]/g, \"\\\\$&\");\r\n\t\t\t\tparsedQuery = new RegExp(parsedQuery, \"i\");\r\n\r\n\t\t\t\t// Filter\r\n\t\t\t\tobj.options.data.forEach(function(v, k) {\r\n\t\t\t\t\tif (search(v, parsedQuery, k)) {\r\n\t\t\t\t\t\t// Merged rows found\r\n\t\t\t\t\t\tvar rows = obj.isRowMerged(k);\r\n\t\t\t\t\t\tif (rows.length) {\r\n\t\t\t\t\t\t\tfor (var i = 0; i < rows.length; i++) {\r\n\t\t\t\t\t\t\t\tvar row = jexcel.getIdFromColumnName(rows[i], true);\r\n\t\t\t\t\t\t\t\tfor (var j = 0; j < obj.options.mergeCells[rows[i]][1]; j++) {\r\n\t\t\t\t\t\t\t\t\taddToResult(row[1]+j);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t// Normal row found\r\n\t\t\t\t\t\t\taddToResult(k);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tobj.results = null;\r\n\t\t\t}\r\n\r\n\t\t\treturn obj.updateResult();\r\n\t\t}\r\n\r\n\t\tobj.updateResult = function() {\r\n\t\t\tvar total = 0;\r\n\t\t\tvar index = 0;\r\n\r\n\t\t\t// Page 1\r\n\t\t\tif (obj.options.lazyLoading == true) {\r\n\t\t\t\ttotal = 100;\r\n\t\t\t} else if (obj.options.pagination > 0) {\r\n\t\t\t\ttotal = obj.options.pagination;\r\n\t\t\t} else {\r\n\t\t\t\tif (obj.results) {\r\n\t\t\t\t\ttotal = obj.results.length;\r\n\t\t\t\t} else {\r\n\t\t\t\t\ttotal = obj.rows.length;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Reset current nodes\r\n\t\t\twhile (obj.tbody.firstChild) {\r\n\t\t\t\tobj.tbody.removeChild(obj.tbody.firstChild);\r\n\t\t\t}\r\n\r\n\t\t\t// Hide all records from the table\r\n\t\t\tfor (var j = 0; j < obj.rows.length; j++) {\r\n\t\t\t\tif (! obj.results || obj.results.indexOf(j) > -1) {\r\n\t\t\t\t\tif (index < total) {\r\n\t\t\t\t\t\tobj.tbody.appendChild(obj.rows[j]);\r\n\t\t\t\t\t\tindex++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tobj.rows[j].style.display = '';\r\n\t\t\t\t} else {\r\n\t\t\t\t\tobj.rows[j].style.display = 'none';\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Update pagination\r\n\t\t\tif (obj.options.pagination > 0) {\r\n\t\t\t\tobj.updatePagination();\r\n\t\t\t}\r\n\r\n\t\t\tobj.updateCornerPosition();\r\n\r\n\t\t\treturn total;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Which page the cell is\r\n\t\t */\r\n\t\tobj.whichPage = function(cell) {\r\n\t\t\t// Search\r\n\t\t\tif ((obj.options.search == true || obj.options.filters == true) && obj.results) {\r\n\t\t\t\tcell = obj.results.indexOf(cell);\r\n\t\t\t}\r\n\r\n\t\t\treturn (Math.ceil((parseInt(cell) + 1) / parseInt(obj.options.pagination))) - 1;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Go to page\r\n\t\t */\r\n\t\tobj.page = function(pageNumber) {\r\n\t\t\tvar oldPage = obj.pageNumber;\r\n\r\n\t\t\t// Search\r\n\t\t\tif ((obj.options.search == true || obj.options.filters == true) && obj.results) {\r\n\t\t\t\tvar results = obj.results;\r\n\t\t\t} else {\r\n\t\t\t\tvar results = obj.rows;\r\n\t\t\t}\r\n\r\n\t\t\t// Per page\r\n\t\t\tvar quantityPerPage = parseInt(obj.options.pagination);\r\n\r\n\t\t\t// pageNumber\r\n\t\t\tif (pageNumber == null || pageNumber == -1) {\r\n\t\t\t\t// Last page\r\n\t\t\t\tpageNumber = Math.ceil(results.length / quantityPerPage) - 1;\r\n\t\t\t}\r\n\r\n\t\t\t// Page number\r\n\t\t\tobj.pageNumber = pageNumber;\r\n\r\n\t\t\tvar startRow = (pageNumber * quantityPerPage);\r\n\t\t\tvar finalRow = (pageNumber * quantityPerPage) + quantityPerPage;\r\n\t\t\tif (finalRow > results.length) {\r\n\t\t\t\tfinalRow = results.length;\r\n\t\t\t}\r\n\t\t\tif (startRow < 0) {\r\n\t\t\t\tstartRow = 0;\r\n\t\t\t}\r\n\r\n\t\t\t// Reset container\r\n\t\t\twhile (obj.tbody.firstChild) {\r\n\t\t\t\tobj.tbody.removeChild(obj.tbody.firstChild);\r\n\t\t\t}\r\n\r\n\t\t\t// Appeding items\r\n\t\t\tfor (var j = startRow; j < finalRow; j++) {\r\n\t\t\t\tif ((obj.options.search == true || obj.options.filters == true) && obj.results) {\r\n\t\t\t\t\tobj.tbody.appendChild(obj.rows[results[j]]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tobj.tbody.appendChild(obj.rows[j]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (obj.options.pagination > 0) {\r\n\t\t\t\tobj.updatePagination();\r\n\t\t\t}\r\n\r\n\t\t\t// Update corner position\r\n\t\t\tobj.updateCornerPosition();\r\n\r\n\t\t\t// Events\r\n\t\t\tobj.dispatch('onchangepage', el, pageNumber, oldPage);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Update the pagination\r\n\t\t */\r\n\t\tobj.updatePagination = function() {\r\n\t\t\t// Reset container\r\n\t\t\tobj.pagination.children[0].innerHTML = '';\r\n\t\t\tobj.pagination.children[1].innerHTML = '';\r\n\r\n\t\t\t// Start pagination\r\n\t\t\tif (obj.options.pagination) {\r\n\t\t\t\t// Searchable\r\n\t\t\t\tif ((obj.options.search == true || obj.options.filters == true) && obj.results) {\r\n\t\t\t\t\tvar results = obj.results.length;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvar results = obj.rows.length;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (! results) {\r\n\t\t\t\t\t// No records found\r\n\t\t\t\t\tobj.pagination.children[0].innerHTML = obj.options.text.noRecordsFound;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Pagination container\r\n\t\t\t\t\tvar quantyOfPages = Math.ceil(results / obj.options.pagination);\r\n\r\n\t\t\t\t\tif (obj.pageNumber < 6) {\r\n\t\t\t\t\t\tvar startNumber = 1;\r\n\t\t\t\t\t\tvar finalNumber = quantyOfPages < 10 ? quantyOfPages : 10;\r\n\t\t\t\t\t} else if (quantyOfPages - obj.pageNumber < 5) {\r\n\t\t\t\t\t\tvar startNumber = quantyOfPages - 9;\r\n\t\t\t\t\t\tvar finalNumber = quantyOfPages;\r\n\t\t\t\t\t\tif (startNumber < 1) {\r\n\t\t\t\t\t\t\tstartNumber = 1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tvar startNumber = obj.pageNumber - 4;\r\n\t\t\t\t\t\tvar finalNumber = obj.pageNumber + 5;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// First\r\n\t\t\t\t\tif (startNumber > 1) {\r\n\t\t\t\t\t\tvar paginationItem = document.createElement('div');\r\n\t\t\t\t\t\tpaginationItem.className = 'jexcel_page';\r\n\t\t\t\t\t\tpaginationItem.innerHTML = '<';\r\n\t\t\t\t\t\tpaginationItem.title = 1;\r\n\t\t\t\t\t\tobj.pagination.children[1].appendChild(paginationItem);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Get page links\r\n\t\t\t\t\tfor (var i = startNumber; i <= finalNumber; i++) {\r\n\t\t\t\t\t\tvar paginationItem = document.createElement('div');\r\n\t\t\t\t\t\tpaginationItem.className = 'jexcel_page';\r\n\t\t\t\t\t\tpaginationItem.innerHTML = i;\r\n\t\t\t\t\t\tobj.pagination.children[1].appendChild(paginationItem);\r\n\r\n\t\t\t\t\t\tif (obj.pageNumber == (i-1)) {\r\n\t\t\t\t\t\t\tpaginationItem.classList.add('jexcel_page_selected');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Last\r\n\t\t\t\t\tif (finalNumber < quantyOfPages) {\r\n\t\t\t\t\t\tvar paginationItem = document.createElement('div');\r\n\t\t\t\t\t\tpaginationItem.className = 'jexcel_page';\r\n\t\t\t\t\t\tpaginationItem.innerHTML = '>';\r\n\t\t\t\t\t\tpaginationItem.title = quantyOfPages;\r\n\t\t\t\t\t\tobj.pagination.children[1].appendChild(paginationItem);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Text\r\n\t\t\t\t\tvar format = function(format) {\r\n\t\t\t\t\t\tvar args = Array.prototype.slice.call(arguments, 1);\r\n\t\t\t\t\t\treturn format.replace(/{(\\d+)}/g, function(match, number) {\r\n\t\t\t\t\t\t  return typeof args[number] != 'undefined'\r\n\t\t\t\t\t\t\t? args[number]\r\n\t\t\t\t\t\t\t: match\r\n\t\t\t\t\t\t  ;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tobj.pagination.children[0].innerHTML = format(obj.options.text.showingPage, obj.pageNumber + 1, quantyOfPages)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Download CSV table\r\n\t\t *\r\n\t\t * @return null\r\n\t\t */\r\n\t\tobj.download = function(includeHeaders) {\r\n\t\t\tif (obj.options.allowExport == false) {\r\n\t\t\t\tconsole.error('Export not allowed');\r\n\t\t\t} else {\r\n\t\t\t\t// Data\r\n\t\t\t\tvar data = '';\r\n\r\n\t\t\t\t// Get data\r\n\t\t\t\tdata += obj.copy(false, obj.options.csvDelimiter, true, includeHeaders, true);\r\n\r\n\t\t\t\t// Download element\r\n\t\t\t\tvar blob = new Blob([\"\\uFEFF\"+data], {type: 'text/csv;charset=utf-8;'});\r\n\r\n\t\t\t\t// IE Compatibility\r\n\t\t\t\tif (window.navigator && window.navigator.msSaveOrOpenBlob) {\r\n\t\t\t\t\twindow.navigator.msSaveOrOpenBlob(blob, obj.options.csvFileName + '.csv');\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Download element\r\n\t\t\t\t\tvar pom = document.createElement('a');\r\n\t\t\t\t\tvar url = URL.createObjectURL(blob);\r\n\t\t\t\t\tpom.href = url;\r\n\t\t\t\t\tpom.setAttribute('download', obj.options.csvFileName + '.csv');\r\n\t\t\t\t\tdocument.body.appendChild(pom);\r\n\t\t\t\t\tpom.click();\r\n\t\t\t\t\tpom.parentNode.removeChild(pom);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Initializes a new history record for undo/redo\r\n\t\t *\r\n\t\t * @return null\r\n\t\t */\r\n\t\tobj.setHistory = function(changes) {\r\n\t\t\tif (obj.ignoreHistory != true) {\r\n\t\t\t\t// Increment and get the current history index\r\n\t\t\t\tvar index = ++obj.historyIndex;\r\n\r\n\t\t\t\t// Slice the array to discard undone changes\r\n\t\t\t\tobj.history = (obj.history = obj.history.slice(0, index + 1));\r\n\r\n\t\t\t\t// Keep history\r\n\t\t\t\tobj.history[index] = changes;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Copy method\r\n\t\t *\r\n\t\t * @param bool highlighted - Get only highlighted cells\r\n\t\t * @param delimiter - \\t default to keep compatibility with excel\r\n\t\t * @return string value\r\n\t\t */\r\n\t\tobj.copy = function(highlighted, delimiter, returnData, includeHeaders, download) {\r\n\t\t\tif (! delimiter) {\r\n\t\t\t\tdelimiter = \"\\t\";\r\n\t\t\t}\r\n\r\n\t\t\tvar div = new RegExp(delimiter, 'ig');\r\n\r\n\t\t\t// Controls\r\n\t\t\tvar header = [];\r\n\t\t\tvar col = [];\r\n\t\t\tvar colLabel = [];\r\n\t\t\tvar row = [];\r\n\t\t\tvar rowLabel = [];\r\n\t\t\tvar x = obj.options.data[0].length;\r\n\t\t\tvar y = obj.options.data.length;\r\n\t\t\tvar tmp = '';\r\n\t\t\tvar copyHeader = false;\r\n\t\t\tvar headers = '';\r\n\t\t\tvar nestedHeaders = '';\r\n\t\t\tvar numOfCols = 0;\r\n\t\t\tvar numOfRows = 0;\r\n\r\n\t\t\t// Partial copy\r\n\t\t\tvar copyX = 0;\r\n\t\t\tvar copyY = 0;\r\n\t\t\tvar isPartialCopy = true;\r\n\t\t\t// Go through the columns to get the data\r\n\t\t\tfor (var j = 0; j < y; j++) {\r\n\t\t\t\tfor (var i = 0; i < x; i++) {\r\n\t\t\t\t\t// If cell is highlighted\r\n\t\t\t\t\tif (! highlighted || obj.records[j][i].classList.contains('highlight')) {\r\n\t\t\t\t\t\tif (copyX <= i) {\r\n\t\t\t\t\t\t\tcopyX = i;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (copyY <= j) {\r\n\t\t\t\t\t\t\tcopyY = j;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (x === copyX+1 && y === copyY+1) {\r\n\t\t\t\tisPartialCopy = false;\r\n\t\t\t}\r\n\r\n\t\t\tif ((download && obj.options.includeHeadersOnDownload == true) ||\r\n\t\t\t\t(! download && obj.options.includeHeadersOnCopy == true && ! isPartialCopy) || (includeHeaders)) {\r\n\t\t\t\t// Nested headers\r\n\t\t\t\tif (obj.options.nestedHeaders && obj.options.nestedHeaders.length > 0) {\r\n\t\t\t\t\t// Flexible way to handle nestedheaders\r\n\t\t\t\t\tif (! (obj.options.nestedHeaders[0] && obj.options.nestedHeaders[0][0])) {\r\n\t\t\t\t\t\ttmp = [obj.options.nestedHeaders];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\ttmp = obj.options.nestedHeaders;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tfor (var j = 0; j < tmp.length; j++) {\r\n\t\t\t\t\t\tvar nested = [];\r\n\t\t\t\t\t\tfor (var i = 0; i < tmp[j].length; i++) {\r\n\t\t\t\t\t\t\tvar colspan = parseInt(tmp[j][i].colspan);\r\n\t\t\t\t\t\t\tnested.push(tmp[j][i].title);\r\n\t\t\t\t\t\t\tfor (var c = 0; c < colspan - 1; c++) {\r\n\t\t\t\t\t\t\t\tnested.push('');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tnestedHeaders += nested.join(delimiter) + \"\\r\\n\";\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcopyHeader = true;\r\n\t\t\t}\r\n\r\n\t\t\t// Reset container\r\n\t\t\tobj.style = [];\r\n\r\n\t\t\t// Go through the columns to get the data\r\n\t\t\tfor (var j = 0; j < y; j++) {\r\n\t\t\t\tcol = [];\r\n\t\t\t\tcolLabel = [];\r\n\r\n\t\t\t\tfor (var i = 0; i < x; i++) {\r\n\t\t\t\t\t// If cell is highlighted\r\n\t\t\t\t\tif (! highlighted || obj.records[j][i].classList.contains('highlight')) {\r\n\t\t\t\t\t\tif (copyHeader == true) {\r\n\t\t\t\t\t\t\theader.push(obj.headers[i].textContent);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// Values\r\n\t\t\t\t\t\tvar value = obj.options.data[j][i];\r\n\t\t\t\t\t\t// TablePress: Only escape quotation marks in cells if the cell has to be CSV escaped due to other characters, and make finding such characters more robust.\r\n\t\t\t\t\t\t/*\r\n\t\t\t\t\t\tif (value.match && (value.match(div) || value.match(/,/g) || value.match(/\\n/) || value.match(/\\\"/))) {\r\n\t\t\t\t\t\t\tvalue = value.replace(new RegExp('\"', 'g'), '\"\"');\r\n\t\t\t\t\t\t\tvalue = '\"' + value + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t*/\r\n\t\t\t\t\t\tif ( value.match && ( value.match( div ) || value.includes( delimiter ) || value.includes( \"\\n\" ) ) ) {\r\n\t\t\t\t\t\t\tif ( value.includes( '\"' ) ) {\r\n\t\t\t\t\t\t\t\tvalue = value.replace(new RegExp('\"', 'g'), '\"\"');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tvalue = '\"' + value + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcol.push(value);\r\n\r\n\t\t\t\t\t\t// Labels\r\n\t\t\t\t\t\tif (obj.options.columns[i].type == 'checkbox' || obj.options.columns[i].type == 'radio') {\r\n\t\t\t\t\t\t\tvar label = value;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tif (obj.options.stripHTMLOnCopy == true) {\r\n\t\t\t\t\t\t\t\tvar label = obj.records[j][i].textContent;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tvar label = obj.records[j][i].innerHTML;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (label.match && (label.match(div) || label.match(/,/g) || label.match(/\\n/) || label.match(/\\\"/))) {\r\n\t\t\t\t\t\t\t\t// Scape double quotes\r\n\t\t\t\t\t\t\t\tlabel = label.replace(new RegExp('\"', 'g'), '\"\"');\r\n\t\t\t\t\t\t\t\tlabel = '\"' + label + '\"';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcolLabel.push(label);\r\n\r\n\t\t\t\t\t\t// Get style\r\n\t\t\t\t\t\ttmp = obj.records[j][i].getAttribute('style');\r\n\t\t\t\t\t\ttmp = tmp.replace('display: none;', '');\r\n\t\t\t\t\t\tobj.style.push(tmp ? tmp : '');\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (col.length) {\r\n\t\t\t\t\tif (copyHeader) {\r\n\t\t\t\t\t\tnumOfCols = col.length;\r\n\t\t\t\t\t\trow.push(header.join(delimiter));\r\n\t\t\t\t\t}\r\n\t\t\t\t\trow.push(col.join(delimiter));\r\n\t\t\t\t}\r\n\t\t\t\tif (colLabel.length) {\r\n\t\t\t\t\tnumOfRows++;\r\n\t\t\t\t\tif (copyHeader) {\r\n\t\t\t\t\t\trowLabel.push(header.join(delimiter));\r\n\t\t\t\t\t\tcopyHeader = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\trowLabel.push(colLabel.join(delimiter));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (x == numOfCols &&  y == numOfRows) {\r\n\t\t\t\theaders = nestedHeaders;\r\n\t\t\t}\r\n\r\n\t\t\t// Final string\r\n\t\t\tvar str = headers + row.join(\"\\r\\n\");\r\n\t\t\tvar strLabel = headers + rowLabel.join(\"\\r\\n\");\r\n\r\n\t\t\t// Create a hidden textarea to copy the values\r\n\t\t\tif (! returnData) {\r\n\t\t\t\tif (obj.options.copyCompatibility == true) {\r\n\t\t\t\t\tobj.textarea.value = strLabel;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tobj.textarea.value = str;\r\n\t\t\t\t}\r\n\t\t\t\tobj.textarea.select();\r\n\t\t\t\tdocument.execCommand(\"copy\");\r\n\t\t\t}\r\n\r\n\t\t\t// Keep data\r\n\t\t\tif (obj.options.copyCompatibility == true) {\r\n\t\t\t\tobj.data = strLabel;\r\n\t\t\t} else {\r\n\t\t\t\tobj.data = str;\r\n\t\t\t}\r\n\t\t\t// Keep non visible information\r\n\t\t\tobj.hashString = obj.hash(obj.data);\r\n\r\n\t\t\t// Any exiting border should go\r\n\t\t\tif (! returnData) {\r\n\t\t\t\tobj.removeCopyingSelection();\r\n\r\n\t\t\t\t// Border\r\n\t\t\t\tif (obj.highlighted) {\r\n\t\t\t\t\tfor (var i = 0; i < obj.highlighted.length; i++) {\r\n\t\t\t\t\t\tobj.highlighted[i].classList.add('copying');\r\n\t\t\t\t\t\tif (obj.highlighted[i].classList.contains('highlight-left')) {\r\n\t\t\t\t\t\t\tobj.highlighted[i].classList.add('copying-left');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (obj.highlighted[i].classList.contains('highlight-right')) {\r\n\t\t\t\t\t\t\tobj.highlighted[i].classList.add('copying-right');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (obj.highlighted[i].classList.contains('highlight-top')) {\r\n\t\t\t\t\t\t\tobj.highlighted[i].classList.add('copying-top');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (obj.highlighted[i].classList.contains('highlight-bottom')) {\r\n\t\t\t\t\t\t\tobj.highlighted[i].classList.add('copying-bottom');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Paste event\r\n\t\t\t\tobj.dispatch('oncopy', el, obj.options.copyCompatibility == true ? rowLabel : row, obj.hashString);\r\n\t\t\t}\r\n\r\n\t\t\treturn obj.data;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Jspreadsheet paste method\r\n\t\t *\r\n\t\t * @param integer row number\r\n\t\t * @return string value\r\n\t\t */\r\n\t\tobj.paste = function(x, y, data) {\r\n\t\t\tvar x_1 = parseInt(x),\r\n\t\t\ty_1 = parseInt(y),\r\n\t\t\tx_2 = parseInt(obj.selectedCell[2]),\r\n\t\t\ty_2 = parseInt(obj.selectedCell[3]),\r\n\t\t\tw = x_2 - x_1 + 1,\r\n\t\t\th = y_2 - y_1 + 1;\r\n\r\n\t\t\t// change paste range if select is from right to left\r\n\t\t\tif (x_2 < x_1){\r\n\t\t\t\tx = x_2.toString();\r\n\t\t\t\tw = x_1 - x_2 + 1;\r\n\t\t\t}\r\n\t\t\t// change paste range if select is from down to up\r\n\t\t\tif (y_2 < y_1){\r\n\t\t\t\ty = y_2.toString();\r\n\t\t\t\th = y_1 - y_2 + 1;\r\n\t\t\t}\r\n\t\t\t// Paste filter\r\n\t\t\tvar ret = obj.dispatch('onbeforepaste', el, data, x, y);\r\n\r\n\t\t\tif (ret === false) {\r\n\t\t\t\treturn false;\r\n\t\t\t} else if (ret) {\r\n\t\t\t\tvar data = ret;\r\n\t\t\t}\r\n\r\n\t\t\t// Controls\r\n\t\t\tvar hash = obj.hash(data);\r\n\t\t\tvar style = (hash == obj.hashString) ? obj.style : null;\r\n\r\n\t\t\t// Depending on the behavior\r\n\t\t\tif (obj.options.copyCompatibility == true && hash == obj.hashString) {\r\n\t\t\t\tvar data = obj.data;\r\n\t\t\t}\r\n\r\n\t\t\t// Split new line\r\n\t\t\tvar data = obj.parseCSV(data, \"\\t\");\r\n\t\t\t// Modify data to allow wor extending paste range in multiples of input range\r\n\t\t\tif ((w > 1) & Number.isInteger(w / data[0].length)) {\r\n\t\t\t\tstyle = null;\r\n\t\t\t\trepeats = w / data[0].length;\r\n\r\n\t\t\t\tvar arrayB = data.map(function (row, i) {\r\n\t\t\t\tvar arrayC = Array.apply(null, { length: repeats * row.length }).map(\r\n\t\t\t\t\tfunction (e, i) { return row[i % row.length]; }\r\n\t\t\t\t);\r\n\t\t\t\treturn arrayC;\r\n\t\t\t\t});\r\n\t\t\t\tdata = arrayB;\r\n\t\t\t}\r\n\t\t\tif ((h > 1) & Number.isInteger(h / data.length)) {\r\n\t\t\t\tstyle = null;\r\n\t\t\t\tvar repeats = h / data.length;\r\n\t\t\t\tvar arrayB = Array.apply(null, { length: repeats * data.length }).map(\r\n\t\t\t\tfunction (e, i) { return data[i % data.length]; }\r\n\t\t\t\t);\r\n\t\t\t\tdata = arrayB;\r\n\t\t\t}\r\n\r\n\t\t\tif (x != null && y != null && data) {\r\n\t\t\t\t// Records\r\n\t\t\t\tvar i = 0;\r\n\t\t\t\tvar j = 0;\r\n\t\t\t\tvar records = [];\r\n\t\t\t\tvar newStyle = {};\r\n\t\t\t\tvar oldStyle = {};\r\n\t\t\t\tvar styleIndex = 0;\r\n\r\n\t\t\t\t// Index\r\n\t\t\t\tvar colIndex = parseInt(x);\r\n\t\t\t\tvar rowIndex = parseInt(y);\r\n\t\t\t\tvar row = null;\r\n\r\n\t\t\t\t// Go through the columns to get the data\r\n\t\t\t\twhile (row = data[j]) {\r\n\t\t\t\t\ti = 0;\r\n\t\t\t\t\tcolIndex = parseInt(x);\r\n\r\n\t\t\t\t\twhile (row[i] != null) {\r\n\t\t\t\t\t\t// Update and keep history\r\n\t\t\t\t\t\tvar record = obj.updateCell(colIndex, rowIndex, row[i]);\r\n\t\t\t\t\t\t// Keep history\r\n\t\t\t\t\t\trecords.push(record);\r\n\t\t\t\t\t\t// Update all formulas in the chain\r\n\t\t\t\t\t\tobj.updateFormulaChain(colIndex, rowIndex, records);\r\n\t\t\t\t\t\t// Style\r\n\t\t\t\t\t\tif (style && style[styleIndex]) {\r\n\t\t\t\t\t\t\tvar columnName = jexcel.getColumnNameFromId([colIndex, rowIndex]);\r\n\t\t\t\t\t\t\tnewStyle[columnName] = style[styleIndex];\r\n\t\t\t\t\t\t\toldStyle[columnName] = obj.getStyle(columnName);\r\n\t\t\t\t\t\t\tobj.records[rowIndex][colIndex].setAttribute('style', style[styleIndex]);\r\n\t\t\t\t\t\t\tstyleIndex++\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\ti++;\r\n\t\t\t\t\t\tif (row[i] != null) {\r\n\t\t\t\t\t\t\tif (colIndex >= obj.headers.length - 1) {\r\n\t\t\t\t\t\t\t\t// If the pasted column is out of range, create it if possible\r\n\t\t\t\t\t\t\t\tif (obj.options.allowInsertColumn == true) {\r\n\t\t\t\t\t\t\t\t\tobj.insertColumn();\r\n\t\t\t\t\t\t\t\t\t// Otherwise skip the pasted data that overflows\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tcolIndex = obj.right.get(colIndex, rowIndex);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tj++;\r\n\t\t\t\t\tif (data[j]) {\r\n\t\t\t\t\t\tif (rowIndex >= obj.rows.length-1) {\r\n\t\t\t\t\t\t\t// If the pasted row is out of range, create it if possible\r\n\t\t\t\t\t\t\tif (obj.options.allowInsertRow == true) {\r\n\t\t\t\t\t\t\t\tobj.insertRow();\r\n\t\t\t\t\t\t\t\t// Otherwise skip the pasted data that overflows\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\trowIndex = obj.down.get(x, rowIndex);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Select the new cells\r\n\t\t\t\tobj.updateSelectionFromCoords(x, y, colIndex, rowIndex);\r\n\r\n\t\t\t\t// Update history\r\n\t\t\t\tobj.setHistory({\r\n\t\t\t\t\taction:'setValue',\r\n\t\t\t\t\trecords:records,\r\n\t\t\t\t\tselection:obj.selectedCell,\r\n\t\t\t\t\tnewStyle:newStyle,\r\n\t\t\t\t\toldStyle:oldStyle,\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// Update table\r\n\t\t\t\tobj.updateTable();\r\n\r\n\t\t\t\t// Paste event\r\n\t\t\t\tobj.dispatch('onpaste', el, data);\r\n\r\n\t\t\t\t// On after changes\r\n\t\t\t\tobj.onafterchanges(el, records);\r\n\t\t\t}\r\n\r\n\t\t\tobj.removeCopyingSelection();\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Remove copying border\r\n\t\t */\r\n\t\tobj.removeCopyingSelection = function() {\r\n\t\t\tvar copying = document.querySelectorAll('.jexcel .copying');\r\n\t\t\tfor (var i = 0; i < copying.length; i++) {\r\n\t\t\t\tcopying[i].classList.remove('copying');\r\n\t\t\t\tcopying[i].classList.remove('copying-left');\r\n\t\t\t\tcopying[i].classList.remove('copying-right');\r\n\t\t\t\tcopying[i].classList.remove('copying-top');\r\n\t\t\t\tcopying[i].classList.remove('copying-bottom');\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Process row\r\n\t\t */\r\n\t\tobj.historyProcessRow = function(type, historyRecord) {\r\n\t\t\tvar rowIndex = (! historyRecord.insertBefore) ? historyRecord.rowNumber + 1 : +historyRecord.rowNumber;\r\n\r\n\t\t\tif (obj.options.search == true) {\r\n\t\t\t\tif (obj.results && obj.results.length != obj.rows.length) {\r\n\t\t\t\t\tobj.resetSearch();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Remove row\r\n\t\t\tif (type == 1) {\r\n\t\t\t\tvar numOfRows = historyRecord.numOfRows;\r\n\t\t\t\t// Remove nodes\r\n\t\t\t\tfor (var j = rowIndex; j < (numOfRows + rowIndex); j++) {\r\n\t\t\t\t\tobj.rows[j].parentNode.removeChild(obj.rows[j]);\r\n\t\t\t\t}\r\n\t\t\t\t// Remove references\r\n\t\t\t\tobj.records.splice(rowIndex, numOfRows);\r\n\t\t\t\tobj.options.data.splice(rowIndex, numOfRows);\r\n\t\t\t\tobj.rows.splice(rowIndex, numOfRows);\r\n\r\n\t\t\t\tobj.conditionalSelectionUpdate(1, rowIndex, (numOfRows + rowIndex) - 1);\r\n\t\t\t} else {\r\n\t\t\t\t// Insert data\r\n\t\t\t\tobj.records = jexcel.injectArray(obj.records, rowIndex, historyRecord.rowRecords);\r\n\t\t\t\tobj.options.data = jexcel.injectArray(obj.options.data, rowIndex, historyRecord.rowData);\r\n\t\t\t\tobj.rows = jexcel.injectArray(obj.rows, rowIndex, historyRecord.rowNode);\r\n\t\t\t\t// Insert nodes\r\n\t\t\t\tvar index = 0\r\n\t\t\t\tfor (var j = rowIndex; j < (historyRecord.numOfRows + rowIndex); j++) {\r\n\t\t\t\t\tobj.tbody.insertBefore(historyRecord.rowNode[index], obj.tbody.children[j]);\r\n\t\t\t\t\tindex++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Respect pagination\r\n\t\t\tif (obj.options.pagination > 0) {\r\n\t\t\t\tobj.page(obj.pageNumber);\r\n\t\t\t}\r\n\r\n\t\t\tobj.updateTableReferences();\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Process column\r\n\t\t */\r\n\t\tobj.historyProcessColumn = function(type, historyRecord) {\r\n\t\t\tvar columnIndex = (! historyRecord.insertBefore) ? historyRecord.columnNumber + 1 : historyRecord.columnNumber;\r\n\r\n\t\t\t// Remove column\r\n\t\t\tif (type == 1) {\r\n\t\t\t\tvar numOfColumns = historyRecord.numOfColumns;\r\n\r\n\t\t\t\tobj.options.columns.splice(columnIndex, numOfColumns);\r\n\t\t\t\tfor (var i = columnIndex; i < (numOfColumns + columnIndex); i++) {\r\n\t\t\t\t\tobj.headers[i].parentNode.removeChild(obj.headers[i]);\r\n\t\t\t\t\tobj.colgroup[i].parentNode.removeChild(obj.colgroup[i]);\r\n\t\t\t\t}\r\n\t\t\t\tobj.headers.splice(columnIndex, numOfColumns);\r\n\t\t\t\tobj.colgroup.splice(columnIndex, numOfColumns);\r\n\t\t\t\tfor (var j = 0; j < historyRecord.data.length; j++) {\r\n\t\t\t\t\tfor (var i = columnIndex; i < (numOfColumns + columnIndex); i++) {\r\n\t\t\t\t\t\tobj.records[j][i].parentNode.removeChild(obj.records[j][i]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tobj.records[j].splice(columnIndex, numOfColumns);\r\n\t\t\t\t\tobj.options.data[j].splice(columnIndex, numOfColumns);\r\n\t\t\t\t}\r\n\t\t\t\t// Process footers\r\n\t\t\t\tif (obj.options.footers) {\r\n\t\t\t\t\tfor (var j = 0; j < obj.options.footers.length; j++) {\r\n\t\t\t\t\t\tobj.options.footers[j].splice(columnIndex, numOfColumns);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\t// Insert data\r\n\t\t\t\tobj.options.columns = jexcel.injectArray(obj.options.columns, columnIndex, historyRecord.columns);\r\n\t\t\t\tobj.headers = jexcel.injectArray(obj.headers, columnIndex, historyRecord.headers);\r\n\t\t\t\tobj.colgroup = jexcel.injectArray(obj.colgroup, columnIndex, historyRecord.colgroup);\r\n\r\n\t\t\t\tvar index = 0\r\n\t\t\t\tfor (var i = columnIndex; i < (historyRecord.numOfColumns + columnIndex); i++) {\r\n\t\t\t\t\tobj.headerContainer.insertBefore(historyRecord.headers[index], obj.headerContainer.children[i+1]);\r\n\t\t\t\t\tobj.colgroupContainer.insertBefore(historyRecord.colgroup[index], obj.colgroupContainer.children[i+1]);\r\n\t\t\t\t\tindex++;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor (var j = 0; j < historyRecord.data.length; j++) {\r\n\t\t\t\t\tobj.options.data[j] = jexcel.injectArray(obj.options.data[j], columnIndex, historyRecord.data[j]);\r\n\t\t\t\t\tobj.records[j] = jexcel.injectArray(obj.records[j], columnIndex, historyRecord.records[j]);\r\n\t\t\t\t\tvar index = 0\r\n\t\t\t\t\tfor (var i = columnIndex; i < (historyRecord.numOfColumns + columnIndex); i++) {\r\n\t\t\t\t\t\tobj.rows[j].insertBefore(historyRecord.records[j][index], obj.rows[j].children[i+1]);\r\n\t\t\t\t\t\tindex++;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t// Process footers\r\n\t\t\t\tif (obj.options.footers) {\r\n\t\t\t\t\tfor (var j = 0; j < obj.options.footers.length; j++) {\r\n\t\t\t\t\t\tobj.options.footers[j] = jexcel.injectArray(obj.options.footers[j], columnIndex, historyRecord.footers[j]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Adjust nested headers\r\n\t\t\tif (obj.options.nestedHeaders && obj.options.nestedHeaders.length > 0) {\r\n\t\t\t\t// Flexible way to handle nestedheaders\r\n\t\t\t\tif (obj.options.nestedHeaders[0] && obj.options.nestedHeaders[0][0]) {\r\n\t\t\t\t\tfor (var j = 0; j < obj.options.nestedHeaders.length; j++) {\r\n\t\t\t\t\t\tif (type == 1) {\r\n\t\t\t\t\t\t\tvar colspan = parseInt(obj.options.nestedHeaders[j][obj.options.nestedHeaders[j].length-1].colspan) - historyRecord.numOfColumns;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tvar colspan = parseInt(obj.options.nestedHeaders[j][obj.options.nestedHeaders[j].length-1].colspan) + historyRecord.numOfColumns;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tobj.options.nestedHeaders[j][obj.options.nestedHeaders[j].length-1].colspan = colspan;\r\n\t\t\t\t\t\tobj.thead.children[j].children[obj.thead.children[j].children.length-1].setAttribute('colspan', colspan);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (type == 1) {\r\n\t\t\t\t\t\tvar colspan = parseInt(obj.options.nestedHeaders[0].colspan) - historyRecord.numOfColumns;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tvar colspan = parseInt(obj.options.nestedHeaders[0].colspan) + historyRecord.numOfColumns;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tobj.options.nestedHeaders[0].colspan = colspan;\r\n\t\t\t\t\tobj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute('colspan', colspan);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tobj.updateTableReferences();\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Undo last action\r\n\t\t */\r\n\t\tobj.undo = function() {\r\n\t\t\t// Ignore events and history\r\n\t\t\tvar ignoreEvents = obj.ignoreEvents ? true : false;\r\n\t\t\tvar ignoreHistory = obj.ignoreHistory ? true : false;\r\n\r\n\t\t\tobj.ignoreEvents = true;\r\n\t\t\tobj.ignoreHistory = true;\r\n\r\n\t\t\t// Records\r\n\t\t\tvar records = [];\r\n\r\n\t\t\t// Update cells\r\n\t\t\tif (obj.historyIndex >= 0) {\r\n\t\t\t\t// History\r\n\t\t\t\tvar historyRecord = obj.history[obj.historyIndex--];\r\n\r\n\t\t\t\tif (historyRecord.action == 'insertRow') {\r\n\t\t\t\t\tobj.historyProcessRow(1, historyRecord);\r\n\t\t\t\t} else if (historyRecord.action == 'deleteRow') {\r\n\t\t\t\t\tobj.historyProcessRow(0, historyRecord);\r\n\t\t\t\t} else if (historyRecord.action == 'insertColumn') {\r\n\t\t\t\t\tobj.historyProcessColumn(1, historyRecord);\r\n\t\t\t\t} else if (historyRecord.action == 'deleteColumn') {\r\n\t\t\t\t\tobj.historyProcessColumn(0, historyRecord);\r\n\t\t\t\t} else if (historyRecord.action == 'moveRow') {\r\n\t\t\t\t\tobj.moveRow(historyRecord.newValue, historyRecord.oldValue);\r\n\t\t\t\t} else if (historyRecord.action == 'moveColumn') {\r\n\t\t\t\t\tobj.moveColumn(historyRecord.newValue, historyRecord.oldValue);\r\n\t\t\t\t} else if (historyRecord.action == 'setMerge') {\r\n\t\t\t\t\tobj.removeMerge(historyRecord.column, historyRecord.data);\r\n\t\t\t\t} else if (historyRecord.action == 'setStyle') {\r\n\t\t\t\t\tobj.setStyle(historyRecord.oldValue, null, null, 1);\r\n\t\t\t\t} else if (historyRecord.action == 'setWidth') {\r\n\t\t\t\t\tobj.setWidth(historyRecord.column, historyRecord.oldValue);\r\n\t\t\t\t} else if (historyRecord.action == 'setHeight') {\r\n\t\t\t\t\tobj.setHeight(historyRecord.row, historyRecord.oldValue);\r\n\t\t\t\t} else if (historyRecord.action == 'setHeader') {\r\n\t\t\t\t\tobj.setHeader(historyRecord.column, historyRecord.oldValue);\r\n\t\t\t\t} else if (historyRecord.action == 'setComments') {\r\n\t\t\t\t\tobj.setComments(historyRecord.column, historyRecord.oldValue[0], historyRecord.oldValue[1]);\r\n\t\t\t\t} else if (historyRecord.action == 'orderBy') {\r\n\t\t\t\t\tvar rows = [];\r\n\t\t\t\t\tfor (var j = 0; j < historyRecord.rows.length; j++) {\r\n\t\t\t\t\t\trows[historyRecord.rows[j]] = j;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tobj.updateOrderArrow(historyRecord.column, historyRecord.order ? 0 : 1);\r\n\t\t\t\t\tobj.updateOrder(rows);\r\n\t\t\t\t} else if (historyRecord.action == 'setValue') {\r\n\t\t\t\t\t// Redo for changes in cells\r\n\t\t\t\t\tfor (var i = 0; i < historyRecord.records.length; i++) {\r\n\t\t\t\t\t\trecords.push({\r\n\t\t\t\t\t\t\tx: historyRecord.records[i].x,\r\n\t\t\t\t\t\t\ty: historyRecord.records[i].y,\r\n\t\t\t\t\t\t\tnewValue: historyRecord.records[i].oldValue,\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\tif (historyRecord.oldStyle) {\r\n\t\t\t\t\t\t\tobj.resetStyle(historyRecord.oldStyle);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// Update records\r\n\t\t\t\t\tobj.setValue(records);\r\n\r\n\t\t\t\t\t// Update selection\r\n\t\t\t\t\tif (historyRecord.selection) {\r\n\t\t\t\t\t\tobj.updateSelectionFromCoords(historyRecord.selection[0], historyRecord.selection[1], historyRecord.selection[2], historyRecord.selection[3]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tobj.ignoreEvents = ignoreEvents;\r\n\t\t\tobj.ignoreHistory = ignoreHistory;\r\n\r\n\t\t\t// Events\r\n\t\t\tobj.dispatch('onundo', el, historyRecord);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Redo previously undone action\r\n\t\t */\r\n\t\tobj.redo = function() {\r\n\t\t\t// Ignore events and history\r\n\t\t\tvar ignoreEvents = obj.ignoreEvents ? true : false;\r\n\t\t\tvar ignoreHistory = obj.ignoreHistory ? true : false;\r\n\r\n\t\t\tobj.ignoreEvents = true;\r\n\t\t\tobj.ignoreHistory = true;\r\n\r\n\t\t\t// Records\r\n\t\t\tvar records = [];\r\n\r\n\t\t\t// Update cells\r\n\t\t\tif (obj.historyIndex < obj.history.length - 1) {\r\n\t\t\t\t// History\r\n\t\t\t\tvar historyRecord = obj.history[++obj.historyIndex];\r\n\r\n\t\t\t\tif (historyRecord.action == 'insertRow') {\r\n\t\t\t\t\tobj.historyProcessRow(0, historyRecord);\r\n\t\t\t\t} else if (historyRecord.action == 'deleteRow') {\r\n\t\t\t\t\tobj.historyProcessRow(1, historyRecord);\r\n\t\t\t\t} else if (historyRecord.action == 'insertColumn') {\r\n\t\t\t\t\tobj.historyProcessColumn(0, historyRecord);\r\n\t\t\t\t} else if (historyRecord.action == 'deleteColumn') {\r\n\t\t\t\t\tobj.historyProcessColumn(1, historyRecord);\r\n\t\t\t\t} else if (historyRecord.action == 'moveRow') {\r\n\t\t\t\t\tobj.moveRow(historyRecord.oldValue, historyRecord.newValue);\r\n\t\t\t\t} else if (historyRecord.action == 'moveColumn') {\r\n\t\t\t\t\tobj.moveColumn(historyRecord.oldValue, historyRecord.newValue);\r\n\t\t\t\t} else if (historyRecord.action == 'setMerge') {\r\n\t\t\t\t\tobj.setMerge(historyRecord.column, historyRecord.colspan, historyRecord.rowspan, 1);\r\n\t\t\t\t} else if (historyRecord.action == 'setStyle') {\r\n\t\t\t\t\tobj.setStyle(historyRecord.newValue, null, null, 1);\r\n\t\t\t\t} else if (historyRecord.action == 'setWidth') {\r\n\t\t\t\t\tobj.setWidth(historyRecord.column, historyRecord.newValue);\r\n\t\t\t\t} else if (historyRecord.action == 'setHeight') {\r\n\t\t\t\t\tobj.setHeight(historyRecord.row, historyRecord.newValue);\r\n\t\t\t\t} else if (historyRecord.action == 'setHeader') {\r\n\t\t\t\t\tobj.setHeader(historyRecord.column, historyRecord.newValue);\r\n\t\t\t\t} else if (historyRecord.action == 'setComments') {\r\n\t\t\t\t\tobj.setComments(historyRecord.column, historyRecord.newValue[0], historyRecord.newValue[1]);\r\n\t\t\t\t} else if (historyRecord.action == 'orderBy') {\r\n\t\t\t\t\tobj.updateOrderArrow(historyRecord.column, historyRecord.order);\r\n\t\t\t\t\tobj.updateOrder(historyRecord.rows);\r\n\t\t\t\t} else if (historyRecord.action == 'setValue') {\r\n\t\t\t\t\tobj.setValue(historyRecord.records);\r\n\t\t\t\t\t// Redo for changes in cells\r\n\t\t\t\t\tfor (var i = 0; i < historyRecord.records.length; i++) {\r\n\t\t\t\t\t\tif (historyRecord.oldStyle) {\r\n\t\t\t\t\t\t\tobj.resetStyle(historyRecord.newStyle);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// Update selection\r\n\t\t\t\t\tif (historyRecord.selection) {\r\n\t\t\t\t\t\tobj.updateSelectionFromCoords(historyRecord.selection[0], historyRecord.selection[1], historyRecord.selection[2], historyRecord.selection[3]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tobj.ignoreEvents = ignoreEvents;\r\n\t\t\tobj.ignoreHistory = ignoreHistory;\r\n\r\n\t\t\t// Events\r\n\t\t\tobj.dispatch('onredo', el, historyRecord);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Get dropdown value from key\r\n\t\t */\r\n\t\tobj.getDropDownValue = function(column, key) {\r\n\t\t\tvar value = [];\r\n\r\n\t\t\tif (obj.options.columns[column] && obj.options.columns[column].source) {\r\n\t\t\t\t// Create array from source\r\n\t\t\t\tvar combo = [];\r\n\t\t\t\tvar source = obj.options.columns[column].source;\r\n\r\n\t\t\t\tfor (var i = 0; i < source.length; i++) {\r\n\t\t\t\t\tif (typeof(source[i]) == 'object') {\r\n\t\t\t\t\t\tcombo[source[i].id] = source[i].name;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tcombo[source[i]] = source[i];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Guarantee single multiple compatibility\r\n\t\t\t\tvar keys = Array.isArray(key) ? key : ('' + key).split(';');\r\n\r\n\t\t\t\tfor (var i = 0; i < keys.length; i++) {\r\n\t\t\t\t\tif (typeof(keys[i]) === 'object') {\r\n\t\t\t\t\t\tvalue.push(combo[keys[i].id]);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (combo[keys[i]]) {\r\n\t\t\t\t\t\t\tvalue.push(combo[keys[i]]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tconsole.error('Invalid column');\r\n\t\t\t}\r\n\r\n\t\t\treturn (value.length > 0) ? value.join('; ') : '';\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * From stack overflow contributions\r\n\t\t */\r\n\t\t/** // TablePress: Replaced with more reliable parseCSV function below.\r\n\t\tobj.parseCSV = function(str, delimiter) {\r\n\t\t\t// Remove last line break\r\n\t\t\tstr = str.replace(/\\r?\\n$|\\r$|\\n$/g, \"\");\r\n\t\t\t// Last caracter is the delimiter\r\n\t\t\tif (str.charCodeAt(str.length-1) == 9) {\r\n\t\t\t\tstr += \"\\0\";\r\n\t\t\t}\r\n\t\t\t// user-supplied delimeter or default comma\r\n\t\t\tdelimiter = (delimiter || \",\");\r\n\r\n\t\t\tvar arr = [];\r\n\t\t\tvar quote = false;  // true means we're inside a quoted field\r\n\t\t\t// iterate over each character, keep track of current row and column (of the returned array)\r\n\t\t\tfor (var row = 0, col = 0, c = 0; c < str.length; c++) {\r\n\t\t\t\tvar cc = str[c], nc = str[c+1];\r\n\t\t\t\tarr[row] = arr[row] || [];\r\n\t\t\t\tarr[row][col] = arr[row][col] || '';\r\n\r\n\t\t\t\t// If the current character is a quotation mark, and we're inside a quoted field, and the next character is also a quotation mark, add a quotation mark to the current column and skip the next character\r\n\t\t\t\tif (cc == '\"' && quote && nc == '\"') { arr[row][col] += cc; ++c; continue; }\r\n\r\n\t\t\t\t// If it's just one quotation mark, begin/end quoted field\r\n\t\t\t\tif (cc == '\"') { quote = !quote; continue; }\r\n\r\n\t\t\t\t// If it's a comma and we're not in a quoted field, move on to the next column\r\n\t\t\t\tif (cc == delimiter && !quote) { ++col; continue; }\r\n\r\n\t\t\t\t// If it's a newline (CRLF) and we're not in a quoted field, skip the next character and move on to the next row and move to column 0 of that new row\r\n\t\t\t\tif (cc == '\\r' && nc == '\\n' && !quote) { ++row; col = 0; ++c; continue; }\r\n\r\n\t\t\t\t// If it's a newline (LF or CR) and we're not in a quoted field, move on to the next row and move to column 0 of that new row\r\n\t\t\t\tif (cc == '\\n' && !quote) { ++row; col = 0; continue; }\r\n\t\t\t\tif (cc == '\\r' && !quote) { ++row; col = 0; continue; }\r\n\r\n\t\t\t\t// Otherwise, append the current character to the current column\r\n\t\t\t\tarr[row][col] += cc;\r\n\t\t\t}\r\n\t\t\treturn arr;\r\n\t\t}\r\n\t\t*/\r\n\t\t// TablePress: This new function replaces the original parseCSV function above, which has problems with quotation marks.\r\n\t\t// This implementation was ported from the PHP implementation in /libraries/csv-parser.class.php to JS.\r\n\t\tobj.parseCSV = function(str, delimiter) {\r\n\t\t\t// Ensure that the string has a line break at the end, by first removing all line breaks, and then adding one.\r\n\t\t\tstr = str.replace( /\\r?\\n$|\\r$|\\n$/g, '' );\r\n\t\t\tstr += \"\\n\";\r\n\r\n\t\t\t// Use user-supplied delimiter or use a comma as the default.\r\n\t\t\tdelimiter = delimiter || ',';\r\n\r\n\t\t\tconst white_spaces = new RegExp( '^' + \" \\t\\x0B\\0\".replace( delimiter, '' ) + '*' );\r\n\r\n\t\t\tlet rows = []; // Complete rows.\r\n\t\t\tlet row = []; // Row that is currently built.\r\n\t\t\tlet column = 0; // Current column index.\r\n\t\t\tlet cell_content = ''; // Content of the currently processed cell.\r\n\t\t\tlet enclosed = false;\r\n\t\t\tlet was_enclosed = false; // To determine if the cell content will be trimmed of whitespace (only for enclosed cells).\r\n\r\n\t\t\t// Walk through each character in the CSV string.\r\n\t\t\tconst data_length = str.length;\r\n\t\t\tfor ( let i = 0; i < data_length; i++ ) {\r\n\t\t\t\tlet curr_char = str[ i ];\r\n\t\t\t\tlet next_char = ( i + 1 < data_length ) ? str[ i + 1 ] : '';\r\n\r\n\t\t\t\tif ( curr_char === '\"' ) {\r\n\t\t\t\t\t// Open/close quotes, and inline quotes.\r\n\t\t\t\t\tif ( ! enclosed ) {\r\n\t\t\t\t\t\tif ( '' === cell_content.replace( white_spaces, '' ) ) {\r\n\t\t\t\t\t\t\tenclosed = true;\r\n\t\t\t\t\t\t\twas_enclosed = true;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t// Technically, there's a CSV syntax here now, but we ignore it.\r\n\t\t\t\t\t\t\tcell_content += curr_char;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if ( next_char === '\"' ) {\r\n\t\t\t\t\t\t// Enclosure character within enclosed cell (\" encoded as \"\").\r\n\t\t\t\t\t\tcell_content += curr_char;\r\n\t\t\t\t\t\t++i; // Skip next character.\r\n\t\t\t\t\t} else if ( next_char !== delimiter && \"\\r\" !== next_char && \"\\n\" !== next_char ) {\r\n\t\t\t\t\t\t// for-loop (instead of while-loop) that skips whitespace.\r\n\t\t\t\t\t\tlet x = i + 1;\r\n\t\t\t\t\t\tfor ( ; undefined !== str[ x ] && '' === str[ x ].replace( white_spaces, '' ); x++ ) {\r\n\t\t\t\t\t\t\t// Action is in iterator check.\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif ( str[ x ] === delimiter ) {\r\n\t\t\t\t\t\t\tenclosed = false;\r\n\t\t\t\t\t\t\ti = x;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t// Technically, there's a CSV syntax here now, but we ignore it.\r\n\t\t\t\t\t\t\tcell_content += curr_char;\r\n\t\t\t\t\t\t\tenclosed = false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// The \" was the closing one for the cell.\r\n\t\t\t\t\t\tenclosed = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if ( ( curr_char === delimiter || \"\\n\" === curr_char || \"\\r\" === curr_char ) && ! enclosed ) {\r\n\t\t\t\t\t// End of cell (by delimiter), or end of line (by line break, and not enclosed!).\r\n\t\t\t\t\trow[ column ] = was_enclosed ? cell_content : cell_content.trim();\r\n\t\t\t\t\tcell_content = '';\r\n\t\t\t\t\twas_enclosed = false;\r\n\t\t\t\t\t++column;\r\n\r\n\t\t\t\t\t// End of line.\r\n\t\t\t\t\tif ( \"\\n\" === curr_char || \"\\r\" === curr_char ) {\r\n\t\t\t\t\t\t// Append completed row.\r\n\t\t\t\t\t\trows.push( row );\r\n\t\t\t\t\t\trow = [];\r\n\t\t\t\t\t\tcolumn = 0;\r\n\t\t\t\t\t\tif ( \"\\r\" === curr_char && \"\\n\" === next_char ) {\r\n\t\t\t\t\t\t\t// Skip next character in \\r\\n line breaks.\r\n\t\t\t\t\t\t\t++i;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Append character to current cell.\r\n\t\t\t\t\tcell_content += curr_char;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn rows;\r\n\t\t}\r\n\r\n\t\tobj.hash = function(str) {\r\n\t\t\tvar hash = 0, i, chr;\r\n\r\n\t\t\tif (str.length === 0) {\r\n\t\t\t\treturn hash;\r\n\t\t\t} else {\r\n\t\t\t\tfor (i = 0; i < str.length; i++) {\r\n\t\t\t\t  chr = str.charCodeAt(i);\r\n\t\t\t\t  hash = ((hash << 5) - hash) + chr;\r\n\t\t\t\t  hash |= 0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn hash;\r\n\t\t}\r\n\r\n\t\tobj.onafterchanges = function(el, records) {\r\n\t\t\t// Events\r\n\t\t\tobj.dispatch('onafterchanges', el, records);\r\n\t\t}\r\n\r\n\t\tobj.destroy = function() {\r\n\t\t\tjexcel.destroy(el);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Initialization method\r\n\t\t */\r\n\t\tobj.init = function() {\r\n\t\t\tjexcel.current = obj;\r\n\r\n\t\t\t// Build handlers\r\n\t\t\tif (typeof(jexcel.build) == 'function') {\r\n\t\t\t\tif (obj.options.root) {\r\n\t\t\t\t\tjexcel.build(obj.options.root);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tjexcel.build(document);\r\n\t\t\t\t\tjexcel.build = null;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Event\r\n\t\t\tel.setAttribute('tabindex', 1);\r\n\t\t\tel.addEventListener('focus', function(e) {\r\n\t\t\t\tif (jexcel.current && ! obj.selectedCell) {\r\n\t\t\t\t\tobj.updateSelectionFromCoords(0,0,0,0);\r\n\t\t\t\t\tobj.left();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t// Load the table data based on an CSV file\r\n\t\t\tif (obj.options.csv) {\r\n\t\t\t\t// Loading\r\n\t\t\t\tif (obj.options.loadingSpin == true) {\r\n\t\t\t\t\tjSuites.loading.show();\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Load CSV file\r\n\t\t\t\tjSuites.ajax({\r\n\t\t\t\t\turl: obj.options.csv,\r\n\t\t\t\t\tmethod: obj.options.method,\r\n\t\t\t\t\tdata: obj.options.requestVariables,\r\n\t\t\t\t\tdataType: 'text',\r\n\t\t\t\t\tsuccess: function(result) {\r\n\t\t\t\t\t\t// Convert data\r\n\t\t\t\t\t\tvar newData = obj.parseCSV(result, obj.options.csvDelimiter)\r\n\r\n\t\t\t\t\t\t// Headers\r\n\t\t\t\t\t\tif (obj.options.csvHeaders == true && newData.length > 0) {\r\n\t\t\t\t\t\t\tvar headers = newData.shift();\r\n\t\t\t\t\t\t\tfor(var i = 0; i < headers.length; i++) {\r\n\t\t\t\t\t\t\t\tif (! obj.options.columns[i]) {\r\n\t\t\t\t\t\t\t\t\tobj.options.columns[i] = { type:'text', align:obj.options.defaultColAlign, width:obj.options.defaultColWidth };\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t// Precedence over pre-configurated titles\r\n\t\t\t\t\t\t\t\tif (typeof obj.options.columns[i].title === 'undefined') {\r\n\t\t\t\t\t\t\t\t  obj.options.columns[i].title = headers[i];\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// Data\r\n\t\t\t\t\t\tobj.options.data = newData;\r\n\t\t\t\t\t\t// Prepare table\r\n\t\t\t\t\t\tobj.prepareTable();\r\n\t\t\t\t\t\t// Hide spin\r\n\t\t\t\t\t\tif (obj.options.loadingSpin == true) {\r\n\t\t\t\t\t\t\tjSuites.loading.hide();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t} else if (obj.options.url) {\r\n\t\t\t\t// Loading\r\n\t\t\t\tif (obj.options.loadingSpin == true) {\r\n\t\t\t\t\tjSuites.loading.show();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tjSuites.ajax({\r\n\t\t\t\t\turl: obj.options.url,\r\n\t\t\t\t\tmethod: obj.options.method,\r\n\t\t\t\t\tdata: obj.options.requestVariables,\r\n\t\t\t\t\tdataType: 'json',\r\n\t\t\t\t\tsuccess: function(result) {\r\n\t\t\t\t\t\t// Data\r\n\t\t\t\t\t\tobj.options.data = (result.data) ? result.data : result;\r\n\t\t\t\t\t\t// Prepare table\r\n\t\t\t\t\t\tobj.prepareTable();\r\n\t\t\t\t\t\t// Hide spin\r\n\t\t\t\t\t\tif (obj.options.loadingSpin == true) {\r\n\t\t\t\t\t\t\tjSuites.loading.hide();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\t// Prepare table\r\n\t\t\t\tobj.prepareTable();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Context menu\r\n\t\tif (options && options.contextMenu != null) {\r\n\t\t\tobj.options.contextMenu = options.contextMenu;\r\n\t\t} else {\r\n\t\t\tobj.options.contextMenu = function(el, x, y, e) {\r\n\t\t\t\tvar items = [];\r\n\r\n\t\t\t\tif (y == null) {\r\n\t\t\t\t\t// Insert a new column\r\n\t\t\t\t\tif (obj.options.allowInsertColumn == true) {\r\n\t\t\t\t\t\titems.push({\r\n\t\t\t\t\t\t\ttitle:obj.options.text.insertANewColumnBefore,\r\n\t\t\t\t\t\t\tonclick:function() {\r\n\t\t\t\t\t\t\t\tobj.insertColumn(1, parseInt(x), 1);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (obj.options.allowInsertColumn == true) {\r\n\t\t\t\t\t\titems.push({\r\n\t\t\t\t\t\t\ttitle:obj.options.text.insertANewColumnAfter,\r\n\t\t\t\t\t\t\tonclick:function() {\r\n\t\t\t\t\t\t\t\tobj.insertColumn(1, parseInt(x), 0);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Delete a column\r\n\t\t\t\t\tif (obj.options.allowDeleteColumn == true) {\r\n\t\t\t\t\t\titems.push({\r\n\t\t\t\t\t\t\ttitle:obj.options.text.deleteSelectedColumns,\r\n\t\t\t\t\t\t\tonclick:function() {\r\n\t\t\t\t\t\t\t\tobj.deleteColumn(obj.getSelectedColumns().length ? undefined : parseInt(x));\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Rename column\r\n\t\t\t\t\tif (obj.options.allowRenameColumn == true) {\r\n\t\t\t\t\t\titems.push({\r\n\t\t\t\t\t\t\ttitle:obj.options.text.renameThisColumn,\r\n\t\t\t\t\t\t\tonclick:function() {\r\n\t\t\t\t\t\t\t\tobj.setHeader(x);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Sorting\r\n\t\t\t\t\tif (obj.options.columnSorting == true) {\r\n\t\t\t\t\t\t// Line\r\n\t\t\t\t\t\titems.push({ type:'line' });\r\n\r\n\t\t\t\t\t\titems.push({\r\n\t\t\t\t\t\t\ttitle:obj.options.text.orderAscending,\r\n\t\t\t\t\t\t\tonclick:function() {\r\n\t\t\t\t\t\t\t\tobj.orderBy(x, 0);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\titems.push({\r\n\t\t\t\t\t\t\ttitle:obj.options.text.orderDescending,\r\n\t\t\t\t\t\t\tonclick:function() {\r\n\t\t\t\t\t\t\t\tobj.orderBy(x, 1);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Insert new row\r\n\t\t\t\t\tif (obj.options.allowInsertRow == true) {\r\n\t\t\t\t\t\titems.push({\r\n\t\t\t\t\t\t\ttitle:obj.options.text.insertANewRowBefore,\r\n\t\t\t\t\t\t\tonclick:function() {\r\n\t\t\t\t\t\t\t\tobj.insertRow(1, parseInt(y), 1);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\titems.push({\r\n\t\t\t\t\t\t\ttitle:obj.options.text.insertANewRowAfter,\r\n\t\t\t\t\t\t\tonclick:function() {\r\n\t\t\t\t\t\t\t\tobj.insertRow(1, parseInt(y));\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (obj.options.allowDeleteRow == true) {\r\n\t\t\t\t\t\titems.push({\r\n\t\t\t\t\t\t\ttitle:obj.options.text.deleteSelectedRows,\r\n\t\t\t\t\t\t\tonclick:function() {\r\n\t\t\t\t\t\t\t\tobj.deleteRow(obj.getSelectedRows().length ? undefined : parseInt(y));\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (x) {\r\n\t\t\t\t\t\tif (obj.options.allowComments == true) {\r\n\t\t\t\t\t\t\titems.push({ type:'line' });\r\n\r\n\t\t\t\t\t\t\tvar title = obj.records[y][x].getAttribute('title') || '';\r\n\r\n\t\t\t\t\t\t\titems.push({\r\n\t\t\t\t\t\t\t\ttitle: title ? obj.options.text.editComments : obj.options.text.addComments,\r\n\t\t\t\t\t\t\t\tonclick:function() {\r\n\t\t\t\t\t\t\t\t\tvar comment = prompt(obj.options.text.comments, title);\r\n\t\t\t\t\t\t\t\t\tif (comment) {\r\n\t\t\t\t\t\t\t\t\t\tobj.setComments([ x, y ], comment);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\tif (title) {\r\n\t\t\t\t\t\t\t\titems.push({\r\n\t\t\t\t\t\t\t\t\ttitle:obj.options.text.clearComments,\r\n\t\t\t\t\t\t\t\t\tonclick:function() {\r\n\t\t\t\t\t\t\t\t\t\tobj.setComments([ x, y ], '');\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Line\r\n\t\t\t\titems.push({ type:'line' });\r\n\r\n\t\t\t\t// Copy\r\n\t\t\t\titems.push({\r\n\t\t\t\t\ttitle:obj.options.text.copy,\r\n\t\t\t\t\tshortcut:'Ctrl + C',\r\n\t\t\t\t\tonclick:function() {\r\n\t\t\t\t\t\tobj.copy(true);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// Paste\r\n\t\t\t\tif (navigator && navigator.clipboard) {\r\n\t\t\t\t\titems.push({\r\n\t\t\t\t\t\ttitle:obj.options.text.paste,\r\n\t\t\t\t\t\tshortcut:'Ctrl + V',\r\n\t\t\t\t\t\tonclick:function() {\r\n\t\t\t\t\t\t\tif (obj.selectedCell) {\r\n\t\t\t\t\t\t\t\tnavigator.clipboard.readText().then(function(text) {\r\n\t\t\t\t\t\t\t\t\tif (text) {\r\n\t\t\t\t\t\t\t\t\t\tjexcel.current.paste(obj.selectedCell[0], obj.selectedCell[1], text);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Save\r\n\t\t\t\tif (obj.options.allowExport) {\r\n\t\t\t\t\titems.push({\r\n\t\t\t\t\t\ttitle: obj.options.text.saveAs,\r\n\t\t\t\t\t\tshortcut: 'Ctrl + S',\r\n\t\t\t\t\t\tonclick: function () {\r\n\t\t\t\t\t\t\tobj.download();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// About\r\n\t\t\t\tif (obj.options.about) {\r\n\t\t\t\t\titems.push({\r\n\t\t\t\t\t\ttitle:obj.options.text.about,\r\n\t\t\t\t\t\tonclick:function() {\r\n\t\t\t\t\t\t\tif (obj.options.about === true) {\r\n\t\t\t\t\t\t\t\talert(Version().print());\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\talert(obj.options.about);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn items;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tobj.scrollControls = function(e) {\r\n\t\t\tobj.wheelControls();\r\n\r\n\t\t\tif (obj.options.freezeColumns > 0 && obj.content.scrollLeft != scrollLeft) {\r\n\t\t\t\tobj.updateFreezePosition();\r\n\t\t\t}\r\n\r\n\t\t\t// Close editor\r\n\t\t\tif (obj.options.lazyLoading == true || obj.options.tableOverflow == true) {\r\n\t\t\t\tif (obj.edition && e.target.className.substr(0,9) != 'jdropdown') {\r\n\t\t\t\t\tobj.closeEditor(obj.edition[0], true);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tobj.wheelControls = function(e) {\r\n\t\t\tif (obj.options.lazyLoading == true) {\r\n\t\t\t\tif (jexcel.timeControlLoading == null) {\r\n\t\t\t\t\tjexcel.timeControlLoading = setTimeout(function() {\r\n\t\t\t\t\t\tif (obj.content.scrollTop + obj.content.clientHeight >= obj.content.scrollHeight - 10) {\r\n\t\t\t\t\t\t\tif (obj.loadDown()) {\r\n\t\t\t\t\t\t\t\tif (obj.content.scrollTop + obj.content.clientHeight > obj.content.scrollHeight - 10) {\r\n\t\t\t\t\t\t\t\t\tobj.content.scrollTop = obj.content.scrollTop - obj.content.clientHeight;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tobj.updateCornerPosition();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else if (obj.content.scrollTop <= obj.content.clientHeight) {\r\n\t\t\t\t\t\t\tif (obj.loadUp()) {\r\n\t\t\t\t\t\t\t\tif (obj.content.scrollTop < 10) {\r\n\t\t\t\t\t\t\t\t\tobj.content.scrollTop = obj.content.scrollTop + obj.content.clientHeight;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tobj.updateCornerPosition();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tjexcel.timeControlLoading = null;\r\n\t\t\t\t\t}, 100);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Get width of all freezed cells together\r\n\t\tobj.getFreezeWidth = function() {\r\n\t\t\tvar width = 0;\r\n\t\t\tif (obj.options.freezeColumns > 0) {\r\n\t\t\t\tfor (var i = 0; i < obj.options.freezeColumns; i++) {\r\n\t\t\t\t\twidth += parseInt(obj.options.columns[i].width);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn width;\r\n\t\t}\r\n\r\n\t\tvar scrollLeft = 0;\r\n\r\n\t\tobj.updateFreezePosition = function() {\r\n\t\t\tscrollLeft = obj.content.scrollLeft;\r\n\t\t\tvar width = 0;\r\n\t\t\tif (scrollLeft > 50) {\r\n\t\t\t\tfor (var i = 0; i < obj.options.freezeColumns; i++) {\r\n\t\t\t\t\tif (i > 0) {\r\n\t\t\t\t\t\t// Must check if the previous column is hidden or not to determin whether the width shoule be added or not!\r\n\t\t\t\t\t\tif (obj.options.columns[i-1].type !== \"hidden\") {\r\n\t\t\t\t\t\t\twidth += parseInt(obj.options.columns[i-1].width);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tobj.headers[i].classList.add('jexcel_freezed');\r\n\t\t\t\t\tobj.headers[i].style.left = width + 'px';\r\n\t\t\t\t\tfor (var j = 0; j < obj.rows.length; j++) {\r\n\t\t\t\t\t\tif (obj.rows[j] && obj.records[j][i]) {\r\n\t\t\t\t\t\t\tvar shifted = (scrollLeft + (i > 0 ? obj.records[j][i-1].style.width : 0)) - 51 + 'px';\r\n\t\t\t\t\t\t\tobj.records[j][i].classList.add('jexcel_freezed');\r\n\t\t\t\t\t\t\tobj.records[j][i].style.left = shifted;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tfor (var i = 0; i < obj.options.freezeColumns; i++) {\r\n\t\t\t\t\tobj.headers[i].classList.remove('jexcel_freezed');\r\n\t\t\t\t\tobj.headers[i].style.left = '';\r\n\t\t\t\t\tfor (var j = 0; j < obj.rows.length; j++) {\r\n\t\t\t\t\t\tif (obj.records[j][i]) {\r\n\t\t\t\t\t\t\tobj.records[j][i].classList.remove('jexcel_freezed');\r\n\t\t\t\t\t\t\tobj.records[j][i].style.left = '';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Place the corner in the correct place\r\n\t\t\tobj.updateCornerPosition();\r\n\t\t}\r\n\r\n\t\tel.addEventListener(\"DOMMouseScroll\", obj.wheelControls);\r\n\t\tel.addEventListener(\"mousewheel\", obj.wheelControls);\r\n\r\n\t\tel.jexcel = obj;\r\n\t\tel.jspreadsheet = obj;\r\n\r\n\t\tobj.init();\r\n\r\n\t\treturn obj;\r\n\t});\r\n\r\n\t// Define dictionary\r\n\tjexcel.setDictionary = function(o) {\r\n\t\tjSuites.setDictionary(o);\r\n\t}\r\n\r\n\t// Define extensions\r\n\tjexcel.setExtensions = function(o) {\r\n\t\tvar k = Object.keys(o);\r\n\t\tfor (var i = 0; i < k.length; i++) {\r\n\t\t\tif (typeof(o[k[i]]) === 'function') {\r\n\t\t\t\tjexcel[k[i]] = o[k[i]];\r\n\t\t\t\tif (jexcel.license && typeof(o[k[i]].license) == 'function') {\r\n\t\t\t\t\to[k[i]].license(jexcel.license);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Formulas\r\n\t */\r\n\tif (typeof(formula) !== 'undefined') {\r\n\t\tjexcel.formula = formula;\r\n\t}\r\n\tjexcel.version = Version;\r\n\r\n\tjexcel.current = null;\r\n\tjexcel.timeControl = null;\r\n\tjexcel.timeControlLoading = null;\r\n\r\n\tconst destroyEvents = function(root) {\r\n\t\troot.removeEventListener(\"mouseup\", jexcel.mouseUpControls);\r\n\t\troot.removeEventListener(\"mousedown\", jexcel.mouseDownControls);\r\n\t\troot.removeEventListener(\"mousemove\", jexcel.mouseMoveControls);\r\n\t\troot.removeEventListener(\"mouseover\", jexcel.mouseOverControls);\r\n\t\troot.removeEventListener(\"dblclick\", jexcel.doubleClickControls);\r\n\t\troot.removeEventListener(\"paste\", jexcel.pasteControls);\r\n\t\troot.removeEventListener(\"contextmenu\", jexcel.contextMenuControls);\r\n\t\troot.removeEventListener(\"touchstart\", jexcel.touchStartControls);\r\n\t\troot.removeEventListener(\"touchend\", jexcel.touchEndControls);\r\n\t\troot.removeEventListener(\"touchcancel\", jexcel.touchEndControls);\r\n\t\tdocument.removeEventListener(\"keydown\", jexcel.keyDownControls);\r\n\t}\r\n\r\n\tjexcel.destroy = function(element, destroyEventHandlers) {\r\n\t\tif (element.jexcel) {\r\n\t\t\tvar root = element.jexcel.options.root ? element.jexcel.options.root : document;\r\n\t\t\telement.removeEventListener(\"DOMMouseScroll\", element.jexcel.scrollControls);\r\n\t\t\telement.removeEventListener(\"mousewheel\", element.jexcel.scrollControls);\r\n\t\t\telement.jexcel = null;\r\n\t\t\telement.innerHTML = '';\r\n\r\n\t\t\tif (destroyEventHandlers) {\r\n\t\t\t\tdestroyEvents(root);\r\n\t\t\t\tjexcel = null;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tjexcel.build = function(root) {\r\n\t\tdestroyEvents(root);\r\n\t\troot.addEventListener(\"mouseup\", jexcel.mouseUpControls);\r\n\t\troot.addEventListener(\"mousedown\", jexcel.mouseDownControls);\r\n\t\troot.addEventListener(\"mousemove\", jexcel.mouseMoveControls);\r\n\t\troot.addEventListener(\"mouseover\", jexcel.mouseOverControls);\r\n\t\troot.addEventListener(\"dblclick\", jexcel.doubleClickControls);\r\n\t\troot.addEventListener(\"paste\", jexcel.pasteControls);\r\n\t\troot.addEventListener(\"contextmenu\", jexcel.contextMenuControls);\r\n\t\troot.addEventListener(\"touchstart\", jexcel.touchStartControls);\r\n\t\troot.addEventListener(\"touchend\", jexcel.touchEndControls);\r\n\t\troot.addEventListener(\"touchcancel\", jexcel.touchEndControls);\r\n\t\troot.addEventListener(\"touchmove\", jexcel.touchEndControls);\r\n\t\tdocument.addEventListener(\"keydown\", jexcel.keyDownControls);\r\n\t}\r\n\r\n\t/**\r\n\t * Events\r\n\t */\r\n\tjexcel.keyDownControls = function(e) {\r\n\t\tif (jexcel.current) {\r\n\t\t\tif (jexcel.current.edition) {\r\n\t\t\t\tif (e.which == 27) {\r\n\t\t\t\t\t// Escape\r\n\t\t\t\t\tif (jexcel.current.edition) {\r\n\t\t\t\t\t\t// Exit without saving\r\n\t\t\t\t\t\tjexcel.current.closeEditor(jexcel.current.edition[0], false);\r\n\t\t\t\t\t}\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t} else if (e.which == 13) {\r\n\t\t\t\t\t// Enter\r\n\t\t\t\t\tif (jexcel.current.options.columns[jexcel.current.edition[2]].type == 'calendar') {\r\n\t\t\t\t\t\tjexcel.current.closeEditor(jexcel.current.edition[0], true);\r\n\t\t\t\t\t} else if (jexcel.current.options.columns[jexcel.current.edition[2]].type == 'dropdown' ||\r\n\t\t\t\t\t\t\t   jexcel.current.options.columns[jexcel.current.edition[2]].type == 'autocomplete') {\r\n\t\t\t\t\t\t// Do nothing\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// Alt enter -> do not close editor\r\n\t\t\t\t\t\tif ((jexcel.current.options.wordWrap == true ||\r\n\t\t\t\t\t\t\t jexcel.current.options.columns[jexcel.current.edition[2]].wordWrap == true ||\r\n\t\t\t\t\t\t\t jexcel.current.options.data[jexcel.current.edition[3]][jexcel.current.edition[2]].length > 200) && e.altKey) {\r\n\t\t\t\t\t\t\t// Add new line to the editor\r\n\t\t\t\t\t\t\tvar editorTextarea = jexcel.current.edition[0].children[0];\r\n\t\t\t\t\t\t\tvar editorValue = jexcel.current.edition[0].children[0].value;\r\n\t\t\t\t\t\t\tvar editorIndexOf = editorTextarea.selectionStart;\r\n\t\t\t\t\t\t\teditorValue = editorValue.slice(0, editorIndexOf) + \"\\n\" + editorValue.slice(editorIndexOf);\r\n\t\t\t\t\t\t\teditorTextarea.value = editorValue;\r\n\t\t\t\t\t\t\teditorTextarea.focus();\r\n\t\t\t\t\t\t\teditorTextarea.selectionStart = editorIndexOf + 1;\r\n\t\t\t\t\t\t\teditorTextarea.selectionEnd = editorIndexOf + 1;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t// TablePress: Comment out next line (leaving the cell when hitting Enter), so that instead a line break is inserted.\r\n\t\t\t\t\t\t\t// jexcel.current.edition[0].children[0].blur();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (e.which == 9) {\r\n\t\t\t\t\t// Tab\r\n\t\t\t\t\tif (['calendar', 'html'].includes(\r\n\t\t\t\t\tjexcel.current.options.columns[jexcel.current.edition[2]].type)) {\r\n\t\t\t\t\t\tjexcel.current.closeEditor(jexcel.current.edition[0], true);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tjexcel.current.edition[0].children[0].blur();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (! jexcel.current.edition && jexcel.current.selectedCell) {\r\n\t\t\t\t// Which key\r\n\t\t\t\tif (e.which == 37) {\r\n\t\t\t\t\tjexcel.current.left(e.shiftKey, e.ctrlKey);\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t} else if (e.which == 39) {\r\n\t\t\t\t\tjexcel.current.right(e.shiftKey, e.ctrlKey);\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t} else if (e.which == 38) {\r\n\t\t\t\t\tjexcel.current.up(e.shiftKey, e.ctrlKey);\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t} else if (e.which == 40) {\r\n\t\t\t\t\tjexcel.current.down(e.shiftKey, e.ctrlKey);\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t} else if (e.which == 36) {\r\n\t\t\t\t\tjexcel.current.first(e.shiftKey, e.ctrlKey);\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t} else if (e.which == 35) {\r\n\t\t\t\t\tjexcel.current.last(e.shiftKey, e.ctrlKey);\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t} else if (e.which == 46) {\r\n\t\t\t\t\t// Delete\r\n\t\t\t\t\tif (jexcel.current.options.editable == true) {\r\n\t\t\t\t\t\tif (jexcel.current.selectedRow) {\r\n\t\t\t\t\t\t\tif (jexcel.current.options.allowDeleteRow == true) {\r\n\t\t\t\t\t\t\t\tif (confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedRows)) {\r\n\t\t\t\t\t\t\t\t\tjexcel.current.deleteRow();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else if (jexcel.current.selectedHeader) {\r\n\t\t\t\t\t\t\tif (jexcel.current.options.allowDeleteColumn == true) {\r\n\t\t\t\t\t\t\t\tif (confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedColumns)) {\r\n\t\t\t\t\t\t\t\t\tjexcel.current.deleteColumn();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t// Change value\r\n\t\t\t\t\t\t\tjexcel.current.setValue(jexcel.current.highlighted, '');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (e.which == 13) {\r\n\t\t\t\t\t// Move cursor\r\n\t\t\t\t\tif (e.shiftKey) {\r\n\t\t\t\t\t\tjexcel.current.up();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (jexcel.current.options.allowInsertRow == true) {\r\n\t\t\t\t\t\t\tif (jexcel.current.options.allowManualInsertRow == true) {\r\n\t\t\t\t\t\t\t\tif (jexcel.current.selectedCell[1] == jexcel.current.options.data.length - 1) {\r\n\t\t\t\t\t\t\t\t\t// New record in case selectedCell in the last row\r\n\t\t\t\t\t\t\t\t\tjexcel.current.insertRow();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tjexcel.current.down();\r\n\t\t\t\t\t}\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t} else if (e.which == 9) {\r\n\t\t\t\t\t// Tab\r\n\t\t\t\t\tif (e.shiftKey) {\r\n\t\t\t\t\t\t// TablePress: Instead of stopping at the left edge when tabbing, go to the previous row's last cell.\r\n\t\t\t\t\t\t// jexcel.current.left();\r\n\t\t\t\t\t\tif ( jexcel.current.selectedCell[0] == 0 ) {\r\n\t\t\t\t\t\t\tjexcel.current.up();\r\n\t\t\t\t\t\t\tjexcel.current.last();\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tjexcel.current.left();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (jexcel.current.options.allowInsertColumn == true) {\r\n\t\t\t\t\t\t\tif (jexcel.current.options.allowManualInsertColumn == true) {\r\n\t\t\t\t\t\t\t\tif (jexcel.current.selectedCell[0] == jexcel.current.options.data[0].length - 1) {\r\n\t\t\t\t\t\t\t\t\t// New record in case selectedCell in the last column\r\n\t\t\t\t\t\t\t\t\tjexcel.current.insertColumn();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// TablePress: Instead of stopping at the right edge when tabbing, go to the next row's first cell.\r\n\t\t\t\t\t\t// jexcel.current.right();\r\n\t\t\t\t\t\tif ( jexcel.current.selectedCell[0] == jexcel.current.options.data[0].length - 1 ) {\r\n\t\t\t\t\t\t\tjexcel.current.down();\r\n\t\t\t\t\t\t\tjexcel.current.first();\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tjexcel.current.right();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif ((e.ctrlKey || e.metaKey) && ! e.shiftKey) {\r\n\t\t\t\t\t\tif (e.which == 65) {\r\n\t\t\t\t\t\t\t// Ctrl + A\r\n\t\t\t\t\t\t\tjexcel.current.selectAll();\r\n\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t} else if (e.which == 83) {\r\n\t\t\t\t\t\t\t// Ctrl + S\r\n\t\t\t\t\t\t\tjexcel.current.download();\r\n\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t} else if (e.which == 89) {\r\n\t\t\t\t\t\t\t// Ctrl + Y\r\n\t\t\t\t\t\t\tjexcel.current.redo();\r\n\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t} else if (e.which == 90) {\r\n\t\t\t\t\t\t\t// Ctrl + Z\r\n\t\t\t\t\t\t\tjexcel.current.undo();\r\n\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t} else if (e.which == 67) {\r\n\t\t\t\t\t\t\t// Ctrl + C\r\n\t\t\t\t\t\t\tjexcel.current.copy(true);\r\n\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t} else if (e.which == 88) {\r\n\t\t\t\t\t\t\t// Ctrl + X\r\n\t\t\t\t\t\t\tif (jexcel.current.options.editable == true) {\r\n\t\t\t\t\t\t\t\tjexcel.cutControls();\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tjexcel.copyControls();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t} else if (e.which == 86) {\r\n\t\t\t\t\t\t\t// Ctrl + V\r\n\t\t\t\t\t\t\tjexcel.pasteControls();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (jexcel.current.selectedCell) {\r\n\t\t\t\t\t\t\tif (jexcel.current.options.editable == true) {\r\n\t\t\t\t\t\t\t\tvar rowId = jexcel.current.selectedCell[1];\r\n\t\t\t\t\t\t\t\tvar columnId = jexcel.current.selectedCell[0];\r\n\r\n\t\t\t\t\t\t\t\t// If is not readonly\r\n\t\t\t\t\t\t\t\tif (jexcel.current.options.columns[columnId].type != 'readonly') {\r\n\t\t\t\t\t\t\t\t\t// Characters able to start a edition\r\n\t\t\t\t\t\t\t\t\tif (e.keyCode == 32) {\r\n\t\t\t\t\t\t\t\t\t\t// Space\r\n\t\t\t\t\t\t\t\t\t\te.preventDefault()\r\n\t\t\t\t\t\t\t\t\t\tif (jexcel.current.options.columns[columnId].type == 'checkbox' ||\r\n\t\t\t\t\t\t\t\t\t\t\tjexcel.current.options.columns[columnId].type == 'radio') {\r\n\t\t\t\t\t\t\t\t\t\t\tjexcel.current.setCheckRadioValue();\r\n\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\t// Start edition\r\n\t\t\t\t\t\t\t\t\t\t\tjexcel.current.openEditor(jexcel.current.records[rowId][columnId], true);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t} else if (e.keyCode == 113) {\r\n\t\t\t\t\t\t\t\t\t\t// Start edition with current content F2\r\n\t\t\t\t\t\t\t\t\t\tjexcel.current.openEditor(jexcel.current.records[rowId][columnId], false);\r\n\t\t\t\t\t\t\t\t\t} else if ((e.keyCode == 8) ||\r\n\t\t\t\t\t\t\t\t\t\t\t   (e.keyCode >= 48 && e.keyCode <= 57) ||\r\n\t\t\t\t\t\t\t\t\t\t\t   (e.keyCode >= 96 && e.keyCode <= 111) ||\r\n\t\t\t\t\t\t\t\t\t\t\t   (e.keyCode >= 187 && e.keyCode <= 190) ||\r\n\t\t\t\t\t\t\t\t\t\t\t   ((String.fromCharCode(e.keyCode) == e.key || String.fromCharCode(e.keyCode).toLowerCase() == e.key.toLowerCase()) && jexcel.validLetter(String.fromCharCode(e.keyCode)))) {\r\n\t\t\t\t\t\t\t\t\t\t// Start edition\r\n\t\t\t\t\t\t\t\t\t\tjexcel.current.openEditor(jexcel.current.records[rowId][columnId], true);\r\n\t\t\t\t\t\t\t\t\t\t// Prevent entries in the calendar\r\n\t\t\t\t\t\t\t\t\t\tif (jexcel.current.options.columns[columnId].type == 'calendar') {\r\n\t\t\t\t\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (e.target.classList.contains('jexcel_search')) {\r\n\t\t\t\t\tif (jexcel.timeControl) {\r\n\t\t\t\t\t\tclearTimeout(jexcel.timeControl);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tjexcel.timeControl = setTimeout(function() {\r\n\t\t\t\t\t\tjexcel.current.search(e.target.value);\r\n\t\t\t\t\t}, 200);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tjexcel.isMouseAction = false;\r\n\r\n\tjexcel.mouseDownControls = function(e) {\r\n\t\te = e || window.event;\r\n\t\tif (e.buttons) {\r\n\t\t\tvar mouseButton = e.buttons;\r\n\t\t} else if (e.button) {\r\n\t\t\tvar mouseButton = e.button;\r\n\t\t} else {\r\n\t\t\tvar mouseButton = e.which;\r\n\t\t}\r\n\r\n\t\t// Get elements\r\n\t\tvar jexcelTable = jexcel.getElement(e.target);\r\n\r\n\t\tif (jexcelTable[0]) {\r\n\t\t\tif (jexcel.current != jexcelTable[0].jexcel) {\r\n\t\t\t\tif (jexcel.current) {\r\n\t\t\t\t\tif (jexcel.current.edition) {\r\n\t\t\t\t\t\tjexcel.current.closeEditor(jexcel.current.edition[0], true);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tjexcel.current.resetSelection();\r\n\t\t\t\t}\r\n\t\t\t\tjexcel.current = jexcelTable[0].jexcel;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (jexcel.current) {\r\n\t\t\t\tif (jexcel.current.edition) {\r\n\t\t\t\t\tjexcel.current.closeEditor(jexcel.current.edition[0], true);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tjexcel.current.resetSelection(true);\r\n\t\t\t\tjexcel.current = null;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (jexcel.current && mouseButton == 1) {\r\n\t\t\tif (e.target.classList.contains('jexcel_selectall')) {\r\n\t\t\t\tif (jexcel.current) {\r\n\t\t\t\t\tjexcel.current.selectAll();\r\n\t\t\t\t}\r\n\t\t\t} else if (e.target.classList.contains('jexcel_corner')) {\r\n\t\t\t\tif (jexcel.current.options.editable == true) {\r\n\t\t\t\t\tjexcel.current.selectedCorner = true;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\t// Header found\r\n\t\t\t\tif (jexcelTable[1] == 1) {\r\n\t\t\t\t\tvar columnId = e.target.getAttribute('data-x');\r\n\t\t\t\t\tif (columnId) {\r\n\t\t\t\t\t\t// Update cursor\r\n\t\t\t\t\t\tvar info = e.target.getBoundingClientRect();\r\n\t\t\t\t\t\tif (jexcel.current.options.columnResize == true && info.width - e.offsetX < 12) { // TablePress: Changed from 6 to 12 pixels to increase draggable mouse region.\r\n\t\t\t\t\t\t\t// Resize helper\r\n\t\t\t\t\t\t\tjexcel.current.resizing = {\r\n\t\t\t\t\t\t\t\tmousePosition: e.pageX,\r\n\t\t\t\t\t\t\t\tcolumn: columnId,\r\n\t\t\t\t\t\t\t\twidth: info.width,\r\n\t\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\t\t// Border indication\r\n\t\t\t\t\t\t\tjexcel.current.headers[columnId].classList.add('resizing');\r\n\t\t\t\t\t\t\tfor (var j = 0; j < jexcel.current.records.length; j++) {\r\n\t\t\t\t\t\t\t\tif (jexcel.current.records[j][columnId]) {\r\n\t\t\t\t\t\t\t\t\tjexcel.current.records[j][columnId].classList.add('resizing');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else if (jexcel.current.options.columnDrag == true && info.height - e.offsetY < 12) { // TablePress: Changed from 6 to 12 pixels to increase draggable mouse region.\r\n\t\t\t\t\t\t\tif (jexcel.current.isColMerged(columnId).length) {\r\n\t\t\t\t\t\t\t\tconsole.error('Jspreadsheet: This column is part of a merged cell.');\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t// Reset selection\r\n\t\t\t\t\t\t\t\tjexcel.current.resetSelection();\r\n\t\t\t\t\t\t\t\t// Drag helper\r\n\t\t\t\t\t\t\t\tjexcel.current.dragging = {\r\n\t\t\t\t\t\t\t\t\telement: e.target,\r\n\t\t\t\t\t\t\t\t\tcolumn: columnId,\r\n\t\t\t\t\t\t\t\t\tdestination: columnId,\r\n\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\t// Border indication\r\n\t\t\t\t\t\t\t\tjexcel.current.headers[columnId].classList.add('dragging');\r\n\t\t\t\t\t\t\t\tfor (var j = 0; j < jexcel.current.records.length; j++) {\r\n\t\t\t\t\t\t\t\t\tif (jexcel.current.records[j][columnId]) {\r\n\t\t\t\t\t\t\t\t\t\tjexcel.current.records[j][columnId].classList.add('dragging');\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tif (jexcel.current.selectedHeader && (e.shiftKey || e.ctrlKey)) {\r\n\t\t\t\t\t\t\t\tvar o = jexcel.current.selectedHeader;\r\n\t\t\t\t\t\t\t\tvar d = columnId;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t// Press to rename\r\n\t\t\t\t\t\t\t\tif (jexcel.current.selectedHeader == columnId && jexcel.current.options.allowRenameColumn == true) {\r\n\t\t\t\t\t\t\t\t\tjexcel.timeControl = setTimeout(function() {\r\n\t\t\t\t\t\t\t\t\t\tjexcel.current.setHeader(columnId);\r\n\t\t\t\t\t\t\t\t\t}, 800);\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t// Keep track of which header was selected first\r\n\t\t\t\t\t\t\t\tjexcel.current.selectedHeader = columnId;\r\n\r\n\t\t\t\t\t\t\t\t// Update selection single column\r\n\t\t\t\t\t\t\t\tvar o = columnId;\r\n\t\t\t\t\t\t\t\tvar d = columnId;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t// Update selection\r\n\t\t\t\t\t\t\tjexcel.current.updateSelectionFromCoords(o, 0, d, jexcel.current.options.data.length - 1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (e.target.parentNode.classList.contains('jexcel_nested')) {\r\n\t\t\t\t\t\t\tif (e.target.getAttribute('data-column')) {\r\n\t\t\t\t\t\t\t\tvar column = e.target.getAttribute('data-column').split(',');\r\n\t\t\t\t\t\t\t\tvar c1 = parseInt(column[0]);\r\n\t\t\t\t\t\t\t\tvar c2 = parseInt(column[column.length-1]);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tvar c1 = 0;\r\n\t\t\t\t\t\t\t\tvar c2 = jexcel.current.options.columns.length - 1;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tjexcel.current.updateSelectionFromCoords(c1, 0, c2, jexcel.current.options.data.length - 1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tjexcel.current.selectedHeader = false;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Body found\r\n\t\t\t\tif (jexcelTable[1] == 2) {\r\n\t\t\t\t\tvar rowId = e.target.getAttribute('data-y');\r\n\r\n\t\t\t\t\tif (e.target.classList.contains('jexcel_row')) {\r\n\t\t\t\t\t\tvar info = e.target.getBoundingClientRect();\r\n\t\t\t\t\t\tif (jexcel.current.options.rowResize == true && info.height - e.offsetY < 12) { // TablePress: Changed from 6 to 12 pixels to increase draggable mouse region.\r\n\t\t\t\t\t\t\t// Resize helper\r\n\t\t\t\t\t\t\tjexcel.current.resizing = {\r\n\t\t\t\t\t\t\t\telement: e.target.parentNode,\r\n\t\t\t\t\t\t\t\tmousePosition: e.pageY,\r\n\t\t\t\t\t\t\t\trow: rowId,\r\n\t\t\t\t\t\t\t\theight: info.height,\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t// Border indication\r\n\t\t\t\t\t\t\te.target.parentNode.classList.add('resizing');\r\n\t\t\t\t\t\t} else if (jexcel.current.options.rowDrag == true && info.width - e.offsetX < 18) { // TablePress: Changed from 6 to 18 pixels to increase draggable mouse region.\r\n\t\t\t\t\t\t\tif (jexcel.current.isRowMerged(rowId).length) {\r\n\t\t\t\t\t\t\t\tconsole.error('Jspreadsheet: This row is part of a merged cell');\r\n\t\t\t\t\t\t\t} else if (jexcel.current.options.search == true && jexcel.current.results) {\r\n\t\t\t\t\t\t\t\tconsole.error('Jspreadsheet: Please clear your search before perform this action');\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t// Reset selection\r\n\t\t\t\t\t\t\t\tjexcel.current.resetSelection();\r\n\t\t\t\t\t\t\t\t// Drag helper\r\n\t\t\t\t\t\t\t\tjexcel.current.dragging = {\r\n\t\t\t\t\t\t\t\t\telement: e.target.parentNode,\r\n\t\t\t\t\t\t\t\t\trow:rowId,\r\n\t\t\t\t\t\t\t\t\tdestination:rowId,\r\n\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\t// Border indication\r\n\t\t\t\t\t\t\t\te.target.parentNode.classList.add('dragging');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tif (jexcel.current.selectedRow && (e.shiftKey || e.ctrlKey)) {\r\n\t\t\t\t\t\t\t\tvar o = jexcel.current.selectedRow;\r\n\t\t\t\t\t\t\t\tvar d = rowId;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t// Keep track of which header was selected first\r\n\t\t\t\t\t\t\t\tjexcel.current.selectedRow = rowId;\r\n\r\n\t\t\t\t\t\t\t\t// Update selection single column\r\n\t\t\t\t\t\t\t\tvar o = rowId;\r\n\t\t\t\t\t\t\t\tvar d = rowId;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t// Update selection\r\n\t\t\t\t\t\t\tjexcel.current.updateSelectionFromCoords(0, o, jexcel.current.options.data[0].length - 1, d);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// Jclose\r\n\t\t\t\t\t\tif (e.target.classList.contains('jclose') && e.target.clientWidth - e.offsetX < 50 && e.offsetY < 50) {\r\n\t\t\t\t\t\t\tjexcel.current.closeEditor(jexcel.current.edition[0], true);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tvar getCellCoords = function(element) {\r\n\t\t\t\t\t\t\t\tvar x = element.getAttribute('data-x');\r\n\t\t\t\t\t\t\t\tvar y = element.getAttribute('data-y');\r\n\t\t\t\t\t\t\t\tif (x && y) {\r\n\t\t\t\t\t\t\t\t\treturn [x, y];\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tif (element.parentNode) {\r\n\t\t\t\t\t\t\t\t\t\treturn getCellCoords(element.parentNode);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\t\tvar position = getCellCoords(e.target);\r\n\t\t\t\t\t\t\tif (position) {\r\n\r\n\t\t\t\t\t\t\t\tvar columnId = position[0];\r\n\t\t\t\t\t\t\t\tvar rowId = position[1];\r\n\t\t\t\t\t\t\t\t// Close edition\r\n\t\t\t\t\t\t\t\tif (jexcel.current.edition) {\r\n\t\t\t\t\t\t\t\t\tif (jexcel.current.edition[2] != columnId || jexcel.current.edition[3] != rowId) {\r\n\t\t\t\t\t\t\t\t\t\tjexcel.current.closeEditor(jexcel.current.edition[0], true);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tif (! jexcel.current.edition) {\r\n\t\t\t\t\t\t\t\t\t// Update cell selection\r\n\t\t\t\t\t\t\t\t\tif (e.shiftKey) {\r\n\t\t\t\t\t\t\t\t\t\tjexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0], jexcel.current.selectedCell[1], columnId, rowId);\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tjexcel.current.updateSelectionFromCoords(columnId, rowId);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t// No full row selected\r\n\t\t\t\t\t\t\t\tjexcel.current.selectedHeader = null;\r\n\t\t\t\t\t\t\t\tjexcel.current.selectedRow = null;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tjexcel.current.selectedRow = false;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Pagination\r\n\t\t\t\tif (e.target.classList.contains('jexcel_page')) {\r\n\t\t\t\t\tif (e.target.textContent == '<') {\r\n\t\t\t\t\t\tjexcel.current.page(0);\r\n\t\t\t\t\t} else if (e.target.textContent == '>') {\r\n\t\t\t\t\t\tjexcel.current.page(e.target.getAttribute('title') - 1);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tjexcel.current.page(e.target.textContent - 1);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (jexcel.current.edition) {\r\n\t\t\t\tjexcel.isMouseAction = false;\r\n\t\t\t} else {\r\n\t\t\t\tjexcel.isMouseAction = true;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tjexcel.isMouseAction = false;\r\n\t\t}\r\n\t}\r\n\r\n\tjexcel.mouseUpControls = function(e) {\r\n\t\tif (jexcel.current) {\r\n\t\t\t// Update cell size\r\n\t\t\tif (jexcel.current.resizing) {\r\n\t\t\t\t// Columns to be updated\r\n\t\t\t\tif (jexcel.current.resizing.column) {\r\n\t\t\t\t\t// New width\r\n\t\t\t\t\tvar newWidth = jexcel.current.colgroup[jexcel.current.resizing.column].getAttribute('width');\r\n\t\t\t\t\t// Columns\r\n\t\t\t\t\tvar columns = jexcel.current.getSelectedColumns();\r\n\t\t\t\t\tif (columns.length > 1) {\r\n\t\t\t\t\t\tvar currentWidth = [];\r\n\t\t\t\t\t\tfor (var i = 0; i < columns.length; i++) {\r\n\t\t\t\t\t\t\tcurrentWidth.push(parseInt(jexcel.current.colgroup[columns[i]].getAttribute('width')));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// Previous width\r\n\t\t\t\t\t\tvar index = columns.indexOf(parseInt(jexcel.current.resizing.column));\r\n\t\t\t\t\t\tcurrentWidth[index] = jexcel.current.resizing.width;\r\n\t\t\t\t\t\tjexcel.current.setWidth(columns, newWidth, currentWidth);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tjexcel.current.setWidth(jexcel.current.resizing.column, newWidth, jexcel.current.resizing.width);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// Remove border\r\n\t\t\t\t\tjexcel.current.headers[jexcel.current.resizing.column].classList.remove('resizing');\r\n\t\t\t\t\tfor (var j = 0; j < jexcel.current.records.length; j++) {\r\n\t\t\t\t\t\tif (jexcel.current.records[j][jexcel.current.resizing.column]) {\r\n\t\t\t\t\t\t\tjexcel.current.records[j][jexcel.current.resizing.column].classList.remove('resizing');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Remove Class\r\n\t\t\t\t\tjexcel.current.rows[jexcel.current.resizing.row].children[0].classList.remove('resizing');\r\n\t\t\t\t\tvar newHeight = jexcel.current.rows[jexcel.current.resizing.row].getAttribute('height');\r\n\t\t\t\t\tjexcel.current.setHeight(jexcel.current.resizing.row, newHeight, jexcel.current.resizing.height);\r\n\t\t\t\t\t// Remove border\r\n\t\t\t\t\tjexcel.current.resizing.element.classList.remove('resizing');\r\n\t\t\t\t}\r\n\t\t\t\t// Reset resizing helper\r\n\t\t\t\tjexcel.current.resizing = null;\r\n\t\t\t} else if (jexcel.current.dragging) {\r\n\t\t\t\t// Reset dragging helper\r\n\t\t\t\tif (jexcel.current.dragging) {\r\n\t\t\t\t\tif (jexcel.current.dragging.column) {\r\n\t\t\t\t\t\t// Target\r\n\t\t\t\t\t\tvar columnId = e.target.getAttribute('data-x');\r\n\t\t\t\t\t\t// Remove move style\r\n\t\t\t\t\t\tjexcel.current.headers[jexcel.current.dragging.column].classList.remove('dragging');\r\n\t\t\t\t\t\tfor (var j = 0; j < jexcel.current.rows.length; j++) {\r\n\t\t\t\t\t\t\tif (jexcel.current.records[j][jexcel.current.dragging.column]) {\r\n\t\t\t\t\t\t\t\tjexcel.current.records[j][jexcel.current.dragging.column].classList.remove('dragging');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfor (var i = 0; i < jexcel.current.headers.length; i++) {\r\n\t\t\t\t\t\t\tjexcel.current.headers[i].classList.remove('dragging-left');\r\n\t\t\t\t\t\t\tjexcel.current.headers[i].classList.remove('dragging-right');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// Update position\r\n\t\t\t\t\t\tif (columnId) {\r\n\t\t\t\t\t\t\tif (jexcel.current.dragging.column != jexcel.current.dragging.destination) {\r\n\t\t\t\t\t\t\t\tjexcel.current.moveColumn(jexcel.current.dragging.column, jexcel.current.dragging.destination);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (jexcel.current.dragging.element.nextSibling) {\r\n\t\t\t\t\t\t\tvar position = parseInt(jexcel.current.dragging.element.nextSibling.getAttribute('data-y'));\r\n\t\t\t\t\t\t\tif (jexcel.current.dragging.row < position) {\r\n\t\t\t\t\t\t\t\tposition -= 1;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tvar position = parseInt(jexcel.current.dragging.element.previousSibling.getAttribute('data-y'));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (jexcel.current.dragging.row != jexcel.current.dragging.destination) {\r\n\t\t\t\t\t\t\tjexcel.current.moveRow(jexcel.current.dragging.row, position, true);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tjexcel.current.dragging.element.classList.remove('dragging');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tjexcel.current.dragging = null;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\t// Close any corner selection\r\n\t\t\t\tif (jexcel.current.selectedCorner) {\r\n\t\t\t\t\tjexcel.current.selectedCorner = false;\r\n\r\n\t\t\t\t\t// Data to be copied\r\n\t\t\t\t\tif (jexcel.current.selection.length > 0) {\r\n\t\t\t\t\t\t// Copy data\r\n\t\t\t\t\t\tjexcel.current.copyData(jexcel.current.selection[0], jexcel.current.selection[jexcel.current.selection.length - 1]);\r\n\r\n\t\t\t\t\t\t// Remove selection\r\n\t\t\t\t\t\tjexcel.current.removeCopySelection();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Clear any time control\r\n\t\tif (jexcel.timeControl) {\r\n\t\t\tclearTimeout(jexcel.timeControl);\r\n\t\t\tjexcel.timeControl = null;\r\n\t\t}\r\n\r\n\t\t// Mouse up\r\n\t\tjexcel.isMouseAction = false;\r\n\t}\r\n\r\n\t// Mouse move controls\r\n\tjexcel.mouseMoveControls = function(e) {\r\n\t\te = e || window.event;\r\n\t\tif (e.buttons) {\r\n\t\t\tvar mouseButton = e.buttons;\r\n\t\t} else if (e.button) {\r\n\t\t\tvar mouseButton = e.button;\r\n\t\t} else {\r\n\t\t\tvar mouseButton = e.which;\r\n\t\t}\r\n\r\n\t\tif (! mouseButton) {\r\n\t\t\tjexcel.isMouseAction = false;\r\n\t\t}\r\n\r\n\t\tif (jexcel.current) {\r\n\t\t\tif (jexcel.isMouseAction == true) {\r\n\t\t\t\t// Resizing is ongoing\r\n\t\t\t\tif (jexcel.current.resizing) {\r\n\t\t\t\t\tif (jexcel.current.resizing.column) {\r\n\t\t\t\t\t\tvar width = e.pageX - jexcel.current.resizing.mousePosition;\r\n\r\n\t\t\t\t\t\tif (jexcel.current.resizing.width + width > 0) {\r\n\t\t\t\t\t\t\tvar tempWidth = jexcel.current.resizing.width + width;\r\n\t\t\t\t\t\t\tjexcel.current.colgroup[jexcel.current.resizing.column].setAttribute('width', tempWidth);\r\n\r\n\t\t\t\t\t\t\tjexcel.current.updateCornerPosition();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tvar height = e.pageY - jexcel.current.resizing.mousePosition;\r\n\r\n\t\t\t\t\t\tif (jexcel.current.resizing.height + height > 0) {\r\n\t\t\t\t\t\t\tvar tempHeight = jexcel.current.resizing.height + height;\r\n\t\t\t\t\t\t\tjexcel.current.rows[jexcel.current.resizing.row].setAttribute('height', tempHeight);\r\n\t\t\t\t\t\t\t// TablePress: Add a custom CSS variable to adjust the number of shown lines of text to the row height.\r\n\t\t\t\t\t\t\tjexcel.current.rows[jexcel.current.resizing.row].style.setProperty( '--table-editor-line-clamp', Math.floor( (tempHeight-10) / 14 ) );\r\n\t\t\t\t\t\t\tjexcel.current.updateCornerPosition();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (jexcel.current.dragging) {\r\n\t\t\t\t\tif (jexcel.current.dragging.column) {\r\n\t\t\t\t\t\tvar columnId = e.target.getAttribute('data-x');\r\n\t\t\t\t\t\tif (columnId) {\r\n\r\n\t\t\t\t\t\t\tif (jexcel.current.isColMerged(columnId).length) {\r\n\t\t\t\t\t\t\t\tconsole.error('Jspreadsheet: This column is part of a merged cell.');\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tfor (var i = 0; i < jexcel.current.headers.length; i++) {\r\n\t\t\t\t\t\t\t\t\tjexcel.current.headers[i].classList.remove('dragging-left');\r\n\t\t\t\t\t\t\t\t\tjexcel.current.headers[i].classList.remove('dragging-right');\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tif (jexcel.current.dragging.column == columnId) {\r\n\t\t\t\t\t\t\t\t\tjexcel.current.dragging.destination = parseInt(columnId);\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tif (e.target.clientWidth / 2 > e.offsetX) {\r\n\t\t\t\t\t\t\t\t\t\tif (jexcel.current.dragging.column < columnId) {\r\n\t\t\t\t\t\t\t\t\t\t\tjexcel.current.dragging.destination = parseInt(columnId) - 1;\r\n\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\tjexcel.current.dragging.destination = parseInt(columnId);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tjexcel.current.headers[columnId].classList.add('dragging-left');\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tif (jexcel.current.dragging.column < columnId) {\r\n\t\t\t\t\t\t\t\t\t\t\tjexcel.current.dragging.destination = parseInt(columnId);\r\n\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\tjexcel.current.dragging.destination = parseInt(columnId) + 1;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tjexcel.current.headers[columnId].classList.add('dragging-right');\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tvar rowId = e.target.getAttribute('data-y');\r\n\t\t\t\t\t\tif (rowId) {\r\n\t\t\t\t\t\t\tif (jexcel.current.isRowMerged(rowId).length) {\r\n\t\t\t\t\t\t\t\tconsole.error('Jspreadsheet: This row is part of a merged cell.');\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tvar target = (e.target.clientHeight / 2 > e.offsetY) ? e.target.parentNode.nextSibling : e.target.parentNode;\r\n\t\t\t\t\t\t\t\tif (jexcel.current.dragging.element != target) {\r\n\t\t\t\t\t\t\t\t\te.target.parentNode.parentNode.insertBefore(jexcel.current.dragging.element, target);\r\n\t\t\t\t\t\t\t\t\tjexcel.current.dragging.destination = Array.prototype.indexOf.call(jexcel.current.dragging.element.parentNode.children, jexcel.current.dragging.element);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tvar x = e.target.getAttribute('data-x');\r\n\t\t\t\tvar y = e.target.getAttribute('data-y');\r\n\t\t\t\tvar rect = e.target.getBoundingClientRect();\r\n\r\n\t\t\t\tif (jexcel.current.cursor) {\r\n\t\t\t\t\tjexcel.current.cursor.style.cursor = '';\r\n\t\t\t\t\tjexcel.current.cursor = null;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (e.target.parentNode.parentNode && e.target.parentNode.parentNode.className) {\r\n\t\t\t\t\tif (e.target.parentNode.parentNode.classList.contains('resizable')) {\r\n\t\t\t\t\t\tif (e.target && x && ! y && (rect.width - (e.clientX - rect.left) < 12)) { // TablePress: Changed from 6 to 12 pixels to increase draggable mouse region.\r\n\t\t\t\t\t\t\tjexcel.current.cursor = e.target;\r\n\t\t\t\t\t\t\tjexcel.current.cursor.style.cursor = 'col-resize';\r\n\t\t\t\t\t\t} else if (e.target && ! x && y && (rect.height - (e.clientY - rect.top) < 12)) { // TablePress: Changed from 6 to 12 pixels to increase draggable mouse region.\r\n\t\t\t\t\t\t\tjexcel.current.cursor = e.target;\r\n\t\t\t\t\t\t\tjexcel.current.cursor.style.cursor = 'row-resize';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (e.target.parentNode.parentNode.classList.contains('draggable')) {\r\n\t\t\t\t\t\tif (e.target && ! x && y && (rect.width - (e.clientX - rect.left) < 18)) { // TablePress: Changed from 6 to 18 pixels to increase draggable mouse region.\r\n\t\t\t\t\t\t\tjexcel.current.cursor = e.target;\r\n\t\t\t\t\t\t\tjexcel.current.cursor.style.cursor = 'move';\r\n\t\t\t\t\t\t} else if (e.target && x && ! y && (rect.height - (e.clientY - rect.top) < 12) && (e.clientX - rect.left < rect.width - 24)) { // TablePress: Changed from 6 to 12 pixels to increase draggable mouse region, and extended to not span full width.\r\n\t\t\t\t\t\t\tjexcel.current.cursor = e.target;\r\n\t\t\t\t\t\t\tjexcel.current.cursor.style.cursor = 'move';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tjexcel.mouseOverControls = function(e) {\r\n\t\te = e || window.event;\r\n\t\tif (e.buttons) {\r\n\t\t\tvar mouseButton = e.buttons;\r\n\t\t} else if (e.button) {\r\n\t\t\tvar mouseButton = e.button;\r\n\t\t} else {\r\n\t\t\tvar mouseButton = e.which;\r\n\t\t}\r\n\r\n\t\tif (! mouseButton) {\r\n\t\t\tjexcel.isMouseAction = false;\r\n\t\t}\r\n\r\n\t\tif (jexcel.current && jexcel.isMouseAction == true) {\r\n\t\t\t// Get elements\r\n\t\t\tvar jexcelTable = jexcel.getElement(e.target);\r\n\r\n\t\t\tif (jexcelTable[0]) {\r\n\t\t\t\t// Avoid cross reference\r\n\t\t\t\tif (jexcel.current != jexcelTable[0].jexcel) {\r\n\t\t\t\t\tif (jexcel.current) {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar columnId = e.target.getAttribute('data-x');\r\n\t\t\t\tvar rowId = e.target.getAttribute('data-y');\r\n\t\t\t\tif (jexcel.current.resizing || jexcel.current.dragging) {\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Header found\r\n\t\t\t\t\tif (jexcelTable[1] == 1) {\r\n\t\t\t\t\t\tif (jexcel.current.selectedHeader) {\r\n\t\t\t\t\t\t\tvar columnId = e.target.getAttribute('data-x');\r\n\t\t\t\t\t\t\tvar o = jexcel.current.selectedHeader;\r\n\t\t\t\t\t\t\tvar d = columnId;\r\n\t\t\t\t\t\t\t// Update selection\r\n\t\t\t\t\t\t\tjexcel.current.updateSelectionFromCoords(o, 0, d, jexcel.current.options.data.length - 1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Body found\r\n\t\t\t\t\tif (jexcelTable[1] == 2) {\r\n\t\t\t\t\t\tif (e.target.classList.contains('jexcel_row')) {\r\n\t\t\t\t\t\t\tif (jexcel.current.selectedRow) {\r\n\t\t\t\t\t\t\t\tvar o = jexcel.current.selectedRow;\r\n\t\t\t\t\t\t\t\tvar d = rowId;\r\n\t\t\t\t\t\t\t\t// Update selection\r\n\t\t\t\t\t\t\t\tjexcel.current.updateSelectionFromCoords(0, o, jexcel.current.options.data[0].length - 1, d);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t// Do not select edtion is in progress\r\n\t\t\t\t\t\t\tif (! jexcel.current.edition) {\r\n\t\t\t\t\t\t\t\tif (columnId && rowId) {\r\n\t\t\t\t\t\t\t\t\tif (jexcel.current.selectedCorner) {\r\n\t\t\t\t\t\t\t\t\t\tjexcel.current.updateCopySelection(columnId, rowId);\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tif (jexcel.current.selectedCell) {\r\n\t\t\t\t\t\t\t\t\t\t\tjexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0], jexcel.current.selectedCell[1], columnId, rowId);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Clear any time control\r\n\t\tif (jexcel.timeControl) {\r\n\t\t\tclearTimeout(jexcel.timeControl);\r\n\t\t\tjexcel.timeControl = null;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Double click event handler: controls the double click in the corner, cell edition or column re-ordering.\r\n\t */\r\n\tjexcel.doubleClickControls = function(e) {\r\n\t\t// Jexcel is selected\r\n\t\tif (jexcel.current) {\r\n\t\t\t// Corner action\r\n\t\t\tif (e.target.classList.contains('jexcel_corner')) {\r\n\t\t\t\t// Any selected cells\r\n\t\t\t\tif (jexcel.current.highlighted.length > 0) {\r\n\t\t\t\t\t// Copy from this\r\n\t\t\t\t\tvar x1 = jexcel.current.highlighted[0].getAttribute('data-x');\r\n\t\t\t\t\tvar y1 = parseInt(jexcel.current.highlighted[jexcel.current.highlighted.length - 1].getAttribute('data-y')) + 1;\r\n\t\t\t\t\t// Until this\r\n\t\t\t\t\tvar x2 = jexcel.current.highlighted[jexcel.current.highlighted.length - 1].getAttribute('data-x');\r\n\t\t\t\t\tvar y2 = jexcel.current.records.length - 1\r\n\t\t\t\t\t// Execute copy\r\n\t\t\t\t\tjexcel.current.copyData(jexcel.current.records[y1][x1], jexcel.current.records[y2][x2]);\r\n\t\t\t\t}\r\n\t\t\t} else if (e.target.classList.contains('jexcel_column_filter')) {\r\n\t\t\t\t// Column\r\n\t\t\t\tvar columnId = e.target.getAttribute('data-x');\r\n\t\t\t\t// Open filter\r\n\t\t\t\tjexcel.current.openFilter(columnId);\r\n\r\n\t\t\t} else {\r\n\t\t\t\t// Get table\r\n\t\t\t\tvar jexcelTable = jexcel.getElement(e.target);\r\n\r\n\t\t\t\t// Double click over header\r\n\t\t\t\tif (jexcelTable[1] == 1 && jexcel.current.options.columnSorting == true) {\r\n\t\t\t\t\t// Check valid column header coords\r\n\t\t\t\t\tvar columnId = e.target.getAttribute('data-x');\r\n\t\t\t\t\tif (columnId) {\r\n\t\t\t\t\t\tjexcel.current.orderBy(columnId);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Double click over body\r\n\t\t\t\tif (jexcelTable[1] == 2 && jexcel.current.options.editable == true) {\r\n\t\t\t\t\tif (! jexcel.current.edition) {\r\n\t\t\t\t\t\tvar getCellCoords = function(element) {\r\n\t\t\t\t\t\t\tif (element.parentNode) {\r\n\t\t\t\t\t\t\t\tvar x = element.getAttribute('data-x');\r\n\t\t\t\t\t\t\t\tvar y = element.getAttribute('data-y');\r\n\t\t\t\t\t\t\t\tif (x && y) {\r\n\t\t\t\t\t\t\t\t\treturn element;\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\treturn getCellCoords(element.parentNode);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar cell = getCellCoords(e.target);\r\n\t\t\t\t\t\tif (cell && cell.classList.contains('highlight')) {\r\n\t\t\t\t\t\t\tjexcel.current.openEditor(cell);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tjexcel.copyControls = function(e) {\r\n\t\tif (jexcel.current && jexcel.copyControls.enabled) {\r\n\t\t\tif (! jexcel.current.edition) {\r\n\t\t\t\tjexcel.current.copy(true);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tjexcel.cutControls = function(e) {\r\n\t\tif (jexcel.current) {\r\n\t\t\tif (! jexcel.current.edition) {\r\n\t\t\t\tjexcel.current.copy(true);\r\n\t\t\t\tif (jexcel.current.options.editable == true) {\r\n\t\t\t\t\tjexcel.current.setValue(jexcel.current.highlighted, '');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tjexcel.pasteControls = function(e) {\r\n\t\tif (jexcel.current && jexcel.current.selectedCell) {\r\n\t\t\tif (! jexcel.current.edition) {\r\n\t\t\t\tif (jexcel.current.options.editable == true) {\r\n\t\t\t\t\tif (e && e.clipboardData) {\r\n\t\t\t\t\t\tjexcel.current.paste(jexcel.current.selectedCell[0], jexcel.current.selectedCell[1], e.clipboardData.getData('text'));\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t} else if (window.clipboardData) {\r\n\t\t\t\t\t\tjexcel.current.paste(jexcel.current.selectedCell[0], jexcel.current.selectedCell[1], window.clipboardData.getData('text'));\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tjexcel.contextMenuControls = function(e) {\r\n\t\te = e || window.event;\r\n\t\tif (\"buttons\" in e) {\r\n\t\t\tvar mouseButton = e.buttons;\r\n\t\t} else {\r\n\t\t\tvar mouseButton = e.which || e.button;\r\n\t\t}\r\n\r\n\t\tif (jexcel.current) {\r\n\t\t\t// TablePress: Don't prevent showing the context menu when editing a focussed cell.\r\n\t\t\t//if (jexcel.current.edition) {\r\n\t\t\t\t//e.preventDefault();\r\n\t\t\t//} else\r\n\t\t\tif (jexcel.current.options.contextMenu) {\r\n\t\t\t\tjexcel.current.contextMenu.contextmenu.close();\r\n\r\n\t\t\t\tif (jexcel.current) {\r\n\t\t\t\t\t// TablePress: Take into account the inserted DIV element and the editor TEXTAREA when opening the context menu.\r\n\t\t\t\t\tvar target = (e.target.tagName === 'DIV' || e.target.tagName === 'TEXTAREA') ? e.target.parentNode : e.target;\r\n\t\t\t\t\tvar x = target.getAttribute('data-x');\r\n\t\t\t\t\tvar y = target.getAttribute('data-y');\r\n\r\n\t\t\t\t\tif (x || y) {\r\n\t\t\t\t\t\t/* // TablePress: Fix the comparison of the clicked cell with the selected cell range (e.g. when a right click happens outside of the selected range).\r\n\t\t\t\t\t\tif ((x < parseInt(jexcel.current.selectedCell[0])) || (x > parseInt(jexcel.current.selectedCell[2])) ||\r\n\t\t\t\t\t\t\t(y < parseInt(jexcel.current.selectedCell[1])) || (y > parseInt(jexcel.current.selectedCell[3])))\r\n\t\t\t\t\t\t*/\r\n\t\t\t\t\t\tconst selection = jexcel.current.selectedCell;\r\n\t\t\t\t\t\tconst selected_cell = {\r\n\t\t\t\t\t\t\tl: Math.min( parseInt( selection[0] ), parseInt( selection[2] ) ),\r\n\t\t\t\t\t\t\tr: Math.max( parseInt( selection[0] ), parseInt( selection[2] ) ),\r\n\t\t\t\t\t\t\tt: Math.min( parseInt( selection[1] ), parseInt( selection[3] ) ),\r\n\t\t\t\t\t\t\tb: Math.max( parseInt( selection[1] ), parseInt( selection[3] ) ),\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tif ( x < selected_cell.l || x > selected_cell.r || y < selected_cell.t || y > selected_cell.b ) {\r\n\t\t\t\t\t\t\tjexcel.current.updateSelectionFromCoords(x, y, x, y);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// TablePress: End of change.\r\n\r\n\t\t\t\t\t\t// Table found\r\n\t\t\t\t\t\tvar items = jexcel.current.options.contextMenu(jexcel.current, x, y, e);\r\n\t\t\t\t\t\t// The id is depending on header and body\r\n\t\t\t\t\t\tjexcel.current.contextMenu.contextmenu.open(e, items);\r\n\t\t\t\t\t\t// Avoid the real one\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tjexcel.touchStartControls = function(e) {\r\n\t\tvar jexcelTable = jexcel.getElement(e.target);\r\n\r\n\t\tif (jexcelTable[0]) {\r\n\t\t\tif (jexcel.current != jexcelTable[0].jexcel) {\r\n\t\t\t\tif (jexcel.current) {\r\n\t\t\t\t\tjexcel.current.resetSelection();\r\n\t\t\t\t}\r\n\t\t\t\tjexcel.current = jexcelTable[0].jexcel;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (jexcel.current) {\r\n\t\t\t\tjexcel.current.resetSelection();\r\n\t\t\t\tjexcel.current = null;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (jexcel.current) {\r\n\t\t\tif (! jexcel.current.edition) {\r\n\t\t\t\tvar columnId = e.target.getAttribute('data-x');\r\n\t\t\t\tvar rowId = e.target.getAttribute('data-y');\r\n\r\n\t\t\t\tif (columnId && rowId) {\r\n\t\t\t\t\tjexcel.current.updateSelectionFromCoords(columnId, rowId);\r\n\r\n\t\t\t\t\tjexcel.timeControl = setTimeout(function() {\r\n\t\t\t\t\t\t// Keep temporary reference to the element\r\n\t\t\t\t\t\tif (jexcel.current.options.columns[columnId].type == 'color') {\r\n\t\t\t\t\t\t\tjexcel.tmpElement = null;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tjexcel.tmpElement = e.target;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tjexcel.current.openEditor(e.target, false, e);\r\n\t\t\t\t\t}, 500);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tjexcel.touchEndControls = function(e) {\r\n\t\t// Clear any time control\r\n\t\tif (jexcel.timeControl) {\r\n\t\t\tclearTimeout(jexcel.timeControl);\r\n\t\t\tjexcel.timeControl = null;\r\n\t\t\t// Element\r\n\t\t\tif (jexcel.tmpElement && jexcel.tmpElement.children[0].tagName == 'INPUT') {\r\n\t\t\t\tjexcel.tmpElement.children[0].focus();\r\n\t\t\t}\r\n\t\t\tjexcel.tmpElement = null;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Jexcel extensions\r\n\t */\r\n\r\n\tjexcel.tabs = function(tabs, result) {\r\n\t\tvar instances = [];\r\n\t\t// Create tab container\r\n\t\tif (! tabs.classList.contains('jexcel_tabs')) {\r\n\t\t\ttabs.innerHTML = '';\r\n\t\t\ttabs.classList.add('jexcel_tabs')\r\n\t\t\ttabs.jexcel = [];\r\n\r\n\t\t\tvar div = document.createElement('div');\r\n\t\t\tvar headers = tabs.appendChild(div);\r\n\t\t\tvar div = document.createElement('div');\r\n\t\t\tvar content = tabs.appendChild(div);\r\n\t\t} else {\r\n\t\t\tvar headers = tabs.children[0];\r\n\t\t\tvar content = tabs.children[1];\r\n\t\t}\r\n\r\n\t\tvar spreadsheet = []\r\n\t\tvar link = [];\r\n\t\tfor (var i = 0; i < result.length; i++) {\r\n\t\t\t// Spreadsheet container\r\n\t\t\tspreadsheet[i] = document.createElement('div');\r\n\t\t\tspreadsheet[i].classList.add('jexcel_tab');\r\n\t\t\tvar worksheet = jexcel(spreadsheet[i], result[i]);\r\n\t\t\tcontent.appendChild(spreadsheet[i]);\r\n\t\t\tinstances[i] = tabs.jexcel.push(worksheet);\r\n\r\n\t\t\t// Tab link\r\n\t\t\tlink[i] = document.createElement('div');\r\n\t\t\tlink[i].classList.add('jexcel_tab_link');\r\n\t\t\tlink[i].setAttribute('data-spreadsheet', tabs.jexcel.length-1);\r\n\t\t\tlink[i].innerHTML = result[i].sheetName;\r\n\t\t\tlink[i].onclick = function() {\r\n\t\t\t\tfor (var j = 0; j < headers.children.length; j++) {\r\n\t\t\t\t\theaders.children[j].classList.remove('selected');\r\n\t\t\t\t\tcontent.children[j].style.display = 'none';\r\n\t\t\t\t}\r\n\t\t\t\tvar i = this.getAttribute('data-spreadsheet');\r\n\t\t\t\tcontent.children[i].style.display = 'block';\r\n\t\t\t\theaders.children[i].classList.add('selected')\r\n\t\t\t}\r\n\t\t\theaders.appendChild(link[i]);\r\n\t\t}\r\n\r\n\t\t// First tab\r\n\t\tfor (var j = 0; j < headers.children.length; j++) {\r\n\t\t\theaders.children[j].classList.remove('selected');\r\n\t\t\tcontent.children[j].style.display = 'none';\r\n\t\t}\r\n\t\theaders.children[headers.children.length - 1].classList.add('selected');\r\n\t\tcontent.children[headers.children.length - 1].style.display = 'block';\r\n\r\n\t\treturn instances;\r\n\t}\r\n\r\n\t// Compability to older versions\r\n\tjexcel.createTabs = jexcel.tabs;\r\n\r\n\tjexcel.fromSpreadsheet = function(file, __callback) {\r\n\t\tvar convert = function(workbook) {\r\n\t\t\tvar spreadsheets = [];\r\n\t\t\tworkbook.SheetNames.forEach(function(sheetName) {\r\n\t\t\t\tvar spreadsheet = {};\r\n\t\t\t\tspreadsheet.rows = [];\r\n\t\t\t\tspreadsheet.columns = [];\r\n\t\t\t\tspreadsheet.data = [];\r\n\t\t\t\tspreadsheet.style = {};\r\n\t\t\t\tspreadsheet.sheetName = sheetName;\r\n\r\n\t\t\t\t// Column widths\r\n\t\t\t\tvar temp = workbook.Sheets[sheetName]['!cols'];\r\n\t\t\t\tif (temp && temp.length) {\r\n\t\t\t\t\tfor (var i = 0; i < temp.length; i++) {\r\n\t\t\t\t\t\tspreadsheet.columns[i] = {};\r\n\t\t\t\t\t\tif (temp[i] && temp[i].wpx) {\r\n\t\t\t\t\t\t\tspreadsheet.columns[i].width = temp[i].wpx + 'px';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t }\r\n\t\t\t\t}\r\n\t\t\t\t// Rows heights\r\n\t\t\t\tvar temp = workbook.Sheets[sheetName]['!rows'];\r\n\t\t\t\tif (temp && temp.length) {\r\n\t\t\t\t\tfor (var i = 0; i < temp.length; i++) {\r\n\t\t\t\t\t\tif (temp[i] && temp[i].hpx) {\r\n\t\t\t\t\t\t\tspreadsheet.rows[i] = {};\r\n\t\t\t\t\t\t\tspreadsheet.rows[i].height = temp[i].hpx + 'px';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t// Merge cells\r\n\t\t\t\tvar temp = workbook.Sheets[sheetName]['!merges'];\r\n\t\t\t\tif (temp && temp.length > 0) {\r\n\t\t\t\t\tspreadsheet.mergeCells = [];\r\n\t\t\t\t\tfor (var i = 0; i < temp.length; i++) {\r\n\t\t\t\t\t\tvar x1 = temp[i].s.c;\r\n\t\t\t\t\t\tvar y1 = temp[i].s.r;\r\n\t\t\t\t\t\tvar x2 = temp[i].e.c;\r\n\t\t\t\t\t\tvar y2 = temp[i].e.r;\r\n\t\t\t\t\t\tvar key = jexcel.getColumnNameFromId([x1,y1]);\r\n\t\t\t\t\t\tspreadsheet.mergeCells[key] = [ x2-x1+1, y2-y1+1 ];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t// Data container\r\n\t\t\t\tvar max_x = 0;\r\n\t\t\t\tvar max_y = 0;\r\n\t\t\t\tvar temp = Object.keys(workbook.Sheets[sheetName]);\r\n\t\t\t\tfor (var i = 0; i < temp.length; i++) {\r\n\t\t\t\t\tif (temp[i].substr(0,1) != '!') {\r\n\t\t\t\t\t\tvar cell = workbook.Sheets[sheetName][temp[i]];\r\n\t\t\t\t\t\tvar info = jexcel.getIdFromColumnName(temp[i], true);\r\n\t\t\t\t\t\tif (! spreadsheet.data[info[1]]) {\r\n\t\t\t\t\t\t\tspreadsheet.data[info[1]] = [];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tspreadsheet.data[info[1]][info[0]] = cell.f ? '=' + cell.f : cell.w;\r\n\t\t\t\t\t\tif (max_x < info[0]) {\r\n\t\t\t\t\t\t\tmax_x = info[0];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (max_y < info[1]) {\r\n\t\t\t\t\t\t\tmax_y = info[1];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// Style\r\n\t\t\t\t\t\tif (cell.style && Object.keys(cell.style).length > 0) {\r\n\t\t\t\t\t\t\tspreadsheet.style[temp[i]] = cell.style;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (cell.s && cell.s.fgColor) {\r\n\t\t\t\t\t\t\tif (spreadsheet.style[temp[i]]) {\r\n\t\t\t\t\t\t\t\tspreadsheet.style[temp[i]] += ';';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tspreadsheet.style[temp[i]] += 'background-color:#' + cell.s.fgColor.rgb;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tvar numColumns = spreadsheet.columns;\r\n\t\t\t\tfor (var j = 0; j <= max_y; j++) {\r\n\t\t\t\t\tfor (var i = 0; i <= max_x; i++) {\r\n\t\t\t\t\t\tif (! spreadsheet.data[j]) {\r\n\t\t\t\t\t\t\tspreadsheet.data[j] = [];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (! spreadsheet.data[j][i]) {\r\n\t\t\t\t\t\t\tif (numColumns < i) {\r\n\t\t\t\t\t\t\t\tspreadsheet.data[j][i] = '';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tspreadsheets.push(spreadsheet);\r\n\t\t\t});\r\n\r\n\t\t\treturn spreadsheets;\r\n\t\t}\r\n\r\n\t\tvar oReq;\r\n\t\toReq = new XMLHttpRequest();\r\n\t\toReq.open(\"GET\", file, true);\r\n\r\n\t\tif(typeof Uint8Array !== 'undefined') {\r\n\t\t\toReq.responseType = \"arraybuffer\";\r\n\t\t\toReq.onload = function(e) {\r\n\t\t\t\tvar arraybuffer = oReq.response;\r\n\t\t\t\tvar data = new Uint8Array(arraybuffer);\r\n\t\t\t\tvar wb = XLSX.read(data, {type:\"array\", cellFormula:true, cellStyles:true });\r\n\t\t\t\t__callback(convert(wb))\r\n\t\t\t};\r\n\t\t} else {\r\n\t\t\toReq.setRequestHeader(\"Accept-Charset\", \"x-user-defined\");\r\n\t\t\toReq.onreadystatechange = function() { if(oReq.readyState == 4 && oReq.status == 200) {\r\n\t\t\t\tvar ff = convertResponseBodyToText(oReq.responseBody);\r\n\t\t\t\tvar wb = XLSX.read(ff, {type:\"binary\", cellFormula:true, cellStyles:true });\r\n\t\t\t\t__callback(convert(wb))\r\n\t\t\t}};\r\n\t\t}\r\n\r\n\t\toReq.send();\r\n\t}\r\n\r\n\t/**\r\n\t * Valid international letter\r\n\t */\r\n\r\n\tjexcel.validLetter = function (text) {\r\n\t\tvar regex = /([\\u0041-\\u005A\\u0061-\\u007A\\u00AA\\u00B5\\u00BA\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u0527\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0\\u08A2-\\u08AC\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0977\\u0979-\\u097F\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C33\\u0C35-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191C\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2183\\u2184\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005\\u3006\\u3031-\\u3035\\u303B\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA697\\uA6A0-\\uA6E5\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA793\\uA7A0-\\uA7AA\\uA7F8-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA80-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC-\\u0400-\\u04FF']+)/g;\r\n\t\treturn text.match(regex) ? 1 : 0;\r\n\t}\r\n\r\n\t/**\r\n\t * Helper injectArray\r\n\t */\r\n\tjexcel.injectArray = function(o, idx, arr) {\r\n\t\treturn o.slice(0, idx).concat(arr).concat(o.slice(idx));\r\n\t}\r\n\r\n\t/**\r\n\t * Get letter based on a number\r\n\t *\r\n\t * @param {number} columnNumber\r\n\t * @return string letter\r\n\t */\r\n\tjexcel.getColumnName = function(columnNumber) {\r\n\t\treturn jexcel.helpers.getColumnName(columnNumber);\r\n\t}\r\n\r\n\t/**\r\n\t * Convert excel like column to jexcel id\r\n\t *\r\n\t * @param string id\r\n\t * @return string id\r\n\t */\r\n\tjexcel.getIdFromColumnName = function (id, arr) {\r\n\t\t// Get the letters\r\n\t\tvar t = /^[a-zA-Z]+/.exec(id);\r\n\r\n\t\tif (t) {\r\n\t\t\t// Base 26 calculation\r\n\t\t\tvar code = 0;\r\n\t\t\tfor (var i = 0; i < t[0].length; i++) {\r\n\t\t\t\tcode += parseInt(t[0].charCodeAt(i) - 64) * Math.pow(26, (t[0].length - 1 - i));\r\n\t\t\t}\r\n\t\t\tcode--;\r\n\t\t\t// Make sure jexcel starts on zero\r\n\t\t\tif (code < 0) {\r\n\t\t\t\tcode = 0;\r\n\t\t\t}\r\n\r\n\t\t\t// Number\r\n\t\t\tvar number = parseInt(/[0-9]+$/.exec(id));\r\n\t\t\tif (number > 0) {\r\n\t\t\t\tnumber--;\r\n\t\t\t}\r\n\r\n\t\t\tif (arr == true) {\r\n\t\t\t\tid = [ code, number ];\r\n\t\t\t} else {\r\n\t\t\t\tid = code + '-' + number;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn id;\r\n\t}\r\n\r\n\t/**\r\n\t * Convert jexcel id to excel like column name\r\n\t *\r\n\t * @param string id\r\n\t * @return string id\r\n\t */\r\n\tjexcel.getColumnNameFromId = function (cellId) {\r\n\t\tif (! Array.isArray(cellId)) {\r\n\t\t\tcellId = cellId.split('-');\r\n\t\t}\r\n\r\n\t\treturn jexcel.getColumnName(parseInt(cellId[0])) + (parseInt(cellId[1]) + 1);\r\n\t}\r\n\r\n\t/**\r\n\t * Verify element inside jexcel table\r\n\t *\r\n\t * @param string id\r\n\t * @return string id\r\n\t */\r\n\tjexcel.getElement = function(element) {\r\n\t\tvar jexcelSection = 0;\r\n\t\tvar jexcelElement = 0;\r\n\r\n\t\tfunction path (element) {\r\n\t\t\tif (element.className) {\r\n\t\t\t\tif (element.classList.contains('jexcel_container')) {\r\n\t\t\t\t\tjexcelElement = element;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (element.tagName == 'THEAD') {\r\n\t\t\t\tjexcelSection = 1;\r\n\t\t\t} else if (element.tagName == 'TBODY') {\r\n\t\t\t\tjexcelSection = 2;\r\n\t\t\t}\r\n\r\n\t\t\tif (element.parentNode) {\r\n\t\t\t\tif (! jexcelElement) {\r\n\t\t\t\t\tpath(element.parentNode);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tpath(element);\r\n\r\n\t\treturn [ jexcelElement, jexcelSection ];\r\n\t}\r\n\r\n\tjexcel.doubleDigitFormat = function(v) {\r\n\t\tv = ''+v;\r\n\t\tif (v.length == 1) {\r\n\t\t\tv = '0'+v;\r\n\t\t}\r\n\t\treturn v;\r\n\t}\r\n\r\n\tjexcel.createFromTable = function(el, options) {\r\n\t\tif (el.tagName != 'TABLE') {\r\n\t\t\tconsole.log('Element is not a table');\r\n\t\t} else {\r\n\t\t\t// Configuration\r\n\t\t\tif (! options) {\r\n\t\t\t\toptions = {};\r\n\t\t\t}\r\n\t\t\toptions.columns = [];\r\n\t\t\toptions.data = [];\r\n\r\n\t\t\t// Colgroup\r\n\t\t\tvar colgroup = el.querySelectorAll('colgroup > col');\r\n\t\t\tif (colgroup.length) {\r\n\t\t\t\t// Get column width\r\n\t\t\t\tfor (var i = 0; i < colgroup.length; i++) {\r\n\t\t\t\t\tvar width = colgroup[i].style.width;\r\n\t\t\t\t\tif (! width) {\r\n\t\t\t\t\t\tvar width = colgroup[i].getAttribute('width');\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// Set column width\r\n\t\t\t\t\tif (width) {\r\n\t\t\t\t\t\tif (! options.columns[i]) {\r\n\t\t\t\t\t\t\toptions.columns[i] = {}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\toptions.columns[i].width = width;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Parse header\r\n\t\t\tvar parseHeader = function(header) {\r\n\t\t\t\t// Get width information\r\n\t\t\t\tvar info = header.getBoundingClientRect();\r\n\t\t\t\tvar width = info.width > 50 ? info.width : 50;\r\n\r\n\t\t\t\t// Create column option\r\n\t\t\t\tif (! options.columns[i]) {\r\n\t\t\t\t\toptions.columns[i] = {};\r\n\t\t\t\t}\r\n\t\t\t\tif (header.getAttribute('data-celltype')) {\r\n\t\t\t\t\toptions.columns[i].type = header.getAttribute('data-celltype');\r\n\t\t\t\t} else {\r\n\t\t\t\t\toptions.columns[i].type = 'text';\r\n\t\t\t\t}\r\n\t\t\t\toptions.columns[i].width = width + 'px';\r\n\t\t\t\toptions.columns[i].title = header.innerHTML;\r\n\t\t\t\toptions.columns[i].align = header.style.textAlign || 'center';\r\n\r\n\t\t\t\tif (info = header.getAttribute('name')) {\r\n\t\t\t\t\toptions.columns[i].name = info;\r\n\t\t\t\t}\r\n\t\t\t\tif (info = header.getAttribute('id')) {\r\n\t\t\t\t\toptions.columns[i].id = info;\r\n\t\t\t\t}\r\n\t\t\t\tif (info = header.getAttribute('data-mask')) {\r\n\t\t\t\t\toptions.columns[i].mask = info;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Headers\r\n\t\t\tvar nested = [];\r\n\t\t\tvar headers = el.querySelectorAll(':scope > thead > tr');\r\n\t\t\tif (headers.length) {\r\n\t\t\t\tfor (var j = 0; j < headers.length - 1; j++) {\r\n\t\t\t\t\tvar cells = [];\r\n\t\t\t\t\tfor (var i = 0; i < headers[j].children.length; i++) {\r\n\t\t\t\t\t\tvar row = {\r\n\t\t\t\t\t\t\ttitle: headers[j].children[i].textContent,\r\n\t\t\t\t\t\t\tcolspan: headers[j].children[i].getAttribute('colspan') || 1,\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tcells.push(row);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tnested.push(cells);\r\n\t\t\t\t}\r\n\t\t\t\t// Get the last row in the thead\r\n\t\t\t\theaders = headers[headers.length-1].children;\r\n\t\t\t\t// Go though the headers\r\n\t\t\t\tfor (var i = 0; i < headers.length; i++) {\r\n\t\t\t\t\tparseHeader(headers[i]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Content\r\n\t\t\tvar rowNumber = 0;\r\n\t\t\tvar mergeCells = {};\r\n\t\t\tvar rows = {};\r\n\t\t\tvar style = {};\r\n\t\t\tvar classes = {};\r\n\r\n\t\t\tvar content = el.querySelectorAll(':scope > tr, :scope > tbody > tr');\r\n\t\t\tfor (var j = 0; j < content.length; j++) {\r\n\t\t\t\toptions.data[rowNumber] = [];\r\n\t\t\t\tif (options.parseTableFirstRowAsHeader == true && ! headers.length && j == 0) {\r\n\t\t\t\t\tfor (var i = 0; i < content[j].children.length; i++) {\r\n\t\t\t\t\t\tparseHeader(content[j].children[i]);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tfor (var i = 0; i < content[j].children.length; i++) {\r\n\t\t\t\t\t\t// WickedGrid formula compatibility\r\n\t\t\t\t\t\tvar value = content[j].children[i].getAttribute('data-formula');\r\n\t\t\t\t\t\tif (value) {\r\n\t\t\t\t\t\t\tif (value.substr(0,1) != '=') {\r\n\t\t\t\t\t\t\t\tvalue = '=' + value;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tvar value = content[j].children[i].innerHTML;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\toptions.data[rowNumber].push(value);\r\n\r\n\t\t\t\t\t\t// Key\r\n\t\t\t\t\t\tvar cellName = jexcel.getColumnNameFromId([ i, j ]);\r\n\r\n\t\t\t\t\t\t// Classes\r\n\t\t\t\t\t\tvar tmp = content[j].children[i].getAttribute('class');\r\n\t\t\t\t\t\tif (tmp) {\r\n\t\t\t\t\t\t\tclasses[cellName] = tmp;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// Merged cells\r\n\t\t\t\t\t\tvar mergedColspan = parseInt(content[j].children[i].getAttribute('colspan')) || 0;\r\n\t\t\t\t\t\tvar mergedRowspan = parseInt(content[j].children[i].getAttribute('rowspan')) || 0;\r\n\t\t\t\t\t\tif (mergedColspan || mergedRowspan) {\r\n\t\t\t\t\t\t\tmergeCells[cellName] = [ mergedColspan || 1, mergedRowspan || 1 ];\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// Avoid problems with hidden cells\r\n\t\t\t\t\t\tif (s = content[j].children[i].style && content[j].children[i].style.display == 'none') {\r\n\t\t\t\t\t\t\tcontent[j].children[i].style.display = '';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// Get style\r\n\t\t\t\t\t\tvar s = content[j].children[i].getAttribute('style');\r\n\t\t\t\t\t\tif (s) {\r\n\t\t\t\t\t\t\tstyle[cellName] = s;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// Bold\r\n\t\t\t\t\t\tif (content[j].children[i].classList.contains('styleBold')) {\r\n\t\t\t\t\t\t\tif (style[cellName]) {\r\n\t\t\t\t\t\t\t\tstyle[cellName] += '; font-weight:bold;';\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tstyle[cellName] = 'font-weight:bold;';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Row Height\r\n\t\t\t\t\tif (content[j].style && content[j].style.height) {\r\n\t\t\t\t\t\trows[j] = { height: content[j].style.height };\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Index\r\n\t\t\t\t\trowNumber++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Nested\r\n\t\t\tif (Object.keys(nested).length > 0) {\r\n\t\t\t\toptions.nestedHeaders = nested;\r\n\t\t\t}\r\n\t\t\t// Style\r\n\t\t\tif (Object.keys(style).length > 0) {\r\n\t\t\t\toptions.style = style;\r\n\t\t\t}\r\n\t\t\t// Merged\r\n\t\t\tif (Object.keys(mergeCells).length > 0) {\r\n\t\t\t\toptions.mergeCells = mergeCells;\r\n\t\t\t}\r\n\t\t\t// Row height\r\n\t\t\tif (Object.keys(rows).length > 0) {\r\n\t\t\t\toptions.rows = rows;\r\n\t\t\t}\r\n\t\t\t// Classes\r\n\t\t\tif (Object.keys(classes).length > 0) {\r\n\t\t\t\toptions.classes = classes;\r\n\t\t\t}\r\n\r\n\t\t\tvar content = el.querySelectorAll('tfoot tr');\r\n\t\t\tif (content.length) {\r\n\t\t\t\tvar footers = [];\r\n\t\t\t\tfor (var j = 0; j < content.length; j++) {\r\n\t\t\t\t\tvar footer = [];\r\n\t\t\t\t\tfor (var i = 0; i < content[j].children.length; i++) {\r\n\t\t\t\t\t\tfooter.push(content[j].children[i].textContent);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfooters.push(footer);\r\n\t\t\t\t}\r\n\t\t\t\tif (Object.keys(footers).length > 0) {\r\n\t\t\t\t\toptions.footers = footers;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// TODO: data-hiddencolumns=\"3,4\"\r\n\r\n\t\t\t// I guess in terms the better column type\r\n\t\t\tif (options.parseTableAutoCellType == true) {\r\n\t\t\t\tvar pattern = [];\r\n\t\t\t\tfor (var i = 0; i < options.columns.length; i++) {\r\n\t\t\t\t\tvar test = true;\r\n\t\t\t\t\tvar testCalendar = true;\r\n\t\t\t\t\tpattern[i] = [];\r\n\t\t\t\t\tfor (var j = 0; j < options.data.length; j++) {\r\n\t\t\t\t\t\tvar value = options.data[j][i];\r\n\t\t\t\t\t\tif (! pattern[i][value]) {\r\n\t\t\t\t\t\t\tpattern[i][value] = 0;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tpattern[i][value]++;\r\n\t\t\t\t\t\tif (value.length > 25) {\r\n\t\t\t\t\t\t\ttest = false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (value.length == 10) {\r\n\t\t\t\t\t\t\tif (! (value.substr(4,1) == '-' && value.substr(7,1) == '-')) {\r\n\t\t\t\t\t\t\t\ttestCalendar = false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\ttestCalendar = false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar keys = Object.keys(pattern[i]).length;\r\n\t\t\t\t\tif (testCalendar) {\r\n\t\t\t\t\t\toptions.columns[i].type = 'calendar';\r\n\t\t\t\t\t} else if (test == true && keys > 1 && keys <= parseInt(options.data.length * 0.1)) {\r\n\t\t\t\t\t\toptions.columns[i].type = 'dropdown';\r\n\t\t\t\t\t\toptions.columns[i].source = Object.keys(pattern[i]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn options;\r\n\t\t}\r\n\t}\r\n\r\n\t// Helpers\r\n\tjexcel.helpers = (function() {\r\n\t\tvar component = {};\r\n\r\n\t\t/**\r\n\t\t * Get carret position for one element\r\n\t\t */\r\n\t\tcomponent.getCaretIndex = function(e) {\r\n\t\t\tif (this.config.root) {\r\n\t\t\t\tvar d = this.config.root;\r\n\t\t\t} else {\r\n\t\t\t\tvar d = window;\r\n\t\t\t}\r\n\t\t\tvar pos = 0;\r\n\t\t\tvar s = d.getSelection();\r\n\t\t\tif (s) {\r\n\t\t\t\tif (s.rangeCount !== 0) {\r\n\t\t\t\t\tvar r = s.getRangeAt(0);\r\n\t\t\t\t\tvar p = r.cloneRange();\r\n\t\t\t\t\tp.selectNodeContents(e);\r\n\t\t\t\t\tp.setEnd(r.endContainer, r.endOffset);\r\n\t\t\t\t\tpos = p.toString().length;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn pos;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Invert keys and values\r\n\t\t */\r\n\t\tcomponent.invert = function(o) {\r\n\t\t\tvar d = [];\r\n\t\t\tvar k = Object.keys(o);\r\n\t\t\tfor (var i = 0; i < k.length; i++) {\r\n\t\t\t\td[o[k[i]]] = k[i];\r\n\t\t\t}\r\n\t\t\treturn d;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Get letter based on a number\r\n\t\t *\r\n\t\t * @param {number} columnNumber\r\n\t\t * @return string letter\r\n\t\t */\r\n\t\tcomponent.getColumnName = function(columnNumber) {\r\n\t\t\tlet dividend = columnNumber+1;\r\n\t\t\tlet columnName = \"\";\r\n\t\t\tlet modulo;\r\n\t\t\twhile (dividend > 0) {\r\n\t\t\t\tmodulo = (dividend - 1) % 26;\r\n\t\t\t\tcolumnName = String.fromCharCode(65 + modulo).toString() + columnName;\r\n\t\t\t\tdividend = parseInt((dividend - modulo) / 26);\r\n\t\t\t}\r\n\t\t\treturn  columnName;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Get column name from coords\r\n\t\t */\r\n\t\tcomponent.getColumnNameFromCoords = function(x, y) {\r\n\t\t\treturn component.getColumnName(parseInt(x)) + (parseInt(y) + 1);\r\n\t\t}\r\n\r\n\t\tcomponent.getCoordsFromColumnName = function(columnName) {\r\n\t\t\t// Get the letters\r\n\t\t\tvar t = /^[a-zA-Z]+/.exec(columnName);\r\n\r\n\t\t\tif (t) {\r\n\t\t\t\t// Base 26 calculation\r\n\t\t\t\tvar code = 0;\r\n\t\t\t\tfor (var i = 0; i < t[0].length; i++) {\r\n\t\t\t\t\tcode += parseInt(t[0].charCodeAt(i) - 64) * Math.pow(26, (t[0].length - 1 - i));\r\n\t\t\t\t}\r\n\t\t\t\tcode--;\r\n\t\t\t\t// Make sure jspreadsheet starts on zero\r\n\t\t\t\tif (code < 0) {\r\n\t\t\t\t\tcode = 0;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Number\r\n\t\t\t\tvar number = parseInt(/[0-9]+$/.exec(columnName)) || null;\r\n\t\t\t\tif (number > 0) {\r\n\t\t\t\t\tnumber--;\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn [ code, number ];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Extract json configuration from a TABLE DOM tag\r\n\t\t */\r\n\t\tcomponent.createFromTable = function() {}\r\n\r\n\t\t/**\r\n\t\t * Helper injectArray\r\n\t\t */\r\n\t\tcomponent.injectArray = function(o, idx, arr) {\r\n\t\t\treturn o.slice(0, idx).concat(arr).concat(o.slice(idx));\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Parse CSV string to JS array\r\n\t\t */\r\n\t\tcomponent.parseCSV = function(str, delimiter) {\r\n\t\t\t// user-supplied delimeter or default comma\r\n\t\t\tdelimiter = (delimiter || \",\");\r\n\r\n\t\t\t// Final data\r\n\t\t\tvar col = 0;\r\n\t\t\tvar row = 0;\r\n\t\t\tvar num = 0;\r\n\t\t\tvar data = [[]];\r\n\t\t\tvar limit = 0;\r\n\t\t\tvar flag = null;\r\n\t\t\tvar inside = false;\r\n\t\t\tvar closed = false;\r\n\r\n\t\t\t// Go over all chars\r\n\t\t\tfor (var i = 0; i < str.length; i++) {\r\n\t\t\t\t// Create new row\r\n\t\t\t\tif (! data[row]) {\r\n\t\t\t\t\tdata[row] = [];\r\n\t\t\t\t}\r\n\t\t\t\t// Create new column\r\n\t\t\t\tif (! data[row][col]) {\r\n\t\t\t\t\tdata[row][col] = '';\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Ignore\r\n\t\t\t\tif (str[i] == '\\r') {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// New row\r\n\t\t\t\tif ((str[i] == '\\n' || str[i] == delimiter) && (inside == false || closed == true || ! flag)) {\r\n\t\t\t\t\t// Restart flags\r\n\t\t\t\t\tflag = null;\r\n\t\t\t\t\tinside = false;\r\n\t\t\t\t\tclosed = false;\r\n\r\n\t\t\t\t\tif (data[row][col][0] == '\"') {\r\n\t\t\t\t\t\tvar val = data[row][col].trim();\r\n\t\t\t\t\t\tif (val[val.length-1] == '\"') {\r\n\t\t\t\t\t\t\tdata[row][col] = val.substr(1, val.length-2);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Go to the next cell\r\n\t\t\t\t\tif (str[i] == '\\n') {\r\n\t\t\t\t\t\t// New line\r\n\t\t\t\t\t\tcol = 0;\r\n\t\t\t\t\t\trow++;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// New column\r\n\t\t\t\t\t\tcol++;\r\n\t\t\t\t\t\tif (col > limit) {\r\n\t\t\t\t\t\t\t// Keep the reference of max column\r\n\t\t\t\t\t\t\tlimit = col;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Inside quotes\r\n\t\t\t\t\tif (str[i] == '\"') {\r\n\t\t\t\t\t\tinside = ! inside;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (flag === null) {\r\n\t\t\t\t\t\tflag = inside;\r\n\t\t\t\t\t\tif (flag == true) {\r\n\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (flag === true && ! closed) {\r\n\t\t\t\t\t\tif (str[i] == '\"') {\r\n\t\t\t\t\t\t\tif (str[i+1] == '\"') {\r\n\t\t\t\t\t\t\t\tinside = true;\r\n\t\t\t\t\t\t\t\tdata[row][col] += str[i];\r\n\t\t\t\t\t\t\t\ti++;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tclosed = true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tdata[row][col] += str[i];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Make sure a square matrix is generated\r\n\t\t\tfor (var j = 0; j < data.length; j++) {\r\n\t\t\t\tfor (var i = 0; i <= limit; i++) {\r\n\t\t\t\t\tif (data[j][i] === undefined) {\r\n\t\t\t\t\t\tdata[j][i] = '';\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn data;\r\n\t\t}\r\n\r\n\t\treturn component;\r\n\t})();\r\n\r\n\t/**\r\n\t * Jquery Support\r\n\t */\r\n\tif (typeof(jQuery) != 'undefined') {\r\n\t\t(function($){\r\n\t\t\t$.fn.jspreadsheet = $.fn.jexcel = function(mixed) {\r\n\t\t\t\tvar spreadsheetContainer = $(this).get(0);\r\n\t\t\t\tif (! spreadsheetContainer.jexcel) {\r\n\t\t\t\t\treturn jexcel($(this).get(0), arguments[0]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (Array.isArray(spreadsheetContainer.jexcel)) {\r\n\t\t\t\t\t\treturn spreadsheetContainer.jexcel[mixed][arguments[1]].apply(this, Array.prototype.slice.call( arguments, 2 ));\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn spreadsheetContainer.jexcel[mixed].apply(this, Array.prototype.slice.call( arguments, 1 ));\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t})(jQuery);\r\n\t}\r\n\r\n\treturn jexcel;\r\n})));\r\n"],"names":["global","factory","jspreadsheet","jexcel","window","Version","info","title","version","type","host","license","print","join","isFormula","value","v","getMask","o","format","mask","locale","opt","options","decimal","el","obj","Element","HTMLDocument","console","error","tagName","createFromTable","div","document","createElement","parentNode","insertBefore","remove","defaults","url","method","requestVariables","data","sorting","copyCompatibility","root","rows","columns","colHeaders","colWidths","colAlignments","nestedHeaders","defaultColWidth","defaultColAlign","defaultRowHeight","minSpareRows","minSpareCols","minDimensions","allowExport","includeHeadersOnDownload","includeHeadersOnCopy","columnSorting","columnDrag","columnResize","rowResize","rowDrag","editable","allowInsertRow","allowManualInsertRow","allowInsertColumn","allowManualInsertColumn","allowDeleteRow","allowDeletingAllRows","allowDeleteColumn","allowRenameColumn","allowComments","wordWrap","imageOptions","csv","csvFileName","csvHeaders","csvDelimiter","parseTableFirstRowAsHeader","parseTableAutoCellType","selectionCopy","mergeCells","toolbar","search","pagination","paginationOptions","fullscreen","lazyLoading","loadingSpin","tableOverflow","tableHeight","tableWidth","textOverflow","meta","style","classes","parseFormulas","autoIncrement","autoCasting","secureFormulas","stripHTML","stripHTMLOnCopy","filters","footers","onundo","onredo","onload","onchange","oncomments","onbeforechange","onafterchanges","onbeforeinsertrow","oninsertrow","onbeforeinsertcolumn","oninsertcolumn","onbeforedeleterow","ondeleterow","onbeforedeletecolumn","ondeletecolumn","onmoverow","onmovecolumn","onresizerow","onresizecolumn","onsort","onselection","oncopy","onpaste","onbeforepaste","onmerge","onfocus","onblur","onchangeheader","oncreateeditor","oneditionstart","oneditionend","onchangestyle","onchangemeta","onchangepage","onbeforesave","onsave","onevent","persistance","updateTable","detachForUpdates","freezeColumns","text","noRecordsFound","showingPage","show","entries","columnName","insertANewColumnBefore","insertANewColumnAfter","deleteSelectedColumns","renameThisColumn","orderAscending","orderDescending","insertANewRowBefore","insertANewRowAfter","deleteSelectedRows","editComments","addComments","comments","clearComments","copy","paste","saveAs","about","areYouSureToDeleteTheSelectedRows","areYouSureToDeleteTheSelectedColumns","thisActionWillDestroyAnyExistingMergedCellsAreYouSure","thisActionWillClearYourSearchResultsAreYouSure","thereIsAConflictWithAnotherMergedCell","invalidMergeProperties","cellAlreadyMerged","noCellsSelected","property","hasOwnProperty","textKey","corner","contextMenu","textarea","ads","content","table","thead","tbody","results","searchInput","pageNumber","headerContainer","colgroupContainer","headers","records","history","formula","colgroup","selection","highlighted","selectedCell","selectedContainer","filter","cursor","historyIndex","ignoreEvents","ignoreHistory","edition","hashString","resizing","dragging","activate","classList","add","dispatch","event","ret","apply","arguments","Array","prototype","slice","call","prepareJson","save","prepareTable","size","length","keys","Object","multiple","i","name","source","editor","allowEmpty","width","align","push","index","dataType","success","createTable","jSuites","ajax","onscroll","e","scrollControls","onwheel","wheelControls","searchContainer","searchText","createTextNode","appendChild","resetSelection","paginationUpdateContainer","paginationDropdown","parseInt","page","temp","innerHTML","tempCol","setAttribute","j","createNestedHeader","createCellHeader","td","className","display","id","tabIndex","contextmenu","onclick","close","span","container","paginationInfo","paginationPages","createToolbar","maxHeight","setData","setStyle","k","cell","getIdFromColumnName","refresh","loading","result","hide","JSON","parse","isArray","row","size_i","size_j","min_i","min_j","max_i","max_j","undefined","startNumber","finalNumber","quantityPerPage","tr","createRow","updatePagination","num","setMerge","getData","dataOnly","dataset","px","py","x","y","contains","getJsonRow","rowNumber","rowData","getJson","newValue","stringify","getRowData","setRowData","getColumnNameFromId","setValue","getColumnData","columnNumber","setColumnData","colNumber","height","createCell","parseValue","substr","executeFormula","Number","masked","render","t","split","t1","match","RegExp","t2","validDate","date","val","secureFormula","textContent","element","checked","readOnly","formatted","tmp","calendar","extractDateFromString","getDateString","getDropDownValue","color","backgroundColor","img","src","stripScript","colAlign","textAlign","whiteSpace","overflow","colWidth","getColumnName","innerText","updateNestedHeader","children","nestedInformation","headerIndex","colspan","numberOfColumns","column","toolbarItem","tooltip","a","b","getAttribute","raiseInitialOnChange","toolbarDropdownOption","selectedValue","selected","dispatchEvent","Event","cellName","rowspan","ignoreHistoryAndEvents","test","alert","x1","y1","x2","y2","cells","updateCell","updateSelection","setHistory","action","getMerge","mergedCells","removeMerge","keepOptions","removeAttribute","destroyMerged","isColMerged","cols","isRowMerged","openFilter","columnId","log","optionsFiltered","hasBlanks","paddingLeft","paddingRight","autocomplete","opened","position","onclose","resetFilters","dropdown","getValue","getText","closeFilter","refreshSelection","updateResult","query","label","openEditor","empty","createEditor","getBoundingClientRect","minHeight","closeEditor","focus","rect","rectContent","innerHeight","bottom","top","image","cell_height","setProperty","Math","floor","updateCornerPosition","disabledMaskOnEdition","m","input","scrollLeft","scrollWidth","removeProperty","extract","getCell","getColumnOptions","getCellFromCoords","getLabel","getLabelFromCoords","processedValue","getValueFromCoords","force","updateFormulaChain","setValueFromCoords","setCheckRadioValue","Option","c","getElementsByTagName","removeChild","record","col","oldValue","copyData","d","h","breakControl","posx","posy","tokens","affectedTokens","token","updateFormula","Date","setDate","getDate","getFullYear","doubleDigitFormat","getMonth","updateSelectionFromCoords","conditionalSelectionUpdate","blur","previousStatus","ux","uy","left","el1","el2","origin","updated","previousState","borderLeft","borderRight","borderTop","borderBottom","removeCopyingSelection","removeCopySelection","updateCopySelection","x3","y3","last","lastX","contentRect","lastRect","w2","h2","scrollTop","getFreezeWidth","updateScroll","direction","w1","h1","reference","referenceRect","freezed","getWidth","setWidth","oldWidth","w","setHeight","oldHeight","getHeight","$","setFooter","tfoot","getHeader","setHeader","prompt","getHeaders","asArray","getMeta","key","setMeta","prop","updateMeta","affectedCells","newMeta","getStyle","resetStyle","applyStyle","cellId","currentValue","oneApplication","trim","getComments","withAuthor","setComments","author","getConfig","orderBy","order","confirm","toLowerCase","valueA","valueB","sort","tp","table_head","first_row_idx","row_idx","unshift","table_foot","last_row_idx","updateOrderArrow","updateOrder","updateTableReferences","loadPage","moveRow","ignoreDom","resetSearch","indexOf","nextSibling","splice","insertRow","mixed","numOfRows","lastRow","rowIndex","currentRecords","currentData","currentRows","rowRecords","rowNode","deleteRow","number","getSelectedRows","mergeExists","moveColumn","insertColumn","properties","numOfColumns","lastColumn","columnIndex","injectArray","currentHeaders","currentColgroup","historyHeaders","historyColgroup","historyRecords","historyData","historyFooters","currentRecord","deleteColumn","getSelectedColumns","asIds","getHighlighted","mergeCellUpdates","updatePosition","columnIdFrom","columnIdTo","totalX","totalY","updateFormulas","numBlankRows","numBlankCols","setTimeout","isReadOnly","setReadOnly","state","showRow","hideRow","showColumn","hideColumn","showIndex","hideIndex","chainLoopProtection","referencesToUpdate","newFormula","letter","testLetter","testNumber","exec","inside","toUpperCase","expression","formulaResults","formulaLoopProtection","execute","parentId","tokensUpdate","f","e1","e2","replace","formulaExpressions","eval","parseNumber","res","isInteger","up","shiftKey","ctrlKey","visible","loadValidation","item","firstChild","loadUp","whichPage","group","get","down","lastChild","loadDown","right","first","selectAll","ceil","startRow","finalRow","currentPage","selectedPage","totalPages","addToResult","parsedQuery","forEach","total","oldPage","quantyOfPages","paginationItem","args","download","includeHeaders","blob","Blob","navigator","msSaveOrOpenBlob","pom","URL","createObjectURL","href","body","click","changes","delimiter","returnData","header","colLabel","rowLabel","copyHeader","numOfCols","copyX","copyY","isPartialCopy","nested","includes","str","strLabel","select","execCommand","hash","x_1","y_1","x_2","y_2","toString","parseCSV","repeats","arrayB","map","arrayC","newStyle","oldStyle","styleIndex","colIndex","copying","querySelectorAll","historyProcessRow","historyRecord","historyProcessColumn","undo","redo","combo","white_spaces","cell_content","enclosed","was_enclosed","data_length","curr_char","next_char","chr","charCodeAt","destroy","init","current","build","addEventListener","newData","shift","items","comment","shortcut","clipboard","readText","then","updateFreezePosition","target","timeControlLoading","clientHeight","scrollHeight","shifted","setDictionary","setExtensions","timeControl","destroyEvents","removeEventListener","mouseUpControls","mouseDownControls","mouseMoveControls","mouseOverControls","doubleClickControls","pasteControls","contextMenuControls","touchStartControls","touchEndControls","keyDownControls","destroyEventHandlers","which","preventDefault","altKey","editorTextarea","editorValue","editorIndexOf","selectionStart","selectionEnd","selectedRow","selectedHeader","metaKey","cutControls","copyControls","rowId","keyCode","String","fromCharCode","validLetter","clearTimeout","isMouseAction","buttons","mouseButton","button","jexcelTable","getElement","selectedCorner","offsetX","mousePosition","pageX","offsetY","destination","c1","c2","pageY","clientWidth","getCellCoords","newWidth","currentWidth","newHeight","previousSibling","tempWidth","tempHeight","clientX","clientY","enabled","clipboardData","selected_cell","l","min","r","max","open","tmpElement","tabs","instances","spreadsheet","link","worksheet","sheetName","createTabs","fromSpreadsheet","file","__callback","convert","workbook","spreadsheets","SheetNames","Sheets","wpx","hpx","s","max_x","max_y","fgColor","rgb","numColumns","oReq","XMLHttpRequest","Uint8Array","responseType","arraybuffer","response","wb","XLSX","read","cellFormula","cellStyles","setRequestHeader","onreadystatechange","readyState","status","ff","convertResponseBodyToText","responseBody","send","regex","idx","arr","concat","helpers","code","pow","jexcelSection","jexcelElement","path","parseHeader","mergedColspan","mergedRowspan","footer","pattern","testCalendar","component","getCaretIndex","config","pos","getSelection","rangeCount","getRangeAt","p","cloneRange","selectNodeContents","setEnd","endContainer","endOffset","invert","dividend","modulo","getColumnNameFromCoords","getCoordsFromColumnName","limit","flag","closed","jQuery","fn","spreadsheetContainer"],"sourceRoot":""}